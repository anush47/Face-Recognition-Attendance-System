var hA=(n,t)=>()=>(t||n((t={exports:{}}).exports,t),t.exports);var Pz=hA((Vz,a_)=>{function pA(n,t){for(var e=0;e<t.length;e++){const r=t[e];if(typeof r!="string"&&!Array.isArray(r)){for(const a in r)if(a!=="default"&&!(a in n)){const o=Object.getOwnPropertyDescriptor(r,a);o&&Object.defineProperty(n,a,o.get?o:{enumerable:!0,get:()=>r[a]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const u of o.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&r(u)}).observe(document,{childList:!0,subtree:!0});function e(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(a){if(a.ep)return;a.ep=!0;const o=e(a);fetch(a.href,o)}})();function Sw(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Dp={exports:{}},ju={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Cx;function vA(){if(Cx)return ju;Cx=1;var n=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function e(r,a,o){var u=null;if(o!==void 0&&(u=""+o),a.key!==void 0&&(u=""+a.key),"key"in a){o={};for(var l in a)l!=="key"&&(o[l]=a[l])}else o=a;return a=o.ref,{$$typeof:n,type:r,key:u,ref:a!==void 0?a:null,props:o}}return ju.Fragment=t,ju.jsx=e,ju.jsxs=e,ju}var _x;function mA(){return _x||(_x=1,Dp.exports=vA()),Dp.exports}var N=mA(),kp={exports:{}},Ge={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rx;function gA(){if(Rx)return Ge;Rx=1;var n=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),e=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),u=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.iterator;function m(P){return P===null||typeof P!="object"?null:(P=p&&P[p]||P["@@iterator"],typeof P=="function"?P:null)}var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b=Object.assign,x={};function w(P,q,ne){this.props=P,this.context=q,this.refs=x,this.updater=ne||g}w.prototype.isReactComponent={},w.prototype.setState=function(P,q){if(typeof P!="object"&&typeof P!="function"&&P!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,P,q,"setState")},w.prototype.forceUpdate=function(P){this.updater.enqueueForceUpdate(this,P,"forceUpdate")};function E(){}E.prototype=w.prototype;function C(P,q,ne){this.props=P,this.context=q,this.refs=x,this.updater=ne||g}var _=C.prototype=new E;_.constructor=C,b(_,w.prototype),_.isPureReactComponent=!0;var R=Array.isArray,A={H:null,A:null,T:null,S:null,V:null},D=Object.prototype.hasOwnProperty;function M(P,q,ne,J,le,ye){return ne=ye.ref,{$$typeof:n,type:P,key:q,ref:ne!==void 0?ne:null,props:ye}}function k(P,q){return M(P.type,q,void 0,void 0,void 0,P.props)}function B(P){return typeof P=="object"&&P!==null&&P.$$typeof===n}function O(P){var q={"=":"=0",":":"=2"};return"$"+P.replace(/[=:]/g,function(ne){return q[ne]})}var V=/\/+/g;function H(P,q){return typeof P=="object"&&P!==null&&P.key!=null?O(""+P.key):q.toString(36)}function ee(){}function $(P){switch(P.status){case"fulfilled":return P.value;case"rejected":throw P.reason;default:switch(typeof P.status=="string"?P.then(ee,ee):(P.status="pending",P.then(function(q){P.status==="pending"&&(P.status="fulfilled",P.value=q)},function(q){P.status==="pending"&&(P.status="rejected",P.reason=q)})),P.status){case"fulfilled":return P.value;case"rejected":throw P.reason}}throw P}function K(P,q,ne,J,le){var ye=typeof P;(ye==="undefined"||ye==="boolean")&&(P=null);var pe=!1;if(P===null)pe=!0;else switch(ye){case"bigint":case"string":case"number":pe=!0;break;case"object":switch(P.$$typeof){case n:case t:pe=!0;break;case h:return pe=P._init,K(pe(P._payload),q,ne,J,le)}}if(pe)return le=le(P),pe=J===""?"."+H(P,0):J,R(le)?(ne="",pe!=null&&(ne=pe.replace(V,"$&/")+"/"),K(le,q,ne,"",function(xe){return xe})):le!=null&&(B(le)&&(le=k(le,ne+(le.key==null||P&&P.key===le.key?"":(""+le.key).replace(V,"$&/")+"/")+pe)),q.push(le)),1;pe=0;var de=J===""?".":J+":";if(R(P))for(var ce=0;ce<P.length;ce++)J=P[ce],ye=de+H(J,ce),pe+=K(J,q,ne,ye,le);else if(ce=m(P),typeof ce=="function")for(P=ce.call(P),ce=0;!(J=P.next()).done;)J=J.value,ye=de+H(J,ce++),pe+=K(J,q,ne,ye,le);else if(ye==="object"){if(typeof P.then=="function")return K($(P),q,ne,J,le);throw q=String(P),Error("Objects are not valid as a React child (found: "+(q==="[object Object]"?"object with keys {"+Object.keys(P).join(", ")+"}":q)+"). If you meant to render a collection of children, use an array instead.")}return pe}function L(P,q,ne){if(P==null)return P;var J=[],le=0;return K(P,J,"","",function(ye){return q.call(ne,ye,le++)}),J}function W(P){if(P._status===-1){var q=P._result;q=q(),q.then(function(ne){(P._status===0||P._status===-1)&&(P._status=1,P._result=ne)},function(ne){(P._status===0||P._status===-1)&&(P._status=2,P._result=ne)}),P._status===-1&&(P._status=0,P._result=q)}if(P._status===1)return P._result.default;throw P._result}var U=typeof reportError=="function"?reportError:function(P){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var q=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof P=="object"&&P!==null&&typeof P.message=="string"?String(P.message):String(P),error:P});if(!window.dispatchEvent(q))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",P);return}console.error(P)};function Z(){}return Ge.Children={map:L,forEach:function(P,q,ne){L(P,function(){q.apply(this,arguments)},ne)},count:function(P){var q=0;return L(P,function(){q++}),q},toArray:function(P){return L(P,function(q){return q})||[]},only:function(P){if(!B(P))throw Error("React.Children.only expected to receive a single React element child.");return P}},Ge.Component=w,Ge.Fragment=e,Ge.Profiler=a,Ge.PureComponent=C,Ge.StrictMode=r,Ge.Suspense=c,Ge.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=A,Ge.__COMPILER_RUNTIME={__proto__:null,c:function(P){return A.H.useMemoCache(P)}},Ge.cache=function(P){return function(){return P.apply(null,arguments)}},Ge.cloneElement=function(P,q,ne){if(P==null)throw Error("The argument must be a React element, but you passed "+P+".");var J=b({},P.props),le=P.key,ye=void 0;if(q!=null)for(pe in q.ref!==void 0&&(ye=void 0),q.key!==void 0&&(le=""+q.key),q)!D.call(q,pe)||pe==="key"||pe==="__self"||pe==="__source"||pe==="ref"&&q.ref===void 0||(J[pe]=q[pe]);var pe=arguments.length-2;if(pe===1)J.children=ne;else if(1<pe){for(var de=Array(pe),ce=0;ce<pe;ce++)de[ce]=arguments[ce+2];J.children=de}return M(P.type,le,void 0,void 0,ye,J)},Ge.createContext=function(P){return P={$$typeof:u,_currentValue:P,_currentValue2:P,_threadCount:0,Provider:null,Consumer:null},P.Provider=P,P.Consumer={$$typeof:o,_context:P},P},Ge.createElement=function(P,q,ne){var J,le={},ye=null;if(q!=null)for(J in q.key!==void 0&&(ye=""+q.key),q)D.call(q,J)&&J!=="key"&&J!=="__self"&&J!=="__source"&&(le[J]=q[J]);var pe=arguments.length-2;if(pe===1)le.children=ne;else if(1<pe){for(var de=Array(pe),ce=0;ce<pe;ce++)de[ce]=arguments[ce+2];le.children=de}if(P&&P.defaultProps)for(J in pe=P.defaultProps,pe)le[J]===void 0&&(le[J]=pe[J]);return M(P,ye,void 0,void 0,null,le)},Ge.createRef=function(){return{current:null}},Ge.forwardRef=function(P){return{$$typeof:l,render:P}},Ge.isValidElement=B,Ge.lazy=function(P){return{$$typeof:h,_payload:{_status:-1,_result:P},_init:W}},Ge.memo=function(P,q){return{$$typeof:f,type:P,compare:q===void 0?null:q}},Ge.startTransition=function(P){var q=A.T,ne={};A.T=ne;try{var J=P(),le=A.S;le!==null&&le(ne,J),typeof J=="object"&&J!==null&&typeof J.then=="function"&&J.then(Z,U)}catch(ye){U(ye)}finally{A.T=q}},Ge.unstable_useCacheRefresh=function(){return A.H.useCacheRefresh()},Ge.use=function(P){return A.H.use(P)},Ge.useActionState=function(P,q,ne){return A.H.useActionState(P,q,ne)},Ge.useCallback=function(P,q){return A.H.useCallback(P,q)},Ge.useContext=function(P){return A.H.useContext(P)},Ge.useDebugValue=function(){},Ge.useDeferredValue=function(P,q){return A.H.useDeferredValue(P,q)},Ge.useEffect=function(P,q,ne){var J=A.H;if(typeof ne=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return J.useEffect(P,q)},Ge.useId=function(){return A.H.useId()},Ge.useImperativeHandle=function(P,q,ne){return A.H.useImperativeHandle(P,q,ne)},Ge.useInsertionEffect=function(P,q){return A.H.useInsertionEffect(P,q)},Ge.useLayoutEffect=function(P,q){return A.H.useLayoutEffect(P,q)},Ge.useMemo=function(P,q){return A.H.useMemo(P,q)},Ge.useOptimistic=function(P,q){return A.H.useOptimistic(P,q)},Ge.useReducer=function(P,q,ne){return A.H.useReducer(P,q,ne)},Ge.useRef=function(P){return A.H.useRef(P)},Ge.useState=function(P){return A.H.useState(P)},Ge.useSyncExternalStore=function(P,q,ne){return A.H.useSyncExternalStore(P,q,ne)},Ge.useTransition=function(){return A.H.useTransition()},Ge.version="19.1.0",Ge}var Ax;function vm(){return Ax||(Ax=1,kp.exports=gA()),kp.exports}var F=vm();const be=Sw(F),Ew=pA({__proto__:null,default:be},[F]);var Mp={exports:{}},Hu={},Op={exports:{}},Ip={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Tx;function yA(){return Tx||(Tx=1,function(n){function t(L,W){var U=L.length;L.push(W);e:for(;0<U;){var Z=U-1>>>1,P=L[Z];if(0<a(P,W))L[Z]=W,L[U]=P,U=Z;else break e}}function e(L){return L.length===0?null:L[0]}function r(L){if(L.length===0)return null;var W=L[0],U=L.pop();if(U!==W){L[0]=U;e:for(var Z=0,P=L.length,q=P>>>1;Z<q;){var ne=2*(Z+1)-1,J=L[ne],le=ne+1,ye=L[le];if(0>a(J,U))le<P&&0>a(ye,J)?(L[Z]=ye,L[le]=U,Z=le):(L[Z]=J,L[ne]=U,Z=ne);else if(le<P&&0>a(ye,U))L[Z]=ye,L[le]=U,Z=le;else break e}}return W}function a(L,W){var U=L.sortIndex-W.sortIndex;return U!==0?U:L.id-W.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;n.unstable_now=function(){return o.now()}}else{var u=Date,l=u.now();n.unstable_now=function(){return u.now()-l}}var c=[],f=[],h=1,p=null,m=3,g=!1,b=!1,x=!1,w=!1,E=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;function R(L){for(var W=e(f);W!==null;){if(W.callback===null)r(f);else if(W.startTime<=L)r(f),W.sortIndex=W.expirationTime,t(c,W);else break;W=e(f)}}function A(L){if(x=!1,R(L),!b)if(e(c)!==null)b=!0,D||(D=!0,H());else{var W=e(f);W!==null&&K(A,W.startTime-L)}}var D=!1,M=-1,k=5,B=-1;function O(){return w?!0:!(n.unstable_now()-B<k)}function V(){if(w=!1,D){var L=n.unstable_now();B=L;var W=!0;try{e:{b=!1,x&&(x=!1,C(M),M=-1),g=!0;var U=m;try{t:{for(R(L),p=e(c);p!==null&&!(p.expirationTime>L&&O());){var Z=p.callback;if(typeof Z=="function"){p.callback=null,m=p.priorityLevel;var P=Z(p.expirationTime<=L);if(L=n.unstable_now(),typeof P=="function"){p.callback=P,R(L),W=!0;break t}p===e(c)&&r(c),R(L)}else r(c);p=e(c)}if(p!==null)W=!0;else{var q=e(f);q!==null&&K(A,q.startTime-L),W=!1}}break e}finally{p=null,m=U,g=!1}W=void 0}}finally{W?H():D=!1}}}var H;if(typeof _=="function")H=function(){_(V)};else if(typeof MessageChannel<"u"){var ee=new MessageChannel,$=ee.port2;ee.port1.onmessage=V,H=function(){$.postMessage(null)}}else H=function(){E(V,0)};function K(L,W){M=E(function(){L(n.unstable_now())},W)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(L){L.callback=null},n.unstable_forceFrameRate=function(L){0>L||125<L?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<L?Math.floor(1e3/L):5},n.unstable_getCurrentPriorityLevel=function(){return m},n.unstable_next=function(L){switch(m){case 1:case 2:case 3:var W=3;break;default:W=m}var U=m;m=W;try{return L()}finally{m=U}},n.unstable_requestPaint=function(){w=!0},n.unstable_runWithPriority=function(L,W){switch(L){case 1:case 2:case 3:case 4:case 5:break;default:L=3}var U=m;m=L;try{return W()}finally{m=U}},n.unstable_scheduleCallback=function(L,W,U){var Z=n.unstable_now();switch(typeof U=="object"&&U!==null?(U=U.delay,U=typeof U=="number"&&0<U?Z+U:Z):U=Z,L){case 1:var P=-1;break;case 2:P=250;break;case 5:P=1073741823;break;case 4:P=1e4;break;default:P=5e3}return P=U+P,L={id:h++,callback:W,priorityLevel:L,startTime:U,expirationTime:P,sortIndex:-1},U>Z?(L.sortIndex=U,t(f,L),e(c)===null&&L===e(f)&&(x?(C(M),M=-1):x=!0,K(A,U-Z))):(L.sortIndex=P,t(c,L),b||g||(b=!0,D||(D=!0,H()))),L},n.unstable_shouldYield=O,n.unstable_wrapCallback=function(L){var W=m;return function(){var U=m;m=W;try{return L.apply(this,arguments)}finally{m=U}}}}(Ip)),Ip}var Nx;function bA(){return Nx||(Nx=1,Op.exports=yA()),Op.exports}var Bp={exports:{}},An={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Dx;function xA(){if(Dx)return An;Dx=1;var n=vm();function t(c){var f="https://react.dev/errors/"+c;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)f+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+c+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function e(){}var r={d:{f:e,r:function(){throw Error(t(522))},D:e,C:e,L:e,m:e,X:e,S:e,M:e},p:0,findDOMNode:null},a=Symbol.for("react.portal");function o(c,f,h){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:p==null?null:""+p,children:c,containerInfo:f,implementation:h}}var u=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function l(c,f){if(c==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return An.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,An.createPortal=function(c,f){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(t(299));return o(c,f,null,h)},An.flushSync=function(c){var f=u.T,h=r.p;try{if(u.T=null,r.p=2,c)return c()}finally{u.T=f,r.p=h,r.d.f()}},An.preconnect=function(c,f){typeof c=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,r.d.C(c,f))},An.prefetchDNS=function(c){typeof c=="string"&&r.d.D(c)},An.preinit=function(c,f){if(typeof c=="string"&&f&&typeof f.as=="string"){var h=f.as,p=l(h,f.crossOrigin),m=typeof f.integrity=="string"?f.integrity:void 0,g=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;h==="style"?r.d.S(c,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:p,integrity:m,fetchPriority:g}):h==="script"&&r.d.X(c,{crossOrigin:p,integrity:m,fetchPriority:g,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},An.preinitModule=function(c,f){if(typeof c=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var h=l(f.as,f.crossOrigin);r.d.M(c,{crossOrigin:h,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&r.d.M(c)},An.preload=function(c,f){if(typeof c=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var h=f.as,p=l(h,f.crossOrigin);r.d.L(c,h,{crossOrigin:p,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},An.preloadModule=function(c,f){if(typeof c=="string")if(f){var h=l(f.as,f.crossOrigin);r.d.m(c,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:h,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else r.d.m(c)},An.requestFormReset=function(c){r.d.r(c)},An.unstable_batchedUpdates=function(c,f){return c(f)},An.useFormState=function(c,f,h){return u.H.useFormState(c,f,h)},An.useFormStatus=function(){return u.H.useHostTransitionStatus()},An.version="19.1.0",An}var kx;function Cw(){if(kx)return Bp.exports;kx=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(t){console.error(t)}}return n(),Bp.exports=xA(),Bp.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Mx;function wA(){if(Mx)return Hu;Mx=1;var n=bA(),t=vm(),e=Cw();function r(i){var s="https://react.dev/errors/"+i;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var d=2;d<arguments.length;d++)s+="&args[]="+encodeURIComponent(arguments[d])}return"Minified React error #"+i+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function o(i){var s=i,d=i;if(i.alternate)for(;s.return;)s=s.return;else{i=s;do s=i,(s.flags&4098)!==0&&(d=s.return),i=s.return;while(i)}return s.tag===3?d:null}function u(i){if(i.tag===13){var s=i.memoizedState;if(s===null&&(i=i.alternate,i!==null&&(s=i.memoizedState)),s!==null)return s.dehydrated}return null}function l(i){if(o(i)!==i)throw Error(r(188))}function c(i){var s=i.alternate;if(!s){if(s=o(i),s===null)throw Error(r(188));return s!==i?null:i}for(var d=i,v=s;;){var y=d.return;if(y===null)break;var S=y.alternate;if(S===null){if(v=y.return,v!==null){d=v;continue}break}if(y.child===S.child){for(S=y.child;S;){if(S===d)return l(y),i;if(S===v)return l(y),s;S=S.sibling}throw Error(r(188))}if(d.return!==v.return)d=y,v=S;else{for(var T=!1,I=y.child;I;){if(I===d){T=!0,d=y,v=S;break}if(I===v){T=!0,v=y,d=S;break}I=I.sibling}if(!T){for(I=S.child;I;){if(I===d){T=!0,d=S,v=y;break}if(I===v){T=!0,v=S,d=y;break}I=I.sibling}if(!T)throw Error(r(189))}}if(d.alternate!==v)throw Error(r(190))}if(d.tag!==3)throw Error(r(188));return d.stateNode.current===d?i:s}function f(i){var s=i.tag;if(s===5||s===26||s===27||s===6)return i;for(i=i.child;i!==null;){if(s=f(i),s!==null)return s;i=i.sibling}return null}var h=Object.assign,p=Symbol.for("react.element"),m=Symbol.for("react.transitional.element"),g=Symbol.for("react.portal"),b=Symbol.for("react.fragment"),x=Symbol.for("react.strict_mode"),w=Symbol.for("react.profiler"),E=Symbol.for("react.provider"),C=Symbol.for("react.consumer"),_=Symbol.for("react.context"),R=Symbol.for("react.forward_ref"),A=Symbol.for("react.suspense"),D=Symbol.for("react.suspense_list"),M=Symbol.for("react.memo"),k=Symbol.for("react.lazy"),B=Symbol.for("react.activity"),O=Symbol.for("react.memo_cache_sentinel"),V=Symbol.iterator;function H(i){return i===null||typeof i!="object"?null:(i=V&&i[V]||i["@@iterator"],typeof i=="function"?i:null)}var ee=Symbol.for("react.client.reference");function $(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===ee?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case b:return"Fragment";case w:return"Profiler";case x:return"StrictMode";case A:return"Suspense";case D:return"SuspenseList";case B:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case g:return"Portal";case _:return(i.displayName||"Context")+".Provider";case C:return(i._context.displayName||"Context")+".Consumer";case R:var s=i.render;return i=i.displayName,i||(i=s.displayName||s.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case M:return s=i.displayName||null,s!==null?s:$(i.type)||"Memo";case k:s=i._payload,i=i._init;try{return $(i(s))}catch{}}return null}var K=Array.isArray,L=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,W=e.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,U={pending:!1,data:null,method:null,action:null},Z=[],P=-1;function q(i){return{current:i}}function ne(i){0>P||(i.current=Z[P],Z[P]=null,P--)}function J(i,s){P++,Z[P]=i.current,i.current=s}var le=q(null),ye=q(null),pe=q(null),de=q(null);function ce(i,s){switch(J(pe,s),J(ye,i),J(le,null),s.nodeType){case 9:case 11:i=(i=s.documentElement)&&(i=i.namespaceURI)?Zb(i):0;break;default:if(i=s.tagName,s=s.namespaceURI)s=Zb(s),i=Jb(s,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}ne(le),J(le,i)}function xe(){ne(le),ne(ye),ne(pe)}function we(i){i.memoizedState!==null&&J(de,i);var s=le.current,d=Jb(s,i.type);s!==d&&(J(ye,i),J(le,d))}function Ee(i){ye.current===i&&(ne(le),ne(ye)),de.current===i&&(ne(de),Fu._currentValue=U)}var De=Object.prototype.hasOwnProperty,Fe=n.unstable_scheduleCallback,Xe=n.unstable_cancelCallback,it=n.unstable_shouldYield,rt=n.unstable_requestPaint,st=n.unstable_now,mn=n.unstable_getCurrentPriorityLevel,pt=n.unstable_ImmediatePriority,Qn=n.unstable_UserBlockingPriority,Qt=n.unstable_NormalPriority,xt=n.unstable_LowPriority,Lt=n.unstable_IdlePriority,hr=n.log,Bn=n.unstable_setDisableYieldValue,_n=null,Rt=null;function At(i){if(typeof hr=="function"&&Bn(i),Rt&&typeof Rt.setStrictMode=="function")try{Rt.setStrictMode(_n,i)}catch{}}var Nt=Math.clz32?Math.clz32:ze,pr=Math.log,Ga=Math.LN2;function ze(i){return i>>>=0,i===0?32:31-(pr(i)/Ga|0)|0}var Fn=256,Vr=4194304;function zn(i){var s=i&42;if(s!==0)return s;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function Bo(i,s,d){var v=i.pendingLanes;if(v===0)return 0;var y=0,S=i.suspendedLanes,T=i.pingedLanes;i=i.warmLanes;var I=v&134217727;return I!==0?(v=I&~S,v!==0?y=zn(v):(T&=I,T!==0?y=zn(T):d||(d=I&~i,d!==0&&(y=zn(d))))):(I=v&~S,I!==0?y=zn(I):T!==0?y=zn(T):d||(d=v&~i,d!==0&&(y=zn(d)))),y===0?0:s!==0&&s!==y&&(s&S)===0&&(S=y&-y,d=s&-s,S>=d||S===32&&(d&4194048)!==0)?s:y}function Fo(i,s){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&s)===0}function Gs(i,s){switch(i){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Nr(){var i=Fn;return Fn<<=1,(Fn&4194048)===0&&(Fn=256),i}function Tl(){var i=Vr;return Vr<<=1,(Vr&62914560)===0&&(Vr=4194304),i}function qs(i){for(var s=[],d=0;31>d;d++)s.push(i);return s}function qa(i,s){i.pendingLanes|=s,s!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function Nl(i,s,d,v,y,S){var T=i.pendingLanes;i.pendingLanes=d,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=d,i.entangledLanes&=d,i.errorRecoveryDisabledLanes&=d,i.shellSuspendCounter=0;var I=i.entanglements,G=i.expirationTimes,ae=i.hiddenUpdates;for(d=T&~d;0<d;){var he=31-Nt(d),me=1<<he;I[he]=0,G[he]=-1;var oe=ae[he];if(oe!==null)for(ae[he]=null,he=0;he<oe.length;he++){var ie=oe[he];ie!==null&&(ie.lane&=-536870913)}d&=~me}v!==0&&Ve(i,v,0),S!==0&&y===0&&i.tag!==0&&(i.suspendedLanes|=S&~(T&~s))}function Ve(i,s,d){i.pendingLanes|=s,i.suspendedLanes&=~s;var v=31-Nt(s);i.entangledLanes|=s,i.entanglements[v]=i.entanglements[v]|1073741824|d&4194090}function zt(i,s){var d=i.entangledLanes|=s;for(i=i.entanglements;d;){var v=31-Nt(d),y=1<<v;y&s|i[v]&s&&(i[v]|=s),d&=~y}}function Gt(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function gn(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function Po(){var i=W.p;return i!==0?i:(i=window.event,i===void 0?32:yx(i.type))}function $t(i,s){var d=W.p;try{return W.p=i,s()}finally{W.p=d}}var Ut=Math.random().toString(36).slice(2),jt="__reactFiber$"+Ut,wt="__reactProps$"+Ut,un="__reactContainer$"+Ut,wi="__reactEvents$"+Ut,ga="__reactListeners$"+Ut,zg="__reactHandles$"+Ut,Ug="__reactResources$"+Ut,Xs="__reactMarker$"+Ut;function Ed(i){delete i[jt],delete i[wt],delete i[wi],delete i[ga],delete i[zg]}function Si(i){var s=i[jt];if(s)return s;for(var d=i.parentNode;d;){if(s=d[un]||d[jt]){if(d=s.alternate,s.child!==null||d!==null&&d.child!==null)for(i=rx(i);i!==null;){if(d=i[jt])return d;i=rx(i)}return s}i=d,d=i.parentNode}return null}function Ei(i){if(i=i[jt]||i[un]){var s=i.tag;if(s===5||s===6||s===13||s===26||s===27||s===3)return i}return null}function Ys(i){var s=i.tag;if(s===5||s===26||s===27||s===6)return i.stateNode;throw Error(r(33))}function Ci(i){var s=i[Ug];return s||(s=i[Ug]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function ln(i){i[Xs]=!0}var jg=new Set,Hg={};function Lo(i,s){_i(i,s),_i(i+"Capture",s)}function _i(i,s){for(Hg[i]=s,i=0;i<s.length;i++)jg.add(s[i])}var o_=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Vg={},Wg={};function i_(i){return De.call(Wg,i)?!0:De.call(Vg,i)?!1:o_.test(i)?Wg[i]=!0:(Vg[i]=!0,!1)}function Dl(i,s,d){if(i_(s))if(d===null)i.removeAttribute(s);else{switch(typeof d){case"undefined":case"function":case"symbol":i.removeAttribute(s);return;case"boolean":var v=s.toLowerCase().slice(0,5);if(v!=="data-"&&v!=="aria-"){i.removeAttribute(s);return}}i.setAttribute(s,""+d)}}function kl(i,s,d){if(d===null)i.removeAttribute(s);else{switch(typeof d){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(s);return}i.setAttribute(s,""+d)}}function ya(i,s,d,v){if(v===null)i.removeAttribute(d);else{switch(typeof v){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(d);return}i.setAttributeNS(s,d,""+v)}}var Cd,Gg;function Ri(i){if(Cd===void 0)try{throw Error()}catch(d){var s=d.stack.trim().match(/\n( *(at )?)/);Cd=s&&s[1]||"",Gg=-1<d.stack.indexOf(`
    at`)?" (<anonymous>)":-1<d.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Cd+i+Gg}var _d=!1;function Rd(i,s){if(!i||_d)return"";_d=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var v={DetermineComponentFrameRoot:function(){try{if(s){var me=function(){throw Error()};if(Object.defineProperty(me.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(me,[])}catch(ie){var oe=ie}Reflect.construct(i,[],me)}else{try{me.call()}catch(ie){oe=ie}i.call(me.prototype)}}else{try{throw Error()}catch(ie){oe=ie}(me=i())&&typeof me.catch=="function"&&me.catch(function(){})}}catch(ie){if(ie&&oe&&typeof ie.stack=="string")return[ie.stack,oe.stack]}return[null,null]}};v.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var y=Object.getOwnPropertyDescriptor(v.DetermineComponentFrameRoot,"name");y&&y.configurable&&Object.defineProperty(v.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var S=v.DetermineComponentFrameRoot(),T=S[0],I=S[1];if(T&&I){var G=T.split(`
`),ae=I.split(`
`);for(y=v=0;v<G.length&&!G[v].includes("DetermineComponentFrameRoot");)v++;for(;y<ae.length&&!ae[y].includes("DetermineComponentFrameRoot");)y++;if(v===G.length||y===ae.length)for(v=G.length-1,y=ae.length-1;1<=v&&0<=y&&G[v]!==ae[y];)y--;for(;1<=v&&0<=y;v--,y--)if(G[v]!==ae[y]){if(v!==1||y!==1)do if(v--,y--,0>y||G[v]!==ae[y]){var he=`
`+G[v].replace(" at new "," at ");return i.displayName&&he.includes("<anonymous>")&&(he=he.replace("<anonymous>",i.displayName)),he}while(1<=v&&0<=y);break}}}finally{_d=!1,Error.prepareStackTrace=d}return(d=i?i.displayName||i.name:"")?Ri(d):""}function s_(i){switch(i.tag){case 26:case 27:case 5:return Ri(i.type);case 16:return Ri("Lazy");case 13:return Ri("Suspense");case 19:return Ri("SuspenseList");case 0:case 15:return Rd(i.type,!1);case 11:return Rd(i.type.render,!1);case 1:return Rd(i.type,!0);case 31:return Ri("Activity");default:return""}}function qg(i){try{var s="";do s+=s_(i),i=i.return;while(i);return s}catch(d){return`
Error generating stack: `+d.message+`
`+d.stack}}function vr(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function Xg(i){var s=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function u_(i){var s=Xg(i)?"checked":"value",d=Object.getOwnPropertyDescriptor(i.constructor.prototype,s),v=""+i[s];if(!i.hasOwnProperty(s)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var y=d.get,S=d.set;return Object.defineProperty(i,s,{configurable:!0,get:function(){return y.call(this)},set:function(T){v=""+T,S.call(this,T)}}),Object.defineProperty(i,s,{enumerable:d.enumerable}),{getValue:function(){return v},setValue:function(T){v=""+T},stopTracking:function(){i._valueTracker=null,delete i[s]}}}}function Ml(i){i._valueTracker||(i._valueTracker=u_(i))}function Yg(i){if(!i)return!1;var s=i._valueTracker;if(!s)return!0;var d=s.getValue(),v="";return i&&(v=Xg(i)?i.checked?"true":"false":i.value),i=v,i!==d?(s.setValue(i),!0):!1}function Ol(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var l_=/[\n"\\]/g;function mr(i){return i.replace(l_,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function Ad(i,s,d,v,y,S,T,I){i.name="",T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"?i.type=T:i.removeAttribute("type"),s!=null?T==="number"?(s===0&&i.value===""||i.value!=s)&&(i.value=""+vr(s)):i.value!==""+vr(s)&&(i.value=""+vr(s)):T!=="submit"&&T!=="reset"||i.removeAttribute("value"),s!=null?Td(i,T,vr(s)):d!=null?Td(i,T,vr(d)):v!=null&&i.removeAttribute("value"),y==null&&S!=null&&(i.defaultChecked=!!S),y!=null&&(i.checked=y&&typeof y!="function"&&typeof y!="symbol"),I!=null&&typeof I!="function"&&typeof I!="symbol"&&typeof I!="boolean"?i.name=""+vr(I):i.removeAttribute("name")}function Kg(i,s,d,v,y,S,T,I){if(S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"&&(i.type=S),s!=null||d!=null){if(!(S!=="submit"&&S!=="reset"||s!=null))return;d=d!=null?""+vr(d):"",s=s!=null?""+vr(s):d,I||s===i.value||(i.value=s),i.defaultValue=s}v=v??y,v=typeof v!="function"&&typeof v!="symbol"&&!!v,i.checked=I?i.checked:!!v,i.defaultChecked=!!v,T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"&&(i.name=T)}function Td(i,s,d){s==="number"&&Ol(i.ownerDocument)===i||i.defaultValue===""+d||(i.defaultValue=""+d)}function Ai(i,s,d,v){if(i=i.options,s){s={};for(var y=0;y<d.length;y++)s["$"+d[y]]=!0;for(d=0;d<i.length;d++)y=s.hasOwnProperty("$"+i[d].value),i[d].selected!==y&&(i[d].selected=y),y&&v&&(i[d].defaultSelected=!0)}else{for(d=""+vr(d),s=null,y=0;y<i.length;y++){if(i[y].value===d){i[y].selected=!0,v&&(i[y].defaultSelected=!0);return}s!==null||i[y].disabled||(s=i[y])}s!==null&&(s.selected=!0)}}function Qg(i,s,d){if(s!=null&&(s=""+vr(s),s!==i.value&&(i.value=s),d==null)){i.defaultValue!==s&&(i.defaultValue=s);return}i.defaultValue=d!=null?""+vr(d):""}function $g(i,s,d,v){if(s==null){if(v!=null){if(d!=null)throw Error(r(92));if(K(v)){if(1<v.length)throw Error(r(93));v=v[0]}d=v}d==null&&(d=""),s=d}d=vr(s),i.defaultValue=d,v=i.textContent,v===d&&v!==""&&v!==null&&(i.value=v)}function Ti(i,s){if(s){var d=i.firstChild;if(d&&d===i.lastChild&&d.nodeType===3){d.nodeValue=s;return}}i.textContent=s}var c_=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Zg(i,s,d){var v=s.indexOf("--")===0;d==null||typeof d=="boolean"||d===""?v?i.setProperty(s,""):s==="float"?i.cssFloat="":i[s]="":v?i.setProperty(s,d):typeof d!="number"||d===0||c_.has(s)?s==="float"?i.cssFloat=d:i[s]=(""+d).trim():i[s]=d+"px"}function Jg(i,s,d){if(s!=null&&typeof s!="object")throw Error(r(62));if(i=i.style,d!=null){for(var v in d)!d.hasOwnProperty(v)||s!=null&&s.hasOwnProperty(v)||(v.indexOf("--")===0?i.setProperty(v,""):v==="float"?i.cssFloat="":i[v]="");for(var y in s)v=s[y],s.hasOwnProperty(y)&&d[y]!==v&&Zg(i,y,v)}else for(var S in s)s.hasOwnProperty(S)&&Zg(i,S,s[S])}function Nd(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var f_=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),d_=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Il(i){return d_.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}var Dd=null;function kd(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var Ni=null,Di=null;function e0(i){var s=Ei(i);if(s&&(i=s.stateNode)){var d=i[wt]||null;e:switch(i=s.stateNode,s.type){case"input":if(Ad(i,d.value,d.defaultValue,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name),s=d.name,d.type==="radio"&&s!=null){for(d=i;d.parentNode;)d=d.parentNode;for(d=d.querySelectorAll('input[name="'+mr(""+s)+'"][type="radio"]'),s=0;s<d.length;s++){var v=d[s];if(v!==i&&v.form===i.form){var y=v[wt]||null;if(!y)throw Error(r(90));Ad(v,y.value,y.defaultValue,y.defaultValue,y.checked,y.defaultChecked,y.type,y.name)}}for(s=0;s<d.length;s++)v=d[s],v.form===i.form&&Yg(v)}break e;case"textarea":Qg(i,d.value,d.defaultValue);break e;case"select":s=d.value,s!=null&&Ai(i,!!d.multiple,s,!1)}}}var Md=!1;function t0(i,s,d){if(Md)return i(s,d);Md=!0;try{var v=i(s);return v}finally{if(Md=!1,(Ni!==null||Di!==null)&&(bc(),Ni&&(s=Ni,i=Di,Di=Ni=null,e0(s),i)))for(s=0;s<i.length;s++)e0(i[s])}}function Ks(i,s){var d=i.stateNode;if(d===null)return null;var v=d[wt]||null;if(v===null)return null;d=v[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(v=!v.disabled)||(i=i.type,v=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!v;break e;default:i=!1}if(i)return null;if(d&&typeof d!="function")throw Error(r(231,s,typeof d));return d}var ba=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Od=!1;if(ba)try{var Qs={};Object.defineProperty(Qs,"passive",{get:function(){Od=!0}}),window.addEventListener("test",Qs,Qs),window.removeEventListener("test",Qs,Qs)}catch{Od=!1}var Xa=null,Id=null,Bl=null;function n0(){if(Bl)return Bl;var i,s=Id,d=s.length,v,y="value"in Xa?Xa.value:Xa.textContent,S=y.length;for(i=0;i<d&&s[i]===y[i];i++);var T=d-i;for(v=1;v<=T&&s[d-v]===y[S-v];v++);return Bl=y.slice(i,1<v?1-v:void 0)}function Fl(i){var s=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&s===13&&(i=13)):i=s,i===10&&(i=13),32<=i||i===13?i:0}function Pl(){return!0}function r0(){return!1}function Un(i){function s(d,v,y,S,T){this._reactName=d,this._targetInst=y,this.type=v,this.nativeEvent=S,this.target=T,this.currentTarget=null;for(var I in i)i.hasOwnProperty(I)&&(d=i[I],this[I]=d?d(S):S[I]);return this.isDefaultPrevented=(S.defaultPrevented!=null?S.defaultPrevented:S.returnValue===!1)?Pl:r0,this.isPropagationStopped=r0,this}return h(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var d=this.nativeEvent;d&&(d.preventDefault?d.preventDefault():typeof d.returnValue!="unknown"&&(d.returnValue=!1),this.isDefaultPrevented=Pl)},stopPropagation:function(){var d=this.nativeEvent;d&&(d.stopPropagation?d.stopPropagation():typeof d.cancelBubble!="unknown"&&(d.cancelBubble=!0),this.isPropagationStopped=Pl)},persist:function(){},isPersistent:Pl}),s}var zo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ll=Un(zo),$s=h({},zo,{view:0,detail:0}),h_=Un($s),Bd,Fd,Zs,zl=h({},$s,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ld,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Zs&&(Zs&&i.type==="mousemove"?(Bd=i.screenX-Zs.screenX,Fd=i.screenY-Zs.screenY):Fd=Bd=0,Zs=i),Bd)},movementY:function(i){return"movementY"in i?i.movementY:Fd}}),a0=Un(zl),p_=h({},zl,{dataTransfer:0}),v_=Un(p_),m_=h({},$s,{relatedTarget:0}),Pd=Un(m_),g_=h({},zo,{animationName:0,elapsedTime:0,pseudoElement:0}),y_=Un(g_),b_=h({},zo,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),x_=Un(b_),w_=h({},zo,{data:0}),o0=Un(w_),S_={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},E_={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},C_={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function __(i){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(i):(i=C_[i])?!!s[i]:!1}function Ld(){return __}var R_=h({},$s,{key:function(i){if(i.key){var s=S_[i.key]||i.key;if(s!=="Unidentified")return s}return i.type==="keypress"?(i=Fl(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?E_[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ld,charCode:function(i){return i.type==="keypress"?Fl(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Fl(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),A_=Un(R_),T_=h({},zl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),i0=Un(T_),N_=h({},$s,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ld}),D_=Un(N_),k_=h({},zo,{propertyName:0,elapsedTime:0,pseudoElement:0}),M_=Un(k_),O_=h({},zl,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),I_=Un(O_),B_=h({},zo,{newState:0,oldState:0}),F_=Un(B_),P_=[9,13,27,32],zd=ba&&"CompositionEvent"in window,Js=null;ba&&"documentMode"in document&&(Js=document.documentMode);var L_=ba&&"TextEvent"in window&&!Js,s0=ba&&(!zd||Js&&8<Js&&11>=Js),u0=" ",l0=!1;function c0(i,s){switch(i){case"keyup":return P_.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function f0(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var ki=!1;function z_(i,s){switch(i){case"compositionend":return f0(s);case"keypress":return s.which!==32?null:(l0=!0,u0);case"textInput":return i=s.data,i===u0&&l0?null:i;default:return null}}function U_(i,s){if(ki)return i==="compositionend"||!zd&&c0(i,s)?(i=n0(),Bl=Id=Xa=null,ki=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return s0&&s.locale!=="ko"?null:s.data;default:return null}}var j_={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function d0(i){var s=i&&i.nodeName&&i.nodeName.toLowerCase();return s==="input"?!!j_[i.type]:s==="textarea"}function h0(i,s,d,v){Ni?Di?Di.push(v):Di=[v]:Ni=v,s=_c(s,"onChange"),0<s.length&&(d=new Ll("onChange","change",null,d,v),i.push({event:d,listeners:s}))}var eu=null,tu=null;function H_(i){Xb(i,0)}function Ul(i){var s=Ys(i);if(Yg(s))return i}function p0(i,s){if(i==="change")return s}var v0=!1;if(ba){var Ud;if(ba){var jd="oninput"in document;if(!jd){var m0=document.createElement("div");m0.setAttribute("oninput","return;"),jd=typeof m0.oninput=="function"}Ud=jd}else Ud=!1;v0=Ud&&(!document.documentMode||9<document.documentMode)}function g0(){eu&&(eu.detachEvent("onpropertychange",y0),tu=eu=null)}function y0(i){if(i.propertyName==="value"&&Ul(tu)){var s=[];h0(s,tu,i,kd(i)),t0(H_,s)}}function V_(i,s,d){i==="focusin"?(g0(),eu=s,tu=d,eu.attachEvent("onpropertychange",y0)):i==="focusout"&&g0()}function W_(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return Ul(tu)}function G_(i,s){if(i==="click")return Ul(s)}function q_(i,s){if(i==="input"||i==="change")return Ul(s)}function X_(i,s){return i===s&&(i!==0||1/i===1/s)||i!==i&&s!==s}var $n=typeof Object.is=="function"?Object.is:X_;function nu(i,s){if($n(i,s))return!0;if(typeof i!="object"||i===null||typeof s!="object"||s===null)return!1;var d=Object.keys(i),v=Object.keys(s);if(d.length!==v.length)return!1;for(v=0;v<d.length;v++){var y=d[v];if(!De.call(s,y)||!$n(i[y],s[y]))return!1}return!0}function b0(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function x0(i,s){var d=b0(i);i=0;for(var v;d;){if(d.nodeType===3){if(v=i+d.textContent.length,i<=s&&v>=s)return{node:d,offset:s-i};i=v}e:{for(;d;){if(d.nextSibling){d=d.nextSibling;break e}d=d.parentNode}d=void 0}d=b0(d)}}function w0(i,s){return i&&s?i===s?!0:i&&i.nodeType===3?!1:s&&s.nodeType===3?w0(i,s.parentNode):"contains"in i?i.contains(s):i.compareDocumentPosition?!!(i.compareDocumentPosition(s)&16):!1:!1}function S0(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var s=Ol(i.document);s instanceof i.HTMLIFrameElement;){try{var d=typeof s.contentWindow.location.href=="string"}catch{d=!1}if(d)i=s.contentWindow;else break;s=Ol(i.document)}return s}function Hd(i){var s=i&&i.nodeName&&i.nodeName.toLowerCase();return s&&(s==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||s==="textarea"||i.contentEditable==="true")}var Y_=ba&&"documentMode"in document&&11>=document.documentMode,Mi=null,Vd=null,ru=null,Wd=!1;function E0(i,s,d){var v=d.window===d?d.document:d.nodeType===9?d:d.ownerDocument;Wd||Mi==null||Mi!==Ol(v)||(v=Mi,"selectionStart"in v&&Hd(v)?v={start:v.selectionStart,end:v.selectionEnd}:(v=(v.ownerDocument&&v.ownerDocument.defaultView||window).getSelection(),v={anchorNode:v.anchorNode,anchorOffset:v.anchorOffset,focusNode:v.focusNode,focusOffset:v.focusOffset}),ru&&nu(ru,v)||(ru=v,v=_c(Vd,"onSelect"),0<v.length&&(s=new Ll("onSelect","select",null,s,d),i.push({event:s,listeners:v}),s.target=Mi)))}function Uo(i,s){var d={};return d[i.toLowerCase()]=s.toLowerCase(),d["Webkit"+i]="webkit"+s,d["Moz"+i]="moz"+s,d}var Oi={animationend:Uo("Animation","AnimationEnd"),animationiteration:Uo("Animation","AnimationIteration"),animationstart:Uo("Animation","AnimationStart"),transitionrun:Uo("Transition","TransitionRun"),transitionstart:Uo("Transition","TransitionStart"),transitioncancel:Uo("Transition","TransitionCancel"),transitionend:Uo("Transition","TransitionEnd")},Gd={},C0={};ba&&(C0=document.createElement("div").style,"AnimationEvent"in window||(delete Oi.animationend.animation,delete Oi.animationiteration.animation,delete Oi.animationstart.animation),"TransitionEvent"in window||delete Oi.transitionend.transition);function jo(i){if(Gd[i])return Gd[i];if(!Oi[i])return i;var s=Oi[i],d;for(d in s)if(s.hasOwnProperty(d)&&d in C0)return Gd[i]=s[d];return i}var _0=jo("animationend"),R0=jo("animationiteration"),A0=jo("animationstart"),K_=jo("transitionrun"),Q_=jo("transitionstart"),$_=jo("transitioncancel"),T0=jo("transitionend"),N0=new Map,qd="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");qd.push("scrollEnd");function Dr(i,s){N0.set(i,s),Lo(s,[i])}var D0=new WeakMap;function gr(i,s){if(typeof i=="object"&&i!==null){var d=D0.get(i);return d!==void 0?d:(s={value:i,source:s,stack:qg(s)},D0.set(i,s),s)}return{value:i,source:s,stack:qg(s)}}var yr=[],Ii=0,Xd=0;function jl(){for(var i=Ii,s=Xd=Ii=0;s<i;){var d=yr[s];yr[s++]=null;var v=yr[s];yr[s++]=null;var y=yr[s];yr[s++]=null;var S=yr[s];if(yr[s++]=null,v!==null&&y!==null){var T=v.pending;T===null?y.next=y:(y.next=T.next,T.next=y),v.pending=y}S!==0&&k0(d,y,S)}}function Hl(i,s,d,v){yr[Ii++]=i,yr[Ii++]=s,yr[Ii++]=d,yr[Ii++]=v,Xd|=v,i.lanes|=v,i=i.alternate,i!==null&&(i.lanes|=v)}function Yd(i,s,d,v){return Hl(i,s,d,v),Vl(i)}function Bi(i,s){return Hl(i,null,null,s),Vl(i)}function k0(i,s,d){i.lanes|=d;var v=i.alternate;v!==null&&(v.lanes|=d);for(var y=!1,S=i.return;S!==null;)S.childLanes|=d,v=S.alternate,v!==null&&(v.childLanes|=d),S.tag===22&&(i=S.stateNode,i===null||i._visibility&1||(y=!0)),i=S,S=S.return;return i.tag===3?(S=i.stateNode,y&&s!==null&&(y=31-Nt(d),i=S.hiddenUpdates,v=i[y],v===null?i[y]=[s]:v.push(s),s.lane=d|536870912),S):null}function Vl(i){if(50<Tu)throw Tu=0,ep=null,Error(r(185));for(var s=i.return;s!==null;)i=s,s=i.return;return i.tag===3?i.stateNode:null}var Fi={};function Z_(i,s,d,v){this.tag=i,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=v,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Zn(i,s,d,v){return new Z_(i,s,d,v)}function Kd(i){return i=i.prototype,!(!i||!i.isReactComponent)}function xa(i,s){var d=i.alternate;return d===null?(d=Zn(i.tag,s,i.key,i.mode),d.elementType=i.elementType,d.type=i.type,d.stateNode=i.stateNode,d.alternate=i,i.alternate=d):(d.pendingProps=s,d.type=i.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=i.flags&65011712,d.childLanes=i.childLanes,d.lanes=i.lanes,d.child=i.child,d.memoizedProps=i.memoizedProps,d.memoizedState=i.memoizedState,d.updateQueue=i.updateQueue,s=i.dependencies,d.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},d.sibling=i.sibling,d.index=i.index,d.ref=i.ref,d.refCleanup=i.refCleanup,d}function M0(i,s){i.flags&=65011714;var d=i.alternate;return d===null?(i.childLanes=0,i.lanes=s,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=d.childLanes,i.lanes=d.lanes,i.child=d.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=d.memoizedProps,i.memoizedState=d.memoizedState,i.updateQueue=d.updateQueue,i.type=d.type,s=d.dependencies,i.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),i}function Wl(i,s,d,v,y,S){var T=0;if(v=i,typeof i=="function")Kd(i)&&(T=1);else if(typeof i=="string")T=eA(i,d,le.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case B:return i=Zn(31,d,s,y),i.elementType=B,i.lanes=S,i;case b:return Ho(d.children,y,S,s);case x:T=8,y|=24;break;case w:return i=Zn(12,d,s,y|2),i.elementType=w,i.lanes=S,i;case A:return i=Zn(13,d,s,y),i.elementType=A,i.lanes=S,i;case D:return i=Zn(19,d,s,y),i.elementType=D,i.lanes=S,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case E:case _:T=10;break e;case C:T=9;break e;case R:T=11;break e;case M:T=14;break e;case k:T=16,v=null;break e}T=29,d=Error(r(130,i===null?"null":typeof i,"")),v=null}return s=Zn(T,d,s,y),s.elementType=i,s.type=v,s.lanes=S,s}function Ho(i,s,d,v){return i=Zn(7,i,v,s),i.lanes=d,i}function Qd(i,s,d){return i=Zn(6,i,null,s),i.lanes=d,i}function $d(i,s,d){return s=Zn(4,i.children!==null?i.children:[],i.key,s),s.lanes=d,s.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},s}var Pi=[],Li=0,Gl=null,ql=0,br=[],xr=0,Vo=null,wa=1,Sa="";function Wo(i,s){Pi[Li++]=ql,Pi[Li++]=Gl,Gl=i,ql=s}function O0(i,s,d){br[xr++]=wa,br[xr++]=Sa,br[xr++]=Vo,Vo=i;var v=wa;i=Sa;var y=32-Nt(v)-1;v&=~(1<<y),d+=1;var S=32-Nt(s)+y;if(30<S){var T=y-y%5;S=(v&(1<<T)-1).toString(32),v>>=T,y-=T,wa=1<<32-Nt(s)+y|d<<y|v,Sa=S+i}else wa=1<<S|d<<y|v,Sa=i}function Zd(i){i.return!==null&&(Wo(i,1),O0(i,1,0))}function Jd(i){for(;i===Gl;)Gl=Pi[--Li],Pi[Li]=null,ql=Pi[--Li],Pi[Li]=null;for(;i===Vo;)Vo=br[--xr],br[xr]=null,Sa=br[--xr],br[xr]=null,wa=br[--xr],br[xr]=null}var Pn=null,Bt=null,lt=!1,Go=null,Wr=!1,eh=Error(r(519));function qo(i){var s=Error(r(418,""));throw iu(gr(s,i)),eh}function I0(i){var s=i.stateNode,d=i.type,v=i.memoizedProps;switch(s[jt]=i,s[wt]=v,d){case"dialog":Je("cancel",s),Je("close",s);break;case"iframe":case"object":case"embed":Je("load",s);break;case"video":case"audio":for(d=0;d<Du.length;d++)Je(Du[d],s);break;case"source":Je("error",s);break;case"img":case"image":case"link":Je("error",s),Je("load",s);break;case"details":Je("toggle",s);break;case"input":Je("invalid",s),Kg(s,v.value,v.defaultValue,v.checked,v.defaultChecked,v.type,v.name,!0),Ml(s);break;case"select":Je("invalid",s);break;case"textarea":Je("invalid",s),$g(s,v.value,v.defaultValue,v.children),Ml(s)}d=v.children,typeof d!="string"&&typeof d!="number"&&typeof d!="bigint"||s.textContent===""+d||v.suppressHydrationWarning===!0||$b(s.textContent,d)?(v.popover!=null&&(Je("beforetoggle",s),Je("toggle",s)),v.onScroll!=null&&Je("scroll",s),v.onScrollEnd!=null&&Je("scrollend",s),v.onClick!=null&&(s.onclick=Rc),s=!0):s=!1,s||qo(i)}function B0(i){for(Pn=i.return;Pn;)switch(Pn.tag){case 5:case 13:Wr=!1;return;case 27:case 3:Wr=!0;return;default:Pn=Pn.return}}function au(i){if(i!==Pn)return!1;if(!lt)return B0(i),lt=!0,!1;var s=i.tag,d;if((d=s!==3&&s!==27)&&((d=s===5)&&(d=i.type,d=!(d!=="form"&&d!=="button")||mp(i.type,i.memoizedProps)),d=!d),d&&Bt&&qo(i),B0(i),s===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(r(317));e:{for(i=i.nextSibling,s=0;i;){if(i.nodeType===8)if(d=i.data,d==="/$"){if(s===0){Bt=Mr(i.nextSibling);break e}s--}else d!=="$"&&d!=="$!"&&d!=="$?"||s++;i=i.nextSibling}Bt=null}}else s===27?(s=Bt,lo(i.type)?(i=xp,xp=null,Bt=i):Bt=s):Bt=Pn?Mr(i.stateNode.nextSibling):null;return!0}function ou(){Bt=Pn=null,lt=!1}function F0(){var i=Go;return i!==null&&(Vn===null?Vn=i:Vn.push.apply(Vn,i),Go=null),i}function iu(i){Go===null?Go=[i]:Go.push(i)}var th=q(null),Xo=null,Ea=null;function Ya(i,s,d){J(th,s._currentValue),s._currentValue=d}function Ca(i){i._currentValue=th.current,ne(th)}function nh(i,s,d){for(;i!==null;){var v=i.alternate;if((i.childLanes&s)!==s?(i.childLanes|=s,v!==null&&(v.childLanes|=s)):v!==null&&(v.childLanes&s)!==s&&(v.childLanes|=s),i===d)break;i=i.return}}function rh(i,s,d,v){var y=i.child;for(y!==null&&(y.return=i);y!==null;){var S=y.dependencies;if(S!==null){var T=y.child;S=S.firstContext;e:for(;S!==null;){var I=S;S=y;for(var G=0;G<s.length;G++)if(I.context===s[G]){S.lanes|=d,I=S.alternate,I!==null&&(I.lanes|=d),nh(S.return,d,i),v||(T=null);break e}S=I.next}}else if(y.tag===18){if(T=y.return,T===null)throw Error(r(341));T.lanes|=d,S=T.alternate,S!==null&&(S.lanes|=d),nh(T,d,i),T=null}else T=y.child;if(T!==null)T.return=y;else for(T=y;T!==null;){if(T===i){T=null;break}if(y=T.sibling,y!==null){y.return=T.return,T=y;break}T=T.return}y=T}}function su(i,s,d,v){i=null;for(var y=s,S=!1;y!==null;){if(!S){if((y.flags&524288)!==0)S=!0;else if((y.flags&262144)!==0)break}if(y.tag===10){var T=y.alternate;if(T===null)throw Error(r(387));if(T=T.memoizedProps,T!==null){var I=y.type;$n(y.pendingProps.value,T.value)||(i!==null?i.push(I):i=[I])}}else if(y===de.current){if(T=y.alternate,T===null)throw Error(r(387));T.memoizedState.memoizedState!==y.memoizedState.memoizedState&&(i!==null?i.push(Fu):i=[Fu])}y=y.return}i!==null&&rh(s,i,d,v),s.flags|=262144}function Xl(i){for(i=i.firstContext;i!==null;){if(!$n(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function Yo(i){Xo=i,Ea=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function Rn(i){return P0(Xo,i)}function Yl(i,s){return Xo===null&&Yo(i),P0(i,s)}function P0(i,s){var d=s._currentValue;if(s={context:s,memoizedValue:d,next:null},Ea===null){if(i===null)throw Error(r(308));Ea=s,i.dependencies={lanes:0,firstContext:s},i.flags|=524288}else Ea=Ea.next=s;return d}var J_=typeof AbortController<"u"?AbortController:function(){var i=[],s=this.signal={aborted:!1,addEventListener:function(d,v){i.push(v)}};this.abort=function(){s.aborted=!0,i.forEach(function(d){return d()})}},eR=n.unstable_scheduleCallback,tR=n.unstable_NormalPriority,Zt={$$typeof:_,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function ah(){return{controller:new J_,data:new Map,refCount:0}}function uu(i){i.refCount--,i.refCount===0&&eR(tR,function(){i.controller.abort()})}var lu=null,oh=0,zi=0,Ui=null;function nR(i,s){if(lu===null){var d=lu=[];oh=0,zi=sp(),Ui={status:"pending",value:void 0,then:function(v){d.push(v)}}}return oh++,s.then(L0,L0),s}function L0(){if(--oh===0&&lu!==null){Ui!==null&&(Ui.status="fulfilled");var i=lu;lu=null,zi=0,Ui=null;for(var s=0;s<i.length;s++)(0,i[s])()}}function rR(i,s){var d=[],v={status:"pending",value:null,reason:null,then:function(y){d.push(y)}};return i.then(function(){v.status="fulfilled",v.value=s;for(var y=0;y<d.length;y++)(0,d[y])(s)},function(y){for(v.status="rejected",v.reason=y,y=0;y<d.length;y++)(0,d[y])(void 0)}),v}var z0=L.S;L.S=function(i,s){typeof s=="object"&&s!==null&&typeof s.then=="function"&&nR(i,s),z0!==null&&z0(i,s)};var Ko=q(null);function ih(){var i=Ko.current;return i!==null?i:St.pooledCache}function Kl(i,s){s===null?J(Ko,Ko.current):J(Ko,s.pool)}function U0(){var i=ih();return i===null?null:{parent:Zt._currentValue,pool:i}}var cu=Error(r(460)),j0=Error(r(474)),Ql=Error(r(542)),sh={then:function(){}};function H0(i){return i=i.status,i==="fulfilled"||i==="rejected"}function $l(){}function V0(i,s,d){switch(d=i[d],d===void 0?i.push(s):d!==s&&(s.then($l,$l),s=d),s.status){case"fulfilled":return s.value;case"rejected":throw i=s.reason,G0(i),i;default:if(typeof s.status=="string")s.then($l,$l);else{if(i=St,i!==null&&100<i.shellSuspendCounter)throw Error(r(482));i=s,i.status="pending",i.then(function(v){if(s.status==="pending"){var y=s;y.status="fulfilled",y.value=v}},function(v){if(s.status==="pending"){var y=s;y.status="rejected",y.reason=v}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw i=s.reason,G0(i),i}throw fu=s,cu}}var fu=null;function W0(){if(fu===null)throw Error(r(459));var i=fu;return fu=null,i}function G0(i){if(i===cu||i===Ql)throw Error(r(483))}var Ka=!1;function uh(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function lh(i,s){i=i.updateQueue,s.updateQueue===i&&(s.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function Qa(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function $a(i,s,d){var v=i.updateQueue;if(v===null)return null;if(v=v.shared,(dt&2)!==0){var y=v.pending;return y===null?s.next=s:(s.next=y.next,y.next=s),v.pending=s,s=Vl(i),k0(i,null,d),s}return Hl(i,v,s,d),Vl(i)}function du(i,s,d){if(s=s.updateQueue,s!==null&&(s=s.shared,(d&4194048)!==0)){var v=s.lanes;v&=i.pendingLanes,d|=v,s.lanes=d,zt(i,d)}}function ch(i,s){var d=i.updateQueue,v=i.alternate;if(v!==null&&(v=v.updateQueue,d===v)){var y=null,S=null;if(d=d.firstBaseUpdate,d!==null){do{var T={lane:d.lane,tag:d.tag,payload:d.payload,callback:null,next:null};S===null?y=S=T:S=S.next=T,d=d.next}while(d!==null);S===null?y=S=s:S=S.next=s}else y=S=s;d={baseState:v.baseState,firstBaseUpdate:y,lastBaseUpdate:S,shared:v.shared,callbacks:v.callbacks},i.updateQueue=d;return}i=d.lastBaseUpdate,i===null?d.firstBaseUpdate=s:i.next=s,d.lastBaseUpdate=s}var fh=!1;function hu(){if(fh){var i=Ui;if(i!==null)throw i}}function pu(i,s,d,v){fh=!1;var y=i.updateQueue;Ka=!1;var S=y.firstBaseUpdate,T=y.lastBaseUpdate,I=y.shared.pending;if(I!==null){y.shared.pending=null;var G=I,ae=G.next;G.next=null,T===null?S=ae:T.next=ae,T=G;var he=i.alternate;he!==null&&(he=he.updateQueue,I=he.lastBaseUpdate,I!==T&&(I===null?he.firstBaseUpdate=ae:I.next=ae,he.lastBaseUpdate=G))}if(S!==null){var me=y.baseState;T=0,he=ae=G=null,I=S;do{var oe=I.lane&-536870913,ie=oe!==I.lane;if(ie?(at&oe)===oe:(v&oe)===oe){oe!==0&&oe===zi&&(fh=!0),he!==null&&(he=he.next={lane:0,tag:I.tag,payload:I.payload,callback:null,next:null});e:{var Ue=i,Pe=I;oe=s;var gt=d;switch(Pe.tag){case 1:if(Ue=Pe.payload,typeof Ue=="function"){me=Ue.call(gt,me,oe);break e}me=Ue;break e;case 3:Ue.flags=Ue.flags&-65537|128;case 0:if(Ue=Pe.payload,oe=typeof Ue=="function"?Ue.call(gt,me,oe):Ue,oe==null)break e;me=h({},me,oe);break e;case 2:Ka=!0}}oe=I.callback,oe!==null&&(i.flags|=64,ie&&(i.flags|=8192),ie=y.callbacks,ie===null?y.callbacks=[oe]:ie.push(oe))}else ie={lane:oe,tag:I.tag,payload:I.payload,callback:I.callback,next:null},he===null?(ae=he=ie,G=me):he=he.next=ie,T|=oe;if(I=I.next,I===null){if(I=y.shared.pending,I===null)break;ie=I,I=ie.next,ie.next=null,y.lastBaseUpdate=ie,y.shared.pending=null}}while(!0);he===null&&(G=me),y.baseState=G,y.firstBaseUpdate=ae,y.lastBaseUpdate=he,S===null&&(y.shared.lanes=0),oo|=T,i.lanes=T,i.memoizedState=me}}function q0(i,s){if(typeof i!="function")throw Error(r(191,i));i.call(s)}function X0(i,s){var d=i.callbacks;if(d!==null)for(i.callbacks=null,i=0;i<d.length;i++)q0(d[i],s)}var ji=q(null),Zl=q(0);function Y0(i,s){i=ka,J(Zl,i),J(ji,s),ka=i|s.baseLanes}function dh(){J(Zl,ka),J(ji,ji.current)}function hh(){ka=Zl.current,ne(ji),ne(Zl)}var Za=0,Ye=null,vt=null,qt=null,Jl=!1,Hi=!1,Qo=!1,ec=0,vu=0,Vi=null,aR=0;function Ht(){throw Error(r(321))}function ph(i,s){if(s===null)return!1;for(var d=0;d<s.length&&d<i.length;d++)if(!$n(i[d],s[d]))return!1;return!0}function vh(i,s,d,v,y,S){return Za=S,Ye=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,L.H=i===null||i.memoizedState===null?ky:My,Qo=!1,S=d(v,y),Qo=!1,Hi&&(S=Q0(s,d,v,y)),K0(i),S}function K0(i){L.H=ic;var s=vt!==null&&vt.next!==null;if(Za=0,qt=vt=Ye=null,Jl=!1,vu=0,Vi=null,s)throw Error(r(300));i===null||cn||(i=i.dependencies,i!==null&&Xl(i)&&(cn=!0))}function Q0(i,s,d,v){Ye=i;var y=0;do{if(Hi&&(Vi=null),vu=0,Hi=!1,25<=y)throw Error(r(301));if(y+=1,qt=vt=null,i.updateQueue!=null){var S=i.updateQueue;S.lastEffect=null,S.events=null,S.stores=null,S.memoCache!=null&&(S.memoCache.index=0)}L.H=fR,S=s(d,v)}while(Hi);return S}function oR(){var i=L.H,s=i.useState()[0];return s=typeof s.then=="function"?mu(s):s,i=i.useState()[0],(vt!==null?vt.memoizedState:null)!==i&&(Ye.flags|=1024),s}function mh(){var i=ec!==0;return ec=0,i}function gh(i,s,d){s.updateQueue=i.updateQueue,s.flags&=-2053,i.lanes&=~d}function yh(i){if(Jl){for(i=i.memoizedState;i!==null;){var s=i.queue;s!==null&&(s.pending=null),i=i.next}Jl=!1}Za=0,qt=vt=Ye=null,Hi=!1,vu=ec=0,Vi=null}function jn(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return qt===null?Ye.memoizedState=qt=i:qt=qt.next=i,qt}function Xt(){if(vt===null){var i=Ye.alternate;i=i!==null?i.memoizedState:null}else i=vt.next;var s=qt===null?Ye.memoizedState:qt.next;if(s!==null)qt=s,vt=i;else{if(i===null)throw Ye.alternate===null?Error(r(467)):Error(r(310));vt=i,i={memoizedState:vt.memoizedState,baseState:vt.baseState,baseQueue:vt.baseQueue,queue:vt.queue,next:null},qt===null?Ye.memoizedState=qt=i:qt=qt.next=i}return qt}function bh(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function mu(i){var s=vu;return vu+=1,Vi===null&&(Vi=[]),i=V0(Vi,i,s),s=Ye,(qt===null?s.memoizedState:qt.next)===null&&(s=s.alternate,L.H=s===null||s.memoizedState===null?ky:My),i}function tc(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return mu(i);if(i.$$typeof===_)return Rn(i)}throw Error(r(438,String(i)))}function xh(i){var s=null,d=Ye.updateQueue;if(d!==null&&(s=d.memoCache),s==null){var v=Ye.alternate;v!==null&&(v=v.updateQueue,v!==null&&(v=v.memoCache,v!=null&&(s={data:v.data.map(function(y){return y.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),d===null&&(d=bh(),Ye.updateQueue=d),d.memoCache=s,d=s.data[s.index],d===void 0)for(d=s.data[s.index]=Array(i),v=0;v<i;v++)d[v]=O;return s.index++,d}function _a(i,s){return typeof s=="function"?s(i):s}function nc(i){var s=Xt();return wh(s,vt,i)}function wh(i,s,d){var v=i.queue;if(v===null)throw Error(r(311));v.lastRenderedReducer=d;var y=i.baseQueue,S=v.pending;if(S!==null){if(y!==null){var T=y.next;y.next=S.next,S.next=T}s.baseQueue=y=S,v.pending=null}if(S=i.baseState,y===null)i.memoizedState=S;else{s=y.next;var I=T=null,G=null,ae=s,he=!1;do{var me=ae.lane&-536870913;if(me!==ae.lane?(at&me)===me:(Za&me)===me){var oe=ae.revertLane;if(oe===0)G!==null&&(G=G.next={lane:0,revertLane:0,action:ae.action,hasEagerState:ae.hasEagerState,eagerState:ae.eagerState,next:null}),me===zi&&(he=!0);else if((Za&oe)===oe){ae=ae.next,oe===zi&&(he=!0);continue}else me={lane:0,revertLane:ae.revertLane,action:ae.action,hasEagerState:ae.hasEagerState,eagerState:ae.eagerState,next:null},G===null?(I=G=me,T=S):G=G.next=me,Ye.lanes|=oe,oo|=oe;me=ae.action,Qo&&d(S,me),S=ae.hasEagerState?ae.eagerState:d(S,me)}else oe={lane:me,revertLane:ae.revertLane,action:ae.action,hasEagerState:ae.hasEagerState,eagerState:ae.eagerState,next:null},G===null?(I=G=oe,T=S):G=G.next=oe,Ye.lanes|=me,oo|=me;ae=ae.next}while(ae!==null&&ae!==s);if(G===null?T=S:G.next=I,!$n(S,i.memoizedState)&&(cn=!0,he&&(d=Ui,d!==null)))throw d;i.memoizedState=S,i.baseState=T,i.baseQueue=G,v.lastRenderedState=S}return y===null&&(v.lanes=0),[i.memoizedState,v.dispatch]}function Sh(i){var s=Xt(),d=s.queue;if(d===null)throw Error(r(311));d.lastRenderedReducer=i;var v=d.dispatch,y=d.pending,S=s.memoizedState;if(y!==null){d.pending=null;var T=y=y.next;do S=i(S,T.action),T=T.next;while(T!==y);$n(S,s.memoizedState)||(cn=!0),s.memoizedState=S,s.baseQueue===null&&(s.baseState=S),d.lastRenderedState=S}return[S,v]}function $0(i,s,d){var v=Ye,y=Xt(),S=lt;if(S){if(d===void 0)throw Error(r(407));d=d()}else d=s();var T=!$n((vt||y).memoizedState,d);T&&(y.memoizedState=d,cn=!0),y=y.queue;var I=ey.bind(null,v,y,i);if(gu(2048,8,I,[i]),y.getSnapshot!==s||T||qt!==null&&qt.memoizedState.tag&1){if(v.flags|=2048,Wi(9,rc(),J0.bind(null,v,y,d,s),null),St===null)throw Error(r(349));S||(Za&124)!==0||Z0(v,s,d)}return d}function Z0(i,s,d){i.flags|=16384,i={getSnapshot:s,value:d},s=Ye.updateQueue,s===null?(s=bh(),Ye.updateQueue=s,s.stores=[i]):(d=s.stores,d===null?s.stores=[i]:d.push(i))}function J0(i,s,d,v){s.value=d,s.getSnapshot=v,ty(s)&&ny(i)}function ey(i,s,d){return d(function(){ty(s)&&ny(i)})}function ty(i){var s=i.getSnapshot;i=i.value;try{var d=s();return!$n(i,d)}catch{return!0}}function ny(i){var s=Bi(i,2);s!==null&&rr(s,i,2)}function Eh(i){var s=jn();if(typeof i=="function"){var d=i;if(i=d(),Qo){At(!0);try{d()}finally{At(!1)}}}return s.memoizedState=s.baseState=i,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:_a,lastRenderedState:i},s}function ry(i,s,d,v){return i.baseState=d,wh(i,vt,typeof v=="function"?v:_a)}function iR(i,s,d,v,y){if(oc(i))throw Error(r(485));if(i=s.action,i!==null){var S={payload:y,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(T){S.listeners.push(T)}};L.T!==null?d(!0):S.isTransition=!1,v(S),d=s.pending,d===null?(S.next=s.pending=S,ay(s,S)):(S.next=d.next,s.pending=d.next=S)}}function ay(i,s){var d=s.action,v=s.payload,y=i.state;if(s.isTransition){var S=L.T,T={};L.T=T;try{var I=d(y,v),G=L.S;G!==null&&G(T,I),oy(i,s,I)}catch(ae){Ch(i,s,ae)}finally{L.T=S}}else try{S=d(y,v),oy(i,s,S)}catch(ae){Ch(i,s,ae)}}function oy(i,s,d){d!==null&&typeof d=="object"&&typeof d.then=="function"?d.then(function(v){iy(i,s,v)},function(v){return Ch(i,s,v)}):iy(i,s,d)}function iy(i,s,d){s.status="fulfilled",s.value=d,sy(s),i.state=d,s=i.pending,s!==null&&(d=s.next,d===s?i.pending=null:(d=d.next,s.next=d,ay(i,d)))}function Ch(i,s,d){var v=i.pending;if(i.pending=null,v!==null){v=v.next;do s.status="rejected",s.reason=d,sy(s),s=s.next;while(s!==v)}i.action=null}function sy(i){i=i.listeners;for(var s=0;s<i.length;s++)(0,i[s])()}function uy(i,s){return s}function ly(i,s){if(lt){var d=St.formState;if(d!==null){e:{var v=Ye;if(lt){if(Bt){t:{for(var y=Bt,S=Wr;y.nodeType!==8;){if(!S){y=null;break t}if(y=Mr(y.nextSibling),y===null){y=null;break t}}S=y.data,y=S==="F!"||S==="F"?y:null}if(y){Bt=Mr(y.nextSibling),v=y.data==="F!";break e}}qo(v)}v=!1}v&&(s=d[0])}}return d=jn(),d.memoizedState=d.baseState=s,v={pending:null,lanes:0,dispatch:null,lastRenderedReducer:uy,lastRenderedState:s},d.queue=v,d=Ty.bind(null,Ye,v),v.dispatch=d,v=Eh(!1),S=Nh.bind(null,Ye,!1,v.queue),v=jn(),y={state:s,dispatch:null,action:i,pending:null},v.queue=y,d=iR.bind(null,Ye,y,S,d),y.dispatch=d,v.memoizedState=i,[s,d,!1]}function cy(i){var s=Xt();return fy(s,vt,i)}function fy(i,s,d){if(s=wh(i,s,uy)[0],i=nc(_a)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var v=mu(s)}catch(T){throw T===cu?Ql:T}else v=s;s=Xt();var y=s.queue,S=y.dispatch;return d!==s.memoizedState&&(Ye.flags|=2048,Wi(9,rc(),sR.bind(null,y,d),null)),[v,S,i]}function sR(i,s){i.action=s}function dy(i){var s=Xt(),d=vt;if(d!==null)return fy(s,d,i);Xt(),s=s.memoizedState,d=Xt();var v=d.queue.dispatch;return d.memoizedState=i,[s,v,!1]}function Wi(i,s,d,v){return i={tag:i,create:d,deps:v,inst:s,next:null},s=Ye.updateQueue,s===null&&(s=bh(),Ye.updateQueue=s),d=s.lastEffect,d===null?s.lastEffect=i.next=i:(v=d.next,d.next=i,i.next=v,s.lastEffect=i),i}function rc(){return{destroy:void 0,resource:void 0}}function hy(){return Xt().memoizedState}function ac(i,s,d,v){var y=jn();v=v===void 0?null:v,Ye.flags|=i,y.memoizedState=Wi(1|s,rc(),d,v)}function gu(i,s,d,v){var y=Xt();v=v===void 0?null:v;var S=y.memoizedState.inst;vt!==null&&v!==null&&ph(v,vt.memoizedState.deps)?y.memoizedState=Wi(s,S,d,v):(Ye.flags|=i,y.memoizedState=Wi(1|s,S,d,v))}function py(i,s){ac(8390656,8,i,s)}function vy(i,s){gu(2048,8,i,s)}function my(i,s){return gu(4,2,i,s)}function gy(i,s){return gu(4,4,i,s)}function yy(i,s){if(typeof s=="function"){i=i();var d=s(i);return function(){typeof d=="function"?d():s(null)}}if(s!=null)return i=i(),s.current=i,function(){s.current=null}}function by(i,s,d){d=d!=null?d.concat([i]):null,gu(4,4,yy.bind(null,s,i),d)}function _h(){}function xy(i,s){var d=Xt();s=s===void 0?null:s;var v=d.memoizedState;return s!==null&&ph(s,v[1])?v[0]:(d.memoizedState=[i,s],i)}function wy(i,s){var d=Xt();s=s===void 0?null:s;var v=d.memoizedState;if(s!==null&&ph(s,v[1]))return v[0];if(v=i(),Qo){At(!0);try{i()}finally{At(!1)}}return d.memoizedState=[v,s],v}function Rh(i,s,d){return d===void 0||(Za&1073741824)!==0?i.memoizedState=s:(i.memoizedState=d,i=Cb(),Ye.lanes|=i,oo|=i,d)}function Sy(i,s,d,v){return $n(d,s)?d:ji.current!==null?(i=Rh(i,d,v),$n(i,s)||(cn=!0),i):(Za&42)===0?(cn=!0,i.memoizedState=d):(i=Cb(),Ye.lanes|=i,oo|=i,s)}function Ey(i,s,d,v,y){var S=W.p;W.p=S!==0&&8>S?S:8;var T=L.T,I={};L.T=I,Nh(i,!1,s,d);try{var G=y(),ae=L.S;if(ae!==null&&ae(I,G),G!==null&&typeof G=="object"&&typeof G.then=="function"){var he=rR(G,v);yu(i,s,he,nr(i))}else yu(i,s,v,nr(i))}catch(me){yu(i,s,{then:function(){},status:"rejected",reason:me},nr())}finally{W.p=S,L.T=T}}function uR(){}function Ah(i,s,d,v){if(i.tag!==5)throw Error(r(476));var y=Cy(i).queue;Ey(i,y,s,U,d===null?uR:function(){return _y(i),d(v)})}function Cy(i){var s=i.memoizedState;if(s!==null)return s;s={memoizedState:U,baseState:U,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:_a,lastRenderedState:U},next:null};var d={};return s.next={memoizedState:d,baseState:d,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:_a,lastRenderedState:d},next:null},i.memoizedState=s,i=i.alternate,i!==null&&(i.memoizedState=s),s}function _y(i){var s=Cy(i).next.queue;yu(i,s,{},nr())}function Th(){return Rn(Fu)}function Ry(){return Xt().memoizedState}function Ay(){return Xt().memoizedState}function lR(i){for(var s=i.return;s!==null;){switch(s.tag){case 24:case 3:var d=nr();i=Qa(d);var v=$a(s,i,d);v!==null&&(rr(v,s,d),du(v,s,d)),s={cache:ah()},i.payload=s;return}s=s.return}}function cR(i,s,d){var v=nr();d={lane:v,revertLane:0,action:d,hasEagerState:!1,eagerState:null,next:null},oc(i)?Ny(s,d):(d=Yd(i,s,d,v),d!==null&&(rr(d,i,v),Dy(d,s,v)))}function Ty(i,s,d){var v=nr();yu(i,s,d,v)}function yu(i,s,d,v){var y={lane:v,revertLane:0,action:d,hasEagerState:!1,eagerState:null,next:null};if(oc(i))Ny(s,y);else{var S=i.alternate;if(i.lanes===0&&(S===null||S.lanes===0)&&(S=s.lastRenderedReducer,S!==null))try{var T=s.lastRenderedState,I=S(T,d);if(y.hasEagerState=!0,y.eagerState=I,$n(I,T))return Hl(i,s,y,0),St===null&&jl(),!1}catch{}finally{}if(d=Yd(i,s,y,v),d!==null)return rr(d,i,v),Dy(d,s,v),!0}return!1}function Nh(i,s,d,v){if(v={lane:2,revertLane:sp(),action:v,hasEagerState:!1,eagerState:null,next:null},oc(i)){if(s)throw Error(r(479))}else s=Yd(i,d,v,2),s!==null&&rr(s,i,2)}function oc(i){var s=i.alternate;return i===Ye||s!==null&&s===Ye}function Ny(i,s){Hi=Jl=!0;var d=i.pending;d===null?s.next=s:(s.next=d.next,d.next=s),i.pending=s}function Dy(i,s,d){if((d&4194048)!==0){var v=s.lanes;v&=i.pendingLanes,d|=v,s.lanes=d,zt(i,d)}}var ic={readContext:Rn,use:tc,useCallback:Ht,useContext:Ht,useEffect:Ht,useImperativeHandle:Ht,useLayoutEffect:Ht,useInsertionEffect:Ht,useMemo:Ht,useReducer:Ht,useRef:Ht,useState:Ht,useDebugValue:Ht,useDeferredValue:Ht,useTransition:Ht,useSyncExternalStore:Ht,useId:Ht,useHostTransitionStatus:Ht,useFormState:Ht,useActionState:Ht,useOptimistic:Ht,useMemoCache:Ht,useCacheRefresh:Ht},ky={readContext:Rn,use:tc,useCallback:function(i,s){return jn().memoizedState=[i,s===void 0?null:s],i},useContext:Rn,useEffect:py,useImperativeHandle:function(i,s,d){d=d!=null?d.concat([i]):null,ac(4194308,4,yy.bind(null,s,i),d)},useLayoutEffect:function(i,s){return ac(4194308,4,i,s)},useInsertionEffect:function(i,s){ac(4,2,i,s)},useMemo:function(i,s){var d=jn();s=s===void 0?null:s;var v=i();if(Qo){At(!0);try{i()}finally{At(!1)}}return d.memoizedState=[v,s],v},useReducer:function(i,s,d){var v=jn();if(d!==void 0){var y=d(s);if(Qo){At(!0);try{d(s)}finally{At(!1)}}}else y=s;return v.memoizedState=v.baseState=y,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:y},v.queue=i,i=i.dispatch=cR.bind(null,Ye,i),[v.memoizedState,i]},useRef:function(i){var s=jn();return i={current:i},s.memoizedState=i},useState:function(i){i=Eh(i);var s=i.queue,d=Ty.bind(null,Ye,s);return s.dispatch=d,[i.memoizedState,d]},useDebugValue:_h,useDeferredValue:function(i,s){var d=jn();return Rh(d,i,s)},useTransition:function(){var i=Eh(!1);return i=Ey.bind(null,Ye,i.queue,!0,!1),jn().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,s,d){var v=Ye,y=jn();if(lt){if(d===void 0)throw Error(r(407));d=d()}else{if(d=s(),St===null)throw Error(r(349));(at&124)!==0||Z0(v,s,d)}y.memoizedState=d;var S={value:d,getSnapshot:s};return y.queue=S,py(ey.bind(null,v,S,i),[i]),v.flags|=2048,Wi(9,rc(),J0.bind(null,v,S,d,s),null),d},useId:function(){var i=jn(),s=St.identifierPrefix;if(lt){var d=Sa,v=wa;d=(v&~(1<<32-Nt(v)-1)).toString(32)+d,s=""+s+"R"+d,d=ec++,0<d&&(s+="H"+d.toString(32)),s+=""}else d=aR++,s=""+s+"r"+d.toString(32)+"";return i.memoizedState=s},useHostTransitionStatus:Th,useFormState:ly,useActionState:ly,useOptimistic:function(i){var s=jn();s.memoizedState=s.baseState=i;var d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=d,s=Nh.bind(null,Ye,!0,d),d.dispatch=s,[i,s]},useMemoCache:xh,useCacheRefresh:function(){return jn().memoizedState=lR.bind(null,Ye)}},My={readContext:Rn,use:tc,useCallback:xy,useContext:Rn,useEffect:vy,useImperativeHandle:by,useInsertionEffect:my,useLayoutEffect:gy,useMemo:wy,useReducer:nc,useRef:hy,useState:function(){return nc(_a)},useDebugValue:_h,useDeferredValue:function(i,s){var d=Xt();return Sy(d,vt.memoizedState,i,s)},useTransition:function(){var i=nc(_a)[0],s=Xt().memoizedState;return[typeof i=="boolean"?i:mu(i),s]},useSyncExternalStore:$0,useId:Ry,useHostTransitionStatus:Th,useFormState:cy,useActionState:cy,useOptimistic:function(i,s){var d=Xt();return ry(d,vt,i,s)},useMemoCache:xh,useCacheRefresh:Ay},fR={readContext:Rn,use:tc,useCallback:xy,useContext:Rn,useEffect:vy,useImperativeHandle:by,useInsertionEffect:my,useLayoutEffect:gy,useMemo:wy,useReducer:Sh,useRef:hy,useState:function(){return Sh(_a)},useDebugValue:_h,useDeferredValue:function(i,s){var d=Xt();return vt===null?Rh(d,i,s):Sy(d,vt.memoizedState,i,s)},useTransition:function(){var i=Sh(_a)[0],s=Xt().memoizedState;return[typeof i=="boolean"?i:mu(i),s]},useSyncExternalStore:$0,useId:Ry,useHostTransitionStatus:Th,useFormState:dy,useActionState:dy,useOptimistic:function(i,s){var d=Xt();return vt!==null?ry(d,vt,i,s):(d.baseState=i,[i,d.queue.dispatch])},useMemoCache:xh,useCacheRefresh:Ay},Gi=null,bu=0;function sc(i){var s=bu;return bu+=1,Gi===null&&(Gi=[]),V0(Gi,i,s)}function xu(i,s){s=s.props.ref,i.ref=s!==void 0?s:null}function uc(i,s){throw s.$$typeof===p?Error(r(525)):(i=Object.prototype.toString.call(s),Error(r(31,i==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":i)))}function Oy(i){var s=i._init;return s(i._payload)}function Iy(i){function s(te,Y){if(i){var re=te.deletions;re===null?(te.deletions=[Y],te.flags|=16):re.push(Y)}}function d(te,Y){if(!i)return null;for(;Y!==null;)s(te,Y),Y=Y.sibling;return null}function v(te){for(var Y=new Map;te!==null;)te.key!==null?Y.set(te.key,te):Y.set(te.index,te),te=te.sibling;return Y}function y(te,Y){return te=xa(te,Y),te.index=0,te.sibling=null,te}function S(te,Y,re){return te.index=re,i?(re=te.alternate,re!==null?(re=re.index,re<Y?(te.flags|=67108866,Y):re):(te.flags|=67108866,Y)):(te.flags|=1048576,Y)}function T(te){return i&&te.alternate===null&&(te.flags|=67108866),te}function I(te,Y,re,ve){return Y===null||Y.tag!==6?(Y=Qd(re,te.mode,ve),Y.return=te,Y):(Y=y(Y,re),Y.return=te,Y)}function G(te,Y,re,ve){var _e=re.type;return _e===b?he(te,Y,re.props.children,ve,re.key):Y!==null&&(Y.elementType===_e||typeof _e=="object"&&_e!==null&&_e.$$typeof===k&&Oy(_e)===Y.type)?(Y=y(Y,re.props),xu(Y,re),Y.return=te,Y):(Y=Wl(re.type,re.key,re.props,null,te.mode,ve),xu(Y,re),Y.return=te,Y)}function ae(te,Y,re,ve){return Y===null||Y.tag!==4||Y.stateNode.containerInfo!==re.containerInfo||Y.stateNode.implementation!==re.implementation?(Y=$d(re,te.mode,ve),Y.return=te,Y):(Y=y(Y,re.children||[]),Y.return=te,Y)}function he(te,Y,re,ve,_e){return Y===null||Y.tag!==7?(Y=Ho(re,te.mode,ve,_e),Y.return=te,Y):(Y=y(Y,re),Y.return=te,Y)}function me(te,Y,re){if(typeof Y=="string"&&Y!==""||typeof Y=="number"||typeof Y=="bigint")return Y=Qd(""+Y,te.mode,re),Y.return=te,Y;if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case m:return re=Wl(Y.type,Y.key,Y.props,null,te.mode,re),xu(re,Y),re.return=te,re;case g:return Y=$d(Y,te.mode,re),Y.return=te,Y;case k:var ve=Y._init;return Y=ve(Y._payload),me(te,Y,re)}if(K(Y)||H(Y))return Y=Ho(Y,te.mode,re,null),Y.return=te,Y;if(typeof Y.then=="function")return me(te,sc(Y),re);if(Y.$$typeof===_)return me(te,Yl(te,Y),re);uc(te,Y)}return null}function oe(te,Y,re,ve){var _e=Y!==null?Y.key:null;if(typeof re=="string"&&re!==""||typeof re=="number"||typeof re=="bigint")return _e!==null?null:I(te,Y,""+re,ve);if(typeof re=="object"&&re!==null){switch(re.$$typeof){case m:return re.key===_e?G(te,Y,re,ve):null;case g:return re.key===_e?ae(te,Y,re,ve):null;case k:return _e=re._init,re=_e(re._payload),oe(te,Y,re,ve)}if(K(re)||H(re))return _e!==null?null:he(te,Y,re,ve,null);if(typeof re.then=="function")return oe(te,Y,sc(re),ve);if(re.$$typeof===_)return oe(te,Y,Yl(te,re),ve);uc(te,re)}return null}function ie(te,Y,re,ve,_e){if(typeof ve=="string"&&ve!==""||typeof ve=="number"||typeof ve=="bigint")return te=te.get(re)||null,I(Y,te,""+ve,_e);if(typeof ve=="object"&&ve!==null){switch(ve.$$typeof){case m:return te=te.get(ve.key===null?re:ve.key)||null,G(Y,te,ve,_e);case g:return te=te.get(ve.key===null?re:ve.key)||null,ae(Y,te,ve,_e);case k:var Qe=ve._init;return ve=Qe(ve._payload),ie(te,Y,re,ve,_e)}if(K(ve)||H(ve))return te=te.get(re)||null,he(Y,te,ve,_e,null);if(typeof ve.then=="function")return ie(te,Y,re,sc(ve),_e);if(ve.$$typeof===_)return ie(te,Y,re,Yl(Y,ve),_e);uc(Y,ve)}return null}function Ue(te,Y,re,ve){for(var _e=null,Qe=null,Be=Y,Le=Y=0,dn=null;Be!==null&&Le<re.length;Le++){Be.index>Le?(dn=Be,Be=null):dn=Be.sibling;var ut=oe(te,Be,re[Le],ve);if(ut===null){Be===null&&(Be=dn);break}i&&Be&&ut.alternate===null&&s(te,Be),Y=S(ut,Y,Le),Qe===null?_e=ut:Qe.sibling=ut,Qe=ut,Be=dn}if(Le===re.length)return d(te,Be),lt&&Wo(te,Le),_e;if(Be===null){for(;Le<re.length;Le++)Be=me(te,re[Le],ve),Be!==null&&(Y=S(Be,Y,Le),Qe===null?_e=Be:Qe.sibling=Be,Qe=Be);return lt&&Wo(te,Le),_e}for(Be=v(Be);Le<re.length;Le++)dn=ie(Be,te,Le,re[Le],ve),dn!==null&&(i&&dn.alternate!==null&&Be.delete(dn.key===null?Le:dn.key),Y=S(dn,Y,Le),Qe===null?_e=dn:Qe.sibling=dn,Qe=dn);return i&&Be.forEach(function(vo){return s(te,vo)}),lt&&Wo(te,Le),_e}function Pe(te,Y,re,ve){if(re==null)throw Error(r(151));for(var _e=null,Qe=null,Be=Y,Le=Y=0,dn=null,ut=re.next();Be!==null&&!ut.done;Le++,ut=re.next()){Be.index>Le?(dn=Be,Be=null):dn=Be.sibling;var vo=oe(te,Be,ut.value,ve);if(vo===null){Be===null&&(Be=dn);break}i&&Be&&vo.alternate===null&&s(te,Be),Y=S(vo,Y,Le),Qe===null?_e=vo:Qe.sibling=vo,Qe=vo,Be=dn}if(ut.done)return d(te,Be),lt&&Wo(te,Le),_e;if(Be===null){for(;!ut.done;Le++,ut=re.next())ut=me(te,ut.value,ve),ut!==null&&(Y=S(ut,Y,Le),Qe===null?_e=ut:Qe.sibling=ut,Qe=ut);return lt&&Wo(te,Le),_e}for(Be=v(Be);!ut.done;Le++,ut=re.next())ut=ie(Be,te,Le,ut.value,ve),ut!==null&&(i&&ut.alternate!==null&&Be.delete(ut.key===null?Le:ut.key),Y=S(ut,Y,Le),Qe===null?_e=ut:Qe.sibling=ut,Qe=ut);return i&&Be.forEach(function(dA){return s(te,dA)}),lt&&Wo(te,Le),_e}function gt(te,Y,re,ve){if(typeof re=="object"&&re!==null&&re.type===b&&re.key===null&&(re=re.props.children),typeof re=="object"&&re!==null){switch(re.$$typeof){case m:e:{for(var _e=re.key;Y!==null;){if(Y.key===_e){if(_e=re.type,_e===b){if(Y.tag===7){d(te,Y.sibling),ve=y(Y,re.props.children),ve.return=te,te=ve;break e}}else if(Y.elementType===_e||typeof _e=="object"&&_e!==null&&_e.$$typeof===k&&Oy(_e)===Y.type){d(te,Y.sibling),ve=y(Y,re.props),xu(ve,re),ve.return=te,te=ve;break e}d(te,Y);break}else s(te,Y);Y=Y.sibling}re.type===b?(ve=Ho(re.props.children,te.mode,ve,re.key),ve.return=te,te=ve):(ve=Wl(re.type,re.key,re.props,null,te.mode,ve),xu(ve,re),ve.return=te,te=ve)}return T(te);case g:e:{for(_e=re.key;Y!==null;){if(Y.key===_e)if(Y.tag===4&&Y.stateNode.containerInfo===re.containerInfo&&Y.stateNode.implementation===re.implementation){d(te,Y.sibling),ve=y(Y,re.children||[]),ve.return=te,te=ve;break e}else{d(te,Y);break}else s(te,Y);Y=Y.sibling}ve=$d(re,te.mode,ve),ve.return=te,te=ve}return T(te);case k:return _e=re._init,re=_e(re._payload),gt(te,Y,re,ve)}if(K(re))return Ue(te,Y,re,ve);if(H(re)){if(_e=H(re),typeof _e!="function")throw Error(r(150));return re=_e.call(re),Pe(te,Y,re,ve)}if(typeof re.then=="function")return gt(te,Y,sc(re),ve);if(re.$$typeof===_)return gt(te,Y,Yl(te,re),ve);uc(te,re)}return typeof re=="string"&&re!==""||typeof re=="number"||typeof re=="bigint"?(re=""+re,Y!==null&&Y.tag===6?(d(te,Y.sibling),ve=y(Y,re),ve.return=te,te=ve):(d(te,Y),ve=Qd(re,te.mode,ve),ve.return=te,te=ve),T(te)):d(te,Y)}return function(te,Y,re,ve){try{bu=0;var _e=gt(te,Y,re,ve);return Gi=null,_e}catch(Be){if(Be===cu||Be===Ql)throw Be;var Qe=Zn(29,Be,null,te.mode);return Qe.lanes=ve,Qe.return=te,Qe}finally{}}}var qi=Iy(!0),By=Iy(!1),wr=q(null),Gr=null;function Ja(i){var s=i.alternate;J(Jt,Jt.current&1),J(wr,i),Gr===null&&(s===null||ji.current!==null||s.memoizedState!==null)&&(Gr=i)}function Fy(i){if(i.tag===22){if(J(Jt,Jt.current),J(wr,i),Gr===null){var s=i.alternate;s!==null&&s.memoizedState!==null&&(Gr=i)}}else eo()}function eo(){J(Jt,Jt.current),J(wr,wr.current)}function Ra(i){ne(wr),Gr===i&&(Gr=null),ne(Jt)}var Jt=q(0);function lc(i){for(var s=i;s!==null;){if(s.tag===13){var d=s.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||d.data==="$?"||bp(d)))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}function Dh(i,s,d,v){s=i.memoizedState,d=d(v,s),d=d==null?s:h({},s,d),i.memoizedState=d,i.lanes===0&&(i.updateQueue.baseState=d)}var kh={enqueueSetState:function(i,s,d){i=i._reactInternals;var v=nr(),y=Qa(v);y.payload=s,d!=null&&(y.callback=d),s=$a(i,y,v),s!==null&&(rr(s,i,v),du(s,i,v))},enqueueReplaceState:function(i,s,d){i=i._reactInternals;var v=nr(),y=Qa(v);y.tag=1,y.payload=s,d!=null&&(y.callback=d),s=$a(i,y,v),s!==null&&(rr(s,i,v),du(s,i,v))},enqueueForceUpdate:function(i,s){i=i._reactInternals;var d=nr(),v=Qa(d);v.tag=2,s!=null&&(v.callback=s),s=$a(i,v,d),s!==null&&(rr(s,i,d),du(s,i,d))}};function Py(i,s,d,v,y,S,T){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(v,S,T):s.prototype&&s.prototype.isPureReactComponent?!nu(d,v)||!nu(y,S):!0}function Ly(i,s,d,v){i=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(d,v),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(d,v),s.state!==i&&kh.enqueueReplaceState(s,s.state,null)}function $o(i,s){var d=s;if("ref"in s){d={};for(var v in s)v!=="ref"&&(d[v]=s[v])}if(i=i.defaultProps){d===s&&(d=h({},d));for(var y in i)d[y]===void 0&&(d[y]=i[y])}return d}var cc=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)};function zy(i){cc(i)}function Uy(i){console.error(i)}function jy(i){cc(i)}function fc(i,s){try{var d=i.onUncaughtError;d(s.value,{componentStack:s.stack})}catch(v){setTimeout(function(){throw v})}}function Hy(i,s,d){try{var v=i.onCaughtError;v(d.value,{componentStack:d.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(y){setTimeout(function(){throw y})}}function Mh(i,s,d){return d=Qa(d),d.tag=3,d.payload={element:null},d.callback=function(){fc(i,s)},d}function Vy(i){return i=Qa(i),i.tag=3,i}function Wy(i,s,d,v){var y=d.type.getDerivedStateFromError;if(typeof y=="function"){var S=v.value;i.payload=function(){return y(S)},i.callback=function(){Hy(s,d,v)}}var T=d.stateNode;T!==null&&typeof T.componentDidCatch=="function"&&(i.callback=function(){Hy(s,d,v),typeof y!="function"&&(io===null?io=new Set([this]):io.add(this));var I=v.stack;this.componentDidCatch(v.value,{componentStack:I!==null?I:""})})}function dR(i,s,d,v,y){if(d.flags|=32768,v!==null&&typeof v=="object"&&typeof v.then=="function"){if(s=d.alternate,s!==null&&su(s,d,y,!0),d=wr.current,d!==null){switch(d.tag){case 13:return Gr===null?np():d.alternate===null&&Ft===0&&(Ft=3),d.flags&=-257,d.flags|=65536,d.lanes=y,v===sh?d.flags|=16384:(s=d.updateQueue,s===null?d.updateQueue=new Set([v]):s.add(v),ap(i,v,y)),!1;case 22:return d.flags|=65536,v===sh?d.flags|=16384:(s=d.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([v])},d.updateQueue=s):(d=s.retryQueue,d===null?s.retryQueue=new Set([v]):d.add(v)),ap(i,v,y)),!1}throw Error(r(435,d.tag))}return ap(i,v,y),np(),!1}if(lt)return s=wr.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=y,v!==eh&&(i=Error(r(422),{cause:v}),iu(gr(i,d)))):(v!==eh&&(s=Error(r(423),{cause:v}),iu(gr(s,d))),i=i.current.alternate,i.flags|=65536,y&=-y,i.lanes|=y,v=gr(v,d),y=Mh(i.stateNode,v,y),ch(i,y),Ft!==4&&(Ft=2)),!1;var S=Error(r(520),{cause:v});if(S=gr(S,d),Au===null?Au=[S]:Au.push(S),Ft!==4&&(Ft=2),s===null)return!0;v=gr(v,d),d=s;do{switch(d.tag){case 3:return d.flags|=65536,i=y&-y,d.lanes|=i,i=Mh(d.stateNode,v,i),ch(d,i),!1;case 1:if(s=d.type,S=d.stateNode,(d.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(io===null||!io.has(S))))return d.flags|=65536,y&=-y,d.lanes|=y,y=Vy(y),Wy(y,i,d,v),ch(d,y),!1}d=d.return}while(d!==null);return!1}var Gy=Error(r(461)),cn=!1;function yn(i,s,d,v){s.child=i===null?By(s,null,d,v):qi(s,i.child,d,v)}function qy(i,s,d,v,y){d=d.render;var S=s.ref;if("ref"in v){var T={};for(var I in v)I!=="ref"&&(T[I]=v[I])}else T=v;return Yo(s),v=vh(i,s,d,T,S,y),I=mh(),i!==null&&!cn?(gh(i,s,y),Aa(i,s,y)):(lt&&I&&Zd(s),s.flags|=1,yn(i,s,v,y),s.child)}function Xy(i,s,d,v,y){if(i===null){var S=d.type;return typeof S=="function"&&!Kd(S)&&S.defaultProps===void 0&&d.compare===null?(s.tag=15,s.type=S,Yy(i,s,S,v,y)):(i=Wl(d.type,null,v,s,s.mode,y),i.ref=s.ref,i.return=s,s.child=i)}if(S=i.child,!Uh(i,y)){var T=S.memoizedProps;if(d=d.compare,d=d!==null?d:nu,d(T,v)&&i.ref===s.ref)return Aa(i,s,y)}return s.flags|=1,i=xa(S,v),i.ref=s.ref,i.return=s,s.child=i}function Yy(i,s,d,v,y){if(i!==null){var S=i.memoizedProps;if(nu(S,v)&&i.ref===s.ref)if(cn=!1,s.pendingProps=v=S,Uh(i,y))(i.flags&131072)!==0&&(cn=!0);else return s.lanes=i.lanes,Aa(i,s,y)}return Oh(i,s,d,v,y)}function Ky(i,s,d){var v=s.pendingProps,y=v.children,S=i!==null?i.memoizedState:null;if(v.mode==="hidden"){if((s.flags&128)!==0){if(v=S!==null?S.baseLanes|d:d,i!==null){for(y=s.child=i.child,S=0;y!==null;)S=S|y.lanes|y.childLanes,y=y.sibling;s.childLanes=S&~v}else s.childLanes=0,s.child=null;return Qy(i,s,v,d)}if((d&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},i!==null&&Kl(s,S!==null?S.cachePool:null),S!==null?Y0(s,S):dh(),Fy(s);else return s.lanes=s.childLanes=536870912,Qy(i,s,S!==null?S.baseLanes|d:d,d)}else S!==null?(Kl(s,S.cachePool),Y0(s,S),eo(),s.memoizedState=null):(i!==null&&Kl(s,null),dh(),eo());return yn(i,s,y,d),s.child}function Qy(i,s,d,v){var y=ih();return y=y===null?null:{parent:Zt._currentValue,pool:y},s.memoizedState={baseLanes:d,cachePool:y},i!==null&&Kl(s,null),dh(),Fy(s),i!==null&&su(i,s,v,!0),null}function dc(i,s){var d=s.ref;if(d===null)i!==null&&i.ref!==null&&(s.flags|=4194816);else{if(typeof d!="function"&&typeof d!="object")throw Error(r(284));(i===null||i.ref!==d)&&(s.flags|=4194816)}}function Oh(i,s,d,v,y){return Yo(s),d=vh(i,s,d,v,void 0,y),v=mh(),i!==null&&!cn?(gh(i,s,y),Aa(i,s,y)):(lt&&v&&Zd(s),s.flags|=1,yn(i,s,d,y),s.child)}function $y(i,s,d,v,y,S){return Yo(s),s.updateQueue=null,d=Q0(s,v,d,y),K0(i),v=mh(),i!==null&&!cn?(gh(i,s,S),Aa(i,s,S)):(lt&&v&&Zd(s),s.flags|=1,yn(i,s,d,S),s.child)}function Zy(i,s,d,v,y){if(Yo(s),s.stateNode===null){var S=Fi,T=d.contextType;typeof T=="object"&&T!==null&&(S=Rn(T)),S=new d(v,S),s.memoizedState=S.state!==null&&S.state!==void 0?S.state:null,S.updater=kh,s.stateNode=S,S._reactInternals=s,S=s.stateNode,S.props=v,S.state=s.memoizedState,S.refs={},uh(s),T=d.contextType,S.context=typeof T=="object"&&T!==null?Rn(T):Fi,S.state=s.memoizedState,T=d.getDerivedStateFromProps,typeof T=="function"&&(Dh(s,d,T,v),S.state=s.memoizedState),typeof d.getDerivedStateFromProps=="function"||typeof S.getSnapshotBeforeUpdate=="function"||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(T=S.state,typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount(),T!==S.state&&kh.enqueueReplaceState(S,S.state,null),pu(s,v,S,y),hu(),S.state=s.memoizedState),typeof S.componentDidMount=="function"&&(s.flags|=4194308),v=!0}else if(i===null){S=s.stateNode;var I=s.memoizedProps,G=$o(d,I);S.props=G;var ae=S.context,he=d.contextType;T=Fi,typeof he=="object"&&he!==null&&(T=Rn(he));var me=d.getDerivedStateFromProps;he=typeof me=="function"||typeof S.getSnapshotBeforeUpdate=="function",I=s.pendingProps!==I,he||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(I||ae!==T)&&Ly(s,S,v,T),Ka=!1;var oe=s.memoizedState;S.state=oe,pu(s,v,S,y),hu(),ae=s.memoizedState,I||oe!==ae||Ka?(typeof me=="function"&&(Dh(s,d,me,v),ae=s.memoizedState),(G=Ka||Py(s,d,G,v,oe,ae,T))?(he||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount()),typeof S.componentDidMount=="function"&&(s.flags|=4194308)):(typeof S.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=v,s.memoizedState=ae),S.props=v,S.state=ae,S.context=T,v=G):(typeof S.componentDidMount=="function"&&(s.flags|=4194308),v=!1)}else{S=s.stateNode,lh(i,s),T=s.memoizedProps,he=$o(d,T),S.props=he,me=s.pendingProps,oe=S.context,ae=d.contextType,G=Fi,typeof ae=="object"&&ae!==null&&(G=Rn(ae)),I=d.getDerivedStateFromProps,(ae=typeof I=="function"||typeof S.getSnapshotBeforeUpdate=="function")||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(T!==me||oe!==G)&&Ly(s,S,v,G),Ka=!1,oe=s.memoizedState,S.state=oe,pu(s,v,S,y),hu();var ie=s.memoizedState;T!==me||oe!==ie||Ka||i!==null&&i.dependencies!==null&&Xl(i.dependencies)?(typeof I=="function"&&(Dh(s,d,I,v),ie=s.memoizedState),(he=Ka||Py(s,d,he,v,oe,ie,G)||i!==null&&i.dependencies!==null&&Xl(i.dependencies))?(ae||typeof S.UNSAFE_componentWillUpdate!="function"&&typeof S.componentWillUpdate!="function"||(typeof S.componentWillUpdate=="function"&&S.componentWillUpdate(v,ie,G),typeof S.UNSAFE_componentWillUpdate=="function"&&S.UNSAFE_componentWillUpdate(v,ie,G)),typeof S.componentDidUpdate=="function"&&(s.flags|=4),typeof S.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof S.componentDidUpdate!="function"||T===i.memoizedProps&&oe===i.memoizedState||(s.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||T===i.memoizedProps&&oe===i.memoizedState||(s.flags|=1024),s.memoizedProps=v,s.memoizedState=ie),S.props=v,S.state=ie,S.context=G,v=he):(typeof S.componentDidUpdate!="function"||T===i.memoizedProps&&oe===i.memoizedState||(s.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||T===i.memoizedProps&&oe===i.memoizedState||(s.flags|=1024),v=!1)}return S=v,dc(i,s),v=(s.flags&128)!==0,S||v?(S=s.stateNode,d=v&&typeof d.getDerivedStateFromError!="function"?null:S.render(),s.flags|=1,i!==null&&v?(s.child=qi(s,i.child,null,y),s.child=qi(s,null,d,y)):yn(i,s,d,y),s.memoizedState=S.state,i=s.child):i=Aa(i,s,y),i}function Jy(i,s,d,v){return ou(),s.flags|=256,yn(i,s,d,v),s.child}var Ih={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Bh(i){return{baseLanes:i,cachePool:U0()}}function Fh(i,s,d){return i=i!==null?i.childLanes&~d:0,s&&(i|=Sr),i}function eb(i,s,d){var v=s.pendingProps,y=!1,S=(s.flags&128)!==0,T;if((T=S)||(T=i!==null&&i.memoizedState===null?!1:(Jt.current&2)!==0),T&&(y=!0,s.flags&=-129),T=(s.flags&32)!==0,s.flags&=-33,i===null){if(lt){if(y?Ja(s):eo(),lt){var I=Bt,G;if(G=I){e:{for(G=I,I=Wr;G.nodeType!==8;){if(!I){I=null;break e}if(G=Mr(G.nextSibling),G===null){I=null;break e}}I=G}I!==null?(s.memoizedState={dehydrated:I,treeContext:Vo!==null?{id:wa,overflow:Sa}:null,retryLane:536870912,hydrationErrors:null},G=Zn(18,null,null,0),G.stateNode=I,G.return=s,s.child=G,Pn=s,Bt=null,G=!0):G=!1}G||qo(s)}if(I=s.memoizedState,I!==null&&(I=I.dehydrated,I!==null))return bp(I)?s.lanes=32:s.lanes=536870912,null;Ra(s)}return I=v.children,v=v.fallback,y?(eo(),y=s.mode,I=hc({mode:"hidden",children:I},y),v=Ho(v,y,d,null),I.return=s,v.return=s,I.sibling=v,s.child=I,y=s.child,y.memoizedState=Bh(d),y.childLanes=Fh(i,T,d),s.memoizedState=Ih,v):(Ja(s),Ph(s,I))}if(G=i.memoizedState,G!==null&&(I=G.dehydrated,I!==null)){if(S)s.flags&256?(Ja(s),s.flags&=-257,s=Lh(i,s,d)):s.memoizedState!==null?(eo(),s.child=i.child,s.flags|=128,s=null):(eo(),y=v.fallback,I=s.mode,v=hc({mode:"visible",children:v.children},I),y=Ho(y,I,d,null),y.flags|=2,v.return=s,y.return=s,v.sibling=y,s.child=v,qi(s,i.child,null,d),v=s.child,v.memoizedState=Bh(d),v.childLanes=Fh(i,T,d),s.memoizedState=Ih,s=y);else if(Ja(s),bp(I)){if(T=I.nextSibling&&I.nextSibling.dataset,T)var ae=T.dgst;T=ae,v=Error(r(419)),v.stack="",v.digest=T,iu({value:v,source:null,stack:null}),s=Lh(i,s,d)}else if(cn||su(i,s,d,!1),T=(d&i.childLanes)!==0,cn||T){if(T=St,T!==null&&(v=d&-d,v=(v&42)!==0?1:Gt(v),v=(v&(T.suspendedLanes|d))!==0?0:v,v!==0&&v!==G.retryLane))throw G.retryLane=v,Bi(i,v),rr(T,i,v),Gy;I.data==="$?"||np(),s=Lh(i,s,d)}else I.data==="$?"?(s.flags|=192,s.child=i.child,s=null):(i=G.treeContext,Bt=Mr(I.nextSibling),Pn=s,lt=!0,Go=null,Wr=!1,i!==null&&(br[xr++]=wa,br[xr++]=Sa,br[xr++]=Vo,wa=i.id,Sa=i.overflow,Vo=s),s=Ph(s,v.children),s.flags|=4096);return s}return y?(eo(),y=v.fallback,I=s.mode,G=i.child,ae=G.sibling,v=xa(G,{mode:"hidden",children:v.children}),v.subtreeFlags=G.subtreeFlags&65011712,ae!==null?y=xa(ae,y):(y=Ho(y,I,d,null),y.flags|=2),y.return=s,v.return=s,v.sibling=y,s.child=v,v=y,y=s.child,I=i.child.memoizedState,I===null?I=Bh(d):(G=I.cachePool,G!==null?(ae=Zt._currentValue,G=G.parent!==ae?{parent:ae,pool:ae}:G):G=U0(),I={baseLanes:I.baseLanes|d,cachePool:G}),y.memoizedState=I,y.childLanes=Fh(i,T,d),s.memoizedState=Ih,v):(Ja(s),d=i.child,i=d.sibling,d=xa(d,{mode:"visible",children:v.children}),d.return=s,d.sibling=null,i!==null&&(T=s.deletions,T===null?(s.deletions=[i],s.flags|=16):T.push(i)),s.child=d,s.memoizedState=null,d)}function Ph(i,s){return s=hc({mode:"visible",children:s},i.mode),s.return=i,i.child=s}function hc(i,s){return i=Zn(22,i,null,s),i.lanes=0,i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},i}function Lh(i,s,d){return qi(s,i.child,null,d),i=Ph(s,s.pendingProps.children),i.flags|=2,s.memoizedState=null,i}function tb(i,s,d){i.lanes|=s;var v=i.alternate;v!==null&&(v.lanes|=s),nh(i.return,s,d)}function zh(i,s,d,v,y){var S=i.memoizedState;S===null?i.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:v,tail:d,tailMode:y}:(S.isBackwards=s,S.rendering=null,S.renderingStartTime=0,S.last=v,S.tail=d,S.tailMode=y)}function nb(i,s,d){var v=s.pendingProps,y=v.revealOrder,S=v.tail;if(yn(i,s,v.children,d),v=Jt.current,(v&2)!==0)v=v&1|2,s.flags|=128;else{if(i!==null&&(i.flags&128)!==0)e:for(i=s.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&tb(i,d,s);else if(i.tag===19)tb(i,d,s);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break e;for(;i.sibling===null;){if(i.return===null||i.return===s)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}v&=1}switch(J(Jt,v),y){case"forwards":for(d=s.child,y=null;d!==null;)i=d.alternate,i!==null&&lc(i)===null&&(y=d),d=d.sibling;d=y,d===null?(y=s.child,s.child=null):(y=d.sibling,d.sibling=null),zh(s,!1,y,d,S);break;case"backwards":for(d=null,y=s.child,s.child=null;y!==null;){if(i=y.alternate,i!==null&&lc(i)===null){s.child=y;break}i=y.sibling,y.sibling=d,d=y,y=i}zh(s,!0,d,null,S);break;case"together":zh(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function Aa(i,s,d){if(i!==null&&(s.dependencies=i.dependencies),oo|=s.lanes,(d&s.childLanes)===0)if(i!==null){if(su(i,s,d,!1),(d&s.childLanes)===0)return null}else return null;if(i!==null&&s.child!==i.child)throw Error(r(153));if(s.child!==null){for(i=s.child,d=xa(i,i.pendingProps),s.child=d,d.return=s;i.sibling!==null;)i=i.sibling,d=d.sibling=xa(i,i.pendingProps),d.return=s;d.sibling=null}return s.child}function Uh(i,s){return(i.lanes&s)!==0?!0:(i=i.dependencies,!!(i!==null&&Xl(i)))}function hR(i,s,d){switch(s.tag){case 3:ce(s,s.stateNode.containerInfo),Ya(s,Zt,i.memoizedState.cache),ou();break;case 27:case 5:we(s);break;case 4:ce(s,s.stateNode.containerInfo);break;case 10:Ya(s,s.type,s.memoizedProps.value);break;case 13:var v=s.memoizedState;if(v!==null)return v.dehydrated!==null?(Ja(s),s.flags|=128,null):(d&s.child.childLanes)!==0?eb(i,s,d):(Ja(s),i=Aa(i,s,d),i!==null?i.sibling:null);Ja(s);break;case 19:var y=(i.flags&128)!==0;if(v=(d&s.childLanes)!==0,v||(su(i,s,d,!1),v=(d&s.childLanes)!==0),y){if(v)return nb(i,s,d);s.flags|=128}if(y=s.memoizedState,y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),J(Jt,Jt.current),v)break;return null;case 22:case 23:return s.lanes=0,Ky(i,s,d);case 24:Ya(s,Zt,i.memoizedState.cache)}return Aa(i,s,d)}function rb(i,s,d){if(i!==null)if(i.memoizedProps!==s.pendingProps)cn=!0;else{if(!Uh(i,d)&&(s.flags&128)===0)return cn=!1,hR(i,s,d);cn=(i.flags&131072)!==0}else cn=!1,lt&&(s.flags&1048576)!==0&&O0(s,ql,s.index);switch(s.lanes=0,s.tag){case 16:e:{i=s.pendingProps;var v=s.elementType,y=v._init;if(v=y(v._payload),s.type=v,typeof v=="function")Kd(v)?(i=$o(v,i),s.tag=1,s=Zy(null,s,v,i,d)):(s.tag=0,s=Oh(null,s,v,i,d));else{if(v!=null){if(y=v.$$typeof,y===R){s.tag=11,s=qy(null,s,v,i,d);break e}else if(y===M){s.tag=14,s=Xy(null,s,v,i,d);break e}}throw s=$(v)||v,Error(r(306,s,""))}}return s;case 0:return Oh(i,s,s.type,s.pendingProps,d);case 1:return v=s.type,y=$o(v,s.pendingProps),Zy(i,s,v,y,d);case 3:e:{if(ce(s,s.stateNode.containerInfo),i===null)throw Error(r(387));v=s.pendingProps;var S=s.memoizedState;y=S.element,lh(i,s),pu(s,v,null,d);var T=s.memoizedState;if(v=T.cache,Ya(s,Zt,v),v!==S.cache&&rh(s,[Zt],d,!0),hu(),v=T.element,S.isDehydrated)if(S={element:v,isDehydrated:!1,cache:T.cache},s.updateQueue.baseState=S,s.memoizedState=S,s.flags&256){s=Jy(i,s,v,d);break e}else if(v!==y){y=gr(Error(r(424)),s),iu(y),s=Jy(i,s,v,d);break e}else{switch(i=s.stateNode.containerInfo,i.nodeType){case 9:i=i.body;break;default:i=i.nodeName==="HTML"?i.ownerDocument.body:i}for(Bt=Mr(i.firstChild),Pn=s,lt=!0,Go=null,Wr=!0,d=By(s,null,v,d),s.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling}else{if(ou(),v===y){s=Aa(i,s,d);break e}yn(i,s,v,d)}s=s.child}return s;case 26:return dc(i,s),i===null?(d=sx(s.type,null,s.pendingProps,null))?s.memoizedState=d:lt||(d=s.type,i=s.pendingProps,v=Ac(pe.current).createElement(d),v[jt]=s,v[wt]=i,xn(v,d,i),ln(v),s.stateNode=v):s.memoizedState=sx(s.type,i.memoizedProps,s.pendingProps,i.memoizedState),null;case 27:return we(s),i===null&&lt&&(v=s.stateNode=ax(s.type,s.pendingProps,pe.current),Pn=s,Wr=!0,y=Bt,lo(s.type)?(xp=y,Bt=Mr(v.firstChild)):Bt=y),yn(i,s,s.pendingProps.children,d),dc(i,s),i===null&&(s.flags|=4194304),s.child;case 5:return i===null&&lt&&((y=v=Bt)&&(v=jR(v,s.type,s.pendingProps,Wr),v!==null?(s.stateNode=v,Pn=s,Bt=Mr(v.firstChild),Wr=!1,y=!0):y=!1),y||qo(s)),we(s),y=s.type,S=s.pendingProps,T=i!==null?i.memoizedProps:null,v=S.children,mp(y,S)?v=null:T!==null&&mp(y,T)&&(s.flags|=32),s.memoizedState!==null&&(y=vh(i,s,oR,null,null,d),Fu._currentValue=y),dc(i,s),yn(i,s,v,d),s.child;case 6:return i===null&&lt&&((i=d=Bt)&&(d=HR(d,s.pendingProps,Wr),d!==null?(s.stateNode=d,Pn=s,Bt=null,i=!0):i=!1),i||qo(s)),null;case 13:return eb(i,s,d);case 4:return ce(s,s.stateNode.containerInfo),v=s.pendingProps,i===null?s.child=qi(s,null,v,d):yn(i,s,v,d),s.child;case 11:return qy(i,s,s.type,s.pendingProps,d);case 7:return yn(i,s,s.pendingProps,d),s.child;case 8:return yn(i,s,s.pendingProps.children,d),s.child;case 12:return yn(i,s,s.pendingProps.children,d),s.child;case 10:return v=s.pendingProps,Ya(s,s.type,v.value),yn(i,s,v.children,d),s.child;case 9:return y=s.type._context,v=s.pendingProps.children,Yo(s),y=Rn(y),v=v(y),s.flags|=1,yn(i,s,v,d),s.child;case 14:return Xy(i,s,s.type,s.pendingProps,d);case 15:return Yy(i,s,s.type,s.pendingProps,d);case 19:return nb(i,s,d);case 31:return v=s.pendingProps,d=s.mode,v={mode:v.mode,children:v.children},i===null?(d=hc(v,d),d.ref=s.ref,s.child=d,d.return=s,s=d):(d=xa(i.child,v),d.ref=s.ref,s.child=d,d.return=s,s=d),s;case 22:return Ky(i,s,d);case 24:return Yo(s),v=Rn(Zt),i===null?(y=ih(),y===null&&(y=St,S=ah(),y.pooledCache=S,S.refCount++,S!==null&&(y.pooledCacheLanes|=d),y=S),s.memoizedState={parent:v,cache:y},uh(s),Ya(s,Zt,y)):((i.lanes&d)!==0&&(lh(i,s),pu(s,null,null,d),hu()),y=i.memoizedState,S=s.memoizedState,y.parent!==v?(y={parent:v,cache:v},s.memoizedState=y,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=y),Ya(s,Zt,v)):(v=S.cache,Ya(s,Zt,v),v!==y.cache&&rh(s,[Zt],d,!0))),yn(i,s,s.pendingProps.children,d),s.child;case 29:throw s.pendingProps}throw Error(r(156,s.tag))}function Ta(i){i.flags|=4}function ab(i,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!dx(s)){if(s=wr.current,s!==null&&((at&4194048)===at?Gr!==null:(at&62914560)!==at&&(at&536870912)===0||s!==Gr))throw fu=sh,j0;i.flags|=8192}}function pc(i,s){s!==null&&(i.flags|=4),i.flags&16384&&(s=i.tag!==22?Tl():536870912,i.lanes|=s,Qi|=s)}function wu(i,s){if(!lt)switch(i.tailMode){case"hidden":s=i.tail;for(var d=null;s!==null;)s.alternate!==null&&(d=s),s=s.sibling;d===null?i.tail=null:d.sibling=null;break;case"collapsed":d=i.tail;for(var v=null;d!==null;)d.alternate!==null&&(v=d),d=d.sibling;v===null?s||i.tail===null?i.tail=null:i.tail.sibling=null:v.sibling=null}}function Dt(i){var s=i.alternate!==null&&i.alternate.child===i.child,d=0,v=0;if(s)for(var y=i.child;y!==null;)d|=y.lanes|y.childLanes,v|=y.subtreeFlags&65011712,v|=y.flags&65011712,y.return=i,y=y.sibling;else for(y=i.child;y!==null;)d|=y.lanes|y.childLanes,v|=y.subtreeFlags,v|=y.flags,y.return=i,y=y.sibling;return i.subtreeFlags|=v,i.childLanes=d,s}function pR(i,s,d){var v=s.pendingProps;switch(Jd(s),s.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Dt(s),null;case 1:return Dt(s),null;case 3:return d=s.stateNode,v=null,i!==null&&(v=i.memoizedState.cache),s.memoizedState.cache!==v&&(s.flags|=2048),Ca(Zt),xe(),d.pendingContext&&(d.context=d.pendingContext,d.pendingContext=null),(i===null||i.child===null)&&(au(s)?Ta(s):i===null||i.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,F0())),Dt(s),null;case 26:return d=s.memoizedState,i===null?(Ta(s),d!==null?(Dt(s),ab(s,d)):(Dt(s),s.flags&=-16777217)):d?d!==i.memoizedState?(Ta(s),Dt(s),ab(s,d)):(Dt(s),s.flags&=-16777217):(i.memoizedProps!==v&&Ta(s),Dt(s),s.flags&=-16777217),null;case 27:Ee(s),d=pe.current;var y=s.type;if(i!==null&&s.stateNode!=null)i.memoizedProps!==v&&Ta(s);else{if(!v){if(s.stateNode===null)throw Error(r(166));return Dt(s),null}i=le.current,au(s)?I0(s):(i=ax(y,v,d),s.stateNode=i,Ta(s))}return Dt(s),null;case 5:if(Ee(s),d=s.type,i!==null&&s.stateNode!=null)i.memoizedProps!==v&&Ta(s);else{if(!v){if(s.stateNode===null)throw Error(r(166));return Dt(s),null}if(i=le.current,au(s))I0(s);else{switch(y=Ac(pe.current),i){case 1:i=y.createElementNS("http://www.w3.org/2000/svg",d);break;case 2:i=y.createElementNS("http://www.w3.org/1998/Math/MathML",d);break;default:switch(d){case"svg":i=y.createElementNS("http://www.w3.org/2000/svg",d);break;case"math":i=y.createElementNS("http://www.w3.org/1998/Math/MathML",d);break;case"script":i=y.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild);break;case"select":i=typeof v.is=="string"?y.createElement("select",{is:v.is}):y.createElement("select"),v.multiple?i.multiple=!0:v.size&&(i.size=v.size);break;default:i=typeof v.is=="string"?y.createElement(d,{is:v.is}):y.createElement(d)}}i[jt]=s,i[wt]=v;e:for(y=s.child;y!==null;){if(y.tag===5||y.tag===6)i.appendChild(y.stateNode);else if(y.tag!==4&&y.tag!==27&&y.child!==null){y.child.return=y,y=y.child;continue}if(y===s)break e;for(;y.sibling===null;){if(y.return===null||y.return===s)break e;y=y.return}y.sibling.return=y.return,y=y.sibling}s.stateNode=i;e:switch(xn(i,d,v),d){case"button":case"input":case"select":case"textarea":i=!!v.autoFocus;break e;case"img":i=!0;break e;default:i=!1}i&&Ta(s)}}return Dt(s),s.flags&=-16777217,null;case 6:if(i&&s.stateNode!=null)i.memoizedProps!==v&&Ta(s);else{if(typeof v!="string"&&s.stateNode===null)throw Error(r(166));if(i=pe.current,au(s)){if(i=s.stateNode,d=s.memoizedProps,v=null,y=Pn,y!==null)switch(y.tag){case 27:case 5:v=y.memoizedProps}i[jt]=s,i=!!(i.nodeValue===d||v!==null&&v.suppressHydrationWarning===!0||$b(i.nodeValue,d)),i||qo(s)}else i=Ac(i).createTextNode(v),i[jt]=s,s.stateNode=i}return Dt(s),null;case 13:if(v=s.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(y=au(s),v!==null&&v.dehydrated!==null){if(i===null){if(!y)throw Error(r(318));if(y=s.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(r(317));y[jt]=s}else ou(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;Dt(s),y=!1}else y=F0(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=y),y=!0;if(!y)return s.flags&256?(Ra(s),s):(Ra(s),null)}if(Ra(s),(s.flags&128)!==0)return s.lanes=d,s;if(d=v!==null,i=i!==null&&i.memoizedState!==null,d){v=s.child,y=null,v.alternate!==null&&v.alternate.memoizedState!==null&&v.alternate.memoizedState.cachePool!==null&&(y=v.alternate.memoizedState.cachePool.pool);var S=null;v.memoizedState!==null&&v.memoizedState.cachePool!==null&&(S=v.memoizedState.cachePool.pool),S!==y&&(v.flags|=2048)}return d!==i&&d&&(s.child.flags|=8192),pc(s,s.updateQueue),Dt(s),null;case 4:return xe(),i===null&&fp(s.stateNode.containerInfo),Dt(s),null;case 10:return Ca(s.type),Dt(s),null;case 19:if(ne(Jt),y=s.memoizedState,y===null)return Dt(s),null;if(v=(s.flags&128)!==0,S=y.rendering,S===null)if(v)wu(y,!1);else{if(Ft!==0||i!==null&&(i.flags&128)!==0)for(i=s.child;i!==null;){if(S=lc(i),S!==null){for(s.flags|=128,wu(y,!1),i=S.updateQueue,s.updateQueue=i,pc(s,i),s.subtreeFlags=0,i=d,d=s.child;d!==null;)M0(d,i),d=d.sibling;return J(Jt,Jt.current&1|2),s.child}i=i.sibling}y.tail!==null&&st()>gc&&(s.flags|=128,v=!0,wu(y,!1),s.lanes=4194304)}else{if(!v)if(i=lc(S),i!==null){if(s.flags|=128,v=!0,i=i.updateQueue,s.updateQueue=i,pc(s,i),wu(y,!0),y.tail===null&&y.tailMode==="hidden"&&!S.alternate&&!lt)return Dt(s),null}else 2*st()-y.renderingStartTime>gc&&d!==536870912&&(s.flags|=128,v=!0,wu(y,!1),s.lanes=4194304);y.isBackwards?(S.sibling=s.child,s.child=S):(i=y.last,i!==null?i.sibling=S:s.child=S,y.last=S)}return y.tail!==null?(s=y.tail,y.rendering=s,y.tail=s.sibling,y.renderingStartTime=st(),s.sibling=null,i=Jt.current,J(Jt,v?i&1|2:i&1),s):(Dt(s),null);case 22:case 23:return Ra(s),hh(),v=s.memoizedState!==null,i!==null?i.memoizedState!==null!==v&&(s.flags|=8192):v&&(s.flags|=8192),v?(d&536870912)!==0&&(s.flags&128)===0&&(Dt(s),s.subtreeFlags&6&&(s.flags|=8192)):Dt(s),d=s.updateQueue,d!==null&&pc(s,d.retryQueue),d=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(d=i.memoizedState.cachePool.pool),v=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(v=s.memoizedState.cachePool.pool),v!==d&&(s.flags|=2048),i!==null&&ne(Ko),null;case 24:return d=null,i!==null&&(d=i.memoizedState.cache),s.memoizedState.cache!==d&&(s.flags|=2048),Ca(Zt),Dt(s),null;case 25:return null;case 30:return null}throw Error(r(156,s.tag))}function vR(i,s){switch(Jd(s),s.tag){case 1:return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 3:return Ca(Zt),xe(),i=s.flags,(i&65536)!==0&&(i&128)===0?(s.flags=i&-65537|128,s):null;case 26:case 27:case 5:return Ee(s),null;case 13:if(Ra(s),i=s.memoizedState,i!==null&&i.dehydrated!==null){if(s.alternate===null)throw Error(r(340));ou()}return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 19:return ne(Jt),null;case 4:return xe(),null;case 10:return Ca(s.type),null;case 22:case 23:return Ra(s),hh(),i!==null&&ne(Ko),i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 24:return Ca(Zt),null;case 25:return null;default:return null}}function ob(i,s){switch(Jd(s),s.tag){case 3:Ca(Zt),xe();break;case 26:case 27:case 5:Ee(s);break;case 4:xe();break;case 13:Ra(s);break;case 19:ne(Jt);break;case 10:Ca(s.type);break;case 22:case 23:Ra(s),hh(),i!==null&&ne(Ko);break;case 24:Ca(Zt)}}function Su(i,s){try{var d=s.updateQueue,v=d!==null?d.lastEffect:null;if(v!==null){var y=v.next;d=y;do{if((d.tag&i)===i){v=void 0;var S=d.create,T=d.inst;v=S(),T.destroy=v}d=d.next}while(d!==y)}}catch(I){yt(s,s.return,I)}}function to(i,s,d){try{var v=s.updateQueue,y=v!==null?v.lastEffect:null;if(y!==null){var S=y.next;v=S;do{if((v.tag&i)===i){var T=v.inst,I=T.destroy;if(I!==void 0){T.destroy=void 0,y=s;var G=d,ae=I;try{ae()}catch(he){yt(y,G,he)}}}v=v.next}while(v!==S)}}catch(he){yt(s,s.return,he)}}function ib(i){var s=i.updateQueue;if(s!==null){var d=i.stateNode;try{X0(s,d)}catch(v){yt(i,i.return,v)}}}function sb(i,s,d){d.props=$o(i.type,i.memoizedProps),d.state=i.memoizedState;try{d.componentWillUnmount()}catch(v){yt(i,s,v)}}function Eu(i,s){try{var d=i.ref;if(d!==null){switch(i.tag){case 26:case 27:case 5:var v=i.stateNode;break;case 30:v=i.stateNode;break;default:v=i.stateNode}typeof d=="function"?i.refCleanup=d(v):d.current=v}}catch(y){yt(i,s,y)}}function qr(i,s){var d=i.ref,v=i.refCleanup;if(d!==null)if(typeof v=="function")try{v()}catch(y){yt(i,s,y)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof d=="function")try{d(null)}catch(y){yt(i,s,y)}else d.current=null}function ub(i){var s=i.type,d=i.memoizedProps,v=i.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":d.autoFocus&&v.focus();break e;case"img":d.src?v.src=d.src:d.srcSet&&(v.srcset=d.srcSet)}}catch(y){yt(i,i.return,y)}}function jh(i,s,d){try{var v=i.stateNode;FR(v,i.type,d,s),v[wt]=s}catch(y){yt(i,i.return,y)}}function lb(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&lo(i.type)||i.tag===4}function Hh(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||lb(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&lo(i.type)||i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function Vh(i,s,d){var v=i.tag;if(v===5||v===6)i=i.stateNode,s?(d.nodeType===9?d.body:d.nodeName==="HTML"?d.ownerDocument.body:d).insertBefore(i,s):(s=d.nodeType===9?d.body:d.nodeName==="HTML"?d.ownerDocument.body:d,s.appendChild(i),d=d._reactRootContainer,d!=null||s.onclick!==null||(s.onclick=Rc));else if(v!==4&&(v===27&&lo(i.type)&&(d=i.stateNode,s=null),i=i.child,i!==null))for(Vh(i,s,d),i=i.sibling;i!==null;)Vh(i,s,d),i=i.sibling}function vc(i,s,d){var v=i.tag;if(v===5||v===6)i=i.stateNode,s?d.insertBefore(i,s):d.appendChild(i);else if(v!==4&&(v===27&&lo(i.type)&&(d=i.stateNode),i=i.child,i!==null))for(vc(i,s,d),i=i.sibling;i!==null;)vc(i,s,d),i=i.sibling}function cb(i){var s=i.stateNode,d=i.memoizedProps;try{for(var v=i.type,y=s.attributes;y.length;)s.removeAttributeNode(y[0]);xn(s,v,d),s[jt]=i,s[wt]=d}catch(S){yt(i,i.return,S)}}var Na=!1,Vt=!1,Wh=!1,fb=typeof WeakSet=="function"?WeakSet:Set,fn=null;function mR(i,s){if(i=i.containerInfo,pp=Oc,i=S0(i),Hd(i)){if("selectionStart"in i)var d={start:i.selectionStart,end:i.selectionEnd};else e:{d=(d=i.ownerDocument)&&d.defaultView||window;var v=d.getSelection&&d.getSelection();if(v&&v.rangeCount!==0){d=v.anchorNode;var y=v.anchorOffset,S=v.focusNode;v=v.focusOffset;try{d.nodeType,S.nodeType}catch{d=null;break e}var T=0,I=-1,G=-1,ae=0,he=0,me=i,oe=null;t:for(;;){for(var ie;me!==d||y!==0&&me.nodeType!==3||(I=T+y),me!==S||v!==0&&me.nodeType!==3||(G=T+v),me.nodeType===3&&(T+=me.nodeValue.length),(ie=me.firstChild)!==null;)oe=me,me=ie;for(;;){if(me===i)break t;if(oe===d&&++ae===y&&(I=T),oe===S&&++he===v&&(G=T),(ie=me.nextSibling)!==null)break;me=oe,oe=me.parentNode}me=ie}d=I===-1||G===-1?null:{start:I,end:G}}else d=null}d=d||{start:0,end:0}}else d=null;for(vp={focusedElem:i,selectionRange:d},Oc=!1,fn=s;fn!==null;)if(s=fn,i=s.child,(s.subtreeFlags&1024)!==0&&i!==null)i.return=s,fn=i;else for(;fn!==null;){switch(s=fn,S=s.alternate,i=s.flags,s.tag){case 0:break;case 11:case 15:break;case 1:if((i&1024)!==0&&S!==null){i=void 0,d=s,y=S.memoizedProps,S=S.memoizedState,v=d.stateNode;try{var Ue=$o(d.type,y,d.elementType===d.type);i=v.getSnapshotBeforeUpdate(Ue,S),v.__reactInternalSnapshotBeforeUpdate=i}catch(Pe){yt(d,d.return,Pe)}}break;case 3:if((i&1024)!==0){if(i=s.stateNode.containerInfo,d=i.nodeType,d===9)yp(i);else if(d===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":yp(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(r(163))}if(i=s.sibling,i!==null){i.return=s.return,fn=i;break}fn=s.return}}function db(i,s,d){var v=d.flags;switch(d.tag){case 0:case 11:case 15:no(i,d),v&4&&Su(5,d);break;case 1:if(no(i,d),v&4)if(i=d.stateNode,s===null)try{i.componentDidMount()}catch(T){yt(d,d.return,T)}else{var y=$o(d.type,s.memoizedProps);s=s.memoizedState;try{i.componentDidUpdate(y,s,i.__reactInternalSnapshotBeforeUpdate)}catch(T){yt(d,d.return,T)}}v&64&&ib(d),v&512&&Eu(d,d.return);break;case 3:if(no(i,d),v&64&&(i=d.updateQueue,i!==null)){if(s=null,d.child!==null)switch(d.child.tag){case 27:case 5:s=d.child.stateNode;break;case 1:s=d.child.stateNode}try{X0(i,s)}catch(T){yt(d,d.return,T)}}break;case 27:s===null&&v&4&&cb(d);case 26:case 5:no(i,d),s===null&&v&4&&ub(d),v&512&&Eu(d,d.return);break;case 12:no(i,d);break;case 13:no(i,d),v&4&&vb(i,d),v&64&&(i=d.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(d=_R.bind(null,d),VR(i,d))));break;case 22:if(v=d.memoizedState!==null||Na,!v){s=s!==null&&s.memoizedState!==null||Vt,y=Na;var S=Vt;Na=v,(Vt=s)&&!S?ro(i,d,(d.subtreeFlags&8772)!==0):no(i,d),Na=y,Vt=S}break;case 30:break;default:no(i,d)}}function hb(i){var s=i.alternate;s!==null&&(i.alternate=null,hb(s)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(s=i.stateNode,s!==null&&Ed(s)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var Tt=null,Hn=!1;function Da(i,s,d){for(d=d.child;d!==null;)pb(i,s,d),d=d.sibling}function pb(i,s,d){if(Rt&&typeof Rt.onCommitFiberUnmount=="function")try{Rt.onCommitFiberUnmount(_n,d)}catch{}switch(d.tag){case 26:Vt||qr(d,s),Da(i,s,d),d.memoizedState?d.memoizedState.count--:d.stateNode&&(d=d.stateNode,d.parentNode.removeChild(d));break;case 27:Vt||qr(d,s);var v=Tt,y=Hn;lo(d.type)&&(Tt=d.stateNode,Hn=!1),Da(i,s,d),Mu(d.stateNode),Tt=v,Hn=y;break;case 5:Vt||qr(d,s);case 6:if(v=Tt,y=Hn,Tt=null,Da(i,s,d),Tt=v,Hn=y,Tt!==null)if(Hn)try{(Tt.nodeType===9?Tt.body:Tt.nodeName==="HTML"?Tt.ownerDocument.body:Tt).removeChild(d.stateNode)}catch(S){yt(d,s,S)}else try{Tt.removeChild(d.stateNode)}catch(S){yt(d,s,S)}break;case 18:Tt!==null&&(Hn?(i=Tt,nx(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,d.stateNode),Uu(i)):nx(Tt,d.stateNode));break;case 4:v=Tt,y=Hn,Tt=d.stateNode.containerInfo,Hn=!0,Da(i,s,d),Tt=v,Hn=y;break;case 0:case 11:case 14:case 15:Vt||to(2,d,s),Vt||to(4,d,s),Da(i,s,d);break;case 1:Vt||(qr(d,s),v=d.stateNode,typeof v.componentWillUnmount=="function"&&sb(d,s,v)),Da(i,s,d);break;case 21:Da(i,s,d);break;case 22:Vt=(v=Vt)||d.memoizedState!==null,Da(i,s,d),Vt=v;break;default:Da(i,s,d)}}function vb(i,s){if(s.memoizedState===null&&(i=s.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{Uu(i)}catch(d){yt(s,s.return,d)}}function gR(i){switch(i.tag){case 13:case 19:var s=i.stateNode;return s===null&&(s=i.stateNode=new fb),s;case 22:return i=i.stateNode,s=i._retryCache,s===null&&(s=i._retryCache=new fb),s;default:throw Error(r(435,i.tag))}}function Gh(i,s){var d=gR(i);s.forEach(function(v){var y=RR.bind(null,i,v);d.has(v)||(d.add(v),v.then(y,y))})}function Jn(i,s){var d=s.deletions;if(d!==null)for(var v=0;v<d.length;v++){var y=d[v],S=i,T=s,I=T;e:for(;I!==null;){switch(I.tag){case 27:if(lo(I.type)){Tt=I.stateNode,Hn=!1;break e}break;case 5:Tt=I.stateNode,Hn=!1;break e;case 3:case 4:Tt=I.stateNode.containerInfo,Hn=!0;break e}I=I.return}if(Tt===null)throw Error(r(160));pb(S,T,y),Tt=null,Hn=!1,S=y.alternate,S!==null&&(S.return=null),y.return=null}if(s.subtreeFlags&13878)for(s=s.child;s!==null;)mb(s,i),s=s.sibling}var kr=null;function mb(i,s){var d=i.alternate,v=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:Jn(s,i),er(i),v&4&&(to(3,i,i.return),Su(3,i),to(5,i,i.return));break;case 1:Jn(s,i),er(i),v&512&&(Vt||d===null||qr(d,d.return)),v&64&&Na&&(i=i.updateQueue,i!==null&&(v=i.callbacks,v!==null&&(d=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=d===null?v:d.concat(v))));break;case 26:var y=kr;if(Jn(s,i),er(i),v&512&&(Vt||d===null||qr(d,d.return)),v&4){var S=d!==null?d.memoizedState:null;if(v=i.memoizedState,d===null)if(v===null)if(i.stateNode===null){e:{v=i.type,d=i.memoizedProps,y=y.ownerDocument||y;t:switch(v){case"title":S=y.getElementsByTagName("title")[0],(!S||S[Xs]||S[jt]||S.namespaceURI==="http://www.w3.org/2000/svg"||S.hasAttribute("itemprop"))&&(S=y.createElement(v),y.head.insertBefore(S,y.querySelector("head > title"))),xn(S,v,d),S[jt]=i,ln(S),v=S;break e;case"link":var T=cx("link","href",y).get(v+(d.href||""));if(T){for(var I=0;I<T.length;I++)if(S=T[I],S.getAttribute("href")===(d.href==null||d.href===""?null:d.href)&&S.getAttribute("rel")===(d.rel==null?null:d.rel)&&S.getAttribute("title")===(d.title==null?null:d.title)&&S.getAttribute("crossorigin")===(d.crossOrigin==null?null:d.crossOrigin)){T.splice(I,1);break t}}S=y.createElement(v),xn(S,v,d),y.head.appendChild(S);break;case"meta":if(T=cx("meta","content",y).get(v+(d.content||""))){for(I=0;I<T.length;I++)if(S=T[I],S.getAttribute("content")===(d.content==null?null:""+d.content)&&S.getAttribute("name")===(d.name==null?null:d.name)&&S.getAttribute("property")===(d.property==null?null:d.property)&&S.getAttribute("http-equiv")===(d.httpEquiv==null?null:d.httpEquiv)&&S.getAttribute("charset")===(d.charSet==null?null:d.charSet)){T.splice(I,1);break t}}S=y.createElement(v),xn(S,v,d),y.head.appendChild(S);break;default:throw Error(r(468,v))}S[jt]=i,ln(S),v=S}i.stateNode=v}else fx(y,i.type,i.stateNode);else i.stateNode=lx(y,v,i.memoizedProps);else S!==v?(S===null?d.stateNode!==null&&(d=d.stateNode,d.parentNode.removeChild(d)):S.count--,v===null?fx(y,i.type,i.stateNode):lx(y,v,i.memoizedProps)):v===null&&i.stateNode!==null&&jh(i,i.memoizedProps,d.memoizedProps)}break;case 27:Jn(s,i),er(i),v&512&&(Vt||d===null||qr(d,d.return)),d!==null&&v&4&&jh(i,i.memoizedProps,d.memoizedProps);break;case 5:if(Jn(s,i),er(i),v&512&&(Vt||d===null||qr(d,d.return)),i.flags&32){y=i.stateNode;try{Ti(y,"")}catch(ie){yt(i,i.return,ie)}}v&4&&i.stateNode!=null&&(y=i.memoizedProps,jh(i,y,d!==null?d.memoizedProps:y)),v&1024&&(Wh=!0);break;case 6:if(Jn(s,i),er(i),v&4){if(i.stateNode===null)throw Error(r(162));v=i.memoizedProps,d=i.stateNode;try{d.nodeValue=v}catch(ie){yt(i,i.return,ie)}}break;case 3:if(Dc=null,y=kr,kr=Tc(s.containerInfo),Jn(s,i),kr=y,er(i),v&4&&d!==null&&d.memoizedState.isDehydrated)try{Uu(s.containerInfo)}catch(ie){yt(i,i.return,ie)}Wh&&(Wh=!1,gb(i));break;case 4:v=kr,kr=Tc(i.stateNode.containerInfo),Jn(s,i),er(i),kr=v;break;case 12:Jn(s,i),er(i);break;case 13:Jn(s,i),er(i),i.child.flags&8192&&i.memoizedState!==null!=(d!==null&&d.memoizedState!==null)&&($h=st()),v&4&&(v=i.updateQueue,v!==null&&(i.updateQueue=null,Gh(i,v)));break;case 22:y=i.memoizedState!==null;var G=d!==null&&d.memoizedState!==null,ae=Na,he=Vt;if(Na=ae||y,Vt=he||G,Jn(s,i),Vt=he,Na=ae,er(i),v&8192)e:for(s=i.stateNode,s._visibility=y?s._visibility&-2:s._visibility|1,y&&(d===null||G||Na||Vt||Zo(i)),d=null,s=i;;){if(s.tag===5||s.tag===26){if(d===null){G=d=s;try{if(S=G.stateNode,y)T=S.style,typeof T.setProperty=="function"?T.setProperty("display","none","important"):T.display="none";else{I=G.stateNode;var me=G.memoizedProps.style,oe=me!=null&&me.hasOwnProperty("display")?me.display:null;I.style.display=oe==null||typeof oe=="boolean"?"":(""+oe).trim()}}catch(ie){yt(G,G.return,ie)}}}else if(s.tag===6){if(d===null){G=s;try{G.stateNode.nodeValue=y?"":G.memoizedProps}catch(ie){yt(G,G.return,ie)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===i)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break e;for(;s.sibling===null;){if(s.return===null||s.return===i)break e;d===s&&(d=null),s=s.return}d===s&&(d=null),s.sibling.return=s.return,s=s.sibling}v&4&&(v=i.updateQueue,v!==null&&(d=v.retryQueue,d!==null&&(v.retryQueue=null,Gh(i,d))));break;case 19:Jn(s,i),er(i),v&4&&(v=i.updateQueue,v!==null&&(i.updateQueue=null,Gh(i,v)));break;case 30:break;case 21:break;default:Jn(s,i),er(i)}}function er(i){var s=i.flags;if(s&2){try{for(var d,v=i.return;v!==null;){if(lb(v)){d=v;break}v=v.return}if(d==null)throw Error(r(160));switch(d.tag){case 27:var y=d.stateNode,S=Hh(i);vc(i,S,y);break;case 5:var T=d.stateNode;d.flags&32&&(Ti(T,""),d.flags&=-33);var I=Hh(i);vc(i,I,T);break;case 3:case 4:var G=d.stateNode.containerInfo,ae=Hh(i);Vh(i,ae,G);break;default:throw Error(r(161))}}catch(he){yt(i,i.return,he)}i.flags&=-3}s&4096&&(i.flags&=-4097)}function gb(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var s=i;gb(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),i=i.sibling}}function no(i,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)db(i,s.alternate,s),s=s.sibling}function Zo(i){for(i=i.child;i!==null;){var s=i;switch(s.tag){case 0:case 11:case 14:case 15:to(4,s,s.return),Zo(s);break;case 1:qr(s,s.return);var d=s.stateNode;typeof d.componentWillUnmount=="function"&&sb(s,s.return,d),Zo(s);break;case 27:Mu(s.stateNode);case 26:case 5:qr(s,s.return),Zo(s);break;case 22:s.memoizedState===null&&Zo(s);break;case 30:Zo(s);break;default:Zo(s)}i=i.sibling}}function ro(i,s,d){for(d=d&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var v=s.alternate,y=i,S=s,T=S.flags;switch(S.tag){case 0:case 11:case 15:ro(y,S,d),Su(4,S);break;case 1:if(ro(y,S,d),v=S,y=v.stateNode,typeof y.componentDidMount=="function")try{y.componentDidMount()}catch(ae){yt(v,v.return,ae)}if(v=S,y=v.updateQueue,y!==null){var I=v.stateNode;try{var G=y.shared.hiddenCallbacks;if(G!==null)for(y.shared.hiddenCallbacks=null,y=0;y<G.length;y++)q0(G[y],I)}catch(ae){yt(v,v.return,ae)}}d&&T&64&&ib(S),Eu(S,S.return);break;case 27:cb(S);case 26:case 5:ro(y,S,d),d&&v===null&&T&4&&ub(S),Eu(S,S.return);break;case 12:ro(y,S,d);break;case 13:ro(y,S,d),d&&T&4&&vb(y,S);break;case 22:S.memoizedState===null&&ro(y,S,d),Eu(S,S.return);break;case 30:break;default:ro(y,S,d)}s=s.sibling}}function qh(i,s){var d=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(d=i.memoizedState.cachePool.pool),i=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(i=s.memoizedState.cachePool.pool),i!==d&&(i!=null&&i.refCount++,d!=null&&uu(d))}function Xh(i,s){i=null,s.alternate!==null&&(i=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==i&&(s.refCount++,i!=null&&uu(i))}function Xr(i,s,d,v){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)yb(i,s,d,v),s=s.sibling}function yb(i,s,d,v){var y=s.flags;switch(s.tag){case 0:case 11:case 15:Xr(i,s,d,v),y&2048&&Su(9,s);break;case 1:Xr(i,s,d,v);break;case 3:Xr(i,s,d,v),y&2048&&(i=null,s.alternate!==null&&(i=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==i&&(s.refCount++,i!=null&&uu(i)));break;case 12:if(y&2048){Xr(i,s,d,v),i=s.stateNode;try{var S=s.memoizedProps,T=S.id,I=S.onPostCommit;typeof I=="function"&&I(T,s.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(G){yt(s,s.return,G)}}else Xr(i,s,d,v);break;case 13:Xr(i,s,d,v);break;case 23:break;case 22:S=s.stateNode,T=s.alternate,s.memoizedState!==null?S._visibility&2?Xr(i,s,d,v):Cu(i,s):S._visibility&2?Xr(i,s,d,v):(S._visibility|=2,Xi(i,s,d,v,(s.subtreeFlags&10256)!==0)),y&2048&&qh(T,s);break;case 24:Xr(i,s,d,v),y&2048&&Xh(s.alternate,s);break;default:Xr(i,s,d,v)}}function Xi(i,s,d,v,y){for(y=y&&(s.subtreeFlags&10256)!==0,s=s.child;s!==null;){var S=i,T=s,I=d,G=v,ae=T.flags;switch(T.tag){case 0:case 11:case 15:Xi(S,T,I,G,y),Su(8,T);break;case 23:break;case 22:var he=T.stateNode;T.memoizedState!==null?he._visibility&2?Xi(S,T,I,G,y):Cu(S,T):(he._visibility|=2,Xi(S,T,I,G,y)),y&&ae&2048&&qh(T.alternate,T);break;case 24:Xi(S,T,I,G,y),y&&ae&2048&&Xh(T.alternate,T);break;default:Xi(S,T,I,G,y)}s=s.sibling}}function Cu(i,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var d=i,v=s,y=v.flags;switch(v.tag){case 22:Cu(d,v),y&2048&&qh(v.alternate,v);break;case 24:Cu(d,v),y&2048&&Xh(v.alternate,v);break;default:Cu(d,v)}s=s.sibling}}var _u=8192;function Yi(i){if(i.subtreeFlags&_u)for(i=i.child;i!==null;)bb(i),i=i.sibling}function bb(i){switch(i.tag){case 26:Yi(i),i.flags&_u&&i.memoizedState!==null&&nA(kr,i.memoizedState,i.memoizedProps);break;case 5:Yi(i);break;case 3:case 4:var s=kr;kr=Tc(i.stateNode.containerInfo),Yi(i),kr=s;break;case 22:i.memoizedState===null&&(s=i.alternate,s!==null&&s.memoizedState!==null?(s=_u,_u=16777216,Yi(i),_u=s):Yi(i));break;default:Yi(i)}}function xb(i){var s=i.alternate;if(s!==null&&(i=s.child,i!==null)){s.child=null;do s=i.sibling,i.sibling=null,i=s;while(i!==null)}}function Ru(i){var s=i.deletions;if((i.flags&16)!==0){if(s!==null)for(var d=0;d<s.length;d++){var v=s[d];fn=v,Sb(v,i)}xb(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)wb(i),i=i.sibling}function wb(i){switch(i.tag){case 0:case 11:case 15:Ru(i),i.flags&2048&&to(9,i,i.return);break;case 3:Ru(i);break;case 12:Ru(i);break;case 22:var s=i.stateNode;i.memoizedState!==null&&s._visibility&2&&(i.return===null||i.return.tag!==13)?(s._visibility&=-3,mc(i)):Ru(i);break;default:Ru(i)}}function mc(i){var s=i.deletions;if((i.flags&16)!==0){if(s!==null)for(var d=0;d<s.length;d++){var v=s[d];fn=v,Sb(v,i)}xb(i)}for(i=i.child;i!==null;){switch(s=i,s.tag){case 0:case 11:case 15:to(8,s,s.return),mc(s);break;case 22:d=s.stateNode,d._visibility&2&&(d._visibility&=-3,mc(s));break;default:mc(s)}i=i.sibling}}function Sb(i,s){for(;fn!==null;){var d=fn;switch(d.tag){case 0:case 11:case 15:to(8,d,s);break;case 23:case 22:if(d.memoizedState!==null&&d.memoizedState.cachePool!==null){var v=d.memoizedState.cachePool.pool;v!=null&&v.refCount++}break;case 24:uu(d.memoizedState.cache)}if(v=d.child,v!==null)v.return=d,fn=v;else e:for(d=i;fn!==null;){v=fn;var y=v.sibling,S=v.return;if(hb(v),v===d){fn=null;break e}if(y!==null){y.return=S,fn=y;break e}fn=S}}}var yR={getCacheForType:function(i){var s=Rn(Zt),d=s.data.get(i);return d===void 0&&(d=i(),s.data.set(i,d)),d}},bR=typeof WeakMap=="function"?WeakMap:Map,dt=0,St=null,Ze=null,at=0,ht=0,tr=null,ao=!1,Ki=!1,Yh=!1,ka=0,Ft=0,oo=0,Jo=0,Kh=0,Sr=0,Qi=0,Au=null,Vn=null,Qh=!1,$h=0,gc=1/0,yc=null,io=null,bn=0,so=null,$i=null,Zi=0,Zh=0,Jh=null,Eb=null,Tu=0,ep=null;function nr(){if((dt&2)!==0&&at!==0)return at&-at;if(L.T!==null){var i=zi;return i!==0?i:sp()}return Po()}function Cb(){Sr===0&&(Sr=(at&536870912)===0||lt?Nr():536870912);var i=wr.current;return i!==null&&(i.flags|=32),Sr}function rr(i,s,d){(i===St&&(ht===2||ht===9)||i.cancelPendingCommit!==null)&&(Ji(i,0),uo(i,at,Sr,!1)),qa(i,d),((dt&2)===0||i!==St)&&(i===St&&((dt&2)===0&&(Jo|=d),Ft===4&&uo(i,at,Sr,!1)),Yr(i))}function _b(i,s,d){if((dt&6)!==0)throw Error(r(327));var v=!d&&(s&124)===0&&(s&i.expiredLanes)===0||Fo(i,s),y=v?SR(i,s):rp(i,s,!0),S=v;do{if(y===0){Ki&&!v&&uo(i,s,0,!1);break}else{if(d=i.current.alternate,S&&!xR(d)){y=rp(i,s,!1),S=!1;continue}if(y===2){if(S=s,i.errorRecoveryDisabledLanes&S)var T=0;else T=i.pendingLanes&-536870913,T=T!==0?T:T&536870912?536870912:0;if(T!==0){s=T;e:{var I=i;y=Au;var G=I.current.memoizedState.isDehydrated;if(G&&(Ji(I,T).flags|=256),T=rp(I,T,!1),T!==2){if(Yh&&!G){I.errorRecoveryDisabledLanes|=S,Jo|=S,y=4;break e}S=Vn,Vn=y,S!==null&&(Vn===null?Vn=S:Vn.push.apply(Vn,S))}y=T}if(S=!1,y!==2)continue}}if(y===1){Ji(i,0),uo(i,s,0,!0);break}e:{switch(v=i,S=y,S){case 0:case 1:throw Error(r(345));case 4:if((s&4194048)!==s)break;case 6:uo(v,s,Sr,!ao);break e;case 2:Vn=null;break;case 3:case 5:break;default:throw Error(r(329))}if((s&62914560)===s&&(y=$h+300-st(),10<y)){if(uo(v,s,Sr,!ao),Bo(v,0,!0)!==0)break e;v.timeoutHandle=ex(Rb.bind(null,v,d,Vn,yc,Qh,s,Sr,Jo,Qi,ao,S,2,-0,0),y);break e}Rb(v,d,Vn,yc,Qh,s,Sr,Jo,Qi,ao,S,0,-0,0)}}break}while(!0);Yr(i)}function Rb(i,s,d,v,y,S,T,I,G,ae,he,me,oe,ie){if(i.timeoutHandle=-1,me=s.subtreeFlags,(me&8192||(me&16785408)===16785408)&&(Bu={stylesheets:null,count:0,unsuspend:tA},bb(s),me=rA(),me!==null)){i.cancelPendingCommit=me(Ob.bind(null,i,s,S,d,v,y,T,I,G,he,1,oe,ie)),uo(i,S,T,!ae);return}Ob(i,s,S,d,v,y,T,I,G)}function xR(i){for(var s=i;;){var d=s.tag;if((d===0||d===11||d===15)&&s.flags&16384&&(d=s.updateQueue,d!==null&&(d=d.stores,d!==null)))for(var v=0;v<d.length;v++){var y=d[v],S=y.getSnapshot;y=y.value;try{if(!$n(S(),y))return!1}catch{return!1}}if(d=s.child,s.subtreeFlags&16384&&d!==null)d.return=s,s=d;else{if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function uo(i,s,d,v){s&=~Kh,s&=~Jo,i.suspendedLanes|=s,i.pingedLanes&=~s,v&&(i.warmLanes|=s),v=i.expirationTimes;for(var y=s;0<y;){var S=31-Nt(y),T=1<<S;v[S]=-1,y&=~T}d!==0&&Ve(i,d,s)}function bc(){return(dt&6)===0?(Nu(0),!1):!0}function tp(){if(Ze!==null){if(ht===0)var i=Ze.return;else i=Ze,Ea=Xo=null,yh(i),Gi=null,bu=0,i=Ze;for(;i!==null;)ob(i.alternate,i),i=i.return;Ze=null}}function Ji(i,s){var d=i.timeoutHandle;d!==-1&&(i.timeoutHandle=-1,LR(d)),d=i.cancelPendingCommit,d!==null&&(i.cancelPendingCommit=null,d()),tp(),St=i,Ze=d=xa(i.current,null),at=s,ht=0,tr=null,ao=!1,Ki=Fo(i,s),Yh=!1,Qi=Sr=Kh=Jo=oo=Ft=0,Vn=Au=null,Qh=!1,(s&8)!==0&&(s|=s&32);var v=i.entangledLanes;if(v!==0)for(i=i.entanglements,v&=s;0<v;){var y=31-Nt(v),S=1<<y;s|=i[y],v&=~S}return ka=s,jl(),d}function Ab(i,s){Ye=null,L.H=ic,s===cu||s===Ql?(s=W0(),ht=3):s===j0?(s=W0(),ht=4):ht=s===Gy?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,tr=s,Ze===null&&(Ft=1,fc(i,gr(s,i.current)))}function Tb(){var i=L.H;return L.H=ic,i===null?ic:i}function Nb(){var i=L.A;return L.A=yR,i}function np(){Ft=4,ao||(at&4194048)!==at&&wr.current!==null||(Ki=!0),(oo&134217727)===0&&(Jo&134217727)===0||St===null||uo(St,at,Sr,!1)}function rp(i,s,d){var v=dt;dt|=2;var y=Tb(),S=Nb();(St!==i||at!==s)&&(yc=null,Ji(i,s)),s=!1;var T=Ft;e:do try{if(ht!==0&&Ze!==null){var I=Ze,G=tr;switch(ht){case 8:tp(),T=6;break e;case 3:case 2:case 9:case 6:wr.current===null&&(s=!0);var ae=ht;if(ht=0,tr=null,es(i,I,G,ae),d&&Ki){T=0;break e}break;default:ae=ht,ht=0,tr=null,es(i,I,G,ae)}}wR(),T=Ft;break}catch(he){Ab(i,he)}while(!0);return s&&i.shellSuspendCounter++,Ea=Xo=null,dt=v,L.H=y,L.A=S,Ze===null&&(St=null,at=0,jl()),T}function wR(){for(;Ze!==null;)Db(Ze)}function SR(i,s){var d=dt;dt|=2;var v=Tb(),y=Nb();St!==i||at!==s?(yc=null,gc=st()+500,Ji(i,s)):Ki=Fo(i,s);e:do try{if(ht!==0&&Ze!==null){s=Ze;var S=tr;t:switch(ht){case 1:ht=0,tr=null,es(i,s,S,1);break;case 2:case 9:if(H0(S)){ht=0,tr=null,kb(s);break}s=function(){ht!==2&&ht!==9||St!==i||(ht=7),Yr(i)},S.then(s,s);break e;case 3:ht=7;break e;case 4:ht=5;break e;case 7:H0(S)?(ht=0,tr=null,kb(s)):(ht=0,tr=null,es(i,s,S,7));break;case 5:var T=null;switch(Ze.tag){case 26:T=Ze.memoizedState;case 5:case 27:var I=Ze;if(!T||dx(T)){ht=0,tr=null;var G=I.sibling;if(G!==null)Ze=G;else{var ae=I.return;ae!==null?(Ze=ae,xc(ae)):Ze=null}break t}}ht=0,tr=null,es(i,s,S,5);break;case 6:ht=0,tr=null,es(i,s,S,6);break;case 8:tp(),Ft=6;break e;default:throw Error(r(462))}}ER();break}catch(he){Ab(i,he)}while(!0);return Ea=Xo=null,L.H=v,L.A=y,dt=d,Ze!==null?0:(St=null,at=0,jl(),Ft)}function ER(){for(;Ze!==null&&!it();)Db(Ze)}function Db(i){var s=rb(i.alternate,i,ka);i.memoizedProps=i.pendingProps,s===null?xc(i):Ze=s}function kb(i){var s=i,d=s.alternate;switch(s.tag){case 15:case 0:s=$y(d,s,s.pendingProps,s.type,void 0,at);break;case 11:s=$y(d,s,s.pendingProps,s.type.render,s.ref,at);break;case 5:yh(s);default:ob(d,s),s=Ze=M0(s,ka),s=rb(d,s,ka)}i.memoizedProps=i.pendingProps,s===null?xc(i):Ze=s}function es(i,s,d,v){Ea=Xo=null,yh(s),Gi=null,bu=0;var y=s.return;try{if(dR(i,y,s,d,at)){Ft=1,fc(i,gr(d,i.current)),Ze=null;return}}catch(S){if(y!==null)throw Ze=y,S;Ft=1,fc(i,gr(d,i.current)),Ze=null;return}s.flags&32768?(lt||v===1?i=!0:Ki||(at&536870912)!==0?i=!1:(ao=i=!0,(v===2||v===9||v===3||v===6)&&(v=wr.current,v!==null&&v.tag===13&&(v.flags|=16384))),Mb(s,i)):xc(s)}function xc(i){var s=i;do{if((s.flags&32768)!==0){Mb(s,ao);return}i=s.return;var d=pR(s.alternate,s,ka);if(d!==null){Ze=d;return}if(s=s.sibling,s!==null){Ze=s;return}Ze=s=i}while(s!==null);Ft===0&&(Ft=5)}function Mb(i,s){do{var d=vR(i.alternate,i);if(d!==null){d.flags&=32767,Ze=d;return}if(d=i.return,d!==null&&(d.flags|=32768,d.subtreeFlags=0,d.deletions=null),!s&&(i=i.sibling,i!==null)){Ze=i;return}Ze=i=d}while(i!==null);Ft=6,Ze=null}function Ob(i,s,d,v,y,S,T,I,G){i.cancelPendingCommit=null;do wc();while(bn!==0);if((dt&6)!==0)throw Error(r(327));if(s!==null){if(s===i.current)throw Error(r(177));if(S=s.lanes|s.childLanes,S|=Xd,Nl(i,d,S,T,I,G),i===St&&(Ze=St=null,at=0),$i=s,so=i,Zi=d,Zh=S,Jh=y,Eb=v,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,AR(Qt,function(){return Lb(),null})):(i.callbackNode=null,i.callbackPriority=0),v=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||v){v=L.T,L.T=null,y=W.p,W.p=2,T=dt,dt|=4;try{mR(i,s,d)}finally{dt=T,W.p=y,L.T=v}}bn=1,Ib(),Bb(),Fb()}}function Ib(){if(bn===1){bn=0;var i=so,s=$i,d=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||d){d=L.T,L.T=null;var v=W.p;W.p=2;var y=dt;dt|=4;try{mb(s,i);var S=vp,T=S0(i.containerInfo),I=S.focusedElem,G=S.selectionRange;if(T!==I&&I&&I.ownerDocument&&w0(I.ownerDocument.documentElement,I)){if(G!==null&&Hd(I)){var ae=G.start,he=G.end;if(he===void 0&&(he=ae),"selectionStart"in I)I.selectionStart=ae,I.selectionEnd=Math.min(he,I.value.length);else{var me=I.ownerDocument||document,oe=me&&me.defaultView||window;if(oe.getSelection){var ie=oe.getSelection(),Ue=I.textContent.length,Pe=Math.min(G.start,Ue),gt=G.end===void 0?Pe:Math.min(G.end,Ue);!ie.extend&&Pe>gt&&(T=gt,gt=Pe,Pe=T);var te=x0(I,Pe),Y=x0(I,gt);if(te&&Y&&(ie.rangeCount!==1||ie.anchorNode!==te.node||ie.anchorOffset!==te.offset||ie.focusNode!==Y.node||ie.focusOffset!==Y.offset)){var re=me.createRange();re.setStart(te.node,te.offset),ie.removeAllRanges(),Pe>gt?(ie.addRange(re),ie.extend(Y.node,Y.offset)):(re.setEnd(Y.node,Y.offset),ie.addRange(re))}}}}for(me=[],ie=I;ie=ie.parentNode;)ie.nodeType===1&&me.push({element:ie,left:ie.scrollLeft,top:ie.scrollTop});for(typeof I.focus=="function"&&I.focus(),I=0;I<me.length;I++){var ve=me[I];ve.element.scrollLeft=ve.left,ve.element.scrollTop=ve.top}}Oc=!!pp,vp=pp=null}finally{dt=y,W.p=v,L.T=d}}i.current=s,bn=2}}function Bb(){if(bn===2){bn=0;var i=so,s=$i,d=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||d){d=L.T,L.T=null;var v=W.p;W.p=2;var y=dt;dt|=4;try{db(i,s.alternate,s)}finally{dt=y,W.p=v,L.T=d}}bn=3}}function Fb(){if(bn===4||bn===3){bn=0,rt();var i=so,s=$i,d=Zi,v=Eb;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?bn=5:(bn=0,$i=so=null,Pb(i,i.pendingLanes));var y=i.pendingLanes;if(y===0&&(io=null),gn(d),s=s.stateNode,Rt&&typeof Rt.onCommitFiberRoot=="function")try{Rt.onCommitFiberRoot(_n,s,void 0,(s.current.flags&128)===128)}catch{}if(v!==null){s=L.T,y=W.p,W.p=2,L.T=null;try{for(var S=i.onRecoverableError,T=0;T<v.length;T++){var I=v[T];S(I.value,{componentStack:I.stack})}}finally{L.T=s,W.p=y}}(Zi&3)!==0&&wc(),Yr(i),y=i.pendingLanes,(d&4194090)!==0&&(y&42)!==0?i===ep?Tu++:(Tu=0,ep=i):Tu=0,Nu(0)}}function Pb(i,s){(i.pooledCacheLanes&=s)===0&&(s=i.pooledCache,s!=null&&(i.pooledCache=null,uu(s)))}function wc(i){return Ib(),Bb(),Fb(),Lb()}function Lb(){if(bn!==5)return!1;var i=so,s=Zh;Zh=0;var d=gn(Zi),v=L.T,y=W.p;try{W.p=32>d?32:d,L.T=null,d=Jh,Jh=null;var S=so,T=Zi;if(bn=0,$i=so=null,Zi=0,(dt&6)!==0)throw Error(r(331));var I=dt;if(dt|=4,wb(S.current),yb(S,S.current,T,d),dt=I,Nu(0,!1),Rt&&typeof Rt.onPostCommitFiberRoot=="function")try{Rt.onPostCommitFiberRoot(_n,S)}catch{}return!0}finally{W.p=y,L.T=v,Pb(i,s)}}function zb(i,s,d){s=gr(d,s),s=Mh(i.stateNode,s,2),i=$a(i,s,2),i!==null&&(qa(i,2),Yr(i))}function yt(i,s,d){if(i.tag===3)zb(i,i,d);else for(;s!==null;){if(s.tag===3){zb(s,i,d);break}else if(s.tag===1){var v=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof v.componentDidCatch=="function"&&(io===null||!io.has(v))){i=gr(d,i),d=Vy(2),v=$a(s,d,2),v!==null&&(Wy(d,v,s,i),qa(v,2),Yr(v));break}}s=s.return}}function ap(i,s,d){var v=i.pingCache;if(v===null){v=i.pingCache=new bR;var y=new Set;v.set(s,y)}else y=v.get(s),y===void 0&&(y=new Set,v.set(s,y));y.has(d)||(Yh=!0,y.add(d),i=CR.bind(null,i,s,d),s.then(i,i))}function CR(i,s,d){var v=i.pingCache;v!==null&&v.delete(s),i.pingedLanes|=i.suspendedLanes&d,i.warmLanes&=~d,St===i&&(at&d)===d&&(Ft===4||Ft===3&&(at&62914560)===at&&300>st()-$h?(dt&2)===0&&Ji(i,0):Kh|=d,Qi===at&&(Qi=0)),Yr(i)}function Ub(i,s){s===0&&(s=Tl()),i=Bi(i,s),i!==null&&(qa(i,s),Yr(i))}function _R(i){var s=i.memoizedState,d=0;s!==null&&(d=s.retryLane),Ub(i,d)}function RR(i,s){var d=0;switch(i.tag){case 13:var v=i.stateNode,y=i.memoizedState;y!==null&&(d=y.retryLane);break;case 19:v=i.stateNode;break;case 22:v=i.stateNode._retryCache;break;default:throw Error(r(314))}v!==null&&v.delete(s),Ub(i,d)}function AR(i,s){return Fe(i,s)}var Sc=null,ts=null,op=!1,Ec=!1,ip=!1,ei=0;function Yr(i){i!==ts&&i.next===null&&(ts===null?Sc=ts=i:ts=ts.next=i),Ec=!0,op||(op=!0,NR())}function Nu(i,s){if(!ip&&Ec){ip=!0;do for(var d=!1,v=Sc;v!==null;){if(i!==0){var y=v.pendingLanes;if(y===0)var S=0;else{var T=v.suspendedLanes,I=v.pingedLanes;S=(1<<31-Nt(42|i)+1)-1,S&=y&~(T&~I),S=S&201326741?S&201326741|1:S?S|2:0}S!==0&&(d=!0,Wb(v,S))}else S=at,S=Bo(v,v===St?S:0,v.cancelPendingCommit!==null||v.timeoutHandle!==-1),(S&3)===0||Fo(v,S)||(d=!0,Wb(v,S));v=v.next}while(d);ip=!1}}function TR(){jb()}function jb(){Ec=op=!1;var i=0;ei!==0&&(PR()&&(i=ei),ei=0);for(var s=st(),d=null,v=Sc;v!==null;){var y=v.next,S=Hb(v,s);S===0?(v.next=null,d===null?Sc=y:d.next=y,y===null&&(ts=d)):(d=v,(i!==0||(S&3)!==0)&&(Ec=!0)),v=y}Nu(i)}function Hb(i,s){for(var d=i.suspendedLanes,v=i.pingedLanes,y=i.expirationTimes,S=i.pendingLanes&-62914561;0<S;){var T=31-Nt(S),I=1<<T,G=y[T];G===-1?((I&d)===0||(I&v)!==0)&&(y[T]=Gs(I,s)):G<=s&&(i.expiredLanes|=I),S&=~I}if(s=St,d=at,d=Bo(i,i===s?d:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),v=i.callbackNode,d===0||i===s&&(ht===2||ht===9)||i.cancelPendingCommit!==null)return v!==null&&v!==null&&Xe(v),i.callbackNode=null,i.callbackPriority=0;if((d&3)===0||Fo(i,d)){if(s=d&-d,s===i.callbackPriority)return s;switch(v!==null&&Xe(v),gn(d)){case 2:case 8:d=Qn;break;case 32:d=Qt;break;case 268435456:d=Lt;break;default:d=Qt}return v=Vb.bind(null,i),d=Fe(d,v),i.callbackPriority=s,i.callbackNode=d,s}return v!==null&&v!==null&&Xe(v),i.callbackPriority=2,i.callbackNode=null,2}function Vb(i,s){if(bn!==0&&bn!==5)return i.callbackNode=null,i.callbackPriority=0,null;var d=i.callbackNode;if(wc()&&i.callbackNode!==d)return null;var v=at;return v=Bo(i,i===St?v:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),v===0?null:(_b(i,v,s),Hb(i,st()),i.callbackNode!=null&&i.callbackNode===d?Vb.bind(null,i):null)}function Wb(i,s){if(wc())return null;_b(i,s,!0)}function NR(){zR(function(){(dt&6)!==0?Fe(pt,TR):jb()})}function sp(){return ei===0&&(ei=Nr()),ei}function Gb(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:Il(""+i)}function qb(i,s){var d=s.ownerDocument.createElement("input");return d.name=s.name,d.value=s.value,i.id&&d.setAttribute("form",i.id),s.parentNode.insertBefore(d,s),i=new FormData(i),d.parentNode.removeChild(d),i}function DR(i,s,d,v,y){if(s==="submit"&&d&&d.stateNode===y){var S=Gb((y[wt]||null).action),T=v.submitter;T&&(s=(s=T[wt]||null)?Gb(s.formAction):T.getAttribute("formAction"),s!==null&&(S=s,T=null));var I=new Ll("action","action",null,v,y);i.push({event:I,listeners:[{instance:null,listener:function(){if(v.defaultPrevented){if(ei!==0){var G=T?qb(y,T):new FormData(y);Ah(d,{pending:!0,data:G,method:y.method,action:S},null,G)}}else typeof S=="function"&&(I.preventDefault(),G=T?qb(y,T):new FormData(y),Ah(d,{pending:!0,data:G,method:y.method,action:S},S,G))},currentTarget:y}]})}}for(var up=0;up<qd.length;up++){var lp=qd[up],kR=lp.toLowerCase(),MR=lp[0].toUpperCase()+lp.slice(1);Dr(kR,"on"+MR)}Dr(_0,"onAnimationEnd"),Dr(R0,"onAnimationIteration"),Dr(A0,"onAnimationStart"),Dr("dblclick","onDoubleClick"),Dr("focusin","onFocus"),Dr("focusout","onBlur"),Dr(K_,"onTransitionRun"),Dr(Q_,"onTransitionStart"),Dr($_,"onTransitionCancel"),Dr(T0,"onTransitionEnd"),_i("onMouseEnter",["mouseout","mouseover"]),_i("onMouseLeave",["mouseout","mouseover"]),_i("onPointerEnter",["pointerout","pointerover"]),_i("onPointerLeave",["pointerout","pointerover"]),Lo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Lo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Lo("onBeforeInput",["compositionend","keypress","textInput","paste"]),Lo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Lo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Lo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Du="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),OR=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Du));function Xb(i,s){s=(s&4)!==0;for(var d=0;d<i.length;d++){var v=i[d],y=v.event;v=v.listeners;e:{var S=void 0;if(s)for(var T=v.length-1;0<=T;T--){var I=v[T],G=I.instance,ae=I.currentTarget;if(I=I.listener,G!==S&&y.isPropagationStopped())break e;S=I,y.currentTarget=ae;try{S(y)}catch(he){cc(he)}y.currentTarget=null,S=G}else for(T=0;T<v.length;T++){if(I=v[T],G=I.instance,ae=I.currentTarget,I=I.listener,G!==S&&y.isPropagationStopped())break e;S=I,y.currentTarget=ae;try{S(y)}catch(he){cc(he)}y.currentTarget=null,S=G}}}}function Je(i,s){var d=s[wi];d===void 0&&(d=s[wi]=new Set);var v=i+"__bubble";d.has(v)||(Yb(s,i,2,!1),d.add(v))}function cp(i,s,d){var v=0;s&&(v|=4),Yb(d,i,v,s)}var Cc="_reactListening"+Math.random().toString(36).slice(2);function fp(i){if(!i[Cc]){i[Cc]=!0,jg.forEach(function(d){d!=="selectionchange"&&(OR.has(d)||cp(d,!1,i),cp(d,!0,i))});var s=i.nodeType===9?i:i.ownerDocument;s===null||s[Cc]||(s[Cc]=!0,cp("selectionchange",!1,s))}}function Yb(i,s,d,v){switch(yx(s)){case 2:var y=iA;break;case 8:y=sA;break;default:y=_p}d=y.bind(null,s,d,i),y=void 0,!Od||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(y=!0),v?y!==void 0?i.addEventListener(s,d,{capture:!0,passive:y}):i.addEventListener(s,d,!0):y!==void 0?i.addEventListener(s,d,{passive:y}):i.addEventListener(s,d,!1)}function dp(i,s,d,v,y){var S=v;if((s&1)===0&&(s&2)===0&&v!==null)e:for(;;){if(v===null)return;var T=v.tag;if(T===3||T===4){var I=v.stateNode.containerInfo;if(I===y)break;if(T===4)for(T=v.return;T!==null;){var G=T.tag;if((G===3||G===4)&&T.stateNode.containerInfo===y)return;T=T.return}for(;I!==null;){if(T=Si(I),T===null)return;if(G=T.tag,G===5||G===6||G===26||G===27){v=S=T;continue e}I=I.parentNode}}v=v.return}t0(function(){var ae=S,he=kd(d),me=[];e:{var oe=N0.get(i);if(oe!==void 0){var ie=Ll,Ue=i;switch(i){case"keypress":if(Fl(d)===0)break e;case"keydown":case"keyup":ie=A_;break;case"focusin":Ue="focus",ie=Pd;break;case"focusout":Ue="blur",ie=Pd;break;case"beforeblur":case"afterblur":ie=Pd;break;case"click":if(d.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ie=a0;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ie=v_;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ie=D_;break;case _0:case R0:case A0:ie=y_;break;case T0:ie=M_;break;case"scroll":case"scrollend":ie=h_;break;case"wheel":ie=I_;break;case"copy":case"cut":case"paste":ie=x_;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ie=i0;break;case"toggle":case"beforetoggle":ie=F_}var Pe=(s&4)!==0,gt=!Pe&&(i==="scroll"||i==="scrollend"),te=Pe?oe!==null?oe+"Capture":null:oe;Pe=[];for(var Y=ae,re;Y!==null;){var ve=Y;if(re=ve.stateNode,ve=ve.tag,ve!==5&&ve!==26&&ve!==27||re===null||te===null||(ve=Ks(Y,te),ve!=null&&Pe.push(ku(Y,ve,re))),gt)break;Y=Y.return}0<Pe.length&&(oe=new ie(oe,Ue,null,d,he),me.push({event:oe,listeners:Pe}))}}if((s&7)===0){e:{if(oe=i==="mouseover"||i==="pointerover",ie=i==="mouseout"||i==="pointerout",oe&&d!==Dd&&(Ue=d.relatedTarget||d.fromElement)&&(Si(Ue)||Ue[un]))break e;if((ie||oe)&&(oe=he.window===he?he:(oe=he.ownerDocument)?oe.defaultView||oe.parentWindow:window,ie?(Ue=d.relatedTarget||d.toElement,ie=ae,Ue=Ue?Si(Ue):null,Ue!==null&&(gt=o(Ue),Pe=Ue.tag,Ue!==gt||Pe!==5&&Pe!==27&&Pe!==6)&&(Ue=null)):(ie=null,Ue=ae),ie!==Ue)){if(Pe=a0,ve="onMouseLeave",te="onMouseEnter",Y="mouse",(i==="pointerout"||i==="pointerover")&&(Pe=i0,ve="onPointerLeave",te="onPointerEnter",Y="pointer"),gt=ie==null?oe:Ys(ie),re=Ue==null?oe:Ys(Ue),oe=new Pe(ve,Y+"leave",ie,d,he),oe.target=gt,oe.relatedTarget=re,ve=null,Si(he)===ae&&(Pe=new Pe(te,Y+"enter",Ue,d,he),Pe.target=re,Pe.relatedTarget=gt,ve=Pe),gt=ve,ie&&Ue)t:{for(Pe=ie,te=Ue,Y=0,re=Pe;re;re=ns(re))Y++;for(re=0,ve=te;ve;ve=ns(ve))re++;for(;0<Y-re;)Pe=ns(Pe),Y--;for(;0<re-Y;)te=ns(te),re--;for(;Y--;){if(Pe===te||te!==null&&Pe===te.alternate)break t;Pe=ns(Pe),te=ns(te)}Pe=null}else Pe=null;ie!==null&&Kb(me,oe,ie,Pe,!1),Ue!==null&&gt!==null&&Kb(me,gt,Ue,Pe,!0)}}e:{if(oe=ae?Ys(ae):window,ie=oe.nodeName&&oe.nodeName.toLowerCase(),ie==="select"||ie==="input"&&oe.type==="file")var _e=p0;else if(d0(oe))if(v0)_e=q_;else{_e=W_;var Qe=V_}else ie=oe.nodeName,!ie||ie.toLowerCase()!=="input"||oe.type!=="checkbox"&&oe.type!=="radio"?ae&&Nd(ae.elementType)&&(_e=p0):_e=G_;if(_e&&(_e=_e(i,ae))){h0(me,_e,d,he);break e}Qe&&Qe(i,oe,ae),i==="focusout"&&ae&&oe.type==="number"&&ae.memoizedProps.value!=null&&Td(oe,"number",oe.value)}switch(Qe=ae?Ys(ae):window,i){case"focusin":(d0(Qe)||Qe.contentEditable==="true")&&(Mi=Qe,Vd=ae,ru=null);break;case"focusout":ru=Vd=Mi=null;break;case"mousedown":Wd=!0;break;case"contextmenu":case"mouseup":case"dragend":Wd=!1,E0(me,d,he);break;case"selectionchange":if(Y_)break;case"keydown":case"keyup":E0(me,d,he)}var Be;if(zd)e:{switch(i){case"compositionstart":var Le="onCompositionStart";break e;case"compositionend":Le="onCompositionEnd";break e;case"compositionupdate":Le="onCompositionUpdate";break e}Le=void 0}else ki?c0(i,d)&&(Le="onCompositionEnd"):i==="keydown"&&d.keyCode===229&&(Le="onCompositionStart");Le&&(s0&&d.locale!=="ko"&&(ki||Le!=="onCompositionStart"?Le==="onCompositionEnd"&&ki&&(Be=n0()):(Xa=he,Id="value"in Xa?Xa.value:Xa.textContent,ki=!0)),Qe=_c(ae,Le),0<Qe.length&&(Le=new o0(Le,i,null,d,he),me.push({event:Le,listeners:Qe}),Be?Le.data=Be:(Be=f0(d),Be!==null&&(Le.data=Be)))),(Be=L_?z_(i,d):U_(i,d))&&(Le=_c(ae,"onBeforeInput"),0<Le.length&&(Qe=new o0("onBeforeInput","beforeinput",null,d,he),me.push({event:Qe,listeners:Le}),Qe.data=Be)),DR(me,i,ae,d,he)}Xb(me,s)})}function ku(i,s,d){return{instance:i,listener:s,currentTarget:d}}function _c(i,s){for(var d=s+"Capture",v=[];i!==null;){var y=i,S=y.stateNode;if(y=y.tag,y!==5&&y!==26&&y!==27||S===null||(y=Ks(i,d),y!=null&&v.unshift(ku(i,y,S)),y=Ks(i,s),y!=null&&v.push(ku(i,y,S))),i.tag===3)return v;i=i.return}return[]}function ns(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function Kb(i,s,d,v,y){for(var S=s._reactName,T=[];d!==null&&d!==v;){var I=d,G=I.alternate,ae=I.stateNode;if(I=I.tag,G!==null&&G===v)break;I!==5&&I!==26&&I!==27||ae===null||(G=ae,y?(ae=Ks(d,S),ae!=null&&T.unshift(ku(d,ae,G))):y||(ae=Ks(d,S),ae!=null&&T.push(ku(d,ae,G)))),d=d.return}T.length!==0&&i.push({event:s,listeners:T})}var IR=/\r\n?/g,BR=/\u0000|\uFFFD/g;function Qb(i){return(typeof i=="string"?i:""+i).replace(IR,`
`).replace(BR,"")}function $b(i,s){return s=Qb(s),Qb(i)===s}function Rc(){}function mt(i,s,d,v,y,S){switch(d){case"children":typeof v=="string"?s==="body"||s==="textarea"&&v===""||Ti(i,v):(typeof v=="number"||typeof v=="bigint")&&s!=="body"&&Ti(i,""+v);break;case"className":kl(i,"class",v);break;case"tabIndex":kl(i,"tabindex",v);break;case"dir":case"role":case"viewBox":case"width":case"height":kl(i,d,v);break;case"style":Jg(i,v,S);break;case"data":if(s!=="object"){kl(i,"data",v);break}case"src":case"href":if(v===""&&(s!=="a"||d!=="href")){i.removeAttribute(d);break}if(v==null||typeof v=="function"||typeof v=="symbol"||typeof v=="boolean"){i.removeAttribute(d);break}v=Il(""+v),i.setAttribute(d,v);break;case"action":case"formAction":if(typeof v=="function"){i.setAttribute(d,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof S=="function"&&(d==="formAction"?(s!=="input"&&mt(i,s,"name",y.name,y,null),mt(i,s,"formEncType",y.formEncType,y,null),mt(i,s,"formMethod",y.formMethod,y,null),mt(i,s,"formTarget",y.formTarget,y,null)):(mt(i,s,"encType",y.encType,y,null),mt(i,s,"method",y.method,y,null),mt(i,s,"target",y.target,y,null)));if(v==null||typeof v=="symbol"||typeof v=="boolean"){i.removeAttribute(d);break}v=Il(""+v),i.setAttribute(d,v);break;case"onClick":v!=null&&(i.onclick=Rc);break;case"onScroll":v!=null&&Je("scroll",i);break;case"onScrollEnd":v!=null&&Je("scrollend",i);break;case"dangerouslySetInnerHTML":if(v!=null){if(typeof v!="object"||!("__html"in v))throw Error(r(61));if(d=v.__html,d!=null){if(y.children!=null)throw Error(r(60));i.innerHTML=d}}break;case"multiple":i.multiple=v&&typeof v!="function"&&typeof v!="symbol";break;case"muted":i.muted=v&&typeof v!="function"&&typeof v!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(v==null||typeof v=="function"||typeof v=="boolean"||typeof v=="symbol"){i.removeAttribute("xlink:href");break}d=Il(""+v),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",d);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":v!=null&&typeof v!="function"&&typeof v!="symbol"?i.setAttribute(d,""+v):i.removeAttribute(d);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":v&&typeof v!="function"&&typeof v!="symbol"?i.setAttribute(d,""):i.removeAttribute(d);break;case"capture":case"download":v===!0?i.setAttribute(d,""):v!==!1&&v!=null&&typeof v!="function"&&typeof v!="symbol"?i.setAttribute(d,v):i.removeAttribute(d);break;case"cols":case"rows":case"size":case"span":v!=null&&typeof v!="function"&&typeof v!="symbol"&&!isNaN(v)&&1<=v?i.setAttribute(d,v):i.removeAttribute(d);break;case"rowSpan":case"start":v==null||typeof v=="function"||typeof v=="symbol"||isNaN(v)?i.removeAttribute(d):i.setAttribute(d,v);break;case"popover":Je("beforetoggle",i),Je("toggle",i),Dl(i,"popover",v);break;case"xlinkActuate":ya(i,"http://www.w3.org/1999/xlink","xlink:actuate",v);break;case"xlinkArcrole":ya(i,"http://www.w3.org/1999/xlink","xlink:arcrole",v);break;case"xlinkRole":ya(i,"http://www.w3.org/1999/xlink","xlink:role",v);break;case"xlinkShow":ya(i,"http://www.w3.org/1999/xlink","xlink:show",v);break;case"xlinkTitle":ya(i,"http://www.w3.org/1999/xlink","xlink:title",v);break;case"xlinkType":ya(i,"http://www.w3.org/1999/xlink","xlink:type",v);break;case"xmlBase":ya(i,"http://www.w3.org/XML/1998/namespace","xml:base",v);break;case"xmlLang":ya(i,"http://www.w3.org/XML/1998/namespace","xml:lang",v);break;case"xmlSpace":ya(i,"http://www.w3.org/XML/1998/namespace","xml:space",v);break;case"is":Dl(i,"is",v);break;case"innerText":case"textContent":break;default:(!(2<d.length)||d[0]!=="o"&&d[0]!=="O"||d[1]!=="n"&&d[1]!=="N")&&(d=f_.get(d)||d,Dl(i,d,v))}}function hp(i,s,d,v,y,S){switch(d){case"style":Jg(i,v,S);break;case"dangerouslySetInnerHTML":if(v!=null){if(typeof v!="object"||!("__html"in v))throw Error(r(61));if(d=v.__html,d!=null){if(y.children!=null)throw Error(r(60));i.innerHTML=d}}break;case"children":typeof v=="string"?Ti(i,v):(typeof v=="number"||typeof v=="bigint")&&Ti(i,""+v);break;case"onScroll":v!=null&&Je("scroll",i);break;case"onScrollEnd":v!=null&&Je("scrollend",i);break;case"onClick":v!=null&&(i.onclick=Rc);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Hg.hasOwnProperty(d))e:{if(d[0]==="o"&&d[1]==="n"&&(y=d.endsWith("Capture"),s=d.slice(2,y?d.length-7:void 0),S=i[wt]||null,S=S!=null?S[d]:null,typeof S=="function"&&i.removeEventListener(s,S,y),typeof v=="function")){typeof S!="function"&&S!==null&&(d in i?i[d]=null:i.hasAttribute(d)&&i.removeAttribute(d)),i.addEventListener(s,v,y);break e}d in i?i[d]=v:v===!0?i.setAttribute(d,""):Dl(i,d,v)}}}function xn(i,s,d){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Je("error",i),Je("load",i);var v=!1,y=!1,S;for(S in d)if(d.hasOwnProperty(S)){var T=d[S];if(T!=null)switch(S){case"src":v=!0;break;case"srcSet":y=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,s));default:mt(i,s,S,T,d,null)}}y&&mt(i,s,"srcSet",d.srcSet,d,null),v&&mt(i,s,"src",d.src,d,null);return;case"input":Je("invalid",i);var I=S=T=y=null,G=null,ae=null;for(v in d)if(d.hasOwnProperty(v)){var he=d[v];if(he!=null)switch(v){case"name":y=he;break;case"type":T=he;break;case"checked":G=he;break;case"defaultChecked":ae=he;break;case"value":S=he;break;case"defaultValue":I=he;break;case"children":case"dangerouslySetInnerHTML":if(he!=null)throw Error(r(137,s));break;default:mt(i,s,v,he,d,null)}}Kg(i,S,I,G,ae,T,y,!1),Ml(i);return;case"select":Je("invalid",i),v=T=S=null;for(y in d)if(d.hasOwnProperty(y)&&(I=d[y],I!=null))switch(y){case"value":S=I;break;case"defaultValue":T=I;break;case"multiple":v=I;default:mt(i,s,y,I,d,null)}s=S,d=T,i.multiple=!!v,s!=null?Ai(i,!!v,s,!1):d!=null&&Ai(i,!!v,d,!0);return;case"textarea":Je("invalid",i),S=y=v=null;for(T in d)if(d.hasOwnProperty(T)&&(I=d[T],I!=null))switch(T){case"value":v=I;break;case"defaultValue":y=I;break;case"children":S=I;break;case"dangerouslySetInnerHTML":if(I!=null)throw Error(r(91));break;default:mt(i,s,T,I,d,null)}$g(i,v,y,S),Ml(i);return;case"option":for(G in d)if(d.hasOwnProperty(G)&&(v=d[G],v!=null))switch(G){case"selected":i.selected=v&&typeof v!="function"&&typeof v!="symbol";break;default:mt(i,s,G,v,d,null)}return;case"dialog":Je("beforetoggle",i),Je("toggle",i),Je("cancel",i),Je("close",i);break;case"iframe":case"object":Je("load",i);break;case"video":case"audio":for(v=0;v<Du.length;v++)Je(Du[v],i);break;case"image":Je("error",i),Je("load",i);break;case"details":Je("toggle",i);break;case"embed":case"source":case"link":Je("error",i),Je("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ae in d)if(d.hasOwnProperty(ae)&&(v=d[ae],v!=null))switch(ae){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,s));default:mt(i,s,ae,v,d,null)}return;default:if(Nd(s)){for(he in d)d.hasOwnProperty(he)&&(v=d[he],v!==void 0&&hp(i,s,he,v,d,void 0));return}}for(I in d)d.hasOwnProperty(I)&&(v=d[I],v!=null&&mt(i,s,I,v,d,null))}function FR(i,s,d,v){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var y=null,S=null,T=null,I=null,G=null,ae=null,he=null;for(ie in d){var me=d[ie];if(d.hasOwnProperty(ie)&&me!=null)switch(ie){case"checked":break;case"value":break;case"defaultValue":G=me;default:v.hasOwnProperty(ie)||mt(i,s,ie,null,v,me)}}for(var oe in v){var ie=v[oe];if(me=d[oe],v.hasOwnProperty(oe)&&(ie!=null||me!=null))switch(oe){case"type":S=ie;break;case"name":y=ie;break;case"checked":ae=ie;break;case"defaultChecked":he=ie;break;case"value":T=ie;break;case"defaultValue":I=ie;break;case"children":case"dangerouslySetInnerHTML":if(ie!=null)throw Error(r(137,s));break;default:ie!==me&&mt(i,s,oe,ie,v,me)}}Ad(i,T,I,G,ae,he,S,y);return;case"select":ie=T=I=oe=null;for(S in d)if(G=d[S],d.hasOwnProperty(S)&&G!=null)switch(S){case"value":break;case"multiple":ie=G;default:v.hasOwnProperty(S)||mt(i,s,S,null,v,G)}for(y in v)if(S=v[y],G=d[y],v.hasOwnProperty(y)&&(S!=null||G!=null))switch(y){case"value":oe=S;break;case"defaultValue":I=S;break;case"multiple":T=S;default:S!==G&&mt(i,s,y,S,v,G)}s=I,d=T,v=ie,oe!=null?Ai(i,!!d,oe,!1):!!v!=!!d&&(s!=null?Ai(i,!!d,s,!0):Ai(i,!!d,d?[]:"",!1));return;case"textarea":ie=oe=null;for(I in d)if(y=d[I],d.hasOwnProperty(I)&&y!=null&&!v.hasOwnProperty(I))switch(I){case"value":break;case"children":break;default:mt(i,s,I,null,v,y)}for(T in v)if(y=v[T],S=d[T],v.hasOwnProperty(T)&&(y!=null||S!=null))switch(T){case"value":oe=y;break;case"defaultValue":ie=y;break;case"children":break;case"dangerouslySetInnerHTML":if(y!=null)throw Error(r(91));break;default:y!==S&&mt(i,s,T,y,v,S)}Qg(i,oe,ie);return;case"option":for(var Ue in d)if(oe=d[Ue],d.hasOwnProperty(Ue)&&oe!=null&&!v.hasOwnProperty(Ue))switch(Ue){case"selected":i.selected=!1;break;default:mt(i,s,Ue,null,v,oe)}for(G in v)if(oe=v[G],ie=d[G],v.hasOwnProperty(G)&&oe!==ie&&(oe!=null||ie!=null))switch(G){case"selected":i.selected=oe&&typeof oe!="function"&&typeof oe!="symbol";break;default:mt(i,s,G,oe,v,ie)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Pe in d)oe=d[Pe],d.hasOwnProperty(Pe)&&oe!=null&&!v.hasOwnProperty(Pe)&&mt(i,s,Pe,null,v,oe);for(ae in v)if(oe=v[ae],ie=d[ae],v.hasOwnProperty(ae)&&oe!==ie&&(oe!=null||ie!=null))switch(ae){case"children":case"dangerouslySetInnerHTML":if(oe!=null)throw Error(r(137,s));break;default:mt(i,s,ae,oe,v,ie)}return;default:if(Nd(s)){for(var gt in d)oe=d[gt],d.hasOwnProperty(gt)&&oe!==void 0&&!v.hasOwnProperty(gt)&&hp(i,s,gt,void 0,v,oe);for(he in v)oe=v[he],ie=d[he],!v.hasOwnProperty(he)||oe===ie||oe===void 0&&ie===void 0||hp(i,s,he,oe,v,ie);return}}for(var te in d)oe=d[te],d.hasOwnProperty(te)&&oe!=null&&!v.hasOwnProperty(te)&&mt(i,s,te,null,v,oe);for(me in v)oe=v[me],ie=d[me],!v.hasOwnProperty(me)||oe===ie||oe==null&&ie==null||mt(i,s,me,oe,v,ie)}var pp=null,vp=null;function Ac(i){return i.nodeType===9?i:i.ownerDocument}function Zb(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Jb(i,s){if(i===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&s==="foreignObject"?0:i}function mp(i,s){return i==="textarea"||i==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var gp=null;function PR(){var i=window.event;return i&&i.type==="popstate"?i===gp?!1:(gp=i,!0):(gp=null,!1)}var ex=typeof setTimeout=="function"?setTimeout:void 0,LR=typeof clearTimeout=="function"?clearTimeout:void 0,tx=typeof Promise=="function"?Promise:void 0,zR=typeof queueMicrotask=="function"?queueMicrotask:typeof tx<"u"?function(i){return tx.resolve(null).then(i).catch(UR)}:ex;function UR(i){setTimeout(function(){throw i})}function lo(i){return i==="head"}function nx(i,s){var d=s,v=0,y=0;do{var S=d.nextSibling;if(i.removeChild(d),S&&S.nodeType===8)if(d=S.data,d==="/$"){if(0<v&&8>v){d=v;var T=i.ownerDocument;if(d&1&&Mu(T.documentElement),d&2&&Mu(T.body),d&4)for(d=T.head,Mu(d),T=d.firstChild;T;){var I=T.nextSibling,G=T.nodeName;T[Xs]||G==="SCRIPT"||G==="STYLE"||G==="LINK"&&T.rel.toLowerCase()==="stylesheet"||d.removeChild(T),T=I}}if(y===0){i.removeChild(S),Uu(s);return}y--}else d==="$"||d==="$?"||d==="$!"?y++:v=d.charCodeAt(0)-48;else v=0;d=S}while(d);Uu(s)}function yp(i){var s=i.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var d=s;switch(s=s.nextSibling,d.nodeName){case"HTML":case"HEAD":case"BODY":yp(d),Ed(d);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(d.rel.toLowerCase()==="stylesheet")continue}i.removeChild(d)}}function jR(i,s,d,v){for(;i.nodeType===1;){var y=d;if(i.nodeName.toLowerCase()!==s.toLowerCase()){if(!v&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(v){if(!i[Xs])switch(s){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(S=i.getAttribute("rel"),S==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(S!==y.rel||i.getAttribute("href")!==(y.href==null||y.href===""?null:y.href)||i.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin)||i.getAttribute("title")!==(y.title==null?null:y.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(S=i.getAttribute("src"),(S!==(y.src==null?null:y.src)||i.getAttribute("type")!==(y.type==null?null:y.type)||i.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin))&&S&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(s==="input"&&i.type==="hidden"){var S=y.name==null?null:""+y.name;if(y.type==="hidden"&&i.getAttribute("name")===S)return i}else return i;if(i=Mr(i.nextSibling),i===null)break}return null}function HR(i,s,d){if(s==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!d||(i=Mr(i.nextSibling),i===null))return null;return i}function bp(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState==="complete"}function VR(i,s){var d=i.ownerDocument;if(i.data!=="$?"||d.readyState==="complete")s();else{var v=function(){s(),d.removeEventListener("DOMContentLoaded",v)};d.addEventListener("DOMContentLoaded",v),i._reactRetry=v}}function Mr(i){for(;i!=null;i=i.nextSibling){var s=i.nodeType;if(s===1||s===3)break;if(s===8){if(s=i.data,s==="$"||s==="$!"||s==="$?"||s==="F!"||s==="F")break;if(s==="/$")return null}}return i}var xp=null;function rx(i){i=i.previousSibling;for(var s=0;i;){if(i.nodeType===8){var d=i.data;if(d==="$"||d==="$!"||d==="$?"){if(s===0)return i;s--}else d==="/$"&&s++}i=i.previousSibling}return null}function ax(i,s,d){switch(s=Ac(d),i){case"html":if(i=s.documentElement,!i)throw Error(r(452));return i;case"head":if(i=s.head,!i)throw Error(r(453));return i;case"body":if(i=s.body,!i)throw Error(r(454));return i;default:throw Error(r(451))}}function Mu(i){for(var s=i.attributes;s.length;)i.removeAttributeNode(s[0]);Ed(i)}var Er=new Map,ox=new Set;function Tc(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var Ma=W.d;W.d={f:WR,r:GR,D:qR,C:XR,L:YR,m:KR,X:$R,S:QR,M:ZR};function WR(){var i=Ma.f(),s=bc();return i||s}function GR(i){var s=Ei(i);s!==null&&s.tag===5&&s.type==="form"?_y(s):Ma.r(i)}var rs=typeof document>"u"?null:document;function ix(i,s,d){var v=rs;if(v&&typeof s=="string"&&s){var y=mr(s);y='link[rel="'+i+'"][href="'+y+'"]',typeof d=="string"&&(y+='[crossorigin="'+d+'"]'),ox.has(y)||(ox.add(y),i={rel:i,crossOrigin:d,href:s},v.querySelector(y)===null&&(s=v.createElement("link"),xn(s,"link",i),ln(s),v.head.appendChild(s)))}}function qR(i){Ma.D(i),ix("dns-prefetch",i,null)}function XR(i,s){Ma.C(i,s),ix("preconnect",i,s)}function YR(i,s,d){Ma.L(i,s,d);var v=rs;if(v&&i&&s){var y='link[rel="preload"][as="'+mr(s)+'"]';s==="image"&&d&&d.imageSrcSet?(y+='[imagesrcset="'+mr(d.imageSrcSet)+'"]',typeof d.imageSizes=="string"&&(y+='[imagesizes="'+mr(d.imageSizes)+'"]')):y+='[href="'+mr(i)+'"]';var S=y;switch(s){case"style":S=as(i);break;case"script":S=os(i)}Er.has(S)||(i=h({rel:"preload",href:s==="image"&&d&&d.imageSrcSet?void 0:i,as:s},d),Er.set(S,i),v.querySelector(y)!==null||s==="style"&&v.querySelector(Ou(S))||s==="script"&&v.querySelector(Iu(S))||(s=v.createElement("link"),xn(s,"link",i),ln(s),v.head.appendChild(s)))}}function KR(i,s){Ma.m(i,s);var d=rs;if(d&&i){var v=s&&typeof s.as=="string"?s.as:"script",y='link[rel="modulepreload"][as="'+mr(v)+'"][href="'+mr(i)+'"]',S=y;switch(v){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":S=os(i)}if(!Er.has(S)&&(i=h({rel:"modulepreload",href:i},s),Er.set(S,i),d.querySelector(y)===null)){switch(v){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(d.querySelector(Iu(S)))return}v=d.createElement("link"),xn(v,"link",i),ln(v),d.head.appendChild(v)}}}function QR(i,s,d){Ma.S(i,s,d);var v=rs;if(v&&i){var y=Ci(v).hoistableStyles,S=as(i);s=s||"default";var T=y.get(S);if(!T){var I={loading:0,preload:null};if(T=v.querySelector(Ou(S)))I.loading=5;else{i=h({rel:"stylesheet",href:i,"data-precedence":s},d),(d=Er.get(S))&&wp(i,d);var G=T=v.createElement("link");ln(G),xn(G,"link",i),G._p=new Promise(function(ae,he){G.onload=ae,G.onerror=he}),G.addEventListener("load",function(){I.loading|=1}),G.addEventListener("error",function(){I.loading|=2}),I.loading|=4,Nc(T,s,v)}T={type:"stylesheet",instance:T,count:1,state:I},y.set(S,T)}}}function $R(i,s){Ma.X(i,s);var d=rs;if(d&&i){var v=Ci(d).hoistableScripts,y=os(i),S=v.get(y);S||(S=d.querySelector(Iu(y)),S||(i=h({src:i,async:!0},s),(s=Er.get(y))&&Sp(i,s),S=d.createElement("script"),ln(S),xn(S,"link",i),d.head.appendChild(S)),S={type:"script",instance:S,count:1,state:null},v.set(y,S))}}function ZR(i,s){Ma.M(i,s);var d=rs;if(d&&i){var v=Ci(d).hoistableScripts,y=os(i),S=v.get(y);S||(S=d.querySelector(Iu(y)),S||(i=h({src:i,async:!0,type:"module"},s),(s=Er.get(y))&&Sp(i,s),S=d.createElement("script"),ln(S),xn(S,"link",i),d.head.appendChild(S)),S={type:"script",instance:S,count:1,state:null},v.set(y,S))}}function sx(i,s,d,v){var y=(y=pe.current)?Tc(y):null;if(!y)throw Error(r(446));switch(i){case"meta":case"title":return null;case"style":return typeof d.precedence=="string"&&typeof d.href=="string"?(s=as(d.href),d=Ci(y).hoistableStyles,v=d.get(s),v||(v={type:"style",instance:null,count:0,state:null},d.set(s,v)),v):{type:"void",instance:null,count:0,state:null};case"link":if(d.rel==="stylesheet"&&typeof d.href=="string"&&typeof d.precedence=="string"){i=as(d.href);var S=Ci(y).hoistableStyles,T=S.get(i);if(T||(y=y.ownerDocument||y,T={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},S.set(i,T),(S=y.querySelector(Ou(i)))&&!S._p&&(T.instance=S,T.state.loading=5),Er.has(i)||(d={rel:"preload",as:"style",href:d.href,crossOrigin:d.crossOrigin,integrity:d.integrity,media:d.media,hrefLang:d.hrefLang,referrerPolicy:d.referrerPolicy},Er.set(i,d),S||JR(y,i,d,T.state))),s&&v===null)throw Error(r(528,""));return T}if(s&&v!==null)throw Error(r(529,""));return null;case"script":return s=d.async,d=d.src,typeof d=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=os(d),d=Ci(y).hoistableScripts,v=d.get(s),v||(v={type:"script",instance:null,count:0,state:null},d.set(s,v)),v):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,i))}}function as(i){return'href="'+mr(i)+'"'}function Ou(i){return'link[rel="stylesheet"]['+i+"]"}function ux(i){return h({},i,{"data-precedence":i.precedence,precedence:null})}function JR(i,s,d,v){i.querySelector('link[rel="preload"][as="style"]['+s+"]")?v.loading=1:(s=i.createElement("link"),v.preload=s,s.addEventListener("load",function(){return v.loading|=1}),s.addEventListener("error",function(){return v.loading|=2}),xn(s,"link",d),ln(s),i.head.appendChild(s))}function os(i){return'[src="'+mr(i)+'"]'}function Iu(i){return"script[async]"+i}function lx(i,s,d){if(s.count++,s.instance===null)switch(s.type){case"style":var v=i.querySelector('style[data-href~="'+mr(d.href)+'"]');if(v)return s.instance=v,ln(v),v;var y=h({},d,{"data-href":d.href,"data-precedence":d.precedence,href:null,precedence:null});return v=(i.ownerDocument||i).createElement("style"),ln(v),xn(v,"style",y),Nc(v,d.precedence,i),s.instance=v;case"stylesheet":y=as(d.href);var S=i.querySelector(Ou(y));if(S)return s.state.loading|=4,s.instance=S,ln(S),S;v=ux(d),(y=Er.get(y))&&wp(v,y),S=(i.ownerDocument||i).createElement("link"),ln(S);var T=S;return T._p=new Promise(function(I,G){T.onload=I,T.onerror=G}),xn(S,"link",v),s.state.loading|=4,Nc(S,d.precedence,i),s.instance=S;case"script":return S=os(d.src),(y=i.querySelector(Iu(S)))?(s.instance=y,ln(y),y):(v=d,(y=Er.get(S))&&(v=h({},d),Sp(v,y)),i=i.ownerDocument||i,y=i.createElement("script"),ln(y),xn(y,"link",v),i.head.appendChild(y),s.instance=y);case"void":return null;default:throw Error(r(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(v=s.instance,s.state.loading|=4,Nc(v,d.precedence,i));return s.instance}function Nc(i,s,d){for(var v=d.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),y=v.length?v[v.length-1]:null,S=y,T=0;T<v.length;T++){var I=v[T];if(I.dataset.precedence===s)S=I;else if(S!==y)break}S?S.parentNode.insertBefore(i,S.nextSibling):(s=d.nodeType===9?d.head:d,s.insertBefore(i,s.firstChild))}function wp(i,s){i.crossOrigin==null&&(i.crossOrigin=s.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=s.referrerPolicy),i.title==null&&(i.title=s.title)}function Sp(i,s){i.crossOrigin==null&&(i.crossOrigin=s.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=s.referrerPolicy),i.integrity==null&&(i.integrity=s.integrity)}var Dc=null;function cx(i,s,d){if(Dc===null){var v=new Map,y=Dc=new Map;y.set(d,v)}else y=Dc,v=y.get(d),v||(v=new Map,y.set(d,v));if(v.has(i))return v;for(v.set(i,null),d=d.getElementsByTagName(i),y=0;y<d.length;y++){var S=d[y];if(!(S[Xs]||S[jt]||i==="link"&&S.getAttribute("rel")==="stylesheet")&&S.namespaceURI!=="http://www.w3.org/2000/svg"){var T=S.getAttribute(s)||"";T=i+T;var I=v.get(T);I?I.push(S):v.set(T,[S])}}return v}function fx(i,s,d){i=i.ownerDocument||i,i.head.insertBefore(d,s==="title"?i.querySelector("head > title"):null)}function eA(i,s,d){if(d===1||s.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;switch(s.rel){case"stylesheet":return i=s.disabled,typeof s.precedence=="string"&&i==null;default:return!0}case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function dx(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}var Bu=null;function tA(){}function nA(i,s,d){if(Bu===null)throw Error(r(475));var v=Bu;if(s.type==="stylesheet"&&(typeof d.media!="string"||matchMedia(d.media).matches!==!1)&&(s.state.loading&4)===0){if(s.instance===null){var y=as(d.href),S=i.querySelector(Ou(y));if(S){i=S._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(v.count++,v=kc.bind(v),i.then(v,v)),s.state.loading|=4,s.instance=S,ln(S);return}S=i.ownerDocument||i,d=ux(d),(y=Er.get(y))&&wp(d,y),S=S.createElement("link"),ln(S);var T=S;T._p=new Promise(function(I,G){T.onload=I,T.onerror=G}),xn(S,"link",d),s.instance=S}v.stylesheets===null&&(v.stylesheets=new Map),v.stylesheets.set(s,i),(i=s.state.preload)&&(s.state.loading&3)===0&&(v.count++,s=kc.bind(v),i.addEventListener("load",s),i.addEventListener("error",s))}}function rA(){if(Bu===null)throw Error(r(475));var i=Bu;return i.stylesheets&&i.count===0&&Ep(i,i.stylesheets),0<i.count?function(s){var d=setTimeout(function(){if(i.stylesheets&&Ep(i,i.stylesheets),i.unsuspend){var v=i.unsuspend;i.unsuspend=null,v()}},6e4);return i.unsuspend=s,function(){i.unsuspend=null,clearTimeout(d)}}:null}function kc(){if(this.count--,this.count===0){if(this.stylesheets)Ep(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var Mc=null;function Ep(i,s){i.stylesheets=null,i.unsuspend!==null&&(i.count++,Mc=new Map,s.forEach(aA,i),Mc=null,kc.call(i))}function aA(i,s){if(!(s.state.loading&4)){var d=Mc.get(i);if(d)var v=d.get(null);else{d=new Map,Mc.set(i,d);for(var y=i.querySelectorAll("link[data-precedence],style[data-precedence]"),S=0;S<y.length;S++){var T=y[S];(T.nodeName==="LINK"||T.getAttribute("media")!=="not all")&&(d.set(T.dataset.precedence,T),v=T)}v&&d.set(null,v)}y=s.instance,T=y.getAttribute("data-precedence"),S=d.get(T)||v,S===v&&d.set(null,y),d.set(T,y),this.count++,v=kc.bind(this),y.addEventListener("load",v),y.addEventListener("error",v),S?S.parentNode.insertBefore(y,S.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(y,i.firstChild)),s.state.loading|=4}}var Fu={$$typeof:_,Provider:null,Consumer:null,_currentValue:U,_currentValue2:U,_threadCount:0};function oA(i,s,d,v,y,S,T,I){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=qs(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=qs(0),this.hiddenUpdates=qs(null),this.identifierPrefix=v,this.onUncaughtError=y,this.onCaughtError=S,this.onRecoverableError=T,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=I,this.incompleteTransitions=new Map}function hx(i,s,d,v,y,S,T,I,G,ae,he,me){return i=new oA(i,s,d,T,I,G,ae,me),s=1,S===!0&&(s|=24),S=Zn(3,null,null,s),i.current=S,S.stateNode=i,s=ah(),s.refCount++,i.pooledCache=s,s.refCount++,S.memoizedState={element:v,isDehydrated:d,cache:s},uh(S),i}function px(i){return i?(i=Fi,i):Fi}function vx(i,s,d,v,y,S){y=px(y),v.context===null?v.context=y:v.pendingContext=y,v=Qa(s),v.payload={element:d},S=S===void 0?null:S,S!==null&&(v.callback=S),d=$a(i,v,s),d!==null&&(rr(d,i,s),du(d,i,s))}function mx(i,s){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var d=i.retryLane;i.retryLane=d!==0&&d<s?d:s}}function Cp(i,s){mx(i,s),(i=i.alternate)&&mx(i,s)}function gx(i){if(i.tag===13){var s=Bi(i,67108864);s!==null&&rr(s,i,67108864),Cp(i,67108864)}}var Oc=!0;function iA(i,s,d,v){var y=L.T;L.T=null;var S=W.p;try{W.p=2,_p(i,s,d,v)}finally{W.p=S,L.T=y}}function sA(i,s,d,v){var y=L.T;L.T=null;var S=W.p;try{W.p=8,_p(i,s,d,v)}finally{W.p=S,L.T=y}}function _p(i,s,d,v){if(Oc){var y=Rp(v);if(y===null)dp(i,s,v,Ic,d),bx(i,v);else if(lA(y,i,s,d,v))v.stopPropagation();else if(bx(i,v),s&4&&-1<uA.indexOf(i)){for(;y!==null;){var S=Ei(y);if(S!==null)switch(S.tag){case 3:if(S=S.stateNode,S.current.memoizedState.isDehydrated){var T=zn(S.pendingLanes);if(T!==0){var I=S;for(I.pendingLanes|=2,I.entangledLanes|=2;T;){var G=1<<31-Nt(T);I.entanglements[1]|=G,T&=~G}Yr(S),(dt&6)===0&&(gc=st()+500,Nu(0))}}break;case 13:I=Bi(S,2),I!==null&&rr(I,S,2),bc(),Cp(S,2)}if(S=Rp(v),S===null&&dp(i,s,v,Ic,d),S===y)break;y=S}y!==null&&v.stopPropagation()}else dp(i,s,v,null,d)}}function Rp(i){return i=kd(i),Ap(i)}var Ic=null;function Ap(i){if(Ic=null,i=Si(i),i!==null){var s=o(i);if(s===null)i=null;else{var d=s.tag;if(d===13){if(i=u(s),i!==null)return i;i=null}else if(d===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;i=null}else s!==i&&(i=null)}}return Ic=i,null}function yx(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(mn()){case pt:return 2;case Qn:return 8;case Qt:case xt:return 32;case Lt:return 268435456;default:return 32}default:return 32}}var Tp=!1,co=null,fo=null,ho=null,Pu=new Map,Lu=new Map,po=[],uA="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function bx(i,s){switch(i){case"focusin":case"focusout":co=null;break;case"dragenter":case"dragleave":fo=null;break;case"mouseover":case"mouseout":ho=null;break;case"pointerover":case"pointerout":Pu.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":Lu.delete(s.pointerId)}}function zu(i,s,d,v,y,S){return i===null||i.nativeEvent!==S?(i={blockedOn:s,domEventName:d,eventSystemFlags:v,nativeEvent:S,targetContainers:[y]},s!==null&&(s=Ei(s),s!==null&&gx(s)),i):(i.eventSystemFlags|=v,s=i.targetContainers,y!==null&&s.indexOf(y)===-1&&s.push(y),i)}function lA(i,s,d,v,y){switch(s){case"focusin":return co=zu(co,i,s,d,v,y),!0;case"dragenter":return fo=zu(fo,i,s,d,v,y),!0;case"mouseover":return ho=zu(ho,i,s,d,v,y),!0;case"pointerover":var S=y.pointerId;return Pu.set(S,zu(Pu.get(S)||null,i,s,d,v,y)),!0;case"gotpointercapture":return S=y.pointerId,Lu.set(S,zu(Lu.get(S)||null,i,s,d,v,y)),!0}return!1}function xx(i){var s=Si(i.target);if(s!==null){var d=o(s);if(d!==null){if(s=d.tag,s===13){if(s=u(d),s!==null){i.blockedOn=s,$t(i.priority,function(){if(d.tag===13){var v=nr();v=Gt(v);var y=Bi(d,v);y!==null&&rr(y,d,v),Cp(d,v)}});return}}else if(s===3&&d.stateNode.current.memoizedState.isDehydrated){i.blockedOn=d.tag===3?d.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Bc(i){if(i.blockedOn!==null)return!1;for(var s=i.targetContainers;0<s.length;){var d=Rp(i.nativeEvent);if(d===null){d=i.nativeEvent;var v=new d.constructor(d.type,d);Dd=v,d.target.dispatchEvent(v),Dd=null}else return s=Ei(d),s!==null&&gx(s),i.blockedOn=d,!1;s.shift()}return!0}function wx(i,s,d){Bc(i)&&d.delete(s)}function cA(){Tp=!1,co!==null&&Bc(co)&&(co=null),fo!==null&&Bc(fo)&&(fo=null),ho!==null&&Bc(ho)&&(ho=null),Pu.forEach(wx),Lu.forEach(wx)}function Fc(i,s){i.blockedOn===s&&(i.blockedOn=null,Tp||(Tp=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,cA)))}var Pc=null;function Sx(i){Pc!==i&&(Pc=i,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Pc===i&&(Pc=null);for(var s=0;s<i.length;s+=3){var d=i[s],v=i[s+1],y=i[s+2];if(typeof v!="function"){if(Ap(v||d)===null)continue;break}var S=Ei(d);S!==null&&(i.splice(s,3),s-=3,Ah(S,{pending:!0,data:y,method:d.method,action:v},v,y))}}))}function Uu(i){function s(G){return Fc(G,i)}co!==null&&Fc(co,i),fo!==null&&Fc(fo,i),ho!==null&&Fc(ho,i),Pu.forEach(s),Lu.forEach(s);for(var d=0;d<po.length;d++){var v=po[d];v.blockedOn===i&&(v.blockedOn=null)}for(;0<po.length&&(d=po[0],d.blockedOn===null);)xx(d),d.blockedOn===null&&po.shift();if(d=(i.ownerDocument||i).$$reactFormReplay,d!=null)for(v=0;v<d.length;v+=3){var y=d[v],S=d[v+1],T=y[wt]||null;if(typeof S=="function")T||Sx(d);else if(T){var I=null;if(S&&S.hasAttribute("formAction")){if(y=S,T=S[wt]||null)I=T.formAction;else if(Ap(y)!==null)continue}else I=T.action;typeof I=="function"?d[v+1]=I:(d.splice(v,3),v-=3),Sx(d)}}}function Np(i){this._internalRoot=i}Lc.prototype.render=Np.prototype.render=function(i){var s=this._internalRoot;if(s===null)throw Error(r(409));var d=s.current,v=nr();vx(d,v,i,s,null,null)},Lc.prototype.unmount=Np.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var s=i.containerInfo;vx(i.current,2,null,i,null,null),bc(),s[un]=null}};function Lc(i){this._internalRoot=i}Lc.prototype.unstable_scheduleHydration=function(i){if(i){var s=Po();i={blockedOn:null,target:i,priority:s};for(var d=0;d<po.length&&s!==0&&s<po[d].priority;d++);po.splice(d,0,i),d===0&&xx(i)}};var Ex=t.version;if(Ex!=="19.1.0")throw Error(r(527,Ex,"19.1.0"));W.findDOMNode=function(i){var s=i._reactInternals;if(s===void 0)throw typeof i.render=="function"?Error(r(188)):(i=Object.keys(i).join(","),Error(r(268,i)));return i=c(s),i=i!==null?f(i):null,i=i===null?null:i.stateNode,i};var fA={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:L,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var zc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!zc.isDisabled&&zc.supportsFiber)try{_n=zc.inject(fA),Rt=zc}catch{}}return Hu.createRoot=function(i,s){if(!a(i))throw Error(r(299));var d=!1,v="",y=zy,S=Uy,T=jy,I=null;return s!=null&&(s.unstable_strictMode===!0&&(d=!0),s.identifierPrefix!==void 0&&(v=s.identifierPrefix),s.onUncaughtError!==void 0&&(y=s.onUncaughtError),s.onCaughtError!==void 0&&(S=s.onCaughtError),s.onRecoverableError!==void 0&&(T=s.onRecoverableError),s.unstable_transitionCallbacks!==void 0&&(I=s.unstable_transitionCallbacks)),s=hx(i,1,!1,null,null,d,v,y,S,T,I,null),i[un]=s.current,fp(i),new Np(s)},Hu.hydrateRoot=function(i,s,d){if(!a(i))throw Error(r(299));var v=!1,y="",S=zy,T=Uy,I=jy,G=null,ae=null;return d!=null&&(d.unstable_strictMode===!0&&(v=!0),d.identifierPrefix!==void 0&&(y=d.identifierPrefix),d.onUncaughtError!==void 0&&(S=d.onUncaughtError),d.onCaughtError!==void 0&&(T=d.onCaughtError),d.onRecoverableError!==void 0&&(I=d.onRecoverableError),d.unstable_transitionCallbacks!==void 0&&(G=d.unstable_transitionCallbacks),d.formState!==void 0&&(ae=d.formState)),s=hx(i,1,!0,s,d??null,v,y,S,T,I,G,ae),s.context=px(null),d=s.current,v=nr(),v=Gt(v),y=Qa(v),y.callback=null,$a(d,y,v),d=v,s.current.lanes=d,qa(s,d),Yr(s),i[un]=s.current,fp(i),new Lc(s)},Hu.version="19.1.0",Hu}var Ox;function SA(){if(Ox)return Mp.exports;Ox=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(t){console.error(t)}}return n(),Mp.exports=wA(),Mp.exports}var EA=SA();/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var _w=function(n,t){return(_w=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var a in r)r.hasOwnProperty(a)&&(e[a]=r[a])})(n,t)};function jr(n,t){function e(){this.constructor=n}_w(n,t),n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}function Te(n,t,e,r){return new(e||(e=Promise))(function(a,o){function u(f){try{c(r.next(f))}catch(h){o(h)}}function l(f){try{c(r.throw(f))}catch(h){o(h)}}function c(f){f.done?a(f.value):new e(function(h){h(f.value)}).then(u,l)}c((r=r.apply(n,[])).next())})}function Ne(n,t){var e,r,a,o,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(c){return function(f){return function(h){if(e)throw new TypeError("Generator is already executing.");for(;u;)try{if(e=1,r&&(a=2&h[0]?r.return:h[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,h[1])).done)return a;switch(r=0,a&&(h=[2&h[0],a.value]),h[0]){case 0:case 1:a=h;break;case 4:return u.label++,{value:h[1],done:!1};case 5:u.label++,r=h[1],h=[0];continue;case 7:h=u.ops.pop(),u.trys.pop();continue;default:if(!(a=(a=u.trys).length>0&&a[a.length-1])&&(h[0]===6||h[0]===2)){u=0;continue}if(h[0]===3&&(!a||h[1]>a[0]&&h[1]<a[3])){u.label=h[1];break}if(h[0]===6&&u.label<a[1]){u.label=a[1],a=h;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(h);break}a[2]&&u.ops.pop(),u.trys.pop();continue}h=t.call(n,u)}catch(p){h=[6,p],r=0}finally{e=a=0}if(5&h[0])throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}([c,f])}}}var CA=function(){function n(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return n.prototype.setPlatform=function(t,e){this.platform!=null&&console.warn("Platform "+this.platformName+" has already been set. Overwriting the platform with "+e+"."),this.platformName=t,this.platform=e},n.prototype.registerFlag=function(t,e,r){if(this.flagRegistry[t]={evaluationFn:e,setHook:r},this.urlFlags[t]!=null){var a=this.urlFlags[t];console.warn("Setting feature override from URL "+t+": "+a+"."),this.set(t,a)}},n.prototype.get=function(t){return t in this.flags?this.flags[t]:(this.flags[t]=this.evaluateFlag(t),this.flags[t])},n.prototype.getNumber=function(t){return this.get(t)},n.prototype.getBool=function(t){return this.get(t)},n.prototype.getFlags=function(){return this.flags},Object.defineProperty(n.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),n.prototype.set=function(t,e){if(this.flagRegistry[t]==null)throw new Error("Cannot set flag "+t+" as it has not been registered.");this.flags[t]=e,this.flagRegistry[t].setHook!=null&&this.flagRegistry[t].setHook(e)},n.prototype.evaluateFlag=function(t){if(this.flagRegistry[t]==null)throw new Error("Cannot evaluate flag '"+t+"': no evaluation function found.");return this.flagRegistry[t].evaluationFn()},n.prototype.setFlags=function(t){this.flags=Object.assign({},t)},n.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},n.prototype.populateURLFlags=function(){var t=this;if(this.global!==void 0&&this.global.location!==void 0&&this.global.location.search!==void 0){var e,r,a=(e=this.global.location.search,r={},e.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,function(o){for(var u=[],l=1;l<arguments.length;l++)u[l-1]=arguments[l];return _A(r,u[0],u[1]),u.join("=")}),r);"tfjsflags"in a&&a.tfjsflags.split(",").forEach(function(o){var u=o.split(":"),l=u[0],c=u[1];t.urlFlags[l]=function(f,h){if((h=h.toLowerCase())==="true"||h==="false")return h==="true";if(""+ +h===h)return+h;throw new Error("Could not parse value flag value "+h+" for flag "+f+".")}(l,c)})}},n}();function _A(n,t,e){n[decodeURIComponent(t)]=decodeURIComponent(e||"")}function fe(){return Rw}var Rw=null,gf=new Map,_v=new Map;function Aw(n,t){var e=Nw(n,t);return gf.get(e)}function RA(n){return _v.get(n)}function Ix(n){for(var t=gf.entries(),e=[];;){var r=t.next(),a=r.done,o=r.value;if(a)break;var u=o[0],l=o[1];u.split("_")[0]===n&&e.push(l)}return e}function Tw(n){var t=n.kernelName,e=n.backendName,r=Nw(t,e);if(gf.has(r))throw new Error("The kernel '"+t+"' for backend '"+e+"' is already registered");gf.set(r,n)}function AA(n){var t=n.kernelName;_v.has(t)&&console.warn("Overriding the gradient for '"+t+"'"),_v.set(t,n)}function Nw(n,t){return t+"_"+n}function Rv(n,t,e){return Math.max(n,Math.min(t,e))}function Dw(n){return n%2==0?n:n+1}function TA(n){for(var t=0,e=0;e<n.length;e++)t+=n[e];return t}function j(n,t){if(!n)throw new Error(typeof t=="string"?t:t())}function ft(n,t,e){e===void 0&&(e=""),j(pn(n,t),function(){return e+" Shapes "+n+" and "+t+" must match"})}function Fs(n){j(n!=null,function(){return"The input to the tensor constructor must be a non-null value."})}function Ns(n,t,e){if(t===void 0&&(t=[]),e===void 0&&(e=!1),t==null&&(t=[]),Array.isArray(n)||aa(n)&&!e)for(var r=0;r<n.length;++r)Ns(n[r],t,e);else t.push(n);return t}function ke(n){if(n.length===0)return 1;for(var t=n[0],e=1;e<n.length;e++)t*=n[e];return t}function pn(n,t){if(n===t)return!0;if(n==null||t==null||n.length!==t.length)return!1;for(var e=0;e<n.length;e++)if(n[e]!==t[e])return!1;return!0}function Wt(n){return n%1==0}function NA(n){if(Math.tanh!=null)return Math.tanh(n);if(n===1/0)return 1;if(n===-1/0)return-1;var t=Math.exp(2*n);return(t-1)/(t+1)}function Av(n){var t=Math.ceil(Math.sqrt(n));return[t,Math.ceil(n/t)]}function xs(n,t){return t<=n.length?n:n+" ".repeat(t-n.length)}function Bx(n,t,e){return t===void 0&&(t=function(r){return 0}),new Promise(function(r,a){var o=0,u=function(){if(n())r();else{o++;var l=t(o);e!=null&&o>=e?a():setTimeout(u,l)}};u()})}function DA(n,t){for(var e=1,r=-1,a=0;a<n.length;++a)if(n[a]>=0)e*=n[a];else if(n[a]===-1){if(r!==-1)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+r+" and dim "+a);r=a}else if(n[a]<0)throw Error("Shapes can not be < 0. Found "+n[a]+" at dim "+a);if(r===-1){if(t>0&&t!==e)throw Error("Size("+t+") must match the product of shape "+n);return n}if(e===0)throw Error("Cannot infer the missing size in ["+n+"] when there are 0 elements");if(t%e!=0)throw Error("The implicit shape can't be a fractional number. Got "+t+" / "+e);var o=n.slice();return o[r]=t/e,o}function sn(n,t){var e=t.length;return j((n=n==null?t.map(function(r,a){return a}):[].concat(n)).every(function(r){return r>=-e&&r<e}),function(){return"All values in axis param must be in range [-"+e+", "+e+") but got axis "+n}),j(n.every(function(r){return Wt(r)}),function(){return"All values in axis param must be integers but got axis "+n}),n.map(function(r){return r<0?e+r:r})}function ii(n,t){for(var e=[],r=[],a=t!=null&&Array.isArray(t)&&t.length===0,o=t==null||a?null:sn(t,n).sort(),u=0,l=0;l<n.length;++l){if(o!=null){if(o[u]===l&&n[l]!==1)throw new Error("Can't squeeze axis "+l+" since its dim '"+n[l]+"' is not 1");(o[u]==null||o[u]>l)&&n[l]===1&&(e.push(n[l]),r.push(l)),o[u]<=l&&u++}n[l]!==1&&(e.push(n[l]),r.push(l))}return{newShape:e,keptDims:r}}function Ju(n,t){var e=null;if(n==null||n==="float32")e=new Float32Array(t);else if(n==="int32")e=new Int32Array(t);else{if(n!=="bool")throw new Error("Unknown data type "+n);e=new Uint8Array(t)}return e}function yf(n,t){var e=null;if(n==null||n==="float32")e=new Float32Array(t);else if(n==="int32")e=new Int32Array(t);else if(n==="bool")e=new Uint8Array(t);else{if(n!=="string")throw new Error("Unknown data type "+n);e=new Array(t)}return e}function kA(n,t){for(var e=0;e<n.length;e++){var r=n[e];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type "+t+" being uploaded contains "+r+".")}}function MA(n){return n==="bool"||n==="complex64"||n==="float32"||n==="int32"||n==="string"}function OA(n,t){return t!=="complex64"&&(t!=="float32"||n==="complex64")&&(t!=="int32"||n==="float32"||n==="complex64")&&(t!=="bool"||n!=="bool")}function aa(n){return n instanceof Float32Array||n instanceof Int32Array||n instanceof Uint8Array}function kw(n){if(n==="float32"||n==="int32")return 4;if(n==="complex64")return 8;if(n==="bool")return 1;throw new Error("Unknown dtype "+n)}function IA(n){if(n==null)return 0;var t=0;return n.forEach(function(e){return t+=e.length}),t}function mm(n){return typeof n=="string"||n instanceof String}function BA(n){return typeof n=="boolean"}function FA(n){return typeof n=="number"}function dl(n){return Array.isArray(n)?dl(n[0]):n instanceof Float32Array?"float32":n instanceof Int32Array||n instanceof Uint8Array?"int32":FA(n)?"float32":mm(n)?"string":BA(n)?"bool":"float32"}function Tv(n){return!!(n&&n.constructor&&n.call&&n.apply)}function Nv(n,t){for(var e=t;e<n;++e)if(n%e==0)return e;return n}function oa(n){var t=n.length;if(t<2)return[];var e=new Array(t-1);e[t-2]=n[t-1];for(var r=t-3;r>=0;--r)e[r]=e[r+1]*n[r+1];return e}function Mw(n,t,e){if(t==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(n)&&(n=Ns(n)),e&&kA(n,t),function(o,u){return o instanceof Float32Array&&u==="float32"||o instanceof Int32Array&&u==="int32"||o instanceof Uint8Array&&u==="bool"}(n,t))return n;if(t==null||t==="float32"||t==="complex64")return new Float32Array(n);if(t==="int32")return new Int32Array(n);if(t==="bool"){for(var r=new Uint8Array(n.length),a=0;a<r.length;++a)Math.round(n[a])!==0&&(r[a]=1);return r}throw new Error("Unknown data type "+t)}function Fx(n,t){if(n.length===0)return t[0];var e=n.reduce(function(r,a){return r*a});if(e===0)return[];if(e!==t.length)throw new Error("["+n+"] does not match the input size.");return function r(a,o,u){var l=new Array;if(o.length===1)for(var c=o[0],f=0;f<c;f++)l[f]=u[a+f];else{c=o[0];var h=o.slice(1),p=h.reduce(function(m,g){return m*g});for(f=0;f<c;f++)l[f]=r(a+f*p,h,u)}return l}(0,n,t)}function Ow(n,t){for(var e=hl(n,t),r=0;r<e.length;r++)e[r]=1;return e}function hl(n,t){if(t==null||t==="float32"||t==="complex64")return new Float32Array(n);if(t==="int32")return new Int32Array(n);if(t==="bool")return new Uint8Array(n);throw new Error("Unknown data type "+t)}function Zr(){return fe().platform.now()}function Iw(n){n.forEach(function(t){j(Number.isInteger(t)&&t>=0,function(){return"Tensor must have a shape comprised of positive integers but got shape ["+n+"]."})})}function PA(n,t){return t===void 0&&(t="utf-8"),t=t||"utf-8",fe().platform.encode(n,t)}function bf(n,t){return t===void 0&&(t="utf-8"),t=t||"utf-8",fe().platform.decode(n,t)}function Px(n,t,e){if(t===0)return 0;if(t===1)return n[0];for(var r=n[n.length-1],a=0;a<n.length-1;++a)r+=e[a]*n[a];return r}function LA(n,t,e){if(t===0)return[];if(t===1)return[n];for(var r=new Array(t),a=0;a<r.length-1;++a)r[a]=Math.floor(n/e[a]),n-=r[a]*e[a];return r[r.length-1]=n,r}var zA=function(){function n(t,e){this.backendTimer=t,this.logger=e,e==null&&(this.logger=new UA)}return n.prototype.profileKernel=function(t,e,r){var a,o=this,u=this.backendTimer.time(function(){a=r()});return a.forEach(function(l){l.data().then(function(c){(function(f,h,p){if(h!=="float32")return!1;for(var m=0;m<f.length;m++){var g=f[m];if(isNaN(g)||!isFinite(g))return console.warn("Found "+g+" in the result of '"+p+"'"),!0}})(c,l.dtype,t),u.then(function(f){var h="";f.getExtraProfileInfo!=null&&(h=f.getExtraProfileInfo()),o.logger.logKernelProfile(t,l,c,f.kernelMs,e,h)})})}),a},n}(),UA=function(){function n(){}return n.prototype.logKernelProfile=function(t,e,r,a,o,u){var l=typeof a=="number"?xs(a+"ms",9):a.error,c=xs(t,25),f=e.rank,h=e.size,p=xs(e.shape.toString(),14),m="";for(var g in o){var b=o[g].shape||e.shape,x=b.length;m+=g+": "+x+"D "+(x>0?b:"")+" "}console.log("%c"+c+"	%c"+l+"	%c"+f+"D "+p+"	%c"+h+"	%c"+m+"	%c"+u,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},n}(),Lx=20,Vu=3,Fp=7;function jA(n,t,e,r){var a=oa(t),o=function(f,h,p,m){var g=ke(h),b=m[m.length-1],x=new Array(b).fill(0),w=h.length,E=p==="complex64"?Gu(f):f;if(w>1)for(var C=0;C<g/b;C++)for(var _=C*b,R=0;R<b;R++)x[R]=Math.max(x[R],Wu(E[_+R],0,p).length);return x}(n,t,e,a),u=t.length,l=function f(h,p,m,g,b,x){x===void 0&&(x=!0);var w=m==="complex64"?2:1,E=p[0],C=p.length;if(C===0)return m==="complex64"?[Wu(Gu(h)[0],0,m)]:m==="bool"?[Bw(h[0])]:[h[0].toString()];if(C===1){if(E>Lx){var _=Vu*w,R=Array.from(h.slice(0,_)),A=Array.from(h.slice((E-Vu)*w,E*w));return m==="complex64"&&(R=Gu(R),A=Gu(A)),["["+R.map(function(K,L){return Wu(K,b[L],m)}).join(", ")+", ..., "+A.map(function(K,L){return Wu(K,b[E-Vu+L],m)}).join(", ")+"]"]}return["["+(m==="complex64"?Gu(h):Array.from(h)).map(function(K,L){return Wu(K,b[L],m)}).join(", ")+"]"]}var D=p.slice(1),M=g.slice(1),k=g[0]*w,B=[];if(E>Lx){for(var O=0;O<Vu;O++){var V=(H=O*k)+k;B.push.apply(B,f(h.slice(H,V),D,m,M,b,!1))}for(B.push("..."),O=E-Vu;O<E;O++)V=(H=O*k)+k,B.push.apply(B,f(h.slice(H,V),D,m,M,b,O===E-1))}else for(O=0;O<E;O++){var H;V=(H=O*k)+k,B.push.apply(B,f(h.slice(H,V),D,m,M,b,O===E-1))}var ee=C===2?",":"";for(B[0]="["+B[0]+ee,O=1;O<B.length-1;O++)B[O]=" "+B[O]+ee;var $=`,
`;for(O=2;O<C;O++)$+=`
`;return B[B.length-1]=" "+B[B.length-1]+"]"+(x?"":$),B}(n,t,e,a,o),c=["Tensor"];return r&&(c.push("  dtype: "+e),c.push("  rank: "+u),c.push("  shape: ["+t+"]"),c.push("  values:")),c.push(l.map(function(f){return"    "+f}).join(`
`)),c.join(`
`)}function Wu(n,t,e){return xs(Array.isArray(n)?parseFloat(n[0].toFixed(Fp))+" + "+parseFloat(n[1].toFixed(Fp))+"j":mm(n)?"'"+n+"'":e==="bool"?Bw(n):parseFloat(n.toFixed(Fp)).toString(),t)}function Bw(n){return n===0?"false":"true"}function Gu(n){for(var t=[],e=0;e<n.length;e+=2)t.push([n[e],n[e+1]]);return t}var el=function(){function n(t,e,r){var a=this;if(this.dtype=e,this.shape=t.slice(),this.size=ke(t),r!=null){var o=r.length;j(o===this.size,function(){return"Length of values '"+o+"' does not match the size inferred by the shape '"+a.size+"'."})}if(e==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||yf(e,this.size),this.strides=oa(t)}return n.prototype.set=function(t){for(var e=this,r=[],a=1;a<arguments.length;a++)r[a-1]=arguments[a];r.length===0&&(r=[0]),j(r.length===this.rank,function(){return"The number of provided coordinates ("+r.length+") must match the rank ("+e.rank+")"});var o=this.locToIndex(r);this.values[o]=t},n.prototype.get=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];t.length===0&&(t=[0]);for(var r=0,a=0,o=t;a<o.length;a++){var u=o[a];if(u<0||u>=this.shape[r]){var l="Requested out of range element at "+t+".   Buffer shape="+this.shape;throw new Error(l)}r++}for(var c=t[t.length-1],f=0;f<t.length-1;++f)c+=this.strides[f]*t[f];return this.values[c]},n.prototype.locToIndex=function(t){if(this.rank===0)return 0;if(this.rank===1)return t[0];for(var e=t[t.length-1],r=0;r<t.length-1;++r)e+=this.strides[r]*t[r];return e},n.prototype.indexToLoc=function(t){if(this.rank===0)return[];if(this.rank===1)return[t];for(var e=new Array(this.shape.length),r=0;r<e.length-1;++r)e[r]=Math.floor(t/this.strides[r]),t-=e[r]*this.strides[r];return e[e.length-1]=t,e},Object.defineProperty(n.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),n.prototype.toTensor=function(){return Jr().makeTensor(this.values,this.shape,this.dtype)},n}(),Jr=null,ue=null,Fw=null,Mt=function(){function n(t,e,r,a){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=e||"float32",this.size=ke(t),this.strides=oa(t),this.dataId=r,this.id=a,this.rankType=this.rank<5?this.rank.toString():"higher"}return n.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},n.prototype.asScalar=function(){return this.throwIfDisposed(),j(this.size===1,function(){return"The array must have only 1 element."}),this.reshape([])},n.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},n.prototype.as2D=function(t,e){return this.throwIfDisposed(),this.reshape([t,e])},n.prototype.as3D=function(t,e,r){return this.throwIfDisposed(),this.reshape([t,e,r])},n.prototype.as4D=function(t,e,r,a){return this.throwIfDisposed(),this.reshape([t,e,r,a])},n.prototype.as5D=function(t,e,r,a,o){return this.throwIfDisposed(),this.reshape([t,e,r,a,o])},n.prototype.asType=function(t){return this.throwIfDisposed(),ue.cast(this,t)},Object.defineProperty(n.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),n.prototype.buffer=function(){return Te(this,void 0,void 0,function(){var t;return Ne(this,function(e){switch(e.label){case 0:return[4,this.data()];case 1:return t=e.sent(),[2,ue.buffer(this.shape,this.dtype,t)]}})})},n.prototype.bufferSync=function(){return ue.buffer(this.shape,this.dtype,this.dataSync())},n.prototype.array=function(){return Te(this,void 0,void 0,function(){var t;return Ne(this,function(e){switch(e.label){case 0:return[4,this.data()];case 1:return t=e.sent(),[2,Fx(this.shape,t)]}})})},n.prototype.arraySync=function(){return Fx(this.shape,this.dataSync())},n.prototype.data=function(){return Te(this,void 0,void 0,function(){var t,e;return Ne(this,function(r){switch(r.label){case 0:return this.throwIfDisposed(),t=Jr().read(this.dataId),this.dtype!=="string"?[3,2]:[4,t];case 1:e=r.sent();try{return[2,e.map(function(a){return bf(a)})]}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}r.label=2;case 2:return[2,t]}})})},n.prototype.dataSync=function(){this.throwIfDisposed();var t=Jr().readSync(this.dataId);if(this.dtype==="string")try{return t.map(function(e){return bf(e)})}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t},n.prototype.bytes=function(){return Te(this,void 0,void 0,function(){var t;return Ne(this,function(e){switch(e.label){case 0:return this.throwIfDisposed(),[4,Jr().read(this.dataId)];case 1:return t=e.sent(),this.dtype==="string"?[2,t]:[2,new Uint8Array(t.buffer)]}})})},n.prototype.dispose=function(){this.isDisposed||(Jr().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(n.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),n.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},n.prototype.toFloat=function(){return this.asType("float32")},n.prototype.toInt=function(){return this.asType("int32")},n.prototype.toBool=function(){return this.asType("bool")},n.prototype.print=function(t){return t===void 0&&(t=!1),ue.print(this,t)},n.prototype.reshape=function(t){return this.throwIfDisposed(),ue.reshape(this,t)},n.prototype.reshapeAs=function(t){return this.throwIfDisposed(),this.reshape(t.shape)},n.prototype.expandDims=function(t){return t===void 0&&(t=0),ue.expandDims(this,t)},n.prototype.cumsum=function(t,e,r){return t===void 0&&(t=0),e===void 0&&(e=!1),r===void 0&&(r=!1),ue.cumsum(this,t,e,r)},n.prototype.squeeze=function(t){return this.throwIfDisposed(),ue.squeeze(this,t)},n.prototype.clone=function(){return this.throwIfDisposed(),ue.clone(this)},n.prototype.oneHot=function(t,e,r){return this.throwIfDisposed(),ue.oneHot(this,t,e,r)},n.prototype.toString=function(t){return t===void 0&&(t=!1),jA(this.dataSync(),this.shape,this.dtype,t)},n.prototype.tile=function(t){return this.throwIfDisposed(),ue.tile(this,t)},n.prototype.gather=function(t,e){return e===void 0&&(e=0),this.throwIfDisposed(),ue.gather(this,t,e)},n.prototype.matMul=function(t,e,r){return e===void 0&&(e=!1),r===void 0&&(r=!1),this.throwIfDisposed(),ue.matMul(this,t,e,r)},n.prototype.dot=function(t){return this.throwIfDisposed(),ue.dot(this,t)},n.prototype.norm=function(t,e,r){return t===void 0&&(t="euclidean"),e===void 0&&(e=null),r===void 0&&(r=!1),this.throwIfDisposed(),ue.norm(this,t,e,r)},n.prototype.slice=function(t,e){return this.throwIfDisposed(),ue.slice(this,t,e)},n.prototype.reverse=function(t){return this.throwIfDisposed(),ue.reverse(this,t)},n.prototype.concat=function(t,e){return e===void 0&&(e=0),this.throwIfDisposed(),t instanceof n&&(t=[t]),ue.concat([this].concat(t),e)},n.prototype.split=function(t,e){return e===void 0&&(e=0),this.throwIfDisposed(),ue.split(this,t,e)},n.prototype.stack=function(t,e){return e===void 0&&(e=0),ue.stack([this,t],e)},n.prototype.unstack=function(t){return t===void 0&&(t=0),ue.unstack(this,t)},n.prototype.pad=function(t,e){return e===void 0&&(e=0),ue.pad(this,t,e)},n.prototype.batchNormalization=function(t,e,r,a,o){return r===void 0&&(r=.001),Fw("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(t,e,o,a,r)},n.prototype.batchNorm=function(t,e,r,a,o){return o===void 0&&(o=.001),this.throwIfDisposed(),ue.batchNorm(this,t,e,r,a,o)},n.prototype.all=function(t,e){return t===void 0&&(t=null),e===void 0&&(e=!1),this.throwIfDisposed(),ue.all(this,t,e)},n.prototype.any=function(t,e){return t===void 0&&(t=null),e===void 0&&(e=!1),this.throwIfDisposed(),ue.any(this,t,e)},n.prototype.logSumExp=function(t,e){return t===void 0&&(t=null),e===void 0&&(e=!1),this.throwIfDisposed(),ue.logSumExp(this,t,e)},n.prototype.sum=function(t,e){return t===void 0&&(t=null),e===void 0&&(e=!1),this.throwIfDisposed(),ue.sum(this,t,e)},n.prototype.prod=function(t,e){return t===void 0&&(t=null),e===void 0&&(e=!1),this.throwIfDisposed(),ue.prod(this,t,e)},n.prototype.mean=function(t,e){return t===void 0&&(t=null),e===void 0&&(e=!1),this.throwIfDisposed(),ue.mean(this,t,e)},n.prototype.min=function(t,e){return t===void 0&&(t=null),e===void 0&&(e=!1),this.throwIfDisposed(),ue.min(this,t,e)},n.prototype.max=function(t,e){return t===void 0&&(t=null),e===void 0&&(e=!1),this.throwIfDisposed(),ue.max(this,t,e)},n.prototype.argMin=function(t){return t===void 0&&(t=null),this.throwIfDisposed(),ue.argMin(this,t)},n.prototype.argMax=function(t){return t===void 0&&(t=null),this.throwIfDisposed(),ue.argMax(this,t)},n.prototype.cast=function(t){return this.throwIfDisposed(),ue.cast(this,t)},n.prototype.add=function(t){return this.throwIfDisposed(),ue.add(this,t)},n.prototype.addStrict=function(t){return this.throwIfDisposed(),ue.addStrict(this,t)},n.prototype.atan2=function(t){return this.throwIfDisposed(),ue.atan2(this,t)},n.prototype.sub=function(t){return this.throwIfDisposed(),ue.sub(this,t)},n.prototype.subStrict=function(t){return this.throwIfDisposed(),ue.subStrict(this,t)},n.prototype.pow=function(t){return this.throwIfDisposed(),ue.pow(this,t)},n.prototype.powStrict=function(t){return this.throwIfDisposed(),ue.powStrict(this,t)},n.prototype.mul=function(t){return this.throwIfDisposed(),ue.mul(this,t)},n.prototype.mulStrict=function(t){return this.throwIfDisposed(),ue.mulStrict(this,t)},n.prototype.div=function(t){return this.throwIfDisposed(),ue.div(this,t)},n.prototype.divNoNan=function(t){return this.throwIfDisposed(),ue.divNoNan(this,t)},n.prototype.floorDiv=function(t){return this.throwIfDisposed(),ue.floorDiv(this,t)},n.prototype.divStrict=function(t){return this.throwIfDisposed(),ue.divStrict(this,t)},n.prototype.minimum=function(t){return this.throwIfDisposed(),ue.minimum(this,t)},n.prototype.minimumStrict=function(t){return this.throwIfDisposed(),ue.minimumStrict(this,t)},n.prototype.maximum=function(t){return this.throwIfDisposed(),ue.maximum(this,t)},n.prototype.maximumStrict=function(t){return this.throwIfDisposed(),ue.maximumStrict(this,t)},n.prototype.mod=function(t){return this.throwIfDisposed(),ue.mod(this,t)},n.prototype.modStrict=function(t){return this.throwIfDisposed(),ue.modStrict(this,t)},n.prototype.squaredDifferenceStrict=function(t){return this.throwIfDisposed(),ue.squaredDifferenceStrict(this,t)},n.prototype.transpose=function(t){return this.throwIfDisposed(),ue.transpose(this,t)},n.prototype.notEqual=function(t){return this.throwIfDisposed(),ue.notEqual(this,t)},n.prototype.notEqualStrict=function(t){return this.throwIfDisposed(),ue.notEqualStrict(this,t)},n.prototype.less=function(t){return this.throwIfDisposed(),ue.less(this,t)},n.prototype.lessStrict=function(t){return this.throwIfDisposed(),ue.lessStrict(this,t)},n.prototype.equal=function(t){return this.throwIfDisposed(),ue.equal(this,t)},n.prototype.equalStrict=function(t){return this.throwIfDisposed(),ue.equalStrict(this,t)},n.prototype.lessEqual=function(t){return this.throwIfDisposed(),ue.lessEqual(this,t)},n.prototype.lessEqualStrict=function(t){return this.throwIfDisposed(),ue.lessEqualStrict(this,t)},n.prototype.greater=function(t){return this.throwIfDisposed(),ue.greater(this,t)},n.prototype.greaterStrict=function(t){return this.throwIfDisposed(),ue.greaterStrict(this,t)},n.prototype.greaterEqual=function(t){return this.throwIfDisposed(),ue.greaterEqual(this,t)},n.prototype.greaterEqualStrict=function(t){return this.throwIfDisposed(),ue.greaterEqualStrict(this,t)},n.prototype.logicalAnd=function(t){return this.throwIfDisposed(),ue.logicalAnd(this,t)},n.prototype.logicalOr=function(t){return this.throwIfDisposed(),ue.logicalOr(this,t)},n.prototype.logicalNot=function(){return this.throwIfDisposed(),ue.logicalNot(this)},n.prototype.logicalXor=function(t){return this.throwIfDisposed(),ue.logicalXor(this,t)},n.prototype.where=function(t,e){return this.throwIfDisposed(),ue.where(t,this,e)},n.prototype.neg=function(){return this.throwIfDisposed(),ue.neg(this)},n.prototype.ceil=function(){return this.throwIfDisposed(),ue.ceil(this)},n.prototype.floor=function(){return this.throwIfDisposed(),ue.floor(this)},n.prototype.sign=function(){return this.throwIfDisposed(),ue.sign(this)},n.prototype.isNaN=function(){return this.throwIfDisposed(),ue.isNaN(this)},n.prototype.isInf=function(){return this.throwIfDisposed(),ue.isInf(this)},n.prototype.isFinite=function(){return this.throwIfDisposed(),ue.isFinite(this)},n.prototype.exp=function(){return this.throwIfDisposed(),ue.exp(this)},n.prototype.expm1=function(){return this.throwIfDisposed(),ue.expm1(this)},n.prototype.log=function(){return this.throwIfDisposed(),ue.log(this)},n.prototype.log1p=function(){return this.throwIfDisposed(),ue.log1p(this)},n.prototype.sqrt=function(){return this.throwIfDisposed(),ue.sqrt(this)},n.prototype.rsqrt=function(){return this.throwIfDisposed(),ue.rsqrt(this)},n.prototype.square=function(){return this.throwIfDisposed(),ue.square(this)},n.prototype.reciprocal=function(){return this.throwIfDisposed(),ue.reciprocal(this)},n.prototype.abs=function(){return this.throwIfDisposed(),ue.abs(this)},n.prototype.clipByValue=function(t,e){return this.throwIfDisposed(),ue.clipByValue(this,t,e)},n.prototype.relu=function(){return this.throwIfDisposed(),ue.relu(this)},n.prototype.relu6=function(){return this.throwIfDisposed(),ue.relu6(this)},n.prototype.elu=function(){return this.throwIfDisposed(),ue.elu(this)},n.prototype.selu=function(){return this.throwIfDisposed(),ue.selu(this)},n.prototype.leakyRelu=function(t){return t===void 0&&(t=.2),this.throwIfDisposed(),ue.leakyRelu(this,t)},n.prototype.prelu=function(t){return this.throwIfDisposed(),ue.prelu(this,t)},n.prototype.sigmoid=function(){return this.throwIfDisposed(),ue.sigmoid(this)},n.prototype.logSigmoid=function(){return this.throwIfDisposed(),ue.logSigmoid(this)},n.prototype.softplus=function(){return this.throwIfDisposed(),ue.softplus(this)},n.prototype.zerosLike=function(){return this.throwIfDisposed(),ue.zerosLike(this)},n.prototype.onesLike=function(){return this.throwIfDisposed(),ue.onesLike(this)},n.prototype.sin=function(){return this.throwIfDisposed(),ue.sin(this)},n.prototype.cos=function(){return this.throwIfDisposed(),ue.cos(this)},n.prototype.tan=function(){return this.throwIfDisposed(),ue.tan(this)},n.prototype.asin=function(){return this.throwIfDisposed(),ue.asin(this)},n.prototype.acos=function(){return this.throwIfDisposed(),ue.acos(this)},n.prototype.atan=function(){return this.throwIfDisposed(),ue.atan(this)},n.prototype.sinh=function(){return this.throwIfDisposed(),ue.sinh(this)},n.prototype.cosh=function(){return this.throwIfDisposed(),ue.cosh(this)},n.prototype.tanh=function(){return this.throwIfDisposed(),ue.tanh(this)},n.prototype.asinh=function(){return this.throwIfDisposed(),ue.asinh(this)},n.prototype.acosh=function(){return this.throwIfDisposed(),ue.acosh(this)},n.prototype.atanh=function(){return this.throwIfDisposed(),ue.atanh(this)},n.prototype.erf=function(){return this.throwIfDisposed(),ue.erf(this)},n.prototype.round=function(){return this.throwIfDisposed(),ue.round(this)},n.prototype.step=function(t){return t===void 0&&(t=0),this.throwIfDisposed(),ue.step(this,t)},n.prototype.softmax=function(t){return t===void 0&&(t=-1),this.throwIfDisposed(),ue.softmax(this,t)},n.prototype.logSoftmax=function(t){return t===void 0&&(t=-1),this.throwIfDisposed(),ue.logSoftmax(this,t)},n.prototype.resizeBilinear=function(t,e){return e===void 0&&(e=!1),this.throwIfDisposed(),ue.image.resizeBilinear(this,t,e)},n.prototype.resizeNearestNeighbor=function(t,e){return e===void 0&&(e=!1),this.throwIfDisposed(),ue.image.resizeNearestNeighbor(this,t,e)},n.prototype.conv1d=function(t,e,r,a,o,u){return a===void 0&&(a="NWC"),o===void 0&&(o=1),this.throwIfDisposed(),ue.conv1d(this,t,e,r,a,o,u)},n.prototype.conv2d=function(t,e,r,a,o,u){return a===void 0&&(a="NHWC"),o===void 0&&(o=[1,1]),this.throwIfDisposed(),ue.conv2d(this,t,e,r,a,o,u)},n.prototype.conv2dTranspose=function(t,e,r,a,o){return this.throwIfDisposed(),ue.conv2dTranspose(this,t,e,r,a,o)},n.prototype.depthwiseConv2D=function(t,e,r,a,o,u){return a===void 0&&(a="NHWC"),o===void 0&&(o=[1,1]),this.throwIfDisposed(),ue.depthwiseConv2d(this,t,e,r,a,o,u)},n.prototype.separableConv2d=function(t,e,r,a,o,u){return o===void 0&&(o=[1,1]),u===void 0&&(u="NHWC"),this.throwIfDisposed(),ue.separableConv2d(this,t,e,r,a,o,u)},n.prototype.avgPool=function(t,e,r,a){return this.throwIfDisposed(),ue.avgPool(this,t,e,r,a)},n.prototype.maxPool=function(t,e,r,a){return this.throwIfDisposed(),ue.maxPool(this,t,e,r,a)},n.prototype.localResponseNormalization=function(t,e,r,a){return t===void 0&&(t=5),e===void 0&&(e=1),r===void 0&&(r=1),a===void 0&&(a=.5),ue.localResponseNormalization(this,t,e,r,a)},n.prototype.pool=function(t,e,r,a,o){return this.throwIfDisposed(),ue.pool(this,t,e,r,a,o)},n.prototype.variable=function(t,e,r){return t===void 0&&(t=!0),this.throwIfDisposed(),Jr().makeVariable(this,t,e,r)},n.prototype.unsortedSegmentSum=function(t,e){return this.throwIfDisposed(),ue.unsortedSegmentSum(this,t,e)},n.prototype.batchToSpaceND=function(t,e){return this.throwIfDisposed(),ue.batchToSpaceND(this,t,e)},n.prototype.spaceToBatchND=function(t,e){return this.throwIfDisposed(),ue.spaceToBatchND(this,t,e)},n.prototype.topk=function(t,e){return t===void 0&&(t=1),e===void 0&&(e=!0),this.throwIfDisposed(),ue.topk(this,t,e)},n.prototype.stridedSlice=function(t,e,r,a,o,u,l,c){return a===void 0&&(a=0),o===void 0&&(o=0),u===void 0&&(u=0),l===void 0&&(l=0),c===void 0&&(c=0),this.throwIfDisposed(),ue.stridedSlice(this,t,e,r,a,o,u,l,c)},n.prototype.depthToSpace=function(t,e){return this.throwIfDisposed(),ue.depthToSpace(this,t,e)},n.prototype.fft=function(){return this.throwIfDisposed(),ue.spectral.fft(this)},n.prototype.ifft=function(){return this.throwIfDisposed(),ue.spectral.ifft(this)},n.prototype.rfft=function(){return this.throwIfDisposed(),ue.spectral.rfft(this)},n.prototype.irfft=function(){return this.throwIfDisposed(),ue.spectral.irfft(this)},n}();Object.defineProperty(Mt,Symbol.hasInstance,{value:function(n){return!!n&&n.dataId!=null&&n.shape!=null&&n.dtype!=null}});var zx,Dv,kv,Mv,Ov,Ds=function(n){function t(e,r,a,o){var u=n.call(this,e.shape,e.dtype,e.dataId,o)||this;return u.trainable=r,u.name=a,u}return jr(t,n),t.prototype.assign=function(e){if(e.dtype!==this.dtype)throw new Error("dtype of the new value ("+e.dtype+") and previous value ("+this.dtype+") must match");if(!pn(e.shape,this.shape))throw new Error("shape of the new value ("+e.shape+") and previous value ("+this.shape+") must match");Jr().disposeTensor(this),this.dataId=e.dataId,Jr().incRef(this,null)},t.prototype.dispose=function(){Jr().disposeVariable(this),this.isDisposedInternal=!0},t}(Mt);Object.defineProperty(Ds,Symbol.hasInstance,{value:function(n){return n instanceof Mt&&n.assign!=null&&n.assign instanceof Function}}),function(n){n.R0="R0",n.R1="R1",n.R2="R2",n.R3="R3",n.R4="R4",n.R5="R5",n.R6="R6"}(zx||(zx={})),function(n){n.float32="float32",n.int32="int32",n.bool="int32",n.complex64="complex64"}(Dv||(Dv={})),function(n){n.float32="float32",n.int32="int32",n.bool="bool",n.complex64="complex64"}(kv||(kv={})),function(n){n.float32="float32",n.int32="float32",n.bool="float32",n.complex64="complex64"}(Mv||(Mv={})),function(n){n.float32="complex64",n.int32="complex64",n.bool="complex64",n.complex64="complex64"}(Ov||(Ov={}));var HA={float32:Mv,int32:Dv,bool:kv,complex64:Ov};function Sn(n,t){if(n==="string"||t==="string"){if(n==="string"&&t==="string")return"string";throw new Error("Can not upcast "+n+" with "+t)}return HA[n][t]}function Pp(n){return Sn(n,"int32")}function It(n,t){if(n.dtype===t.dtype)return[n,t];var e=Sn(n.dtype,t.dtype);return[n.cast(e),t.cast(e)]}function VA(n,t){j(n.dtype===t.dtype,function(){return"The dtypes of the first("+n.dtype+") and second("+t.dtype+") input must match"})}function Pw(n){var t=[];return function e(r,a,o){if(r!=null){if(r instanceof Mt)return void a.push(r);if(u=r,!(!Array.isArray(u)&&typeof u!="object")){var u,l=r;for(var c in l){var f=l[c];o.has(f)||(o.add(f),e(f,a,o))}}}}(n,t,new Set),t}var Lp,Ux=function(){function n(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return n.prototype.dispose=function(){for(var t in this.registeredVariables)this.registeredVariables[t].dispose()},n}(),WA=function(){function n(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new Ux}return n.prototype.ready=function(){return Te(this,void 0,void 0,function(){var t,e,r;return Ne(this,function(a){switch(a.label){case 0:if(this.pendingBackendInit!=null)return[2,this.pendingBackendInit.then(function(){})];if(this.backendInstance!=null)return[2];t=this.getSortedBackends(),e=0,a.label=1;case 1:return e<t.length?(r=t[e],[4,this.initializeBackend(r).success]):[3,5];case 2:return a.sent()?[4,this.setBackend(r)]:[3,4];case 3:return a.sent(),[2];case 4:return e++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}})})},Object.defineProperty(n.prototype,"backend",{get:function(){if(this.pendingBackendInit!=null)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");if(this.backendInstance==null){var t=this.initializeBackendsAndReturnBest(),e=t.name;if(t.asyncInit)throw new Error("The highest priority backend '"+e+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(e)}return this.backendInstance},enumerable:!0,configurable:!0}),n.prototype.backendNames=function(){return Object.keys(this.registryFactory)},n.prototype.findBackend=function(t){return!(t in this.registry)&&(!(t in this.registryFactory)||this.initializeBackend(t).asyncInit)?null:this.registry[t]},n.prototype.findBackendFactory=function(t){return t in this.registryFactory?this.registryFactory[t].factory:null},n.prototype.registerBackend=function(t,e,r){return r===void 0&&(r=1),t in this.registryFactory?(console.warn(t+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[t]={factory:e,priority:r},!0)},n.prototype.setBackend=function(t){return Te(this,void 0,void 0,function(){var e,r,a;return Ne(this,function(o){switch(o.label){case 0:if(this.registryFactory[t]==null)throw new Error("Backend name '"+t+"' not found in registry");return this.backendName=t,this.registry[t]!=null?[3,4]:(this.backendInstance=null,e=this.initializeBackend(t),r=e.success,e.asyncInit?[4,r]:[3,2]);case 1:return a=o.sent(),[3,3];case 2:a=r,o.label=3;case 3:if(!a)return[2,!1];o.label=4;case 4:return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new zA(this.backendInstance),[2,!0]}})})},n.prototype.setupRegisteredKernels=function(){var t=this;Ix(this.backendName).forEach(function(e){e.setupFunc!=null&&e.setupFunc(t.backendInstance)})},n.prototype.disposeRegisteredKernels=function(t){var e=this;Ix(t).forEach(function(r){r.disposeFunc!=null&&r.disposeFunc(e.registry[t])})},n.prototype.initializeBackend=function(t){var e=this,r=this.registryFactory[t];if(r==null)throw new Error("Cannot initialize backend "+t+", no registration found.");try{var a=r.factory();if(Promise.resolve(a)===a){var o=++this.pendingBackendInitId,u=a.then(function(l){return!(o<e.pendingBackendInitId)&&(e.registry[t]=l,e.pendingBackendInit=null,!0)}).catch(function(l){return!(o<e.pendingBackendInitId)&&(e.pendingBackendInit=null,console.warn("Initialization of backend "+t+" failed"),console.warn(l.stack||l.message),!1)});return this.pendingBackendInit=u,{success:u,asyncInit:!0}}return this.registry[t]=a,{success:!0,asyncInit:!1}}catch(l){return console.warn("Initialization of backend "+t+" failed"),console.warn(l.stack||l.message),{success:!1,asyncInit:!1}}},n.prototype.removeBackend=function(t){if(!(t in this.registryFactory))throw new Error(t+" backend not found in registry");this.backendName===t&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},n.prototype.getSortedBackends=function(){var t=this;if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort(function(e,r){return t.registryFactory[r].priority-t.registryFactory[e].priority})},n.prototype.initializeBackendsAndReturnBest=function(){for(var t=this.getSortedBackends(),e=0;e<t.length;e++){var r=t[e],a=this.initializeBackend(r),o=a.success,u=a.asyncInit;if(u||o)return{name:r,asyncInit:u}}throw new Error("Could not initialize any backends, all backend initializations failed.")},n.prototype.moveData=function(t,e){var r=this.state.tensorInfo.get(e),a=r.backend,o=this.readSync(e);a.disposeData(e),r.backend=t,t.move(e,o,r.shape,r.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},n.prototype.tidy=function(t,e){var r,a=this,o=null;if(e==null){if(typeof t!="function")throw new Error("Please provide a function to tidy()");e=t}else{if(typeof t!="string"&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof e!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");o=t}return this.scopedRun(function(){return a.startScope(o)},function(){return a.endScope(r)},function(){return(r=e())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),r})},n.prototype.scopedRun=function(t,e,r){t();try{var a=r();return e(),a}catch(o){throw e(),o}},n.prototype.nextTensorId=function(){return n.nextTensorId++},n.prototype.nextVariableId=function(){return n.nextVariableId++},n.prototype.clone=function(t){var e=this.makeTensorFromDataId(t.dataId,t.shape,t.dtype),r={x:t};return this.addTapeNode(this.state.activeScope.name,r,[e],function(a){return{x:function(){return a.toFloat()}}},[]),e},n.prototype.runKernel=function(t,e,r,a,o){return this.runKernelFunc(null,e,null,t,r,a,o)},n.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool("IS_TEST")},n.prototype.checkKernelForMemLeak=function(t,e,r){var a=this.backend.numDataIds(),o=0;r.forEach(function(c){o+=c.dtype==="complex64"?3:1});var u=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],l=a-e-o-u;if(l>0)throw new Error("Backend '"+this.backendName+"' has an internal memory leak ("+l+" data ids) after running '"+t+"'")},n.prototype.runKernelFunc=function(t,e,r,a,o,u,l){var c,f=this;u===void 0&&(u=[]),l===void 0&&(l=[]);var h=[],p=this.isTapeOn();a==null&&(a=this.state.activeScope!=null?this.state.activeScope.name:"");var m,g=function(C){p&&(h=C.map(function(_){return f.keep(f.clone(_))}))},b=this.state.numBytes,x=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var w,E=Aw(a,this.backendName);return m=E!=null?function(){var C=f.backend.numDataIds();w=E.kernelFunc({inputs:e,attrs:o,backend:f.backend});var _=Array.isArray(w)?w:[w];f.shouldCheckForMemLeaks()&&f.checkKernelForMemLeak(a,C,_);var R=_.map(function(D){var M=D.dataId,k=D.shape,B=D.dtype;return f.makeTensorFromDataId(M,k,B)}),A=R.filter(function(D,M){return l[M]});return g((u||[]).slice().concat(A)),R}:function(){var C=f.backend.numDataIds();w=f.tidy(function(){return t(f.backend,g)});var _=Array.isArray(w)?w:[w];return f.shouldCheckForMemLeaks()&&f.checkKernelForMemLeak(a,C,_),_},this.scopedRun(function(){return f.state.kernelDepth++},function(){return f.state.kernelDepth--},function(){c=f.ENV.getBool("DEBUG")?f.profiler.profileKernel(a,e,function(){return m()}):m()}),p&&this.addTapeNode(a,e,c,r,h),this.state.profiling&&this.state.activeProfile.kernels.push({name:a,bytesAdded:this.state.numBytes-b,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-x,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(e).map(function(C){return e[C].shape}),outputShapes:c.map(function(C){return C.shape})}),Array.isArray(w)?c:c[0]},n.prototype.makeTensor=function(t,e,r,a){if(t==null)throw new Error("Values passed to engine.makeTensor() are null");r=r||"float32",a=a||this.backend;var o=t;r==="string"&&mm(t[0])&&(o=t.map(function(h){return PA(h)}));var u=a.write(o,e,r),l=new Mt(e,r,u,this.nextTensorId());if(this.incRef(l,a),r==="string"){var c=this.state.tensorInfo.get(u),f=IA(o);this.state.numBytes+=f-c.bytes,c.bytes=f}return l},n.prototype.makeTensorFromDataId=function(t,e,r,a){var o=new Mt(e,r=r||"float32",t,this.nextTensorId());return this.incRef(o,a),o},n.prototype.makeVariable=function(t,e,r,a){e===void 0&&(e=!0),r=r||this.nextVariableId().toString(),a!=null&&a!==t.dtype&&(t=t.asType(a));var o=new Ds(t,e,r,this.nextTensorId());if(this.state.registeredVariables[o.name]!=null)throw new Error("Variable with name "+o.name+" was already registered");return this.state.registeredVariables[o.name]=o,this.incRef(o,this.backend),o},n.prototype.incRef=function(t,e){var r=this.state.tensorInfo.has(t.dataId)?this.state.tensorInfo.get(t.dataId).refCount:0;if(this.state.numTensors++,t.dtype==="string"&&this.state.numStringTensors++,r===0){this.state.numDataBuffers++;var a=0;t.dtype!=="complex64"&&t.dtype!=="string"&&(a=t.size*kw(t.dtype)),this.state.tensorInfo.set(t.dataId,{backend:e||this.backend,dtype:t.dtype,shape:t.shape,bytes:a,refCount:0}),this.state.numBytes+=a}this.state.tensorInfo.get(t.dataId).refCount++,t instanceof Ds||this.track(t)},n.prototype.disposeTensor=function(t){if(this.state.tensorInfo.has(t.dataId)){this.state.numTensors--,t.dtype==="string"&&this.state.numStringTensors--;var e=this.state.tensorInfo.get(t.dataId);e.refCount<=1?(t.dtype!=="complex64"&&(this.state.numBytes-=e.bytes),this.state.numDataBuffers--,e.backend.disposeData(t.dataId),this.state.tensorInfo.delete(t.dataId)):this.state.tensorInfo.get(t.dataId).refCount--}},n.prototype.disposeVariables=function(){for(var t in this.state.registeredVariables){var e=this.state.registeredVariables[t];this.disposeVariable(e)}},n.prototype.disposeVariable=function(t){this.disposeTensor(t),this.state.registeredVariables[t.name]!=null&&delete this.state.registeredVariables[t.name]},n.prototype.memory=function(){var t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,t.reasons==null&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t},n.prototype.profile=function(t){return Te(this,void 0,void 0,function(){var e,r;return Ne(this,function(a){return this.state.profiling=!0,e=this.state.numBytes,r=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map(function(o){return o.totalBytesSnapshot})),this.state.activeProfile.newBytes=this.state.numBytes-e,this.state.activeProfile.newTensors=this.state.numTensors-r,[2,this.state.activeProfile]})})},n.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&this.state.kernelDepth===0},n.prototype.addTapeNode=function(t,e,r,a,o){var u=this,l={id:this.state.nextTapeNodeId++,kernelName:t,inputs:e,outputs:r,saved:o},c=RA(t);c!=null&&(a=c.gradFunc),a!=null&&(l.gradient=function(f){return f=f.map(function(h,p){if(h==null){var m=r[p],g=hl(m.size,m.dtype);return u.makeTensor(g,m.shape,m.dtype)}return h}),a(f.length>1?f:f[0],o)}),this.state.activeTape.push(l)},n.prototype.keep=function(t){return t.kept=!0,t},n.prototype.startTape=function(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++},n.prototype.endTape=function(){this.state.gradientDepth--},n.prototype.startScope=function(t){var e={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(e.name=t),this.state.scopeStack.push(e),this.state.activeScope=e},n.prototype.endScope=function(t){for(var e=this,r=Pw(t),a=new Set(r.map(function(c){return c.id})),o=0;o<this.state.activeScope.track.length;o++){var u=this.state.activeScope.track[o];u.kept||a.has(u.id)||u.dispose()}var l=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],r.forEach(function(c){c.kept||c.scopeId!==l.id||e.track(c)})},n.prototype.gradients=function(t,e,r,a){var o=this;if(a===void 0&&(a=!1),j(e.length>0,function(){return"gradients() received an empty list of xs."}),r!=null&&r.dtype!=="float32")throw new Error("dy must have 'float32' dtype, but has '"+r.dtype+"'");var u=this.scopedRun(function(){return o.startTape()},function(){return o.endTape()},function(){return o.tidy("forward",t)});j(u instanceof Mt,function(){return"The result y returned by f() must be a tensor."});var l=function(c,f,h){for(var p={},m={},g=0;g<f.length;g++)p[f[g].id]=!0;for(g=0;g<c.length;g++){var b=(D=c[g]).inputs;for(var x in b){for(var w=b[x],E=!1,C=0;C<f.length;C++)if(p[w.id]){D.outputs.forEach(function(O){return p[O.id]=!0}),E=!0,m[D.id]=!0;break}if(E)break}}var _={};_[h.id]=!0;var R={};for(g=c.length-1;g>=0;g--)for(b=(D=c[g]).inputs,C=0;C<D.outputs.length;C++)if(_[D.outputs[C].id]){for(var x in b)_[b[x].id]=!0,R[D.id]=!0;break}var A=[];for(g=0;g<c.length;g++){var D;if(m[(D=c[g]).id]&&R[D.id]){var M={};for(var x in D.inputs){var k=D.inputs[x];p[k.id]&&(M[x]=k)}var B=Object.assign({},D);B.inputs=M,B.outputs=D.outputs,A.push(B)}}return A}(this.state.activeTape,e,u);if(!a&&l.length===0&&e.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",function(){var c,f,h={};h[u.id]=r??(c=u.shape,f=Ow(ke(c),"float32"),Q.makeTensor(f,c,"float32")),function(m,g,b){for(var x=function(E){var C=g[E],_=[];if(C.outputs.forEach(function(M){var k=m[M.id];k!=null?_.push(k):_.push(null)}),C.gradient==null)throw new Error("Cannot compute gradient: gradient function not found for "+C.kernelName+".");var R=C.gradient(_),A=function(M){if(!(M in R))throw new Error("Cannot backprop through input "+M+". Available gradients found: "+Object.keys(R)+".");var k=b(function(){return R[M]()});if(k.dtype!=="float32")throw new Error("Error in gradient for op "+C.kernelName+". The gradient of input "+M+" must have 'float32' dtype, but has '"+k.dtype+"'");var B=C.inputs[M];if(!pn(k.shape,B.shape))throw new Error("Error in gradient for op "+C.kernelName+". The gradient of input '"+M+"' has shape '"+k.shape+"', which does not match the shape of the input '"+B.shape+"'");if(m[B.id]==null)m[B.id]=k;else{var O=m[B.id];m[B.id]=O.add(k),O.dispose()}};for(var D in C.inputs)A(D)},w=g.length-1;w>=0;w--)x(w)}(h,l,function(m){return o.tidy(m)});var p=e.map(function(m){return h[m.id]});return o.state.gradientDepth===0&&(o.state.activeTape.forEach(function(m){for(var g=0,b=m.saved;g<b.length;g++)b[g].dispose()}),o.state.activeTape=null),{value:u,grads:p}})},n.prototype.customGrad=function(t){var e=this;return j(Tv(t),function(){return"The f passed in customGrad(f) must be a function."}),function(){for(var r,a=[],o=0;o<arguments.length;o++)a[o]=arguments[o];j(a.every(function(l){return l instanceof Mt}),function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"});var u={};return a.forEach(function(l,c){u[c]=l}),e.runKernelFunc(function(l,c){return j((r=t.apply(void 0,a.concat([c]))).value instanceof Mt,function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"}),j(Tv(r.gradFunc),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."}),r.value},u,function(l,c){var f=r.gradFunc(l,c),h=Array.isArray(f)?f:[f];j(h.length===a.length,function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."}),j(h.every(function(m){return m instanceof Mt}),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."});var p={};return h.forEach(function(m,g){p[g]=function(){return m}}),p})}},n.prototype.readSync=function(t){return this.state.tensorInfo.get(t).backend.readSync(t)},n.prototype.read=function(t){return this.state.tensorInfo.get(t).backend.read(t)},n.prototype.time=function(t){return Te(this,void 0,void 0,function(){var e,r;return Ne(this,function(a){switch(a.label){case 0:return e=Zr(),[4,this.backend.time(t)];case 1:return(r=a.sent()).wallMs=Zr()-e,[2,r]}})})},n.prototype.track=function(t){return this.state.activeScope!=null&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t},Object.defineProperty(n.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),n.prototype.reset=function(){for(var t in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new Ux,this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},n.nextTensorId=0,n.nextVariableId=0,n}(),Q=function(){var n=function(){if(Lp==null){var e=void 0;if(typeof window<"u")e=window;else if(typeof global<"u")e=global;else if(typeof process<"u")e=process;else{if(typeof self>"u")throw new Error("Could not find a global object");e=self}Lp=e}return Lp}();if(n._tfengine==null){var t=new CA(n);n._tfengine=new WA(t)}return function(e){Rw=e}(n._tfengine.ENV),Jr=function(){return n._tfengine},n._tfengine}();function Lw(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}var Oa=fe();Oa.registerFlag("DEBUG",function(){return!1},function(n){n&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),Oa.registerFlag("IS_BROWSER",function(){return Lw()}),Oa.registerFlag("IS_NODE",function(){return typeof process<"u"&&process.versions!==void 0&&process.versions.node!==void 0}),Oa.registerFlag("IS_CHROME",function(){return typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}),Oa.registerFlag("PROD",function(){return!1}),Oa.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",function(){return Oa.getBool("DEBUG")}),Oa.registerFlag("DEPRECATION_WARNINGS_ENABLED",function(){return!0}),Oa.registerFlag("IS_TEST",function(){return!1});var tl,sr,or,ai={},zp={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function GA(n,t){ai[n]=t}function da(n){n in ai||(ai[n]=function(e){if(e!==1&&e!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var r=function(a){if(typeof OffscreenCanvas<"u"&&a===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(e);return r.addEventListener("webglcontextlost",function(a){a.preventDefault(),delete ai[e]},!1),e===1?r.getContext("webgl",zp)||r.getContext("experimental-webgl",zp):r.getContext("webgl2",zp)}(n));var t=ai[n];return t.isContextLost()?(delete ai[n],da(n)):(t.disable(t.DEPTH_TEST),t.disable(t.STENCIL_TEST),t.disable(t.BLEND),t.disable(t.DITHER),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SAMPLE_COVERAGE),t.enable(t.SCISSOR_TEST),t.enable(t.CULL_FACE),t.cullFace(t.BACK),ai[n])}function Yf(n,t){return[t,n]}function Ku(n){var t=ke(n);return Av(Math.ceil(t/4))}function pl(n,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(n/2))]}function gm(n,t){var e,r,a,o,u,l,c,f,h,p=n;return fe().getNumber("WEBGL_VERSION")===2?(e=p.R32F,r=p.R16F,a=p.RGBA16F,o=p.RGBA32F,u=p.RED,l=4,c=1,f=p.HALF_FLOAT,h=p.FLOAT):(e=n.RGBA,r=n.RGBA,a=n.RGBA,o=p.RGBA,u=n.RGBA,l=4,c=4,f=t!=null?t.HALF_FLOAT_OES:null,h=n.FLOAT),{internalFormatFloat:e,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:a,internalFormatPackedFloat:o,textureFormatFloat:u,downloadTextureFormat:n.RGBA,downloadUnpackNumChannels:l,defaultNumChannels:c,textureTypeHalfFloat:f,textureTypeFloat:h}}function Me(n,t,e){var r=e();return t&&function(a){var o=a.getError();if(o!==a.NO_ERROR)throw new Error("WebGL Error: "+KA(a,o))}(n),r}(function(n){n[n.DENSE=0]="DENSE",n[n.SHARED_BATCH=1]="SHARED_BATCH"})(tl||(tl={})),function(n){n[n.RENDER=0]="RENDER",n[n.UPLOAD=1]="UPLOAD",n[n.PIXELS=2]="PIXELS",n[n.DOWNLOAD=3]="DOWNLOAD"}(sr||(sr={})),function(n){n[n.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",n[n.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",n[n.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",n[n.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",n[n.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(or||(or={}));var qA=596e-10,XA=65504;function YA(n){return!!(fe().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||n===0||qA<Math.abs(n)&&Math.abs(n)<XA)}function KA(n,t){switch(t){case n.NO_ERROR:return"NO_ERROR";case n.INVALID_ENUM:return"INVALID_ENUM";case n.INVALID_VALUE:return"INVALID_VALUE";case n.INVALID_OPERATION:return"INVALID_OPERATION";case n.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case n.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case n.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+t}}function Uc(n,t,e){return za(n,t,function(){return n.getExtension(e)},'Extension "'+e+'" not supported on this browser.')}function QA(n,t,e){var r=za(n,t,function(){return n.createShader(n.VERTEX_SHADER)},"Unable to create vertex WebGLShader.");if(Me(n,t,function(){return n.shaderSource(r,e)}),Me(n,t,function(){return n.compileShader(r)}),n.getShaderParameter(r,n.COMPILE_STATUS)===!1)throw console.log(n.getShaderInfoLog(r)),new Error("Failed to compile vertex shader.");return r}function $A(n,t,e){var r=za(n,t,function(){return n.createShader(n.FRAGMENT_SHADER)},"Unable to create fragment WebGLShader.");if(Me(n,t,function(){return n.shaderSource(r,e)}),Me(n,t,function(){return n.compileShader(r)}),n.getShaderParameter(r,n.COMPILE_STATUS)===!1)throw function(a,o){var u=ZA.exec(o);if(u==null)return console.log("Couldn't parse line number in error: "+o),void console.log(a);for(var l=+u[1],c=a.split(`
`),f=c.length.toString().length+2,h=c.map(function(w,E){return xs((E+1).toString(),f)+w}),p=0,m=0;m<h.length;m++)p=Math.max(h[m].length,p);var g=h.slice(0,l-1),b=h.slice(l-1,l),x=h.slice(l);console.log(g.join(`
`)),console.log(o.split(`
`)[0]),console.log("%c "+xs(b[0],p),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(x.join(`
`))}(e,n.getShaderInfoLog(r)),new Error("Failed to compile fragment shader.");return r}var Up,jp,ZA=/ERROR: [0-9]+:([0-9]+):/g;function JA(n,t){return za(n,t,function(){return n.createProgram()},"Unable to create WebGLProgram.")}function eT(n,t,e){if(Me(n,t,function(){return n.linkProgram(e)}),n.getProgramParameter(e,n.LINK_STATUS)===!1)throw console.log(n.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function Hp(n,t,e){if(Me(n,t,function(){return n.validateProgram(e)}),n.getProgramParameter(e,n.VALIDATE_STATUS)===!1)throw console.log(n.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function tT(n,t,e){var r=za(n,t,function(){return n.createBuffer()},"Unable to create WebGLBuffer");return Me(n,t,function(){return n.bindBuffer(n.ARRAY_BUFFER,r)}),Me(n,t,function(){return n.bufferData(n.ARRAY_BUFFER,e,n.STATIC_DRAW)}),r}function nT(n,t,e){var r=za(n,t,function(){return n.createBuffer()},"Unable to create WebGLBuffer");return Me(n,t,function(){return n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,r)}),Me(n,t,function(){return n.bufferData(n.ELEMENT_ARRAY_BUFFER,e,n.STATIC_DRAW)}),r}function rT(n,t){return za(n,t,function(){return n.createTexture()},"Unable to create WebGLTexture.")}function aT(n,t){var e=fe().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(n<=0||t<=0){var r="["+n+"x"+t+"]";throw new Error("Requested texture size "+r+" is invalid.")}if(n>e||t>e)throw r="["+n+"x"+t+"]",new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+("["+e+"x"+e+"]")+".")}function oT(n,t){return za(n,t,function(){return n.createFramebuffer()},"Unable to create WebGLFramebuffer.")}function jx(n,t,e,r,a,o,u,l){var c=n.getAttribLocation(e,r);return c!==-1&&(Me(n,t,function(){return n.bindBuffer(n.ARRAY_BUFFER,a)}),Me(n,t,function(){return n.vertexAttribPointer(c,o,n.FLOAT,!1,u,l)}),Me(n,t,function(){return n.enableVertexAttribArray(c)}),!0)}function iT(n,t,e,r){fT(n,r),Me(n,t,function(){return n.activeTexture(n.TEXTURE0+r)}),Me(n,t,function(){return n.bindTexture(n.TEXTURE_2D,e)})}function sT(n,t,e,r){return za(n,t,function(){return n.getUniformLocation(e,r)},'uniform "'+r+'" not present in program.')}function uT(n,t,e){return n.getUniformLocation(t,e)}function lT(n,t,e,r,a,o){Me(n,t,function(){return iT(n,t,r,o)}),Me(n,t,function(){return n.uniform1i(a,o)})}function Vp(n,t,e,r){Me(n,t,function(){return n.bindFramebuffer(n.FRAMEBUFFER,r)}),Me(n,t,function(){return n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,e,0)})}function Hx(n,t,e){Me(n,t,function(){return n.bindFramebuffer(n.FRAMEBUFFER,e)}),Me(n,t,function(){return n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,null,0)})}function jc(n){var t=n.checkFramebufferStatus(n.FRAMEBUFFER);if(t!==n.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+cT(n,t))}function cT(n,t){switch(t){case n.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case n.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case n.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case n.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+t}}function za(n,t,e,r){var a=Me(n,t,function(){return e()});if(a==null)throw new Error(r);return a}function fT(n,t){var e=n.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+n.TEXTURE0;if(r<n.TEXTURE0||r>e)throw new Error("textureUnit must be in "+("[gl.TEXTURE0, gl.TEXTURE"+e+"]")+".")}function xf(n,t){return t===void 0&&(t=2),ke(n.slice(0,n.length-t))}function wf(n){if(n.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[n.length>1?n[n.length-2]:1,n[n.length-1]]}function Wp(n){var t=[1,1,1];return n.length===0||n.length===1&&n[0]===1||(t=[xf(n)].concat(wf(n))),t}function dT(n,t){var e;t===void 0&&(t=!1);var r=fe().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t&&(r*=2,(n=n.map(function(f,h){return h>=n.length-2?Dw(n[h]):n[h]})).length===1&&(n=[2,n[0]])),n.length!==2){var a=ii(n);n=a.newShape}var o=ke(n);if(n.length<=1&&o<=r)return[1,o];if(n.length===2&&n[0]<=r&&n[1]<=r)return n;if(n.length===3&&n[0]*n[1]<=r&&n[2]<=r)return[n[0]*n[1],n[2]];if(n.length===3&&n[0]<=r&&n[1]*n[2]<=r)return[n[0],n[1]*n[2]];if(n.length===4&&n[0]*n[1]*n[2]<=r&&n[3]<=r)return[n[0]*n[1]*n[2],n[3]];if(n.length===4&&n[0]<=r&&n[1]*n[2]*n[3]<=r)return[n[0],n[1]*n[2]*n[3]];if(t){var u=xf(n),l=2,c=2;return n.length&&(l=(e=wf(n))[0],c=e[1]),Av(o=u*(l/2)*(c/2)).map(function(f){return 2*f})}return Av(o)}function Hc(n){return n%2==0}function Vc(n,t){if(pn(n=n.slice(-2),t=t.slice(-2))||!n.length||!t.length||n[0]===0||n[1]===0||t[0]===0||t[1]===0)return!0;if(n.length!==t.length){var e=n.slice(-1)[0],r=t.slice(-1)[0];if(e===r||Hc(e)&&Hc(r)&&(n[0]===1||t[0]===1))return!0}return n[1]===t[1]&&Hc(n[0])&&Hc(t[0])}function hT(n){if(Up==null){var t=da(n);Up=t.getParameter(t.MAX_TEXTURE_SIZE)}return Up}function pT(n){if(jp==null){var t=da(n);jp=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,jp)}function vT(n){if(n===0)return 0;var t=da(n);return Rr(t,"EXT_disjoint_timer_query_webgl2")&&n===2?2:Rr(t,"EXT_disjoint_timer_query")?1:0}function Rr(n,t){return n.getExtension(t)!=null}function Vx(n){try{if(da(n)!=null)return!0}catch{return!1}return!1}function mT(n){if(n===0)return!1;var t=da(n);if(n===1){if(!Rr(t,"OES_texture_float"))return!1}else if(!Rr(t,"EXT_color_buffer_float"))return!1;return Iv(t)}function gT(n){if(n===0)return!1;var t=da(n);if(n!==1){if(Rr(t,"EXT_color_buffer_float"))return Iv(t);if(Rr(t,"EXT_color_buffer_half_float")){var e=t.getExtension("EXT_color_buffer_half_float");return function(r,a){var o=gm(r,a),u=r.createTexture();r.bindTexture(r.TEXTURE_2D,u),r.texImage2D(r.TEXTURE_2D,0,o.internalFormatHalfFloat,1,1,0,o.textureFormatFloat,o.textureTypeHalfFloat,null);var l=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,l),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,u,0);var c=r.checkFramebufferStatus(r.FRAMEBUFFER)===r.FRAMEBUFFER_COMPLETE;return r.bindTexture(r.TEXTURE_2D,null),r.bindFramebuffer(r.FRAMEBUFFER,null),r.deleteTexture(u),r.deleteFramebuffer(l),c}(t,e)}return!1}return!!Rr(t,"OES_texture_float")&&!!Rr(t,"WEBGL_color_buffer_float")&&Iv(t)}function Iv(n){var t=gm(n),e=n.createTexture();n.bindTexture(n.TEXTURE_2D,e),n.texImage2D(n.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);var r=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,r),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,e,0);var a=n.checkFramebufferStatus(n.FRAMEBUFFER)===n.FRAMEBUFFER_COMPLETE;return n.bindTexture(n.TEXTURE_2D,null),n.bindFramebuffer(n.FRAMEBUFFER,null),n.deleteTexture(e),n.deleteFramebuffer(r),a}function yT(n){return n===2&&da(n).fenceSync!=null}var je=fe();function zw(n){fe().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(n+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function Ce(n,t){return Q.tidy(n,t)}function Xn(n){Pw(n).forEach(function(t){return t.dispose()})}function bT(n){return Q.keep(n)}function Sf(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];fe().getBool("IS_TEST")||console.warn.apply(console,n)}function Do(n,t){var e=n;if(aa(n))return t==="string"?[]:[n.length];if(!Array.isArray(n))return[];for(var r=[];Array.isArray(e)||aa(e)&&t!=="string";)r.push(e.length),e=e[0];return Array.isArray(n)&&fe().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function a(o,u,l){if(l=l||[],!Array.isArray(o)&&!aa(o))return void j(u.length===0,function(){return"Element arr["+l.join("][")+"] is a primitive, but should be an array/TypedArray of "+u[0]+" elements"});j(u.length>0,function(){return"Element arr["+l.join("][")+"] should be a primitive, but is an array of "+o.length+" elements"}),j(o.length===u[0],function(){return"Element arr["+l.join("][")+"] should have "+u[0]+" elements, but has "+o.length+" elements"});for(var c=u.slice(1),f=0;f<o.length;++f)a(o[f],c,l.concat(f))}(n,r,[]),r}function Wx(n,t,e,r){if(n!=null&&(n!=="numeric"&&n!==t||n==="numeric"&&t==="string"))throw new Error("Argument '"+e+"' passed to '"+r+"' must be "+n+" tensor, but got "+t+" tensor")}function z(n,t,e,r){if(r===void 0&&(r="numeric"),n instanceof Mt)return Wx(r,n.dtype,t,e),n;var a=dl(n);if(a!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(a=r),Wx(r,a,t,e),n==null||!aa(n)&&!Array.isArray(n)&&typeof n!="number"&&typeof n!="boolean"&&typeof n!="string"){var o=n==null?"null":n.constructor.name;throw new Error("Argument '"+t+"' passed to '"+e+"' must be a Tensor or TensorLike, but got '"+o+"'")}var u=Do(n,a);aa(n)||Array.isArray(n)||(n=[n]);var l=a!=="string"?Mw(n,a,fe().getBool("DEBUG")):Ns(n,[],!0);return Q.makeTensor(l,u,a)}function Ef(n,t,e,r){if(r===void 0&&(r="numeric"),!Array.isArray(n))throw new Error("Argument "+t+" passed to "+e+" must be a `Tensor[]` or `TensorLike[]`");return n.map(function(a,o){return z(a,t+"["+o+"]",e)},r)}function Uw(n,t){for(var e=0;e<n.length;++e)if(n[n.length-e-1]!==t-1-e)return!1;return!0}function xT(n,t,e){for(var r=n.length+t.length,a=[],o=0,u=0,l=0;l<r;l++)e.indexOf(l)===-1?a.push(n[o++]):a.push(t[u++]);return a}function Tn(n,t){for(var e=[],r=n.length,a=0;a<r;a++)t.indexOf(a)===-1&&e.push(n[a]);return[e,t.map(function(o){return n[o]})]}function Yn(n,t){return xT(n,t.map(function(e){return 1}),t)}function ar(n,t,e){j(Uw(t,e),function(){return n+" supports only inner-most axes for now. Got axes "+t+" and rank-"+e+" input."})}function ha(n,t){if(Uw(n,t))return null;for(var e=[],r=0;r<t;++r)n.indexOf(r)===-1&&e.push(r);return n.forEach(function(a){return e.push(a)}),e}function ym(n){return n.map(function(t,e){return[e,t]}).sort(function(t,e){return t[1]-e[1]}).map(function(t){return t[0]})}function pa(n,t){for(var e=[],r=t-n;r<t;++r)e.push(r);return e}function wT(n,t){var e=n[0].length;n.forEach(function(a,o){j(a.length===e,function(){return"Error in concat"+e+"D: rank of tensors["+o+"] must be the same as the rank of the rest ("+e+")"})}),j(t>=0&&t<e,function(){return"Error in concat"+e+"D: axis must be between 0 and "+(e-1)+"."});var r=n[0];n.forEach(function(a,o){for(var u=0;u<e;u++)j(u===t||a[u]===r[u],function(){return"Error in concat"+e+"D: Shape of tensors["+o+"] ("+a+") does not match the shape of the rest ("+r+") along the non-concatenated axis "+o+"."})})}function ks(n,t){for(var e=n[0].slice(),r=1;r<n.length;r++)e[t]+=n[r][t];return e}function X(n){var t=Object.keys(n);if(t.length!==1)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+t.length+" keys.");var e=t[0],r=n[e];e.endsWith("_")&&(e=e.substring(0,e.length-1));var a=function(){for(var o=[],u=0;u<arguments.length;u++)o[u]=arguments[u];Q.startScope(e);try{var l=r.apply(void 0,o);return l instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),Q.endScope(l),l}catch(c){throw Q.endScope(null),c}};return Object.defineProperty(a,"name",{value:e,configurable:!0}),a}je.registerFlag("HAS_WEBGL",function(){return je.getNumber("WEBGL_VERSION")>0}),je.registerFlag("WEBGL_VERSION",function(){return Vx(2)?2:Vx(1)?1:0}),je.registerFlag("WEBGL_BUFFER_SUPPORTED",function(){return je.get("WEBGL_VERSION")===2}),je.registerFlag("WEBGL_CPU_FORWARD",function(){return!0}),je.registerFlag("WEBGL_FORCE_F16_TEXTURES",function(){return!1}),je.registerFlag("WEBGL_PACK",function(){return je.getBool("HAS_WEBGL")}),je.registerFlag("WEBGL_PACK_NORMALIZATION",function(){return je.getBool("WEBGL_PACK")}),je.registerFlag("WEBGL_PACK_CLIP",function(){return je.getBool("WEBGL_PACK")}),je.registerFlag("WEBGL_PACK_DEPTHWISECONV",function(){return!1}),je.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",function(){return je.getBool("WEBGL_PACK")}),je.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",function(){return je.getBool("WEBGL_PACK")}),je.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",function(){return je.getBool("WEBGL_PACK")}),je.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",function(){return je.getBool("WEBGL_PACK")}),je.registerFlag("WEBGL_PACK_REDUCE",function(){return je.getBool("WEBGL_PACK")}),je.registerFlag("WEBGL_LAZILY_UNPACK",function(){return je.getBool("WEBGL_PACK")}),je.registerFlag("WEBGL_CONV_IM2COL",function(){return je.getBool("WEBGL_PACK")}),je.registerFlag("WEBGL_MAX_TEXTURE_SIZE",function(){return hT(je.getNumber("WEBGL_VERSION"))}),je.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",function(){return pT(je.getNumber("WEBGL_VERSION"))}),je.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",function(){var n=je.getNumber("WEBGL_VERSION");return n===0?0:vT(n)}),je.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",function(){return je.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&(n=navigator.userAgent||navigator.vendor||window.opera,!(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(n)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(n.substr(0,4))));var n}),je.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",function(){return mT(je.getNumber("WEBGL_VERSION"))}),je.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",function(){return!je.getBool("WEBGL_FORCE_F16_TEXTURES")&&je.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")}),je.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",function(){return gT(je.getNumber("WEBGL_VERSION"))}),je.registerFlag("WEBGL_FENCE_API_ENABLED",function(){return yT(je.getNumber("WEBGL_VERSION"))}),je.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",function(){return je.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0}),Fw=zw;var wn=X({complex_:function(n,t){var e=z(n,"real","complex"),r=z(t,"imag","complex");return ft(e.shape,r.shape,"real and imag shapes, "+e.shape+" and "+r.shape+", must match in call to tf.complex()."),Q.runKernelFunc(function(a){return a.complex(e,r)},{$real:e,$imag:r})}}),_r=X({real_:function(n){var t=z(n,"input","real");return Q.runKernelFunc(function(e){return e.real(t)},{$input:t})}}),ea=X({imag_:function(n){var t=z(n,"input","imag");return Q.runKernelFunc(function(e){return e.imag(t)},{$input:t})}});function En(n,t,e){return ko(n,t,Do(n,e),e)}function ko(n,t,e,r){if(r==null&&(r=dl(n)),r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!aa(n)&&!Array.isArray(n)&&typeof n!="number"&&typeof n!="boolean"&&typeof n!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(t!=null){Iw(t);var a=ke(t),o=ke(e);j(a===o,function(){return"Based on the provided shape, ["+t+"], the tensor should have "+a+" values but has "+o});for(var u=0;u<e.length;++u){var l=e[u],c=u!==e.length-1||l!==ke(t.slice(u));j(e[u]===t[u]||!c,function(){return"Error creating a new Tensor. Inferred shape ("+e+") does not match the provided shape ("+t+"). "})}}return aa(n)||Array.isArray(n)||(n=[n]),t=t||e,n=r!=="string"?Mw(n,r,fe().getBool("DEBUG")):Ns(n,[],!0),Q.makeTensor(n,t,r)}function Se(n,t){if((aa(n)&&t!=="string"||Array.isArray(n))&&t!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(t==="string"&&aa(n)&&!(n instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return ko(n,[],[],t)}function Yt(n,t){Fs(n);var e=Do(n,t);if(e.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return ko(n,null,e,t)}function Eo(n,t,e){if(Fs(n),t!=null&&t.length!==2)throw new Error("tensor2d() requires shape to have two numbers");var r=Do(n,e);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return ko(n,t,r,e)}function bm(n,t,e){if(Fs(n),t!=null&&t.length!==3)throw new Error("tensor3d() requires shape to have three numbers");var r=Do(n,e);if(r.length!==3&&r.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return ko(n,t,r,e)}function Gn(n,t,e){if(Fs(n),t!=null&&t.length!==4)throw new Error("tensor4d() requires shape to have four numbers");var r=Do(n,e);if(r.length!==4&&r.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return ko(n,t,r,e)}function ST(n,t,e){if(Fs(n),t!=null&&t.length!==5)throw new Error("tensor5d() requires shape to have five numbers");var r=Do(n,e);if(r.length!==5&&r.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return ko(n,t,r,e)}function ET(n,t,e){if(Fs(n),t!=null&&t.length!==6)throw new Error("tensor6d() requires shape to have six numbers");var r=Do(n,e);if(r.length!==6&&r.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return ko(n,t=t||r,r,e)}function CT(n,t,e,r){return t===void 0&&(t=!0),Q.makeVariable(n,t,e,r)}function Ps(n,t){if(t===void 0&&(t="float32"),t==="complex64"){var e=Ps(n,"float32"),r=_t(n,"float32");return wn(e,r)}var a=Ow(ke(n),t);return Q.makeTensor(a,n,t)}function _t(n,t){if(t===void 0&&(t="float32"),t==="complex64"){var e=_t(n,"float32"),r=_t(n,"float32");return wn(e,r)}var a=hl(ke(n),t);return Q.makeTensor(a,n,t)}function ia(n,t,e){return Q.runKernelFunc(function(r){return r.fill(n,t,e)},{})}function _T(n,t,e){if(e<=0)throw new Error("The number of values should be positive.");return Q.runKernelFunc(function(r){return r.linspace(n,t,e)},{})}function Cf(n,t,e,r){if(e===void 0&&(e=1),r===void 0&&(r="float32"),e===0)throw new Error("Cannot have a step of zero");if(n===t||n<t&&e<0||t<n&&e>1)return _t([0],r);var a=hl(Math.abs(Math.ceil((t-n)/e)),r);t<n&&e===1&&(e=-1),a[0]=n;for(var o=1;o<a.length;o++)a[o]=a[o-1]+e;return Yt(a,r)}var jw=X({onesLike_:function(n){var t=z(n,"x","onesLike");if(t.dtype==="complex64"){var e=jw(_r(t)),r=ot(ea(t));return wn(e,r)}return Q.runKernelFunc(function(a){return a.onesLike(t)},{$x:t},function(a,o){return{$x:function(){return ot(a)}}})}}),ot=X({zerosLike_:function(n){var t=z(n,"x","zerosLike");return Q.runKernelFunc(function(e){return e.zerosLike(t)},{$x:t},function(e,r){return{$x:function(){return ot(e)}}})}}),nn=X({concat_:function(n,t){t===void 0&&(t=0),j(n.length>=1,function(){return"Pass at least one tensor to concat"});var e=Ef(n,"tensors","concat");e[0].dtype==="complex64"&&e.forEach(function(l){if(l.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype `+l.dtype+". ")}),t=sn(t,e[0].shape)[0];var r=ks(e.map(function(l){return l.shape}),t);if(ke(r)===0)return En([],r);if((e=e.filter(function(l){return l.size>0})).length===1)return e[0];var a=e.map(function(l){return l.shape});wT(a,t);var o=e,u={axis:t};return Q.runKernelFunc(function(l){return l.concat(e,t)},o,function(l){var c=a.map(function(f){return f[t]});return xm(l,c,t).map(function(f){return function(){return f}})},"Concat",u)}}),RT=X({concat1d_:function(n){return nn(n,0)}}),AT=X({concat2d_:function(n,t){return nn(n,t)}}),TT=X({concat3d_:function(n,t){return nn(n,t)}}),NT=X({concat4d_:function(n,t){return nn(n,t)}}),xm=X({split_:function(n,t,e){e===void 0&&(e=0);var r,a=z(n,"x","split");return e=sn(e,a.shape)[0],typeof t=="number"?(j(a.shape[e]%t==0,function(){return"Number of splits must evenly divide the axis."}),r=new Array(t).fill(a.shape[e]/t)):(j(a.shape[e]===t.reduce(function(o,u){return o+u}),function(){return"The sum of sizes must match the size of the axis dimension."}),r=t),Q.runKernelFunc(function(o){return o.split(a,r,e)},{$x:a},function(o){return{$x:function(){return nn(o,e)}}})}});function vi(n,t){return n(t={exports:{}},t.exports),t.exports}var DT=vi(function(n){(function(t,e,r){function a(l){var c,f=this,h=(c=4022871197,function(p){p=p.toString();for(var m=0;m<p.length;m++){var g=.02519603282416938*(c+=p.charCodeAt(m));g-=c=g>>>0,c=(g*=c)>>>0,c+=4294967296*(g-=c)}return 23283064365386963e-26*(c>>>0)});f.next=function(){var p=2091639*f.s0+23283064365386963e-26*f.c;return f.s0=f.s1,f.s1=f.s2,f.s2=p-(f.c=0|p)},f.c=1,f.s0=h(" "),f.s1=h(" "),f.s2=h(" "),f.s0-=h(l),f.s0<0&&(f.s0+=1),f.s1-=h(l),f.s1<0&&(f.s1+=1),f.s2-=h(l),f.s2<0&&(f.s2+=1),h=null}function o(l,c){return c.c=l.c,c.s0=l.s0,c.s1=l.s1,c.s2=l.s2,c}function u(l,c){var f=new a(l),h=c&&c.state,p=f.next;return p.int32=function(){return 4294967296*f.next()|0},p.double=function(){return p()+11102230246251565e-32*(2097152*p()|0)},p.quick=p,h&&(typeof h=="object"&&o(h,f),p.state=function(){return o(f,{})}),p}e&&e.exports?e.exports=u:this.alea=u})(0,n)}),kT=vi(function(n){(function(t,e,r){function a(l){var c=this,f="";c.x=0,c.y=0,c.z=0,c.w=0,c.next=function(){var p=c.x^c.x<<11;return c.x=c.y,c.y=c.z,c.z=c.w,c.w^=c.w>>>19^p^p>>>8},l===(0|l)?c.x=l:f+=l;for(var h=0;h<f.length+64;h++)c.x^=0|f.charCodeAt(h),c.next()}function o(l,c){return c.x=l.x,c.y=l.y,c.z=l.z,c.w=l.w,c}function u(l,c){var f=new a(l),h=c&&c.state,p=function(){return(f.next()>>>0)/4294967296};return p.double=function(){do var m=((f.next()>>>11)+(f.next()>>>0)/4294967296)/2097152;while(m===0);return m},p.int32=f.next,p.quick=p,h&&(typeof h=="object"&&o(h,f),p.state=function(){return o(f,{})}),p}e&&e.exports?e.exports=u:this.xor128=u})(0,n)}),MT=vi(function(n){(function(t,e,r){function a(l){var c=this,f="";c.next=function(){var p=c.x^c.x>>>2;return c.x=c.y,c.y=c.z,c.z=c.w,c.w=c.v,(c.d=c.d+362437|0)+(c.v=c.v^c.v<<4^p^p<<1)|0},c.x=0,c.y=0,c.z=0,c.w=0,c.v=0,l===(0|l)?c.x=l:f+=l;for(var h=0;h<f.length+64;h++)c.x^=0|f.charCodeAt(h),h==f.length&&(c.d=c.x<<10^c.x>>>4),c.next()}function o(l,c){return c.x=l.x,c.y=l.y,c.z=l.z,c.w=l.w,c.v=l.v,c.d=l.d,c}function u(l,c){var f=new a(l),h=c&&c.state,p=function(){return(f.next()>>>0)/4294967296};return p.double=function(){do var m=((f.next()>>>11)+(f.next()>>>0)/4294967296)/2097152;while(m===0);return m},p.int32=f.next,p.quick=p,h&&(typeof h=="object"&&o(h,f),p.state=function(){return o(f,{})}),p}e&&e.exports?e.exports=u:this.xorwow=u})(0,n)}),OT=vi(function(n){(function(t,e,r){function a(l){var c=this;c.next=function(){var f,h,p=c.x,m=c.i;return f=p[m],h=(f^=f>>>7)^f<<24,h^=(f=p[m+1&7])^f>>>10,h^=(f=p[m+3&7])^f>>>3,h^=(f=p[m+4&7])^f<<7,f=p[m+7&7],h^=(f^=f<<13)^f<<9,p[m]=h,c.i=m+1&7,h},function(f,h){var p,m=[];if(h===(0|h))m[0]=h;else for(h=""+h,p=0;p<h.length;++p)m[7&p]=m[7&p]<<15^h.charCodeAt(p)+m[p+1&7]<<13;for(;m.length<8;)m.push(0);for(p=0;p<8&&m[p]===0;++p);for(p==8?m[7]=-1:m[p],f.x=m,f.i=0,p=256;p>0;--p)f.next()}(c,l)}function o(l,c){return c.x=l.x.slice(),c.i=l.i,c}function u(l,c){l==null&&(l=+new Date);var f=new a(l),h=c&&c.state,p=function(){return(f.next()>>>0)/4294967296};return p.double=function(){do var m=((f.next()>>>11)+(f.next()>>>0)/4294967296)/2097152;while(m===0);return m},p.int32=f.next,p.quick=p,h&&(h.x&&o(h,f),p.state=function(){return o(f,{})}),p}e&&e.exports?e.exports=u:this.xorshift7=u})(0,n)}),IT=vi(function(n){(function(t,e,r){function a(l){var c=this;c.next=function(){var f,h,p=c.w,m=c.X,g=c.i;return c.w=p=p+1640531527|0,h=m[g+34&127],f=m[g=g+1&127],h^=h<<13,f^=f<<17,h^=h>>>15,f^=f>>>12,h=m[g]=h^f,c.i=g,h+(p^p>>>16)|0},function(f,h){var p,m,g,b,x,w=[],E=128;for(h===(0|h)?(m=h,h=null):(h+="\0",m=0,E=Math.max(E,h.length)),g=0,b=-32;b<E;++b)h&&(m^=h.charCodeAt((b+32)%h.length)),b===0&&(x=m),m^=m<<10,m^=m>>>15,m^=m<<4,m^=m>>>13,b>=0&&(x=x+1640531527|0,g=(p=w[127&b]^=m+x)==0?g+1:0);for(g>=128&&(w[127&(h&&h.length||0)]=-1),g=127,b=512;b>0;--b)m=w[g+34&127],p=w[g=g+1&127],m^=m<<13,p^=p<<17,m^=m>>>15,p^=p>>>12,w[g]=m^p;f.w=x,f.X=w,f.i=g}(c,l)}function o(l,c){return c.i=l.i,c.w=l.w,c.X=l.X.slice(),c}function u(l,c){l==null&&(l=+new Date);var f=new a(l),h=c&&c.state,p=function(){return(f.next()>>>0)/4294967296};return p.double=function(){do var m=((f.next()>>>11)+(f.next()>>>0)/4294967296)/2097152;while(m===0);return m},p.int32=f.next,p.quick=p,h&&(h.X&&o(h,f),p.state=function(){return o(f,{})}),p}e&&e.exports?e.exports=u:this.xor4096=u})(0,n)}),BT=vi(function(n){(function(t,e,r){function a(l){var c=this,f="";c.next=function(){var p=c.b,m=c.c,g=c.d,b=c.a;return p=p<<25^p>>>7^m,m=m-g|0,g=g<<24^g>>>8^b,b=b-p|0,c.b=p=p<<20^p>>>12^m,c.c=m=m-g|0,c.d=g<<16^m>>>16^b,c.a=b-p|0},c.a=0,c.b=0,c.c=-1640531527,c.d=1367130551,l===Math.floor(l)?(c.a=l/4294967296|0,c.b=0|l):f+=l;for(var h=0;h<f.length+20;h++)c.b^=0|f.charCodeAt(h),c.next()}function o(l,c){return c.a=l.a,c.b=l.b,c.c=l.c,c.d=l.d,c}function u(l,c){var f=new a(l),h=c&&c.state,p=function(){return(f.next()>>>0)/4294967296};return p.double=function(){do var m=((f.next()>>>11)+(f.next()>>>0)/4294967296)/2097152;while(m===0);return m},p.int32=f.next,p.quick=p,h&&(typeof h=="object"&&o(h,f),p.state=function(){return o(f,{})}),p}e&&e.exports?e.exports=u:this.tychei=u})(0,n)}),oi=vi(function(n){(function(t,e){var r,a=this,o=256,u=6,l="random",c=e.pow(o,u),f=e.pow(2,52),h=2*f,p=o-1;function m(E,C,_){var R=[],A=x(function k(B,O){var V,H=[],ee=typeof B;if(O&&ee=="object")for(V in B)try{H.push(k(B[V],O-1))}catch{}return H.length?H:ee=="string"?B:B+"\0"}((C=C==1?{entropy:!0}:C||{}).entropy?[E,w(t)]:E??function(){try{var k;return r&&(k=r.randomBytes)?k=k(o):(k=new Uint8Array(o),(a.crypto||a.msCrypto).getRandomValues(k)),w(k)}catch{var B=a.navigator,O=B&&B.plugins;return[+new Date,a,O,a.screen,w(t)]}}(),3),R),D=new g(R),M=function(){for(var k=D.g(u),B=c,O=0;k<f;)k=(k+O)*o,B*=o,O=D.g(1);for(;k>=h;)k/=2,B/=2,O>>>=1;return(k+O)/B};return M.int32=function(){return 0|D.g(4)},M.quick=function(){return D.g(4)/4294967296},M.double=M,x(w(D.S),t),(C.pass||_||function(k,B,O,V){return V&&(V.S&&b(V,D),k.state=function(){return b(D,{})}),O?(e[l]=k,B):k})(M,A,"global"in C?C.global:this==e,C.state)}function g(E){var C,_=E.length,R=this,A=0,D=R.i=R.j=0,M=R.S=[];for(_||(E=[_++]);A<o;)M[A]=A++;for(A=0;A<o;A++)M[A]=M[D=p&D+E[A%_]+(C=M[A])],M[D]=C;(R.g=function(k){for(var B,O=0,V=R.i,H=R.j,ee=R.S;k--;)B=ee[V=p&V+1],O=O*o+ee[p&(ee[V]=ee[H=p&H+B])+(ee[H]=B)];return R.i=V,R.j=H,O})(o)}function b(E,C){return C.i=E.i,C.j=E.j,C.S=E.S.slice(),C}function x(E,C){for(var _,R=E+"",A=0;A<R.length;)C[p&A]=p&(_^=19*C[p&A])+R.charCodeAt(A++);return w(C)}function w(E){return String.fromCharCode.apply(0,E)}if(e["seed"+l]=m,x(e.random(),t),n.exports){n.exports=m;try{r=require("crypto")}catch{}}})([],Math)});oi.alea=DT,oi.xor128=kT,oi.xorwow=MT,oi.xorshift7=OT,oi.xor4096=IT,oi.tychei=BT;var Kf=oi.alea,wm=function(){function n(t,e,r,a,o){this.mean=t,this.stdDev=e,this.dtype=r,this.nextVal=NaN,this.truncated=a,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var u=o||Math.random();this.random=Kf(u.toString())}return n.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var t=this.nextVal;return this.nextVal=NaN,t}for(var e,r,a=!1;!a;){var o=void 0,u=void 0,l=void 0;do l=(o=2*this.random()-1)*o+(u=2*this.random()-1)*u;while(l>=1||l===0);var c=Math.sqrt(-2*Math.log(l)/l);e=this.mean+this.stdDev*o*c,r=this.mean+this.stdDev*u*c,this.truncated&&!this.isValidTruncated(e)||(a=!0)}return this.truncated&&!this.isValidTruncated(r)||(this.nextVal=this.convertValue(r)),this.convertValue(e)},n.prototype.convertValue=function(t){return this.dtype==null||this.dtype==="float32"?t:Math.round(t)},n.prototype.isValidTruncated=function(t){return t<=this.upper&&t>=this.lower},n}(),FT=function(){function n(t,e,r,a){this.alpha=t,this.beta=1/e,this.dtype=r;var o=a||Math.random();this.randu=Kf(o.toString()),this.randn=new wm(0,1,r,!1,this.randu()),this.d=t<1?t+2/3:t-1/3,this.c=1/Math.sqrt(9*this.d)}return n.prototype.nextValue=function(){for(var t,e,r,a,o,u;;){do a=this.randn.nextValue(),u=1+this.c*a;while(u<=0);if(u*=u*u,e=1-.331*(t=a*a)*t,r=.5*t+this.d*(1-u+Math.log(u)),(o=this.randu())<e||Math.log(o)<r)break}return u=1/this.beta*this.d*u,this.alpha<1&&(u*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(u)},n.prototype.convertValue=function(t){return this.dtype==="float32"?t:Math.round(t)},n}(),PT=function(){function n(t,e,r,a){var o=this;if(t===void 0&&(t=0),e===void 0&&(e=1),this.canReturnFloat=function(){return o.dtype==null||o.dtype==="float32"},this.min=t,this.range=e-t,this.dtype=r,a==null&&(a=Math.random()),typeof a=="number"&&(a=a.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between "+t+" - "+e+" <= 1 and dtype is not float");this.random=Kf(a)}return n.prototype.convertValue=function(t){return this.canReturnFloat()?t:Math.round(t)},n.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},n}();function We(n,t,e){return t===void 0&&(t="float32"),t=t||"float32",Iw(n),new el(n,t,e)}function LT(n,t){t===void 0&&(t=!1),console.log(n.toString(t))}var Hw=X({batchToSpaceND_:function(n,t,e){var r=z(n,"x","batchToSpaceND"),a=t.reduce(function(o,u){return o*u});return j(r.rank>=1+t.length,function(){return"input rank is "+r.rank+" but should be > than blockShape.length "+t.length}),j(e.length===t.length,function(){return"crops.length is "+e.length+" but should be equal to blockShape.length  "+t.length}),j(r.shape[0]%a==0,function(){return"input tensor batch is "+r.shape[0]+" but is not divisible by the product of the elements of blockShape "+t.join(" * ")+" === "+a}),Q.runKernelFunc(function(o){return o.batchToSpaceND(r,t,e)},{$x:r},function(o){return{$x:function(){return o.spaceToBatchND(t,e)}}})}}),zT=X({broadcastTo_:function(n,t){var e=z(n,"broadcastTo","x"),r=e.shape;if(t.some(function(c){return!(c>0)||c%1!=0}))throw new Error("broadcastTo(): Invalid broadcast shape ["+t+"].");if(t.length<e.rank)throw new Error("broadcastTo(): shape.length="+t.length+" < input.rank="+e.rank+".");if(t.length>e.rank){for(var a=e.shape.slice();a.length<t.length;)a.unshift(1);e=e.reshape(a)}for(var o=Array.from(t),u=t.length-1;u>=0;u--)if(e.shape[u]===t[u])o[u]=1;else if(e.shape[u]!==1)throw new Error("broadcastTo(): ["+r+"] cannot be broadcast to ["+t+"].");var l=o.map(function(c,f){return c>1?f:-1}).filter(function(c){return c>=0});return l.length===0?e.clone():Q.runKernelFunc(function(c){return c.tile(e,o)},{input:e},function(c){return{input:function(){return c.sum(l,!0)}}})}}),UT=X({cast_:function(n,t){var e=z(n,"x","cast");if(!MA(t))throw new Error("Failed to cast to unknown dtype "+t);if(t==="string"&&e.dtype!=="string"||t!=="string"&&e.dtype==="string")throw new Error("Only strings can be casted to strings");var r={dtype:t};return Q.runKernelFunc(function(a){return a.cast(e,t)},{x:e},function(a){return{x:function(){return a.clone()}}},"Cast",r)}}),jT=X({clone_:function(n){var t=z(n,"x","clone",null);return Q.runKernelFunc(function(){return Q.makeTensorFromDataId(t.dataId,t.shape,t.dtype)},{$x:t},function(e){return{$x:function(){return e.toFloat()}}})}}),HT=X({cumsum_:function(n,t,e,r){t===void 0&&(t=0),e===void 0&&(e=!1),r===void 0&&(r=!1);var a=z(n,"x","cumsum"),o=ha([t|=0],a.rank),u=a;o!=null&&(u=a.transpose(o));var l=pa(1,a.rank)[0],c=Q.runKernelFunc(function(f){return f.cumsum(u,l,e,r)},{permutedX:u},function(f){return{permutedX:function(){return f.cumsum(t,e,!r)}}});return o!=null&&(c=c.transpose(o)),c}}),VT=X({depthToSpace_:function(n,t,e){e===void 0&&(e="NHWC");var r=z(n,"x","depthToSpace"),a=e==="NHWC"?r.shape[1]:r.shape[2],o=e==="NHWC"?r.shape[2]:r.shape[3],u=e==="NHWC"?r.shape[3]:r.shape[1];return j(a*t>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+a+" and "+t+`  for depthToSpace with input shape
      `+r.shape}),j(o*t>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+o+" and "+t+` for depthToSpace with input shape
          `+r.shape}),j(u%(t*t)==0,function(){return"Dimension size must be evenly divisible by "+t*t+" but is "+u+" for depthToSpace with input shape "+r.shape}),Q.runKernelFunc(function(l){return l.depthToSpace(r,t,e)},{$x:r})}}),Cr=X({expandDims_:function(n,t){t===void 0&&(t=0);var e=z(n,"x","expandDims",null);j(t<=e.rank,function(){return"Axis must be <= rank of the tensor"});var r=e.shape.slice();return t<0&&(j(-(e.rank+1)<=t,function(){return"Axis must be in the interval ["+-(e.rank+1)+", "+e.rank+"]"}),t=e.rank+t+1),r.splice(t,0,1),Pr(e,r)}}),Vw=X({eye_:function(n,t,e,r){r===void 0&&(r="float32"),t==null&&(t=n);for(var a=We([n,t],r),o=n<=t?n:t,u=0;u<o;++u)a.set(1,u,u);var l=a.toTensor().as2D(n,t);if(e==null)return l;if(e.length===1)return ws(Cr(l,0),[e[0],1,1]);if(e.length===2)return ws(Cr(Cr(l,0),0),[e[0],e[1],1,1]);if(e.length===3)return ws(Cr(Cr(Cr(l,0),0),0),[e[0],e[1],e[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received "+e.length+"D.")}}),WT=X({multinomial_:function(n,t,e,r){r===void 0&&(r=!1);var a=z(n,"logits","multinomial"),o=a.size,u=a.rank;if(o<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+o+".");if(u>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+u);e=e||Math.random();var l=u===1?a.as2D(1,-1):a,c=Q.runKernelFunc(function(f){return f.multinomial(l,r,t,e)},{logits2D:l});return u===1?c.as1D():c}}),Bv=X({oneHot_:function(n,t,e,r){if(e===void 0&&(e=1),r===void 0&&(r=0),t<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+t);var a=z(n,"indices","oneHot","int32"),o=a.shape.concat([t]);return a=a.flatten(),Q.runKernelFunc(function(u){return u.oneHot(a,t,e,r)},{$indices:a},function(u){return{$indices:function(){return _t(a.shape,"float32")}}}).reshape(o)}}),mi=X({pad_:function(n,t,e){e===void 0&&(e=0);var r=z(n,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var a={paddings:t,constantValue:e};return Q.runKernelFunc(function(o){return o.pad(r,t,e)},{x:r},function(o){var u=t.map(function(l){return l[0]});return{x:function(){return o.slice(u,r.shape)}}},"PadV2",a)}}),GT=X({pad1d_:function(n,t,e){return e===void 0&&(e=0),j(t.length===2,function(){return"Invalid number of paddings. Must be length of 2."}),mi(n,[t],e)}}),qT=X({pad2d_:function(n,t,e){return e===void 0&&(e=0),j(t.length===2&&t[0].length===2&&t[1].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),mi(n,t,e)}}),XT=X({pad3d_:function(n,t,e){return e===void 0&&(e=0),j(t.length===3&&t[0].length===2&&t[1].length===2&&t[2].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),mi(n,t,e)}}),YT=X({pad4d_:function(n,t,e){return e===void 0&&(e=0),j(t.length===4&&t[0].length===2&&t[1].length===2&&t[2].length===2&&t[3].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),mi(n,t,e)}}),KT=X({rand_:function(n,t,e){var r=ke(n),a=null;if(e==null||e==="float32")a=new Float32Array(r);else if(e==="int32")a=new Int32Array(r);else{if(e!=="bool")throw new Error("Unknown data type "+e);a=new Uint8Array(r)}for(var o=0;o<r;o++)a[o]=t();return Q.makeTensor(a,n,e)}}),QT=X({randomNormal_:function(n,t,e,r,a){if(t===void 0&&(t=0),e===void 0&&(e=1),r!=null&&r==="bool")throw new Error("Unsupported data type "+r);for(var o=new wm(t,e,r,!1,a),u=We(n,r),l=0;l<u.values.length;l++)u.values[l]=o.nextValue();return u.toTensor()}}),$T=X({randomGamma_:function(n,t,e,r,a){if(e===void 0&&(e=1),r===void 0&&(r="float32"),e==null&&(e=1),r==null&&(r="float32"),r!=="float32"&&r!=="int32")throw new Error("Unsupported data type "+r);for(var o=new FT(t,e,r,a),u=We(n,r),l=0;l<u.values.length;l++)u.values[l]=o.nextValue();return u.toTensor()}}),Ww=X({randomUniform_:function(n,t,e,r,a){t===void 0&&(t=0),e===void 0&&(e=1),r===void 0&&(r="float32");for(var o=We(n,r),u=new PT(t,e,null,a),l=0;l<o.values.length;l++)o.values[l]=u.nextValue();return o.toTensor()}}),Pr=X({reshape_:function(n,t){var e=z(n,"x","reshape",null);t=DA(t,e.size),j(e.size===ke(t),function(){return"new shape and old shape must have the same number of elements."});var r={shape:t};return Q.runKernelFunc(function(a){return a.reshape(e,t)},{x:e},function(a){return{x:function(){return a.reshape(e.shape)}}},"Reshape",r)}}),Gw=X({spaceToBatchND_:function(n,t,e){var r=z(n,"x","spaceToBatchND");return j(r.rank>=1+t.length,function(){return"input rank "+r.rank+" should be > than [blockShape] "+t.length}),j(e.length===t.length,function(){return"paddings.shape[0] "+e.length+" must be equal to [blockShape] "+t.length}),j(r.shape.reduce(function(a,o,u){return u>0&&u<=t.length?a&&(o+e[u-1][0]+e[u-1][1])%t[u-1]==0:a},!0),function(){return"input spatial dimensions "+r.shape.slice(1)+" with paddings "+e.toString()+" must be divisible by blockShapes "+t.toString()}),Q.runKernelFunc(function(a){return a.spaceToBatchND(r,t,e)},{$x:r},function(a){return{$x:function(){return a.batchToSpaceND(t,e)}}})}}),qw=X({squeeze_:function(n,t){var e=z(n,"x","squeeze");return Pr(e,ii(e.shape,t).newShape)}}),cr=X({stack_:function(n,t){t===void 0&&(t=0);var e=Ef(n,"tensors","stack");if(j(e.length>=1,function(){return"Pass at least one tensor to tf.stack"}),e.length===1)return e[0].expandDims(t);var r=e[0].rank,a=e[0].shape,o=e[0].dtype;j(t<=r,function(){return"Axis must be <= rank of the tensor"}),e.forEach(function(l){ft(a,l.shape,"All tensors passed to stack must have matching shapes")}),e.forEach(function(l){j(o===l.dtype,function(){return"All tensors passed to stack must have matching dtypes"})});var u=e.map(function(l){return l.expandDims(t)});return nn(u,t)}}),ws=X({tile_:function(n,t){var e=z(n,"x","tile",null);j(e.rank===t.length,function(){return"Error in transpose: rank of input "+e.rank+" must match length of reps "+t+"."});var r=[e],a={reps:t};return Q.runKernelFunc(function(o,u){var l=o.tile(e,t);return u([e]),l},{x:e},function(o,u){var l=u[0];return{x:function(){var c=ot(l);if(l.rank===1)for(var f=0;f<t[0];++f)c=c.add(o.slice([f*l.shape[0]],[l.shape[0]]));else if(l.rank===2)for(f=0;f<t[0];++f)for(var h=0;h<t[1];++h)c=c.add(o.slice([f*l.shape[0],h*l.shape[1]],[l.shape[0],l.shape[1]]));else if(l.rank===3)for(f=0;f<t[0];++f)for(h=0;h<t[1];++h)for(var p=0;p<t[2];++p)c=c.add(o.slice([f*l.shape[0],h*l.shape[1],p*l.shape[2]],[l.shape[0],l.shape[1],l.shape[2]]));else{if(l.rank!==4)throw new Error("Gradient for tile operation is not implemented for rank-"+l.rank+" tensors yet.");for(f=0;f<t[0];++f)for(h=0;h<t[1];++h)for(p=0;p<t[2];++p)for(var m=0;m<t[3];++m)c=c.add(o.slice([f*l.shape[0],h*l.shape[1],p*l.shape[2],m*l.shape[3]],[l.shape[0],l.shape[1],l.shape[2],l.shape[3]]))}return c}}},"Tile",a,r)}}),ZT=X({truncatedNormal_:function(n,t,e,r,a){if(t===void 0&&(t=0),e===void 0&&(e=1),r!=null&&r==="bool")throw new Error("Unsupported data type "+r);for(var o=new wm(t,e,r,!0,a),u=We(n,r),l=0;l<u.values.length;l++)u.values[l]=o.nextValue();return u.toTensor()}}),rn=X({unstack_:function(n,t){t===void 0&&(t=0),t=t||0;var e=z(n,"x","unstack");j(t>=-e.shape.length&&t<e.shape.length,function(){return"Axis = "+t+" is not in [-"+e.shape.length+", "+e.shape.length+")"}),t<0&&(t+=e.shape.length);var r={axis:t};return Q.runKernelFunc(function(a){return a.unstack(e,t)},{x:e},function(a){return{x:function(){return cr(a,t)}}},"Unpack",r)}}),JT=function(n,t){return Te(this,void 0,void 0,function(){var e,r,a,o,u,l,c,f,h,p;return Ne(this,function(m){switch(m.label){case 0:return e=z(n,"x","setdiff1d"),r=z(t,"y","setdiff1d"),j(e.dtype===r.dtype,function(){return"x and y should have the same dtype, but got x ("+e.dtype+") and y ("+r.dtype+")."}),j(e.rank===1,function(){return"x should be 1D tensor, but got x ("+e.shape+")."}),j(r.rank===1,function(){return"y should be 1D tensor, but got y ("+r.shape+")."}),[4,e.data()];case 1:return a=m.sent(),[4,r.data()];case 2:for(o=m.sent(),u=new Set(o),l=0,h=0;h<a.length;h++)u.has(a[h])||l++;for(c=new el([l],e.dtype),f=new el([l],"int32"),h=0,p=0;h<a.length;h++)u.has(a[h])||(c.values[p]=a[h],f.values[p]=h,p++);return[2,[c.toTensor(),f.toTensor()]]}})})};function _f(n,t,e,r){r===void 0&&(r=!0);var a=[];if(r)(a=a.concat(t.slice(0))).push(n[0]/e),a=a.concat(n.slice(1));else{a=a.concat(n[0]);for(var o=t.length,u=0;u<o;++u)a=a.concat([n[u+1]/t[u],t[u]]);a=a.concat(n.slice(o+1))}return a}function Rf(n,t,e){e===void 0&&(e=!0);var r=[];if(e){r.push(t);for(var a=t+1;a<n;++a)a<=2*t?(r.push(a),r.push(a-(t+1))):r.push(a)}else{var o=[],u=[];for(a=1;a<n;++a)a>=2*t+1||a%2==1?u.push(a):o.push(a);r.push.apply(r,o),r.push(0),r.push.apply(r,u)}return r}function Af(n,t,e,r){r===void 0&&(r=!0);var a=[];r?a.push(n[0]/e):a.push(n[0]*e);for(var o=1;o<n.length;++o)o<=t.length?r?a.push(t[o-1]*n[o]):a.push(n[o]/t[o-1]):a.push(n[o]);return a}function Xw(n,t){for(var e=[0],r=0;r<t;++r)e.push(n[r][0]);return e}function Yw(n,t,e){for(var r=n.slice(0,1),a=0;a<e;++a)r.push(n[a+1]-t[a][0]-t[a][1]);return r}function Kw(n,t){if(n.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was "+n.rank+".");if(t.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if(t.dtype!=="int32")throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was "+t.dtype+".");if(t.shape[t.rank-1]>n.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+t.shape[t.rank-1]+" vs. "+n.rank);if(n.size===0)throw new Error("Requested more than 0 entries, but input is empty. Input shape: "+n.shape+".");for(var e=t.shape,r=e[e.length-1],a=1,o=0;o<e.length-1;++o)a*=e[o];var u=n.shape,l=e.slice();l.pop();var c=1;for(o=r;o<n.rank;++o)c*=u[o],l.push(u[o]);var f=oa(n.shape).map(function(h){return h/c}).concat([1]).slice(0,r);return[l,a,c,f]}var Qw=30;function Gp(n){return n<=Qw?n:Nv(n,Math.floor(Math.sqrt(n)))}function eN(n,t,e){var r=t.rank>1?t.shape[t.rank-1]:1,a=t.rank>1?t.rank-1:1,o="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+e.shape+", indices.shape: "+t.shape+", shape: "+n+", sliceDim: "+r+", and batchDim: "+a+".";if(e.rank<a)throw new Error(o+" update.rank < "+a+". ");if(n.length<r+(e.rank-a))throw new Error(o+" Output shape length < "+(r+(e.rank-a)));if(e.rank!==a+n.length-r)throw new Error(o+" update.rank != "+(a+n.length-r));for(var u=0;u<a;++u)if(e.shape[u]!==t.shape[u])throw new Error(o+" updates.shape["+u+"] ("+e.shape[u]+") != indices.shape["+u+"] ("+t.shape[u]+").");for(u=0;u<e.rank-a;++u)if(e.shape[u+a]!==n[u+r])throw new Error(o+" updates.shape["+(u+a)+"] ("+e.shape[u+a]+") != shape["+(u+a)+"] ("+n[u+a]+")")}function tN(n,t,e){if(t.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if(n.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was "+n.rank+".");if(t.dtype!=="int32")throw new Error("The dtype of 'indices' should be int32, but got dtype: "+t.dtype);if(e.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+e);if(e.length===0){if(t.size===0)throw new Error("Indices specified for empty output. indices shape: "+t.shape);if(n.size===0)throw new Error("Updates specified for empty output. updates shape: "+n.shape)}eN(e,t,n)}function Tf(n,t,e){for(var r=t.shape.length,a=r>1?t.shape[r-1]:1,o=e.length,u=1,l=a;l<o;++l)u*=e[l];var c=a<1?1:a;return{sliceRank:a,numUpdates:ke(t.shape)/c,sliceSize:u,strides:oa(e.slice(0,a)).concat([1]),outputSize:ke(e)}}function nN(n,t,e){j(n.rank===t.length,function(){return"Error in slice"+n.rank+"D: Length of begin "+t+" must match the rank of the array ("+n.rank+")."}),j(n.rank===e.length,function(){return"Error in slice"+n.rank+"D: Length of size "+e+" must match the rank of the array ("+n.rank+")."});for(var r=function(o){j(t[o]+e[o]<=n.shape[o],function(){return"Error in slice"+n.rank+"D: begin["+o+"] + size["+o+"] ("+(t[o]+e[o])+") would overflow input.shape["+o+"] ("+n.shape[o]+")"})},a=0;a<n.rank;++a)r(a)}function Gx(n){for(var t=[],e=0;n>0;)1&n&&t.push(e),n/=2,e++;return t}function Sm(n,t,e){for(var r=[],a=0;a<n.length;a++)r[a]=Math.ceil((t[a]-n[a])/e[a]);return r}function rN(n,t,e,r,a){var o=t[a],u=e[a]||1;(n&1<<a||o==null)&&(o=u>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var l=r[a];return o<0&&(o+=l),o=Rv(0,o,l-1)}function aN(n,t,e,r,a){var o=t[a],u=e[a]||1;(n&1<<a||o==null)&&(o=u>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var l=r[a];return o<0&&(o+=l),o=u>0?Rv(0,o,l):Rv(-1,o,l-1)}function $w(n,t,e){for(var r=e.length,a=0;a<e.length;a++)if(e[a]>1){r=a;break}for(a=r+1;a<e.length;a++)if(t[a]>0||e[a]!==n[a])return!1;return!0}function Zw(n,t){for(var e=n.length>0?n[n.length-1]:1,r=0;r<n.length-1;r++)e+=n[r]*t[r];return e}function oN(n,t){j(Tv(n),function(){return"The f passed in variableGrads(f) must be a function"}),j(t==null||Array.isArray(t)&&t.every(function(h){return h instanceof Ds}),function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"});var e=t!=null;if(!e)for(var r in t=[],Q.registeredVariables)t.push(Q.registeredVariables[r]);var a=e?t.filter(function(h){return!h.trainable}):null,o=t.length;j((t=t.filter(function(h){return h.trainable})).length>0,function(){return"variableGrads() expects at least one of the input variables to be trainable, but none of the "+o+" variables is trainable."});var u=Q.gradients(n,t,null,!0),l=u.value,c=u.grads;j(c.some(function(h){return h!=null}),function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."}),j(l.rank===0,function(){return"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+l.rank+" tensor"});var f={};return t.forEach(function(h,p){c[p]!=null&&(f[h.name]=c[p])}),a?.forEach(function(h){return f[h.name]=null}),{value:l,grads:f}}function Qf(n){return Q.customGrad(n)}var Ua=X({softmax_:function(n,t){t===void 0&&(t=-1);var e=z(n,"logits","softmax","float32");if(t===-1&&(t=e.rank-1),t!==e.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+e.rank+" and dim was "+t);return Q.runKernelFunc(function(r,a){var o=r.softmax(e,t);return a([o]),o},{logits:e},function(r,a){var o=a[0],u=r.mul(o);return{logits:function(){return u.sub(u.sum([t],!0).mul(o))}}},"Softmax",{dim:t},[],[!0])}}),iN=X({logSoftmax_:function(n,t){t===void 0&&(t=-1);var e=z(n,"logits","logSoftmax");if(t===-1&&(t=e.rank-1),t!==e.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank "+e.rank+" and axis was "+t);return Qf(function(r,a){var o=r.max(t,!0),u=r.sub(o),l=u.toFloat().sub(u.exp().sum(t,!0).log());return a([l]),{value:l,gradFunc:function(c,f){var h=f[0].exp();return c.sub(c.sum(t,!0).mul(h))}}})(e)}}),Jw=function(){function n(t,e){this.backend=t,this.dataMover=e,this.data=new WeakMap,this.dataIdsCount=0}return n.prototype.get=function(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)},n.prototype.set=function(t,e){this.dataIdsCount++,this.data.set(t,e)},n.prototype.has=function(t){return this.data.has(t)},n.prototype.delete=function(t){return this.dataIdsCount--,this.data.delete(t)},n.prototype.numDataIds=function(){return this.dataIdsCount},n}(),e2=function(){function n(){}return n.prototype.time=function(t){return se("time")},n.prototype.read=function(t){return se("read")},n.prototype.readSync=function(t){return se("readSync")},n.prototype.numDataIds=function(){return se("numDataIds")},n.prototype.disposeData=function(t){return se("disposeData")},n.prototype.write=function(t,e,r){return se("write")},n.prototype.move=function(t,e,r,a){return se("move")},n.prototype.memory=function(){return se("memory")},n.prototype.floatPrecision=function(){return se("floatPrecision")},n.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},n.prototype.batchMatMul=function(t,e,r,a){return se("batchMatMul")},n.prototype.fusedBatchMatMul=function(t){return t.a,t.b,t.transposeA,t.transposeB,t.bias,t.activation,t.preluActivationWeights,se("fusedBatchMatMul")},n.prototype.slice=function(t,e,r){return se("slice")},n.prototype.stridedSlice=function(t,e,r,a){return se("stridedSlice")},n.prototype.unstack=function(t,e){return se("unstack")},n.prototype.reverse=function(t,e){return se("reverse")},n.prototype.concat=function(t,e){return se("concat")},n.prototype.neg=function(t){return se("neg")},n.prototype.add=function(t,e){return se("add")},n.prototype.addN=function(t){return se("addN")},n.prototype.subtract=function(t,e){return se("subtract")},n.prototype.multiply=function(t,e){return se("multiply")},n.prototype.realDivide=function(t,e){return se("realDivide")},n.prototype.floorDiv=function(t,e){return se("floorDiv")},n.prototype.sum=function(t,e){return se("sum")},n.prototype.prod=function(t,e){return se("prod")},n.prototype.unsortedSegmentSum=function(t,e,r){return se("unsortedSegmentSum")},n.prototype.argMin=function(t,e){return se("argMin")},n.prototype.argMax=function(t,e){return se("argMax")},n.prototype.equal=function(t,e){return se("equal")},n.prototype.notEqual=function(t,e){return se("notEqual")},n.prototype.less=function(t,e){return se("less")},n.prototype.lessEqual=function(t,e){return se("lessEqual")},n.prototype.greater=function(t,e){return se("greater")},n.prototype.greaterEqual=function(t,e){return se("greaterEqual")},n.prototype.logicalNot=function(t){return se("logicalNot")},n.prototype.logicalAnd=function(t,e){return se("logicalAnd")},n.prototype.logicalOr=function(t,e){return se("logicalOr")},n.prototype.where=function(t){return se("where")},n.prototype.select=function(t,e,r){return se("select")},n.prototype.topk=function(t,e,r){return se("topk")},n.prototype.min=function(t,e){return se("min")},n.prototype.minimum=function(t,e){return se("minimum")},n.prototype.mod=function(t,e){return se("mod")},n.prototype.max=function(t,e){return se("max")},n.prototype.maximum=function(t,e){return se("maximum")},n.prototype.all=function(t,e){return se("all")},n.prototype.any=function(t,e){return se("any")},n.prototype.squaredDifference=function(t,e){return se("squaredDifference")},n.prototype.ceil=function(t){return se("ceil")},n.prototype.floor=function(t){return se("floor")},n.prototype.round=function(t){return se("round")},n.prototype.sign=function(t){return se("sign")},n.prototype.isNaN=function(t){return se("isNaN")},n.prototype.isInf=function(t){return se("isInf")},n.prototype.isFinite=function(t){return se("isFinite")},n.prototype.pow=function(t,e){return se("pow")},n.prototype.exp=function(t){return se("exp")},n.prototype.expm1=function(t){return se("expm1")},n.prototype.softmax=function(t,e){return se("softmax")},n.prototype.log=function(t){return se("log")},n.prototype.log1p=function(t){return se("log1p")},n.prototype.sqrt=function(t){return se("sqrt")},n.prototype.rsqrt=function(t){return se("rsqrt")},n.prototype.square=function(t){return se("square")},n.prototype.reciprocal=function(t){return se("reciprocal")},n.prototype.relu=function(t){return se("relu")},n.prototype.relu6=function(t){return se("relu6")},n.prototype.prelu=function(t,e){return se("prelu")},n.prototype.elu=function(t){return se("elu")},n.prototype.eluDer=function(t,e){return se("eluDer")},n.prototype.selu=function(t){return se("selu")},n.prototype.int=function(t){return se("int")},n.prototype.clip=function(t,e,r){return se("clip")},n.prototype.abs=function(t){return se("abs")},n.prototype.complexAbs=function(t){return se("complexAbs")},n.prototype.sigmoid=function(t){return se("sigmoid")},n.prototype.softplus=function(t){return se("softplus")},n.prototype.sin=function(t){return se("sin")},n.prototype.cos=function(t){return se("cos")},n.prototype.tan=function(t){return se("tan")},n.prototype.asin=function(t){return se("asin")},n.prototype.acos=function(t){return se("acos")},n.prototype.atan=function(t){return se("atan")},n.prototype.atan2=function(t,e){return se("atan2")},n.prototype.sinh=function(t){return se("sinh")},n.prototype.cosh=function(t){return se("cosh")},n.prototype.tanh=function(t){return se("tanh")},n.prototype.asinh=function(t){return se("asinh")},n.prototype.acosh=function(t){return se("acosh")},n.prototype.atanh=function(t){return se("atanh")},n.prototype.erf=function(t){return se("erf")},n.prototype.step=function(t,e){return se("step")},n.prototype.fusedConv2d=function(t){return t.input,t.filter,t.convInfo,t.bias,t.activation,t.preluActivationWeights,se("fusedConv2d")},n.prototype.conv2d=function(t,e,r){return se("conv2d")},n.prototype.conv2dDerInput=function(t,e,r){return se("conv2dDerInput")},n.prototype.conv2dDerFilter=function(t,e,r){return se("conv2dDerFilter")},n.prototype.fusedDepthwiseConv2D=function(t){return t.input,t.filter,t.convInfo,t.bias,t.activation,t.preluActivationWeights,se("fusedDepthwiseConv2D")},n.prototype.depthwiseConv2D=function(t,e,r){return se("depthwiseConv2D")},n.prototype.depthwiseConv2DDerInput=function(t,e,r){return se("depthwiseConv2DDerInput")},n.prototype.depthwiseConv2DDerFilter=function(t,e,r){return se("depthwiseConv2DDerFilter")},n.prototype.conv3d=function(t,e,r){return se("conv3d")},n.prototype.conv3dDerInput=function(t,e,r){return se("conv3dDerInput")},n.prototype.conv3dDerFilter=function(t,e,r){return se("conv3dDerFilter")},n.prototype.maxPool=function(t,e){return se("maxPool")},n.prototype.maxPoolBackprop=function(t,e,r,a){return se("maxPoolBackprop")},n.prototype.avgPool=function(t,e){return se("avgPool")},n.prototype.avgPoolBackprop=function(t,e,r){return se("avgPoolBackprop")},n.prototype.avgPool3d=function(t,e){return se("avgPool3d")},n.prototype.avgPool3dBackprop=function(t,e,r){return se("avgPool3dBackprop")},n.prototype.maxPool3d=function(t,e){return se("maxPool3d")},n.prototype.maxPool3dBackprop=function(t,e,r,a){return se("maxPool3dBackprop")},n.prototype.reshape=function(t,e){return se("reshape")},n.prototype.cast=function(t,e){return se("cast")},n.prototype.tile=function(t,e){return se("tile")},n.prototype.pad=function(t,e,r){return se("pad")},n.prototype.transpose=function(t,e){return se("transpose")},n.prototype.gather=function(t,e,r){return se("gather")},n.prototype.gatherND=function(t,e){return se("gatherND")},n.prototype.scatterND=function(t,e,r){return se("scatterND")},n.prototype.batchToSpaceND=function(t,e,r){return se("batchToSpaceND")},n.prototype.spaceToBatchND=function(t,e,r){return se("spaceToBatchND")},n.prototype.resizeBilinear=function(t,e,r,a){return se("resizeBilinear")},n.prototype.resizeBilinearBackprop=function(t,e,r){return se("resizeBilinearBackprop")},n.prototype.resizeNearestNeighbor=function(t,e,r,a){return se("resizeNearestNeighbor")},n.prototype.resizeNearestNeighborBackprop=function(t,e,r){return se("resizeNearestNeighborBackprop")},n.prototype.batchNormalization=function(t,e,r,a,o,u){return se("batchNormalization")},n.prototype.localResponseNormalization4D=function(t,e,r,a,o){return se("localResponseNormalization4D")},n.prototype.LRNGrad=function(t,e,r,a,o,u,l){return se("LRNGrad")},n.prototype.multinomial=function(t,e,r,a){return se("multinomial")},n.prototype.oneHot=function(t,e,r,a){return se("oneHot")},n.prototype.cumsum=function(t,e,r,a){return se("cumsum")},n.prototype.nonMaxSuppression=function(t,e,r,a,o){return se("nonMaxSuppression")},n.prototype.fft=function(t){return se("fft")},n.prototype.ifft=function(t){return se("ifft")},n.prototype.complex=function(t,e){return se("complex")},n.prototype.real=function(t){return se("real")},n.prototype.imag=function(t){return se("imag")},n.prototype.cropAndResize=function(t,e,r,a,o,u){return se("cropAndResize")},n.prototype.depthToSpace=function(t,e,r){return se("depthToSpace")},n.prototype.split=function(t,e,r){return se("split")},n.prototype.sparseToDense=function(t,e,r,a){return se("sparseToDense")},n.prototype.diag=function(t){return se("diag")},n.prototype.fill=function(t,e,r){return se("fill")},n.prototype.onesLike=function(t){return se("onesLike")},n.prototype.zerosLike=function(t){return se("zerosLike")},n.prototype.linspace=function(t,e,r){return se("linspace")},n.prototype.dispose=function(){return se("dispose")},n}();function se(n){throw new Error("'"+n+"' not yet implemented or not found in the registry. Did you forget to import the kernel?")}function xo(n,t){for(var e=n.length,r=[],a=0;a<e;a++){var o=e-1-a,u=n[o]||1;(t[t.length-1-a]||1)>1&&u===1&&r.unshift(o)}return r}function an(n,t){for(var e=[],r=0;r<t.length;r++){var a=n[n.length-r-1],o=t.length-r-1,u=t[o];(a==null||a===1&&u>1)&&e.unshift(o)}return e}function tt(n,t){for(var e=[],r=Math.max(n.length,t.length),a=0;a<r;a++){var o=n[n.length-a-1];o==null&&(o=1);var u=t[t.length-a-1];if(u==null&&(u=1),o===1)e.unshift(u);else if(u===1)e.unshift(o);else{if(o!==u)throw Error("Operands could not be broadcast together with shapes "+n+" and "+t+".");e.unshift(o)}}return e}function nl(n,t,e,r,a,o,u){u===void 0&&(u="channelsLast");var l,c=kf(t),f=c[0],h=c[1];if(u==="channelsLast")l=[f,h,n[3],n[3]];else{if(u!=="channelsFirst")throw new Error("Unknown dataFormat "+u);l=[f,h,n[1],n[1]]}return gi(n,l,e,r,a,o,!1,u)}function Nf(n,t,e,r,a,o,u){u===void 0&&(u="NDHWC");var l,c,f=Fv(t),h=f[0],p=f[1],m=f[2];if(u==="NDHWC")c="channelsLast",l=[h,p,m,n[4],n[4]];else{if(u!=="NCDHW")throw new Error("Unknown dataFormat "+u);c="channelsFirst",l=[h,p,m,n[1],n[1]]}return Df(n,l,e,r,a,!1,c,o)}function gi(n,t,e,r,a,o,u,l){u===void 0&&(u=!1),l===void 0&&(l="channelsLast");var c=[-1,-1,-1,-1],f=c[0],h=c[1],p=c[2],m=c[3];if(l==="channelsLast")f=n[0],h=n[1],p=n[2],m=n[3];else{if(l!=="channelsFirst")throw new Error("Unknown dataFormat "+l);f=n[0],m=n[1],h=n[2],p=n[3]}var g,b=t[0],x=t[1],w=t[3],E=kf(e),C=E[0],_=E[1],R=kf(r),A=R[0],D=R[1],M=Ss(b,A),k=Ss(x,D),B=function($,K,L,W,U,Z,P,q){var ne,J,le;if(typeof $=="number"){ne={top:$,bottom:$,left:$,right:$,type:$===0?"VALID":"NUMBER"};var ye=function(Ee,De,Fe,Xe,it){Xe==null&&(Xe=t2(Ee,De,Fe));var rt=Ee[0],st=Ee[1],mn=Qu((rt-De+2*Xe)/Fe+1,it);j(Wt(mn),function(){return"The output # of rows ("+mn+") must be an integer. Change the stride and/or zero pad parameters"});var pt=Qu((st-De+2*Xe)/Fe+1,it);return j(Wt(pt),function(){return"The output # of columns ("+pt+") must be an integer. Change the stride and/or zero pad parameters"}),[mn,pt]}([K,L],Z,W,$,q);J=ye[0],le=ye[1]}else if($==="same"){J=Math.ceil(K/W),le=Math.ceil(L/U);var pe=Math.max(0,(J-1)*W+Z-K),de=Math.max(0,(le-1)*U+P-L),ce=Math.floor(pe/2),xe=pe-ce,we=Math.floor(de/2);ne={top:ce,bottom:xe,left:we,right:de-we,type:"SAME"}}else{if($!=="valid")throw Error("Unknown padding parameter: "+$);ne={top:0,bottom:0,left:0,right:0,type:"VALID"},J=Math.ceil((K-Z+1)/W),le=Math.ceil((L-P+1)/U)}return{padInfo:ne,outHeight:J,outWidth:le}}(a,h,p,C,_,M,k,o),O=B.padInfo,V=B.outHeight,H=B.outWidth,ee=u?w*m:w;return l==="channelsFirst"?g=[f,ee,V,H]:l==="channelsLast"&&(g=[f,V,H,ee]),{batchSize:f,dataFormat:l,inHeight:h,inWidth:p,inChannels:m,outHeight:V,outWidth:H,outChannels:ee,padInfo:O,strideHeight:C,strideWidth:_,filterHeight:b,filterWidth:x,effectiveFilterHeight:M,effectiveFilterWidth:k,dilationHeight:A,dilationWidth:D,inShape:n,outShape:g,filterShape:t}}function Df(n,t,e,r,a,o,u,l){o===void 0&&(o=!1),u===void 0&&(u="channelsLast");var c=[-1,-1,-1,-1,-1],f=c[0],h=c[1],p=c[2],m=c[3],g=c[4];if(u==="channelsLast")f=n[0],h=n[1],p=n[2],m=n[3],g=n[4];else{if(u!=="channelsFirst")throw new Error("Unknown dataFormat "+u);f=n[0],g=n[1],h=n[2],p=n[3],m=n[4]}var b,x=t[0],w=t[1],E=t[2],C=t[4],_=Fv(e),R=_[0],A=_[1],D=_[2],M=Fv(r),k=M[0],B=M[1],O=M[2],V=Ss(x,k),H=Ss(w,B),ee=Ss(E,O),$=function(P,q,ne,J,le,ye,pe,de,ce,xe,we){var Ee,De,Fe,Xe;if(typeof P=="number"){Ee={top:P,bottom:P,left:P,right:P,front:P,back:P,type:P===0?"VALID":"NUMBER"};var it=function(hr,Bn,_n,Rt,At,Nt){At==null&&(At=t2(hr,Bn,Rt));var pr=hr[0],Ga=hr[1],ze=hr[2],Fn=Qu((pr-Bn+2*At)/Rt+1,Nt);j(Wt(Fn),function(){return"The output # of depths ("+Fn+") must be an integer. Change the stride and/or zero pad parameters"});var Vr=Qu((Ga-Bn+2*At)/Rt+1,Nt);j(Wt(Vr),function(){return"The output # of rows ("+Vr+") must be an integer. Change the stride and/or zero pad parameters"});var zn=Qu((ze-Bn+2*At)/Rt+1,Nt);return j(Wt(zn),function(){return"The output # of columns ("+zn+") must be an integer. Change the stride and/or zero pad parameters"}),[Fn,Vr,zn,_n]}([q,ne,J,1],de,1,le,P,we);De=it[0],Fe=it[1],Xe=it[2]}else if(P==="same"){De=Math.ceil(q/le),Fe=Math.ceil(ne/ye),Xe=Math.ceil(J/pe);var rt=(De-1)*le+de-q,st=(Fe-1)*ye+ce-ne,mn=(Xe-1)*pe+xe-J,pt=Math.floor(rt/2),Qn=rt-pt,Qt=Math.floor(st/2),xt=st-Qt,Lt=Math.floor(mn/2);Ee={top:Qt,bottom:xt,left:Lt,right:mn-Lt,front:pt,back:Qn,type:"SAME"}}else{if(P!=="valid")throw Error("Unknown padding parameter: "+P);Ee={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},De=Math.ceil((q-de+1)/le),Fe=Math.ceil((ne-ce+1)/ye),Xe=Math.ceil((J-xe+1)/pe)}return{padInfo:Ee,outDepth:De,outHeight:Fe,outWidth:Xe}}(a,h,p,m,R,A,D,V,H,ee,l),K=$.padInfo,L=$.outDepth,W=$.outHeight,U=$.outWidth,Z=o?C*g:C;return u==="channelsFirst"?b=[f,Z,L,W,U]:u==="channelsLast"&&(b=[f,L,W,U,Z]),{batchSize:f,dataFormat:u,inDepth:h,inHeight:p,inWidth:m,inChannels:g,outDepth:L,outHeight:W,outWidth:U,outChannels:Z,padInfo:K,strideDepth:R,strideHeight:A,strideWidth:D,filterDepth:x,filterHeight:w,filterWidth:E,effectiveFilterDepth:V,effectiveFilterHeight:H,effectiveFilterWidth:ee,dilationDepth:k,dilationHeight:B,dilationWidth:O,inShape:n,outShape:b,filterShape:t}}function t2(n,t,e,r){r===void 0&&(r=1);var a=Ss(t,r);return Math.floor((n[0]*(e-1)-e+a)/2)}function kf(n){return typeof n=="number"?[n,n,n]:n.length===2?[n[0],n[1],1]:n}function Fv(n){return typeof n=="number"?[n,n,n]:n}function Ss(n,t){return t<=1?n:n+(n-1)*(t-1)}function Qu(n,t){if(!t)return n;switch(t){case"round":return Math.round(n);case"ceil":return Math.ceil(n);case"floor":return Math.floor(n);default:throw new Error("Unknown roundingMode "+t)}}function Ms(n){var t=kf(n),e=t[0],r=t[1],a=t[2];return e===1&&r===1&&a===1}function Kn(n,t){return Ms(n)||Ms(t)}function Em(n){if(n==="NHWC")return"channelsLast";if(n==="NCHW")return"channelsFirst";throw new Error("Unknown dataFormat "+n)}function n2(n,t,e){if(t==="complex64"){if(n.dtype==="complex64")return n.clone();var r=_t(n.shape),a=n.toFloat(),o=e.complex(a,r);return r.dispose(),a.dispose(),o}if(!OA(n.dtype,t))return Q.makeTensorFromDataId(n.dataId,n.shape,t);if(n.dtype==="complex64"){var u=e.real(n);return o=u.cast(t),u.dispose(),o}if(t==="int32")return e.int(n);if(t==="bool"){var l=Se(0,n.dtype);return o=e.notEqual(n,l),l.dispose(),o}throw new Error("Error in Cast: failed to cast "+n.dtype+" to "+t)}function Pv(n,t){return Q.makeTensorFromDataId(n.dataId,t,n.dtype)}function r2(n,t,e){var r=(t-n)/(e-1),a=hl(e,"float32");a[0]=n;for(var o=1;o<a.length;o++)a[o]=a[o-1]+r;return Yt(a,"float32")}function Lv(n,t){if(n.length!==t.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+n.length+", imag: "+t.length+".");for(var e=new Float32Array(2*n.length),r=0;r<e.length;r+=2)e[r]=n[r/2],e[r+1]=t[r/2];return e}function qx(n,t){return{real:n[2*t],imag:n[2*t+1]}}function sN(n,t,e,r){n[2*r]=t,n[2*r+1]=e}function uN(n,t,e){var r=(e?2:-2)*Math.PI*(n/t);return{real:Math.cos(r),imag:Math.sin(r)}}function lN(n,t,e){var r=function(o,u,l){return function(c,f,h){for(var p=0,m=c.length,g=0,b=!1;p<m;){var x=h(f,c[g=p+(m-p>>>1)]);x>0?p=g+1:(m=g,b=!x)}return b?p:-p-1}(o,u,l||cN)}(n,t,e),a=r<0?-(r+1):r;n.splice(a,0,t)}function cN(n,t){return n>t?1:n<t?-1:0}function Cm(n,t,e,r,a){return a2(n,t,e,r,a,0).selectedIndices}function _m(n,t,e,r,a,o){var u=a2(n,t,e,r,a,o);return u.numValidOutputs.dispose(),{selectedIndices:u.selectedIndices,selectedScores:u.selectedScores}}function a2(n,t,e,r,a,o,u,l){l===void 0&&(l=!1);for(var c=Array.from(t).map(function(R,A){return{score:R,boxIndex:A,suppressBeginIndex:0}}).filter(function(R){return R.score>a}).sort(Xx),f=o>0?-.5/o:0,h=[],p=[];h.length<e&&c.length>0;){var m=c.pop(),g=m.score,b=m.boxIndex,x=m.suppressBeginIndex;if(g<a)break;for(var w=!1,E=h.length-1;E>=x;--E){var C=fN(n,b,h[E]);if(C>=r){w=!0;break}if(m.score=m.score*dN(r,f,C),m.score<=a)break}m.suppressBeginIndex=h.length,w||(m.score===g?(h.push(b),p.push(m.score)):m.score>a&&lN(c,m,Xx))}var _=h.length;return l&&(h.fill(0,_),p.fill(0,_)),{selectedIndices:Yt(h,"int32"),selectedScores:Yt(p,"float32"),numValidOutputs:Se(_,"int32")}}function fN(n,t,e){var r=n.subarray(4*t,4*t+4),a=n.subarray(4*e,4*e+4),o=Math.min(r[0],r[2]),u=Math.min(r[1],r[3]),l=Math.max(r[0],r[2]),c=Math.max(r[1],r[3]),f=Math.min(a[0],a[2]),h=Math.min(a[1],a[3]),p=Math.max(a[0],a[2]),m=Math.max(a[1],a[3]),g=(l-o)*(c-u),b=(p-f)*(m-h);if(g<=0||b<=0)return 0;var x=Math.max(o,f),w=Math.max(u,h),E=Math.min(l,p),C=Math.min(c,m),_=Math.max(E-x,0)*Math.max(C-w,0);return _/(g+b-_)}function dN(n,t,e){var r=Math.exp(t*e*e);return e<=n?r:0}function Xx(n,t){return n.score-t.score||n.score===t.score&&t.boxIndex-n.boxIndex}function o2(n,t,e){var r=new Array(n.rank).fill(0),a=n.shape.slice();return t.map(function(o){a[e]=o;var u=n.slice(r,a);return r[e]+=o,u})}function i2(n,t){for(var e=new Array(n.rank),r=0;r<e.length;r++)e[r]=n.shape[r]*t[r];var a=We(e,n.dtype);for(r=0;r<a.values.length;++r){for(var o=a.indexToLoc(r),u=new Array(n.rank),l=0;l<u.length;l++)u[l]=o[l]%n.shape[l];var c=n.locToIndex(u);a.values[r]=n.values[c]}return a.toTensor()}function s2(n,t,e,r,a){for(var o=t[t.length-1],u=[n.length/o,o],l=u[0],c=u[1],f=Ju(e,l*r),h=Ju("int32",l*r),p=0;p<l;p++){for(var m=p*c,g=n.subarray(m,m+c),b=[],x=0;x<g.length;x++)b.push({value:g[x],index:x});b.sort(function(R,A){return A.value-R.value});var w=p*r,E=f.subarray(w,w+r),C=h.subarray(w,w+r);for(x=0;x<r;x++)E[x]=b[x].value,C[x]=b[x].index}var _=t.slice();return _[_.length-1]=r,[En(f,_,e),En(h,_,"int32")]}function Rm(n,t){for(var e=[],r=0;r<t.length;r++)t[r]&&e.push(r);var a=We(n,"int32"),o=We([e.length,n.length],"int32");for(r=0;r<e.length;r++){var u=a.indexToLoc(e[r]),l=r*n.length;o.values.set(u,l)}return o.toTensor()}var hN=function(n,t){this.outputShape=[],this.outputShape=n,this.variableNames=t.map(function(a,o){return"T"+o});var e=[];this.variableNames.forEach(function(a){e.push("float v"+a+" = get"+a+"AtOutCoords();")});var r=this.variableNames.map(function(a){return"v"+a}).join(" + ");this.userCode=`
      void main() {
        `+e.join(`
        `)+`

        float result = `+r+`;
        setOutput(result);
      }
    `},pN=function(n,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n,this.variableNames=t.map(function(a,o){return"T"+o});var e=[];this.variableNames.forEach(function(a){e.push("vec4 v"+a+" = get"+a+"AtOutCoords();")});var r=this.variableNames.map(function(a){return"v"+a}).join(" + ");this.userCode=`
      void main() {
        `+e.join(`
        `)+`

        vec4 result = `+r+`;
        setOutput(result);
      }
    `},vN=function(n,t,e){this.variableNames=["A"];var r=n.windowSize,a=n.batchSize,o=n.inSize,u=Math.ceil(o/r);e||this.variableNames.push("bestIndicesA"),this.outputShape=[a,u];var l=t==="max"?">":"<",c=e?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+r+`;

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < `+r+`; i++) {
          int inIdx = `+c+`;
          float candidate = getA(batch, inIdx);
          if (candidate `+l+` bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `};function u2(n,t){return["x","y","z","w","u","v"].slice(0,t).map(function(e){return n+"."+e})}function qn(n,t){return t===1?[n]:u2(n,t)}function Dn(){var n,t,e,r,a,o,u,l,c,f;return fe().getNumber("WEBGL_VERSION")===2?(n="#version 300 es",t="in",e="out",r="in",a="texture",o="outputColor",u="out vec4 outputColor;",l=`
      bool isnan_custom(float val) {
        return (val > 0.0 || val < 0.0) ? false : val != 0.0;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `,c="",f=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(n="",t="attribute",e="varying",r="varying",a="texture2D",o="gl_FragColor",u="",l=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,c=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,f=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:n,attribute:t,varyingVs:e,varyingFs:r,texture2D:a,output:o,defineOutput:u,defineSpecialNaN:l,defineSpecialInf:c,defineRound:f}}function si(n,t,e){e===void 0&&(e="index");var r=oa(t);return r.map(function(a,o){return"int "+n[o]+" = "+e+" / "+a+"; "+(o===r.length-1?"int "+n[o+1]+" = "+e+" - "+n[o]+" * "+a:"index -= "+n[o]+" * "+a)+";"}).join("")}function Am(n){var t=oa(n).map(function(e){return e.toString()});return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * `+t[0]+" + coords.y * "+t[1]+` + coords.z;
  }
`}var l2=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;function mN(n,t,e,r){var a=[];n.forEach(function(g){var b=ke(g.shapeInfo.logicalShape);g.shapeInfo.isUniform?a.push("uniform float "+g.name+(b>1?"["+b+"]":"")+";"):(a.push("uniform sampler2D "+g.name+";"),a.push("uniform int offset"+g.name+";"))});var o,u,l=a.join(`
`),c=n.map(function(g){return function(b,x,w){w===void 0&&(w=!1);var E="";E+=w?c2(b):ps(b);var C=b.shapeInfo.logicalShape,_=x.logicalShape;return C.length<=_.length&&(E+=w?function(R,A){var D,M=R.name,k=M.charAt(0).toUpperCase()+M.slice(1),B="get"+k+"AtOutCoords",O=R.shapeInfo.logicalShape.length,V=A.logicalShape.length,H=xo(R.shapeInfo.logicalShape,A.logicalShape),ee=Et(V),$=V-O,K=["x","y","z","w","u","v"];D=O===0?"":V<2&&H.length>=1?"coords = 0;":H.map(function(ne){return"coords."+K[ne+$]+" = 0;"}).join(`
`);var L="";L=V<2&&O>0?"coords":R.shapeInfo.logicalShape.map(function(ne,J){return"coords."+K[J+$]}).join(", ");var W="return outputValue;",U=ke(R.shapeInfo.logicalShape)===1,Z=ke(A.logicalShape)===1;if(O!==1||U||Z){if(U&&!Z)W=V===1?`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:`
        return vec4(outputValue.x);
      `;else if(H.length){var P=O-2,q=O-1;H.indexOf(P)>-1&&H.indexOf(q)>-1?W="return vec4(outputValue.x);":H.indexOf(P)>-1?W="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":H.indexOf(q)>-1&&(W="return vec4(outputValue.xx, outputValue.zz);")}}else W=`
      return vec4(outputValue.xy, outputValue.xy);
    `;return`
    vec4 `+B+`() {
      `+ee+` coords = getOutputCoords();
      `+D+`
      vec4 outputValue = get`+k+"("+L+`);
      `+W+`
    }
  `}(b,x):function(R,A){var D=R.name,M=D.charAt(0).toUpperCase()+D.slice(1),k="get"+M+"AtOutCoords",B=A.texShape,O=R.shapeInfo.texShape,V=R.shapeInfo.logicalShape.length,H=A.logicalShape.length;if(!R.shapeInfo.isUniform&&V===H&&R.shapeInfo.flatOffset==null&&pn(O,B))return`
      float `+k+`() {
        return sampleTexture(`+D+`, resultUV);
      }
    `;var ee,$=Et(H),K=xo(R.shapeInfo.logicalShape,A.logicalShape),L=H-V,W=["x","y","z","w","u","v"];ee=V===0?"":H<2&&K.length>=1?"coords = 0;":K.map(function(Z){return"coords."+W[Z+L]+" = 0;"}).join(`
`);var U="";return U=H<2&&V>0?"coords":R.shapeInfo.logicalShape.map(function(Z,P){return"coords."+W[P+L]}).join(", "),`
    float `+k+`() {
      `+$+` coords = getOutputCoords();
      `+ee+`
      return get`+M+"("+U+`);
    }
  `}(b,x)),E}(g,t,r)}).join(`
`),f=t.texShape,h=Dn(),p=function(g){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return `+g.texture2D+`(textureSampler, uv).r;
    }
  `}(h),m=function(g){return g.version+`
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    `+g.varyingFs+` vec2 resultUV;
    `+g.defineOutput+`
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    `+g.defineSpecialNaN+`
    `+g.defineSpecialInf+`
    `+g.defineRound+`

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    `+gN+`
    `+yN+`
    `+bN+`
  `}(h);return t.isPacked?(o=function(g,b){switch(g.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return function(R,A){var D=[Math.ceil(A[0]/2),Math.ceil(A[1]/2)];return D[0]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * `+D[1]+`.0);
      }
    `:D[1]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * `+D[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+D[0]+", "+D[1]+`));
      return 2 * (resTexRC.x * `+D[1]+` + resTexRC.y);
    }
  `}(0,b);case 2:return function(R,A){var D=[Math.ceil(A[0]/2),Math.ceil(A[1]/2)];if(pn(R,A))return`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(`+D[0]+", "+D[1]+`));
      }
    `;var M=Math.ceil(R[1]/2);return`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+D[0]+", "+D[1]+`));

      int index = resTexRC.x * `+D[1]+` + resTexRC.y;
      int r = 2 * (index / `+M+`);
      int c = imod(index, `+M+`) * 2;

      return ivec2(r, c);
    }
  `}(g,b);case 3:return x=g,w=b,E=[Math.ceil(w[0]/2),Math.ceil(w[1]/2)],C=Math.ceil(x[2]/2),_=C*Math.ceil(x[1]/2),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+E[0]+", "+E[1]+`));
      int index = resTexRC.x * `+E[1]+` + resTexRC.y;

      int b = index / `+_+`;
      index -= b * `+_+`;

      int r = 2 * (index / `+C+`);
      int c = imod(index, `+C+`) * 2;

      return ivec3(b, r, c);
    }
  `;default:return function(R,A){for(var D=[Math.ceil(A[0]/2),Math.ceil(A[1]/2)],M=Math.ceil(R[R.length-1]/2),k=M*Math.ceil(R[R.length-2]/2),B=k,O="",V="b, r, c",H=2;H<R.length-1;H++)B*=R[R.length-H-1],O=`
      int b`+H+" = index / "+B+`;
      index -= b`+H+" * "+B+`;
    `+O,V="b"+H+", "+V;return`
    ivec`+R.length+` getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+D[0]+", "+D[1]+`));
      int index = resTexRC.x * `+D[1]+` + resTexRC.y;

      `+O+`

      int b = index / `+k+`;
      index -= b * `+k+`;

      int r = 2 * (index / `+M+`);
      int c = imod(index, `+M+`) * 2;

      return ivec`+R.length+"("+V+`);
    }
  `}(g,b)}var x,w,E,C,_}(t.logicalShape,f),u=function(g){return`
    void setOutput(vec4 val) {
      `+g.output+` = val;
    }
  `}(h)):(o=function(g,b){switch(g.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return function(E,C){return C[0]===1?`
      int getOutputCoords() {
        return int(resultUV.x * `+C[1]+`.0);
      }
    `:C[1]===1?`
      int getOutputCoords() {
        return int(resultUV.y * `+C[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+C[0]+", "+C[1]+`));
      return resTexRC.x * `+C[1]+` + resTexRC.y;
    }
  `}(0,b);case 2:return function(E,C){return pn(E,C)?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(`+C[0]+", "+C[1]+`));
      }
    `:E[1]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+C[0]+", "+C[1]+`));
        int index = resTexRC.x * `+C[1]+` + resTexRC.y;
        return ivec2(index, 0);
      }
    `:E[0]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+C[0]+", "+C[1]+`));
        int index = resTexRC.x * `+C[1]+` + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+C[0]+", "+C[1]+`));
      int index = resTexRC.x * `+C[1]+` + resTexRC.y;
      int r = index / `+E[1]+`;
      int c = index - r * `+E[1]+`;
      return ivec2(r, c);
    }
  `}(g,b);case 3:return x=b,w=si(["r","c","d"],g),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+x[0]+", "+x[1]+`));
      int index = resTexRC.x * `+x[1]+` + resTexRC.y;
      `+w+`
      return ivec3(r, c, d);
    }
  `;case 4:return function(E,C){var _=si(["r","c","d","d2"],E);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+C[0]+", "+C[1]+`));
      int index = resTexRC.x * `+C[1]+` + resTexRC.y;
      `+_+`
      return ivec4(r, c, d, d2);
    }
  `}(g,b);case 5:return function(E,C){var _=si(["r","c","d","d2","d3"],E);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(`+C[0]+`,
                             `+C[1]+`));

      int index = resTexRC.x * `+C[1]+` + resTexRC.y;

      `+_+`

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}(g,b);case 6:return function(E,C){var _=si(["r","c","d","d2","d3","d4"],E);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+C[0]+", "+C[1]+`));
      int index = resTexRC.x * `+C[1]+` + resTexRC.y;

      `+_+`

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}(g,b);default:throw new Error(g.length+"-D output sampling is not yet supported")}var x,w}(t.logicalShape,f),u=function(g){return`
    void setOutput(float val) {
      `+g.output+` = vec4(val, 0, 0, 0);
    }
  `}(h)),r&&(m+=xN),[m,p,u,l,o,c,e].join(`
`)}function ps(n){var t=n.shapeInfo.logicalShape;switch(t.length){case 0:return function(e){var r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1);if(e.shapeInfo.isUniform)return"float "+a+"() {return "+r+";}";var o=e.shapeInfo.texShape,u=o[0],l=o[1];if(u===1&&l===1)return`
      float `+a+`() {
        return sampleTexture(`+r+`, halfCR);
      }
    `;var c=e.shapeInfo.texShape,f=c[0],h=c[1],p=ti(r);return`
    float `+a+`() {
      vec2 uv = uvFromFlat(`+f+", "+h+", "+p+`);
      return sampleTexture(`+r+`, uv);
    }
  `}(n);case 1:return function(e){var r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1);if(e.shapeInfo.isUniform)return`
      float `+a+`(int index) {
        `+is(e)+`
      }
    `;var o=e.shapeInfo.texShape,u=o[0],l=o[1];if(l===1&&u===1)return`
      float `+a+`(int index) {
        return sampleTexture(`+r+`, halfCR);
      }
    `;var c=ti(r);return l===1?`
      float `+a+`(int index) {
        vec2 uv = vec2(0.5, (float(index + `+c+") + 0.5) / "+u+`.0);
        return sampleTexture(`+r+`, uv);
      }
    `:u===1?`
      float `+a+`(int index) {
        vec2 uv = vec2((float(index + `+c+") + 0.5) / "+l+`.0, 0.5);
        return sampleTexture(`+r+`, uv);
      }
    `:`
    float `+a+`(int index) {
      vec2 uv = uvFromFlat(`+u+", "+l+", index + "+c+`);
      return sampleTexture(`+r+`, uv);
    }
  `}(n);case 2:return function(e){var r=e.shapeInfo.logicalShape,a=e.name,o="get"+a.charAt(0).toUpperCase()+a.slice(1),u=e.shapeInfo.texShape;if(u!=null&&pn(r,u)){var l=u[0],c=u[1];return`
    float `+o+`(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(`+c+".0, "+l+`.0);
      return sampleTexture(`+a+`, uv);
    }
  `}var f=ii(r),h=f.newShape,p=f.keptDims,m=h;if(m.length<r.length){var g=vs(e,m);return`
      `+ps(g)+`
      float `+o+`(int row, int col) {
        return `+o+"("+ms(["row","col"],p)+`);
      }
    `}if(e.shapeInfo.isUniform)return`
      float `+o+`(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(`+r[1]+`, 1)));
        `+is(e)+`
      }
    `;var b=u[0],x=u[1],w=ti(a);return x===1?`
    float `+o+`(int row, int col) {
      float index = dot(vec3(row, col, `+w+"), vec3("+r[1]+`, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / `+b+`.0);
      return sampleTexture(`+a+`, uv);
    }
  `:b===1?`
    float `+o+`(int row, int col) {
      float index = dot(vec3(row, col, `+w+"), vec3("+r[1]+`, 1, 1));
      vec2 uv = vec2((index + 0.5) / `+x+`.0, 0.5);
      return sampleTexture(`+a+`, uv);
    }
  `:`
  float `+o+`(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * `+r[1]+" + col + "+w+`;
    vec2 uv = uvFromFlat(`+b+", "+x+`, index);
    return sampleTexture(`+a+`, uv);
  }
`}(n);case 3:return function(e){var r=e.shapeInfo.logicalShape,a=e.name,o="get"+a.charAt(0).toUpperCase()+a.slice(1),u=r[1]*r[2],l=r[2],c=ii(r),f=c.newShape,h=c.keptDims,p=f;if(p.length<r.length){var m=vs(e,p);return`
        `+ps(m)+`
        float `+o+`(int row, int col, int depth) {
          return `+o+"("+ms(["row","col","depth"],h)+`);
        }
      `}if(e.shapeInfo.isUniform)return`
      float `+o+`(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(`+u+", "+l+`, 1)));
        `+is(e)+`
      }
    `;var g=e.shapeInfo.texShape,b=g[0],x=g[1],w=e.shapeInfo.flatOffset;if(x===u&&w==null)return`
        float `+o+`(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(`+l+`, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(`+x+".0, "+b+`.0);
          return sampleTexture(`+a+`, uv);
        }
      `;if(x===l&&w==null)return`
    float `+o+`(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(`+r[1]+`, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+x+".0, "+b+`.0);
      return sampleTexture(`+a+`, uv);
    }
  `;var E=ti(a);return`
      float `+o+`(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * `+u+" + col * "+l+" + depth + "+E+`;
        vec2 uv = uvFromFlat(`+b+", "+x+`, index);
        return sampleTexture(`+a+`, uv);
      }
  `}(n);case 4:return function(e){var r=e.shapeInfo.logicalShape,a=e.name,o="get"+a.charAt(0).toUpperCase()+a.slice(1),u=r[3],l=r[2]*u,c=r[1]*l,f=ii(r),h=f.newShape,p=f.keptDims;if(h.length<r.length){var m=vs(e,h);return`
      `+ps(m)+`
      float `+o+`(int row, int col, int depth, int depth2) {
        return `+o+"("+ms(["row","col","depth","depth2"],p)+`);
      }
    `}if(e.shapeInfo.isUniform)return`
      float `+o+`(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(`+c+", "+l+", "+u+`, 1)));
        `+is(e)+`
      }
    `;var g=e.shapeInfo.flatOffset,b=e.shapeInfo.texShape,x=b[0],w=b[1];if(w===c&&g==null)return`
      float `+o+`(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(`+l+", "+u+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+w+".0, "+x+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;if(w===u&&g==null)return`
      float `+o+`(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(`+r[1]*r[2]+", "+r[2]+`, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+w+".0, "+x+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;var E=ti(a);return`
    float `+o+`(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+c+" + col * "+l+` +
          depth * `+u+` + depth2;
      vec2 uv = uvFromFlat(`+x+", "+w+", index + "+E+`);
      return sampleTexture(`+a+`, uv);
    }
  `}(n);case 5:return function(e){var r=e.shapeInfo.logicalShape,a=e.name,o="get"+a.charAt(0).toUpperCase()+a.slice(1),u=r[4],l=r[3]*u,c=r[2]*l,f=r[1]*c,h=ii(r),p=h.newShape,m=h.keptDims;if(p.length<r.length){var g=vs(e,p);return`
      `+ps(g)+`
      float `+o+`(int row, int col, int depth, int depth2, int depth3) {
        return `+o+"("+ms(["row","col","depth","depth2","depth3"],m)+`);
      }
    `}if(e.shapeInfo.isUniform)return`
      float `+o+`(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(`+f+", "+c+", "+l+", "+u+`)) +
          depth3;
        `+is(e)+`
      }
    `;var b=e.shapeInfo.flatOffset,x=e.shapeInfo.texShape,w=x[0],E=x[1];if(E===f&&b==null)return`
      float `+o+`(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(`+c+", "+l+", "+u+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+E+".0, "+w+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;if(E===u&&b==null)return`
      float `+o+`(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(`+r[1]*r[2]*r[3]+`,
               `+r[2]*r[3]+", "+r[3]+`, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+E+".0, "+w+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;var C=ti(a);return`
    float `+o+`(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+f+" + col * "+c+" + depth * "+l+` +
          depth2 * `+u+" + depth3 + "+C+`;
      vec2 uv = uvFromFlat(`+w+", "+E+`, index);
      return sampleTexture(`+a+`, uv);
    }
  `}(n);case 6:return function(e){var r=e.shapeInfo.logicalShape,a=e.name,o="get"+a.charAt(0).toUpperCase()+a.slice(1),u=ii(r),l=u.newShape,c=u.keptDims;if(l.length<r.length){var f=vs(e,l);return`
      `+ps(f)+`
      float `+o+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return `+o+"("+ms(["row","col","depth","depth2","depth3","depth4"],c)+`);
      }
    `}var h=r[5],p=r[4]*h,m=r[3]*p,g=r[2]*m,b=r[1]*g;if(e.shapeInfo.isUniform)return`
      float `+o+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(`+b+", "+g+", "+m+", "+p+`)) +
          dot(
            vec2(depth3, depth4),
            vec2(`+h+`, 1)));
        `+is(e)+`
      }
    `;var x=e.shapeInfo.flatOffset,w=e.shapeInfo.texShape,E=w[0],C=w[1];if(C===b&&x==null)return`
      float `+o+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(`+g+", "+m+", "+p+", "+h+`)) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+C+".0, "+E+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;if(C===h&&x==null)return`
      float `+o+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(`+r[1]*r[2]*r[3]*r[4]+`,
               `+r[2]*r[3]*r[4]+`,
               `+r[3]*r[4]+`,
               `+r[4]+`)) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+C+".0, "+E+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;var _=ti(a);return`
    float `+o+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+b+" + col * "+g+" + depth * "+m+` +
          depth2 * `+p+" + depth3 * "+h+" + depth4 + "+_+`;
      vec2 uv = uvFromFlat(`+E+", "+C+`, index);
      return sampleTexture(`+a+`, uv);
    }
  `}(n);default:throw new Error(t.length+"-D input sampling is not yet supported")}}function c2(n){var t,e,r;switch(n.shapeInfo.logicalShape.length){case 0:return t=n.name,e="get"+t.charAt(0).toUpperCase()+t.slice(1),r=Dn(),`
    vec4 `+e+`() {
      return `+r.texture2D+"("+t+`, halfCR);
    }
  `;case 1:return function(a){var o=a.name,u="get"+o.charAt(0).toUpperCase()+o.slice(1),l=a.shapeInfo.texShape,c=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)],f=Dn();return`
    vec4 `+u+`(int index) {
      vec2 uv = packedUVfrom1D(
        `+c[0]+", "+c[1]+`, index);
      return `+f.texture2D+"("+o+`, uv);
    }
  `}(n);case 2:return function(a){var o=a.shapeInfo.logicalShape,u=a.name,l="get"+u.charAt(0).toUpperCase()+u.slice(1),c=a.shapeInfo.texShape,f=c[0],h=c[1],p=Dn();if(c!=null&&pn(o,c))return`
      vec4 `+l+`(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(`+h+".0, "+f+`.0);

        return `+p.texture2D+"("+u+`, uv);
      }
    `;var m=[Math.ceil(c[0]/2),Math.ceil(c[1]/2)],g=Math.ceil(o[1]/2);return`
    vec4 `+l+`(int row, int col) {
      vec2 uv = packedUVfrom2D(`+g+", "+m[0]+", "+m[1]+`, row, col);
      return `+p.texture2D+"("+u+`, uv);
    }
  `}(n);case 3:return function(a){var o=a.shapeInfo.logicalShape,u=a.name,l="get"+u.charAt(0).toUpperCase()+u.slice(1),c=a.shapeInfo.texShape,f=[Math.ceil(c[0]/2),Math.ceil(c[1]/2)];if(o[0]===1){var h=o.slice(1),p=vs(a,h);return`
        `+c2(p)+`
        vec4 `+l+`(int b, int row, int col) {
          return `+l+"("+ms(["b","row","col"],[1,2])+`);
        }
      `}var m=f[0],g=f[1],b=Math.ceil(o[2]/2),x=b*Math.ceil(o[1]/2),w=Dn();return`
    vec4 `+l+`(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        `+m+", "+g+", "+x+", "+b+`, b, row, col);
      return `+w.texture2D+"("+u+`, uv);
    }
  `}(n);default:return function(a){for(var o=a.shapeInfo.logicalShape,u=o.length,l=a.name,c="get"+l.charAt(0).toUpperCase()+l.slice(1),f=a.shapeInfo.texShape,h=[Math.ceil(f[0]/2),Math.ceil(f[1]/2)],p=h[0],m=h[1],g=Math.ceil(o[u-1]/2),b=g*Math.ceil(o[u-2]/2),x="int b, int row, int col",w="b * "+b+" + (row / 2) * "+g+" + (col / 2)",E=2;E<u-1;E++)x="int b"+E+", "+x,b*=o[u-E-1],w="b"+E+" * "+b+" + "+w;var C=Dn();return`
    vec4 `+c+"("+x+`) {
      int index = `+w+`;
      int texR = index / `+m+`;
      int texC = index - texR * `+m+`;
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+m+", "+p+`);
      return `+C.texture2D+"("+l+`, uv);
    }
  `}(n)}}var gN=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,yN=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,bN=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,xN=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function ti(n){return"offset"+n}function is(n){var t=n.name,e=ke(n.shapeInfo.logicalShape);return e<2?"return "+t+";":`
    for (int i = 0; i < `+e+`; i++) {
      if (i == index) {
        return `+t+`[i];
      }
    }
  `}function Et(n){if(n<=1)return"int";if(n===2)return"ivec2";if(n===3)return"ivec3";if(n===4)return"ivec4";if(n===5)return"ivec5";if(n===6)return"ivec6";throw Error("GPU for rank "+n+" is not yet supported")}function vs(n,t){var e=JSON.parse(JSON.stringify(n));return e.shapeInfo.logicalShape=t,e}function ms(n,t){return t.map(function(e){return n[e]}).join(", ")}var wN=function(n,t,e,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,j(n.length>2,function(){return"Packed arg"+(e.charAt(0).toUpperCase()+e.slice(1))+" supports only inputs with rank above 2."});var a=n[n.length-1],o=Math.ceil(a/t);this.outputShape=n.slice(0,-1),o>1&&this.outputShape.push(o),r||this.variableNames.push("bestIndicesA");var u,l,c=this.outputShape,f=c.length,h=Et(f),p=qn("coords",f);if(o===1){var m=Et(l=f+1);u=`
        `+m+" sourceLocR = "+m+"("+p.join()+`, 0);
        ++`+p[f-1]+`;
        `+m+" sourceLocG = "+m+"("+p.join()+`, 0);
        ++`+p[f-2]+`;
        `+m+" sourceLocA = "+m+"("+p.join()+`, 0);
        --`+p[f-1]+`;
        `+m+" sourceLocB = "+m+"("+p.join()+`, 0);
        --`+p[f-2]+";"}else l=f,u=`
        `+h+` sourceLocR = coords;
        ++`+p[f-1]+`;
        `+h+` sourceLocG = coords;
        ++`+p[f-2]+`;
        `+h+` sourceLocA = coords;
        --`+p[f-1]+`;
        `+h+` sourceLocB = coords;
        --`+p[f-2]+";";var g=["x","y","z","w","u","v"].slice(0,l),b="."+g[l-1],x=g.map(function(k){return"int "+k}),w=qn("sourceLocR",l-1).concat("inIdx.r"),E=qn("sourceLocG",l-1).concat("inIdx.g"),C=qn("sourceLocB",l-1).concat("inIdx.b"),_=qn("sourceLocA",l-1).concat("inIdx.a"),R=e==="max"?"greaterThan":"lessThan",A=r?"":`
          inIdx = round(vec4(getBestIndicesAChannel(`+w.join()+`),
                             getBestIndicesAChannel(`+E.join()+`),
                             getBestIndicesAChannel(`+C.join()+`),
                             getBestIndicesAChannel(`+_.join()+")));",D=`vec4(
            getAChannel(`+w.join()+`),
            hasNextCol ? getAChannel(`+E.join()+`) : 0.,
            hasNextRow ? getAChannel(`+C.join()+`) : 0.,
            hasNextRow && hasNextCol ? getAChannel(`+_.join()+") : 0.)",M=r?"":`
      float getBestIndicesAChannel(`+x.join()+`) {
        return getChannel(getBestIndicesA(`+g.join()+`),
                                          vec2(`+g.slice(-2).join()+`));
      }`;this.userCode=`
      float getAChannel(`+x.join()+`) {
        return getChannel(getA(`+g.join()+`),
                               vec2(`+g.slice(-2).join()+`));
      }
      `+M+`
      void main() {
        `+h+` coords = getOutputCoords();
        bool hasNextCol = `+p[f-1]+" < "+(c[f-1]-1)+`;
        bool hasNextRow = `+p[f-2]+" < "+(c[f-2]-1)+`;
        `+u+`
        ivec4 srcIdx = ivec4(sourceLocR`+b+", sourceLocG"+b+`,
          sourceLocB`+b+", sourceLocA"+b+") * "+t+`;
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = `+D+`;

        for (int i = 0; i < `+t+`; i++) {
          inIdx = srcIdx;
          `+A+`
          vec4 candidate = `+D+`;
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(`+R+`(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `},SN=function(n){this.variableNames=["dy"],this.outputShape=n.inShape;var t=n.filterHeight,e=n.filterWidth,r=n.strideHeight,a=n.strideWidth,o=n.dilationHeight,u=n.dilationWidth,l=n.effectiveFilterHeight,c=n.effectiveFilterWidth,f=l-1-n.padInfo.top,h=c-1-n.padInfo.left,p=1/(t*e);this.userCode=`
      const ivec2 pads = ivec2(`+f+", "+h+`);
      const float avgMultiplier = float(`+p+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+l+`;
            wR += `+o+`) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+n.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+c+`;
            wC+= `+u+`) {
            float dyC = float(dyCCorner + wC) / `+a+`.0;

            if (dyC < 0.0 || dyC >= `+n.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `},EN=function(n){this.variableNames=["dy"],this.outputShape=n.inShape;var t=n.filterDepth,e=n.filterHeight,r=n.filterWidth,a=n.strideDepth,o=n.strideHeight,u=n.strideWidth,l=n.dilationDepth,c=n.dilationHeight,f=n.dilationWidth,h=n.effectiveFilterDepth,p=n.effectiveFilterHeight,m=n.effectiveFilterWidth,g=h-1-n.padInfo.front,b=p-1-n.padInfo.top,x=m-1-n.padInfo.left,w=1/(t*e*r);this.userCode=`
      const ivec3 pads = ivec3(`+g+", "+b+", "+x+`);
      const float avgMultiplier = float(`+w+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+h+`;
            wD += `+l+`) {
          float dyD = float(dyDCorner + wD) / `+a+`.0;

          if (dyD < 0.0 || dyD >= `+n.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+p+`;
              wR += `+c+`) {
            float dyR = float(dyRCorner + wR) / `+o+`.0;

            if (dyR < 0.0 || dyR >= `+n.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+m+`;
                wC += `+f+`) {
              float dyC = float(dyCCorner + wC) / `+u+`.0;

              if (dyC < 0.0 || dyC >= `+n.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `},CN=function(n,t,e,r,a,o){this.outputShape=[],this.variableNames=["x","mean","variance"],tt(n,t),tt(n,e);var u="0.0";r!=null&&(tt(n,r),this.variableNames.push("offset"),u="getOffsetAtOutCoords()");var l="1.0";a!=null&&(tt(n,a),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=n,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = `+u+`;
        float scale = `+l+`;
        float inv = scale * inversesqrt(variance + float(`+o+`));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `},_N=function(n,t,e,r,a,o){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],tt(n,t),tt(n,e);var u="vec4(0.0)";r!=null&&(tt(n,r),this.variableNames.push("offset"),u="getOffsetAtOutCoords()");var l="vec4(1.0)";a!=null&&(tt(n,a),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=n,this.userCode=`
      void main() {
        vec4 offset = `+u+`;
        vec4 scale = `+l+`;

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(`+o+`));

        setOutput((x - mean) * inv + offset);
      }
    `},RN="return areal * breal - aimag * bimag;",AN="return areal * bimag + aimag * breal;",Yx=function(n,t,e){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=tt(t,e),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        `+n+`
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `},qp="return a + b;",Xp="return a - b;",Kx="return a * b;",f2="return (a < 0.) ? b * a : a;",Pt=function(n,t,e){this.variableNames=["A","B"],this.outputShape=tt(t,e),this.userCode=`
      float binaryOperation(float a, float b) {
        `+n+`
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `},d2=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`,Ba=function(n,t,e,r){r===void 0&&(r=!1),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=tt(t,e);var a=this.outputShape.length,o="";if(r)if(a===0||ke(this.outputShape)===1)o=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(o=`
          `+Et(a)+` coords = getOutputCoords();
        `,a===1)o+=`
            result.y = (coords + 1) >= `+this.outputShape[0]+` ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{var u=qn("coords",a);o+=`
            bool nextRowOutOfBounds =
              (`+u[a-2]+" + 1) >= "+this.outputShape[a-2]+`;
            bool nextColOutOfBounds =
              (`+u[a-1]+" + 1) >= "+this.outputShape[a-1]+`;
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        `+n+`
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        `+o+`

        setOutput(result);
      }
    `},TN=function(){function n(t){this.variableNames=["A"],this.outputShape=t,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}return n.prototype.getCustomSetupFunc=function(t,e){var r=this;return function(a,o){r.minLoc==null&&(r.minLoc=a.getUniformLocationNoThrow(o,"minVal"),r.maxLoc=a.getUniformLocationNoThrow(o,"maxVal")),a.gl.uniform1f(r.minLoc,t),a.gl.uniform1f(r.maxLoc,e)}},n}(),NN=function(){function n(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}return n.prototype.getCustomSetupFunc=function(t,e){var r=this;return function(a,o){r.minLoc==null&&(r.minLoc=a.getUniformLocationNoThrow(o,"minVal"),r.maxLoc=a.getUniformLocationNoThrow(o,"maxVal")),a.gl.uniform1f(r.minLoc,t),a.gl.uniform1f(r.maxLoc,e)}},n}(),DN=function(n){this.variableNames=["real","imag"],this.outputShape=n,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `},kN=function(n){this.outputShape=[],this.outputShape=ks(n,1),this.variableNames=n.map(function(l,c){return"T"+c});var t=new Array(n.length-1);t[0]=n[0][1];for(var e=1;e<t.length;e++)t[e]=t[e-1]+n[e][1];var r=["if (yC < "+t[0]+") setOutput(getT0(yR, yC));"];for(e=1;e<t.length;e++){var a=t[e-1];r.push("else if (yC < "+t[e]+") setOutput(getT"+e+"(yR, yC-"+a+"));")}var o=t.length,u=t[t.length-1];r.push("else setOutput(getT"+o+"(yR, yC-"+u+"));"),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        `+r.join(`
        `)+`
      }
    `},MN=function(n,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=ks(n,t);var e=this.outputShape,r=e.length,a=Et(r),o=qn("coords",r),u=["x","y","z","w","u","v"].slice(0,r);this.variableNames=n.map(function(w,E){return"T"+E});var l=new Array(n.length-1);l[0]=n[0][t];for(var c=1;c<l.length;c++)l[c]=l[c-1]+n[c][t];var f=u[t],h=u.slice(-2),p=u.join(),m="if ("+f+" < "+l[0]+`) {
        return getChannel(
            getT0(`+p+"), vec2("+h.join()+`));
        }`;for(c=1;c<l.length;c++){var g=l[c-1];m+=`
        if (`+f+" < "+l[c]+"  && "+f+" >= "+l[c-1]+`) {
          return getChannel(
            getT`+c+"("+Wc(u,f,g)+`),
            vec2(`+Wc(h,f,g)+`));
        }`}var b=l.length,x=l[l.length-1];m+=`
        return getChannel(
          getT`+b+"("+Wc(u,f,x)+`),
          vec2(`+Wc(h,f,x)+"));",this.userCode=`
      float getValue(`+u.map(function(w){return"int "+w})+`) {
        `+m+`
      }

      void main() {
        `+a+` coords = getOutputCoords();
        vec4 result = vec4(getValue(`+o+`), 0., 0., 0.);

        `+o[r-1]+" = "+o[r-1]+` + 1;
        if (`+o[r-1]+" < "+e[r-1]+`) {
          result.g = getValue(`+o+`);
        }

        `+o[r-2]+" = "+o[r-2]+` + 1;
        if (`+o[r-2]+" < "+e[r-2]+`) {
          result.a = getValue(`+o+`);
        }

        `+o[r-1]+" = "+o[r-1]+` - 1;
        if (`+o[r-2]+" < "+e[r-2]+` &&
            `+o[r-1]+" < "+e[r-1]+`) {
          result.b = getValue(`+o+`);
        }
        setOutput(result);
      }
    `};function Wc(n,t,e){var r=n.indexOf(t);return n.map(function(a,o){return o===r?a+" - "+e:a}).join()}var ON=function(n){this.variableNames=["x","dy"],this.outputShape=n.filterShape;var t=n.strideHeight,e=n.strideWidth,r=n.padInfo.top,a=n.padInfo.left,o=n.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < `+n.batchSize+`; b++) {
          for (int yR = 0; yR < `+n.outHeight+`; yR++) {
            int xR = wR + yR * `+t+" - "+r+`;

            if (xR < 0 || xR >= `+n.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+n.outWidth+`; yC++) {
              int xC = wC + yC * `+e+" - "+a+`;

              if (xC < 0 || xC >= `+n.inWidth+`) {
                continue;
              }

              if (`+o+`) {
                float dyValue = getDy(b, yR, yC, d2);
                float xValue = getX(b, xR, xC, d1);
                dotProd += (xValue * dyValue);
              } else {
                float dyValue = getDy(b, d2, yR, yC);
                float xValue = getX(b, d1, xR, xC);
                dotProd += (xValue * dyValue);
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},IN=function(n){this.variableNames=["dy","W"],this.outputShape=n.inShape;var t=n.filterHeight,e=n.filterWidth,r=n.strideHeight,a=n.strideWidth,o=n.dataFormat==="channelsLast",u=t-1-n.padInfo.top,l=e-1-n.padInfo.left,c=o?1:2,f=o?2:3,h=o?3:1;this.userCode=`
      const ivec2 pads = ivec2(`+u+", "+l+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[`+h+`];

        ivec2 dyCorner = ivec2(coords[`+c+"], coords["+f+`]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+t+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+n.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+t+` - 1 - wR;

          for (int wC = 0; wC < `+e+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+a+`.0;

            if (dyC < 0.0 || dyC >= `+n.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+e+` - 1 - wC;

            for (int d2 = 0; d2 < `+n.outChannels+`; d2++) {

              if (`+o+`) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},BN=function(n){this.variableNames=["x","dy"],this.outputShape=n.filterShape;var t=n.strideDepth,e=n.strideHeight,r=n.strideWidth,a=n.padInfo.front,o=n.padInfo.top,u=n.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < `+n.batchSize+`; b++) {
          for (int yF = 0; yF < `+n.outDepth+`; yF++) {
            int xF = wF + yF * `+t+" - "+a+`;

            if (xF < 0 || xF >= `+n.inDepth+`) {
              continue;
            }

            for (int yR = 0; yR < `+n.outHeight+`; yR++) {
              int xR = wR + yR * `+e+" - "+o+`;

              if (xR < 0 || xR >= `+n.inHeight+`) {
                continue;
              }

              for (int yC = 0; yC < `+n.outWidth+`; yC++) {
                int xC = wC + yC * `+r+" - "+u+`;

                if (xC < 0 || xC >= `+n.inWidth+`) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},FN=function(n){this.variableNames=["dy","W"],this.outputShape=n.inShape;var t=n.filterDepth,e=n.filterHeight,r=n.filterWidth,a=n.strideDepth,o=n.strideHeight,u=n.strideWidth,l=t-1-n.padInfo.front,c=e-1-n.padInfo.top,f=r-1-n.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(`+l+", "+c+", "+f+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < `+t+`; wF++) {
          float dyF = float(dyFCorner + wF) / `+a+`.0;

          if (dyF < 0.0 || dyF >= `+n.outDepth+`.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = `+t+` - 1 - wF;

          for (int wR = 0; wR < `+e+`; wR++) {
            float dyR = float(dyRCorner + wR) / `+o+`.0;

            if (dyR < 0.0 || dyR >= `+n.outHeight+`.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = `+e+` - 1 - wR;

            for (int wC = 0; wC < `+r+`; wC++) {
              float dyC = float(dyCCorner + wC) / `+u+`.0;

              if (dyC < 0.0 || dyC >= `+n.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = `+r+` - 1 - wC;

              for (int d2 = 0; d2 < `+n.outChannels+`; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},PN=function(n){this.variableNames=["x","dy"],this.outputShape=n.filterShape;var t=n.strideHeight,e=n.strideWidth,r=n.padInfo.top,a=n.padInfo.left,o=n.outChannels/n.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * `+o+` + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < `+n.batchSize+`; b++) {
          for (int yR = 0; yR < `+n.outHeight+`; yR++) {
            int xR = wR + yR * `+t+" - "+r+`;

            if (xR < 0 || xR >= `+n.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+n.outWidth+`; yC++) {
              int xC = wC + yC * `+e+" - "+a+`;

              if (xC < 0 || xC >= `+n.inWidth+`) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `},LN=function(n){this.variableNames=["dy","W"],this.outputShape=n.inShape;var t=n.filterHeight,e=n.filterWidth,r=n.strideHeight,a=n.strideWidth,o=t-1-n.padInfo.top,u=e-1-n.padInfo.left,l=n.outChannels/n.inChannels;this.userCode=`
      const ivec2 pads = ivec2(`+o+", "+u+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < `+t+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+n.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+t+` - 1 - wR;

          for (int wC = 0; wC < `+e+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+a+`.0;

            if (dyC < 0.0 || dyC >= `+n.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+e+` - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < `+l+`; dm++) {
              int d2 = d1 * `+l+` + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `},Qx=function(n,t,e,r){t===void 0&&(t=!1),e===void 0&&(e=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.outputShape=n.outShape;var a=n.padInfo.top,o=n.padInfo.left,u=n.strideHeight,l=n.strideWidth,c=n.dilationHeight,f=n.dilationWidth,h=n.filterHeight,p=n.filterWidth,m=4*Math.floor(n.inChannels/4),g=n.inChannels%4,b=n.dataFormat==="channelsLast",x=b?1:2,w=b?2:3,E=b?3:1,C="",_="";e&&(C=r?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+e+`
        }`:`
          float activation(float x) {
            `+e+`
          }
        `,_="result = activation(result);");var R=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+C+`

      const ivec2 strides = ivec2(`+u+", "+l+`);
      const ivec2 pads = ivec2(`+a+", "+o+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[`+E+`];

        ivec2 xRCCorner =
            ivec2(coords[`+x+"], coords["+w+`]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+h+`; wR++) {
          int xR = xRCorner + wR * `+c+`;

          if (xR < 0 || xR >= `+n.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+p+`; wC++) {
            int xC = xCCorner + wC * `+f+`;

            if (xC < 0 || xC >= `+n.inWidth+`) {
              continue;
            }

            for (int d1 = 0; d1 < `+m+`; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (`+b+`) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (`+(g===1)+`) {

              if (`+b+`) {
                dotProd +=
                    getX(batch, xR, xC, `+m+`) *
                    getW(wR, wC, `+m+`, d2);
              } else {
                dotProd +=
                    getX(batch, `+m+`, xR, xC) *
                    getW(wR, wC, `+m+`, d2);
              }

            } else if (`+(g===2)+`) {
              vec2 wValues = vec2(
                getW(wR, wC, `+m+`, d2),
                getW(wR, wC, `+m+` + 1, d2)
              );

              if (`+b+`) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, `+m+`),
                  getX(batch, xR, xC, `+m+` + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, `+m+`, xR, xC),
                  getX(batch, `+m+` + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (`+(g===3)+`) {
              vec3 wValues = vec3(
                getW(wR, wC, `+m+`, d2),
                getW(wR, wC, `+m+` + 1, d2),
                getW(wR, wC, `+m+` + 2, d2)
              );

              if (`+b+`) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, `+m+`),
                  getX(batch, xR, xC, `+m+` + 1),
                  getX(batch, xR, xC, `+m+` + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, `+m+`, xR, xC),
                  getX(batch, `+m+` + 1, xR, xC),
                  getX(batch, `+m+` + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        `+R+`
        `+_+`
        setOutput(result);
      }
    `},zN=function(n){this.variableNames=["x","W"],this.outputShape=n.outShape;var t=n.padInfo.front,e=n.padInfo.top,r=n.padInfo.left,a=n.strideDepth,o=n.strideHeight,u=n.strideWidth,l=n.dilationDepth,c=n.dilationHeight,f=n.dilationWidth,h=n.filterDepth,p=n.filterHeight,m=n.filterWidth,g=4*Math.floor(n.inChannels/4),b=n.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(`+a+", "+o+", "+u+`);
      const ivec3 pads = ivec3(`+t+", "+e+", "+r+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < `+h+`; wF++) {
          int xF = xFCorner + wF * `+l+`;

          if (xF < 0 || xF >= `+n.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+p+`; wR++) {
            int xR = xRCorner + wR * `+c+`;

            if (xR < 0 || xR >= `+n.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+m+`; wC++) {
              int xC = xCCorner + wC * `+f+`;

              if (xC < 0 || xC >= `+n.inWidth+`) {
                continue;
              }

              for (int d1 = 0; d1 < `+g+`; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (`+(b===1)+`) {
                dotProd +=
                  getX(batch, xF, xR, xC, `+g+`) *
                  getW(wF, wR, wC, `+g+`, d2);
              } else if (`+(b===2)+`) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, `+g+`),
                  getX(batch, xF, xR, xC, `+g+` + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, `+g+`, d2),
                  getW(wF, wR, wC, `+g+` + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (`+(b===3)+`) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, `+g+`),
                  getX(batch, xF, xR, xC, `+g+` + 1),
                  getX(batch, xF, xR, xC, `+g+` + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, `+g+`, d2),
                  getW(wF, wR, wC, `+g+` + 1, d2),
                  getW(wF, wR, wC, `+g+` + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},$x=function(n,t,e,r){t===void 0&&(t=!1),e===void 0&&(e=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.outputShape=n.outShape;var a=n.inHeight,o=n.inWidth,u=n.padInfo.top,l=n.padInfo.left,c=n.strideHeight,f=n.strideWidth,h=n.dilationHeight,p=n.dilationWidth,m=n.filterHeight,g=n.filterWidth,b=n.outChannels/n.inChannels,x="",w="";e&&(x=r?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+e+`
        }`:`
          float activation(float x) {
            `+e+`
          }
        `,w="result = activation(result);");var E=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+x+`

      const ivec2 strides = ivec2(`+c+", "+f+`);
      const ivec2 pads = ivec2(`+u+", "+l+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / `+b+`;
        int q = d2 - d1 * `+b+`;

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < `+m+`; wR++) {
          int xR = xRCorner + wR * `+h+`;

          if (xR < 0 || xR >= `+a+`) {
            continue;
          }

          for (int wC = 0; wC < `+g+`; wC++) {
            int xC = xCCorner + wC * `+p+`;

            if (xC < 0 || xC >= `+o+`) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        `+E+`
        `+w+`
        setOutput(result);
      }
    `},Zx=function(n,t,e,r){t===void 0&&(t=!1),e===void 0&&(e=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.outShape;for(var a=n.inHeight,o=n.inWidth,u=n.padInfo.top,l=n.padInfo.left,c=n.strideHeight,f=n.strideWidth,h=n.dilationHeight,p=n.dilationWidth,m=n.filterHeight,g=n.filterWidth,b=g,x="int xR; int xC; int xCOffset;",w=0;w<m;w++)for(var E=0;E<g;E++)x+=`
          vec4 xTexelR`+w+"C"+2*E+` = vec4(0.);
          vec4 wR`+w+"C"+E+` = vec4(0.);
          vec4 xR`+w+"C"+E+" = vec4(0.);";for(w=0;w<m;w++)for(var C=0;C<b;C++){if(x+=`
          xR = xRCorner + `+w*h+`;
          xC = xCCorner + `+(E=2*C)*p+`;
        `,f===1){if(E<g&&(x+=l%2==1?`
                xCOffset = xC + 1;
                if(xR >= 0 && xR < `+a+" && xCOffset >= 0 && xCOffset < "+o+`) {
                  xTexelR`+w+"C"+E+` = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+o+`) {
                    xTexelR`+w+"C"+E+`.zw = vec2(0.);
                  }
                } else {
                  xTexelR`+w+"C"+E+` = vec4(0.);
                }

                xCOffset = xC + 1 - 2;
                if(xR >= 0 && xR < `+a+" && xCOffset >= 0 && xCOffset < "+o+`) {
                  vec4 previous = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+o+`) {
                    previous.zw = vec2(0.);
                  }

                  xR`+w+"C"+E+" = vec4(previous.zw, xTexelR"+w+"C"+E+`.xy);
                } else {
                  xR`+w+"C"+E+" = vec4(0, 0, xTexelR"+w+"C"+E+`.xy);
                }
              `:`
                if(xR >= 0 && xR < `+a+" && xC >= 0 && xC < "+o+`) {
                  xTexelR`+w+"C"+E+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+w+"C"+E+` = vec4(0.);
                }

                xR`+w+"C"+E+" = xTexelR"+w+"C"+E+`;
              `,E+1<g)){var _=l%2==0?Dw(p):p;p%2==0&&l%2==1||p%2!=0&&l%2!=1?(x+=`
                  xCOffset = xC + `+l%2+" + "+_+`;

                  if(xR >= 0 && xR < `+a+` &&
                    xCOffset >= 0 && xCOffset < `+o+`) {
                    xTexelR`+w+"C"+(E+2)+` = getX(batch, xR, xCOffset, d1);
                  }
                `,p>1&&(x+=`
                    xCOffset -= 2;
                    if(xR >= 0 && xR < `+a+` &&
                      xCOffset >= 0 && xCOffset < `+o+`) {
                      xTexelR`+w+"C"+E+` = getX(batch, xR, xCOffset, d1);
                    } else {
                      xTexelR`+w+"C"+E+` = vec4(0.);
                    }
                  `),x+=`
                  xR`+w+"C"+(E+1)+` = vec4(
                    xTexelR`+w+"C"+E+".zw, xTexelR"+w+"C"+(E+2)+`.xy);
                `):x+=`
                  xCOffset = xC + `+_+`;

                  if(xR >= 0 && xR < `+a+` &&
                    xCOffset >= 0 && xCOffset < `+o+`) {
                    xTexelR`+w+"C"+(E+2)+` = getX(batch, xR, xCOffset, d1);
                  }

                  xR`+w+"C"+(E+1)+" = xTexelR"+w+"C"+(E+2)+`;
                `}}else E<g&&(x+=`
              if(xR >= 0 && xR < `+a+`) {
            `,l%2==1?(x+=`
                xCOffset = xC + 1 - `+f+`;
                if(xCOffset >= 0 && xCOffset < `+o+`) {
                  xTexelR`+w+"C"+E+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+w+"C"+E+` = vec4(0.);
                }

                if(xC + 1 >= 0 && xC + 1 < `+o+`) {
                  xTexelR`+w+"C"+(E+2)+` = getX(batch, xR, xC + 1, d1);
                } else {
                  xTexelR`+w+"C"+(E+2)+` = vec4(0.);
                }

                xR`+w+"C"+E+` = vec4(
                  xTexelR`+w+"C"+E+".zw, xTexelR"+w+"C"+(E+2)+`.zw);
              `,E+1<g&&(x+=`
                  vec4 final = vec4(0.);
                  xCOffset = xC + 1 + `+f+`;
                  if(xCOffset >= 0 && xCOffset < `+o+`) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xR`+w+"C"+(E+1)+" = vec4(xTexelR"+w+"C"+(E+2)+`.xy, final.xy);
                `)):(x+=`
                if(xC >= 0 && xC < `+o+`) {
                  xTexelR`+w+"C"+E+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+w+"C"+E+` = vec4(0.);
                }

                xCOffset = xC + `+f+`;
                if(xCOffset >= 0 && xCOffset < `+o+`) {
                  xTexelR`+w+"C"+(E+2)+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+w+"C"+(E+2)+` = vec4(0.);
                }

                xR`+w+"C"+E+` = vec4(
                  xTexelR`+w+"C"+E+".xy, xTexelR"+w+"C"+(E+2)+`.xy);
              `,E+1<g&&(x+=`
                  xR`+w+"C"+(E+1)+` = vec4(
                    xTexelR`+w+"C"+E+".zw, xTexelR"+w+"C"+(E+2)+`.zw);
                `)),x+="}");E<g&&(x+=`
            vec4 wTexelR`+w+"C"+E+" = getW("+w+", "+E+`, d1, q);
            wR`+w+"C"+E+" = vec4(wTexelR"+w+"C"+E+".xz, wTexelR"+w+"C"+E+`.xz);
          `,E+1<g&&(x+=`
              vec4 wTexelR`+w+"C"+(E+1)+" = getW("+w+", "+(E+1)+`, d1, q);
              wR`+w+"C"+(E+1)+` =
                vec4(wTexelR`+w+"C"+(E+1)+".xz, wTexelR"+w+"C"+(E+1)+".xz);"))}for(w=0;w<m;w++)for(E=0;E<g;E++)x+="dotProd += xR"+w+"C"+E+" * wR"+w+"C"+E+";";var R="",A="";e&&(R=r?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+e+`
        }`:`vec4 activation(vec4 x) {
          `+e+`
        }`,A="result = activation(result);");var D=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+R+`

      const ivec2 strides = ivec2(`+c+", "+f+`);
      const ivec2 pads = ivec2(`+u+", "+l+`);

      void main() {

        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2;
        int q = 0;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        vec4 dotProd = vec4(0.);

        `+x+`

        vec4 result = dotProd;
        `+D+`
        `+A+`
        setOutput(result);
      }
    `},UN=function(n,t,e,r,a){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var o=n[0],u=n[1],l=n[2],c=n[3],f=t[0],h=e[0],p=e[1];this.outputShape=[f,h,p,c];var m=r==="bilinear"?1:0,g=[u-1+".0",l-1+".0"],b=g[0],x=g[1],w=h>1?[""+(u-1)/(h-1),"(y2-y1) * height_ratio","y1*"+b+" + float(y)*(height_scale)"]:["0.0","0.0","0.5 * (y1+y2) * "+b],E=w[0],C=w[1],_=w[2],R=p>1?[""+(l-1)/(p-1),"(x2-x1) * width_ratio","x1*"+x+" + float(x)*(width_scale)"]:["0.0","0.0","0.5 * (x1+x2) * "+x],A=R[0],D=R[1],M=R[2];this.userCode=`
      const float height_ratio = float(`+E+`);
      const float width_ratio = float(`+A+`);
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= `+o+`) {
          return;
        }

        float height_scale = `+C+`;
        float width_scale = `+D+`;

        float in_y = `+_+`;
        if( in_y < 0.0 || in_y > `+b+` ) {
          setOutput(float(`+a+`));
          return;
        }
        float in_x = `+M+`;
        if( in_x < 0.0 || in_x > `+x+` ) {
          setOutput(float(`+a+`));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(`+m+` == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `},jN=function(n,t,e){this.variableNames=["x"],this.outputShape=n;var r=n.length,a=n[n.length-1],o=e?"<":">";this.userCode=`
      int getIndex(int i) {
        `+(e?"return "+a+" -i - 1;":"return i;")+`
      }

      void main() {
        `+Et(r)+` coords = getOutputCoords();
        int end = `+Jx(r,"coords")+`;
        float val = 0.0;
        for (int i = `+a+` - 1; i >= 0; i -= 1) {
          int idx = getIndex(i);
          if (idx `+o+` end) {
            continue;
          }
          if (idx == end && `+t+`) {
            continue;
          }
          `+Jx(r,"coords")+` = idx;
          val += getX(`+function(u,l){if(u===1)return""+l;if(u===2)return l+".x, "+l+".y";if(u===3)return l+".x, "+l+".y, "+l+".z";if(u===4)return l+".x, "+l+".y, "+l+".z, "+l+".w";throw Error("Cumulative sum for rank "+u+" is not yet supported")}(r,"coords")+`);
        }
        setOutput(val);
      }
    `};function Jx(n,t){if(n===1)return""+t;if(n===2)return t+".y";if(n===3)return t+".z";if(n===4)return t+".w";throw Error("Cumulative sum for rank "+n+" is not yet supported")}var HN=function(n){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=tl.DENSE;var t=Ku(n),e=Dn();this.outputShape=n,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+si(["r","c","d"],n)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+t[0]+", "+t[1]+`));
        int index = 4 * (resTexRC.x * `+t[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        `+e.output+` = result;
      }
    `},VN=function(n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=tl.DENSE;var t=Ku(n),e=Dn();this.outputShape=n,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+si(["r","c","d"],n)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+t[0]+", "+t[1]+`));
        int index = 4 * (resTexRC.x * `+t[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        `+e.output+` = result;
      }
    `},WN=function(){function n(t,e,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=e,this.dataFormat=r,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = `+this.getHeightCoordString()+`;
      int w = `+this.getWidthCoordString()+`;
      int d = `+this.getDepthCoordString()+`;

      int in_h = h / `+e+`;
      int offset_h = imod(h, `+e+`);
      int in_w = w / `+e+`;
      int offset_w = imod(w, `+e+`);
      int offset_d = (offset_h * `+e+` + offset_w) *
        `+this.getOutputDepthSize()+`;
      int in_d = d + offset_d;

      float result = `+this.getInputSamplingString()+`;
      setOutput(result);
    }
  `}return n.prototype.getHeightCoordString=function(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"},n.prototype.getWidthCoordString=function(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"},n.prototype.getDepthCoordString=function(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"},n.prototype.getOutputDepthSize=function(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]},n.prototype.getInputSamplingString=function(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"},n}(),GN=function(n){this.variableNames=["X"],this.outputShape=[n,n],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `},qN=function(n){this.variableNames=["A"],this.outTexUsage=sr.DOWNLOAD;var t=Dn();this.outputShape=n,this.userCode=`
      `+l2+`

      void main() {
        float x = getAAtOutCoords();
        `+t.output+` = encode_float(x);
      }
    `},XN=function(n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=sr.DOWNLOAD;var t=Dn();this.outputShape=n,this.userCode=`
      `+l2+`

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        `+t.output+` = encode_float(x);
      }
    `},YN=function(n,t,e){e===void 0&&(e=!1),this.variableNames=["A"];var r=Dn(),a=t[0],o=t[1];this.outputShape=n;var u="result";e&&(u="floor(result * 255. + 0.5)"),this.userCode=`
      `+Am(n)+`

      void main() {
        ivec3 coords = getOutputCoords();

        int flatIndex = getFlatIndex(coords);
        int offset = imod(flatIndex, 4);

        flatIndex = idiv(flatIndex, 4, 1.);
        
        int r = flatIndex / `+o+`;
        int c = imod(flatIndex, `+o+`);
        vec2 uv = (vec2(c, r) + halfCR) / vec2(`+o+".0, "+a+`.0);
        vec4 values = `+r.texture2D+`(A, uv);

        float result;

        if(offset == 0) {
          result = values[0];
        } else if(offset == 1) {
          result = values[1];
        } else if(offset == 2) {
          result = values[2];
        } else {
          result = values[3];
        }

        `+r.output+" = vec4("+u+`, 0., 0., 0.);
      }
    `},KN=function(n,t,e){e===void 0&&(e=!1),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var r=Dn(),a=t[0],o=t[1];this.outputShape=n;var u="",l="result";e&&(l="floor(result * 255. + 0.5)");for(var c=0;c<=1;c++)for(var f=0;f<=1;f++){var h=2*c+f;u+=`
          localCoords = coords;
          if(localCoords[2] + `+f+" < "+n[2]+`) {
            localCoords[2] += `+f+`;
            if(localCoords[1] + `+c+" < "+n[1]+`) {
              localCoords[1] += `+c+`;

              flatIndex = getFlatIndex(localCoords);
              offset = imod(flatIndex, 4);

              flatIndex = idiv(flatIndex, 4, 1.);

              r = flatIndex / `+o+`;
              c = imod(flatIndex, `+o+`);
              uv = (vec2(c, r) + halfCR) / vec2(`+o+".0, "+a+`.0);
              values = `+r.texture2D+`(A, uv);

              if(offset == 0) {
                result[`+h+`] = values[0];
              } else if(offset == 1) {
                result[`+h+`] = values[1];
              } else if(offset == 2) {
                result[`+h+`] = values[2];
              } else {
                result[`+h+`] = values[3];
              }
            }
          }
        `}this.userCode=`
      `+Am(n)+`

      void main() {
        ivec3 coords = getOutputCoords();

        vec4 result = vec4(0.);
        int flatIndex, r, c, offset;
        ivec3 localCoords;
        vec2 uv;
        vec4 values;

        `+u+`

        `+r.output+" = "+l+`;
      }
    `},QN="return real * expR - imag * expI;",$N="return real * expI + imag * expR;",e1=function(n,t,e){this.variableNames=["real","imag"];var r=t[1];this.outputShape=t;var a=e?"2.0 * "+Math.PI:"-2.0 * "+Math.PI,o=e?r+".0":"1.0";this.userCode=`
      const float exponentMultiplier = `+a+`;

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        `+n+`
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(`+r+`);
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < `+r+`; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / `+o+`;
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `},ZN=function(){function n(t,e){this.outputShape=[],this.variableNames=["x"],this.outputShape=t,this.userCode=`
      uniform float value;
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}return n.prototype.getCustomSetupFunc=function(t){var e=this;return function(r,a){e.valueLoc==null&&(e.valueLoc=r.getUniformLocationNoThrow(a,"value")),r.gl.uniform1f(e.valueLoc,t)}},n}(),JN=function(n,t,e){this.variableNames=["A","indices"];var r=n.slice();r[e]=t,this.outputShape=r,this.rank=r.length;var a=Et(this.rank),o=function(u,l){var c=u.length;if(c>4)throw Error("Gather for rank "+c+" is not yet supported");if(c===1)return"int(getIndices(resRC))";for(var f=["resRC.x","resRC.y","resRC.z","resRC.w"],h=[],p=0;p<u.length;p++)p===l?h.push("int(getIndices("+f[p]+"))"):h.push(""+f[p]);return h.join()}(n,e);this.userCode=`
      void main() {
        `+a+` resRC = getOutputCoords();
        setOutput(getA(`+o+`));
      }
    `},eD=function(n,t,e){this.sliceDim=n,this.strides=t,this.variableNames=["x","indices"],this.outputShape=e;var r=Et(t.length),a=Et(e.length),o=this.sliceDim>1?"strides[j]":"strides";this.userCode=`
        `+r+" strides = "+r+"("+this.strides+`);
         void main() {
          `+a+` coords = getOutputCoords();
          int flattenIndex = 0;
          for (int j = 0; j < `+this.sliceDim+`; j++) {
            int index = round(getIndices(coords[0], j));
            flattenIndex += index * `+o+`;
          }
          setOutput(getX(flattenIndex, coords[1]));
        }
      `};function tD(n,t){var e=Dn();return QA(n,t,e.version+`
    precision highp float;
    `+e.attribute+` vec3 clipSpacePos;
    `+e.attribute+` vec2 uv;
    `+e.varyingVs+` vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`)}function nD(n,t){return tT(n,t,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function rD(n,t){return nT(n,t,new Uint16Array([0,1,2,2,1,3]))}function vl(n,t,e,r,a,o,u){aT(e,r);var l=rT(n,t),c=n.TEXTURE_2D;return Me(n,t,function(){return n.bindTexture(c,l)}),Me(n,t,function(){return n.texParameteri(c,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE)}),Me(n,t,function(){return n.texParameteri(c,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE)}),Me(n,t,function(){return n.texParameteri(c,n.TEXTURE_MIN_FILTER,n.NEAREST)}),Me(n,t,function(){return n.texParameteri(c,n.TEXTURE_MAG_FILTER,n.NEAREST)}),Me(n,t,function(){return n.texImage2D(c,0,a,e,r,0,o,u,null)}),Me(n,t,function(){return n.bindTexture(n.TEXTURE_2D,null)}),l}function aD(n,t,e,r,a){var o=Yf(e,r);return vl(n,t,o[0],o[1],a.internalFormatFloat,a.textureFormatFloat,n.FLOAT)}function oD(n,t,e,r,a){var o=Yf(e,r);return vl(n,t,o[0],o[1],a.internalFormatHalfFloat,a.textureFormatFloat,a.textureTypeHalfFloat)}function iD(n,t,e,r,a){var o=Yf(e,r);return vl(n,t,o[0],o[1],n.RGBA,n.RGBA,n.UNSIGNED_BYTE)}function sD(n,t,e,r,a){var o=pl(e,r);return vl(n,t,o[0],o[1],a.internalFormatPackedFloat,n.RGBA,n.FLOAT)}function uD(n,t,e,r,a){var o=pl(e,r);return vl(n,t,o[0],o[1],a.internalFormatPackedHalfFloat,n.RGBA,a.textureTypeHalfFloat)}function lD(n,t,e,r){return Me(n,t,function(){return n.bindBuffer(n.ARRAY_BUFFER,r)}),jx(n,t,e,"clipSpacePos",r,3,20,0)&&jx(n,t,e,"uv",r,2,20,12)}function cD(n,t,e,r,a,o,u){var l,c,f;Me(n,t,function(){return n.bindTexture(n.TEXTURE_2D,e)}),o instanceof Uint8Array?(l=new Uint8Array(r*a*4),c=n.UNSIGNED_BYTE,f=n.RGBA):(l=new Float32Array(r*a*4),c=n.FLOAT,f=u.internalFormatPackedFloat),l.set(o),Me(n,t,function(){return n.texImage2D(n.TEXTURE_2D,0,f,r,a,0,n.RGBA,c,l)}),Me(n,t,function(){return n.bindTexture(n.TEXTURE_2D,null)})}function fD(n,t,e,r){Me(n,t,function(){return n.bindTexture(n.TEXTURE_2D,e)}),r.data instanceof Uint8Array?Me(n,t,function(){return n.texImage2D(n.TEXTURE_2D,0,n.RGBA,r.width,r.height,0,n.RGBA,n.UNSIGNED_BYTE,r.data)}):Me(n,t,function(){return n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,r)}),Me(n,t,function(){return n.bindTexture(n.TEXTURE_2D,null)})}function dD(n,t,e,r,a){var o=n.createBuffer();Me(n,t,function(){return n.bindBuffer(n.PIXEL_PACK_BUFFER,o)});var u=16*e*r;return Me(n,t,function(){return n.bufferData(n.PIXEL_PACK_BUFFER,u,n.STREAM_READ)}),Me(n,t,function(){return n.readPixels(0,0,r,e,n.RGBA,n.FLOAT,0)}),Me(n,t,function(){return n.bindBuffer(n.PIXEL_PACK_BUFFER,null)}),o}function hD(n,t,e){var r=n,a=new Float32Array(e);return r.bindBuffer(r.PIXEL_PACK_BUFFER,t),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,a),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),a}function pD(n,t,e,r,a){var o=Yf(e,r),u=o[0],l=o[1],c=new Uint8Array(e*r*4);return Me(n,t,function(){return n.readPixels(0,0,u,l,a.downloadTextureFormat,n.UNSIGNED_BYTE,c)}),new Float32Array(c.buffer)}function vD(n,t,e,r,a,o,u,l){var c=n,f=new Float32Array(function(h,p){var m=pl(h,p);return m[0]*m[1]*4}(o,u));return c.bindBuffer(c.PIXEL_PACK_BUFFER,t),c.getBufferSubData(c.PIXEL_PACK_BUFFER,0,f),c.bindBuffer(c.PIXEL_PACK_BUFFER,null),f}function mD(n,t,e,r){var a=new Float32Array(e*r*4);return Me(n,t,function(){return n.readPixels(0,0,r,e,n.RGBA,n.FLOAT,a)}),a}var gD=function(){function n(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var e=fe().getNumber("WEBGL_VERSION");t!=null?(this.gl=t,GA(e,t)):this.gl=da(e);var r="WEBGL_color_buffer_float";if(fe().getNumber("WEBGL_VERSION")===1){if(this.textureFloatExtension=Uc(this.gl,this.debug,"OES_texture_float"),Rr(this.gl,"OES_texture_half_float"))this.textureHalfFloatExtension=Uc(this.gl,this.debug,"OES_texture_half_float");else if(fe().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),Rr(this.gl,"EXT_color_buffer_half_float"))this.colorBufferHalfFloatExtension=Uc(this.gl,this.debug,"EXT_color_buffer_half_float");else if(fe().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",Rr(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else{if(!Rr(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=nD(this.gl,this.debug),this.indexBuffer=rD(this.gl,this.debug),this.framebuffer=oT(this.gl,this.debug),this.textureConfig=gm(this.gl,this.textureHalfFloatExtension)}return Object.defineProperty(n.prototype,"debug",{get:function(){return fe().getBool("DEBUG")},enumerable:!0,configurable:!0}),n.prototype.dispose=function(){var t=this;if(!this.disposed){this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var e=this.gl;Me(e,this.debug,function(){return e.finish()}),Me(e,this.debug,function(){return e.bindFramebuffer(e.FRAMEBUFFER,null)}),Me(e,this.debug,function(){return e.deleteFramebuffer(t.framebuffer)}),Me(e,this.debug,function(){return e.bindBuffer(e.ARRAY_BUFFER,null)}),Me(e,this.debug,function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)}),Me(e,this.debug,function(){return e.deleteBuffer(t.indexBuffer)}),this.disposed=!0}},n.prototype.createFloat32MatrixTexture=function(t,e){return this.throwIfDisposed(),aD(this.gl,this.debug,t,e,this.textureConfig)},n.prototype.createFloat16MatrixTexture=function(t,e){return this.throwIfDisposed(),oD(this.gl,this.debug,t,e,this.textureConfig)},n.prototype.createUnsignedBytesMatrixTexture=function(t,e){return this.throwIfDisposed(),iD(this.gl,this.debug,t,e,this.textureConfig)},n.prototype.uploadPixelDataToTexture=function(t,e){this.throwIfDisposed(),fD(this.gl,this.debug,t,e)},n.prototype.uploadDenseMatrixToTexture=function(t,e,r,a){this.throwIfDisposed(),cD(this.gl,this.debug,t,e,r,a,this.textureConfig)},n.prototype.createFloat16PackedMatrixTexture=function(t,e){return this.throwIfDisposed(),uD(this.gl,this.debug,t,e,this.textureConfig)},n.prototype.createPackedMatrixTexture=function(t,e){return this.throwIfDisposed(),sD(this.gl,this.debug,t,e,this.textureConfig)},n.prototype.deleteMatrixTexture=function(t){var e=this;this.throwIfDisposed(),this.outputTexture===t&&(Hx(this.gl,this.debug,this.framebuffer),this.outputTexture=null),Me(this.gl,this.debug,function(){return e.gl.deleteTexture(t)})},n.prototype.downloadByteEncodedFloatMatrixFromOutputTexture=function(t,e,r){var a=this;return this.downloadMatrixDriver(t,function(){return pD(a.gl,a.debug,e,r,a.textureConfig)})},n.prototype.downloadPackedMatrixFromBuffer=function(t,e,r,a,o,u){return vD(this.gl,t,0,0,0,o,u,this.textureConfig)},n.prototype.downloadFloat32MatrixFromBuffer=function(t,e){return hD(this.gl,t,e)},n.prototype.createBufferFromTexture=function(t,e,r){this.bindTextureToFrameBuffer(t);var a=dD(this.gl,this.debug,e,r,this.textureConfig);return this.unbindTextureToFrameBuffer(),a},n.prototype.createAndWaitForFence=function(){var t=this.createFence(this.gl);return this.pollFence(t)},n.prototype.createFence=function(t){var e,r,a=this;if(fe().getBool("WEBGL_FENCE_API_ENABLED")){var o=t,u=o.fenceSync(o.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),r=function(){var l=o.clientWaitSync(u,0,0);return l===o.ALREADY_SIGNALED||l===o.CONDITION_SATISFIED},e=u}else fe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(e=this.beginQuery(),this.endQuery(),r=function(){return a.isQueryAvailable(e,fe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):r=function(){return!0};return{query:e,isFencePassed:r}},n.prototype.downloadMatrixFromPackedTexture=function(t,e,r){var a=this;return this.downloadMatrixDriver(t,function(){return mD(a.gl,a.debug,e,r)})},n.prototype.createProgram=function(t){this.throwIfDisposed();var e=this.gl,r=$A(e,this.debug,t),a=tD(e,this.debug),o=JA(e,this.debug);return Me(e,this.debug,function(){return e.attachShader(o,a)}),Me(e,this.debug,function(){return e.attachShader(o,r)}),eT(e,this.debug,o),this.debug&&Hp(e,this.debug,o),this.vertexAttrsAreBound||(this.setProgram(o),this.vertexAttrsAreBound=lD(e,this.debug,this.program,this.vertexBuffer)),o},n.prototype.deleteProgram=function(t){var e=this;this.throwIfDisposed(),t===this.program&&(this.program=null),t!=null&&Me(this.gl,this.debug,function(){return e.gl.deleteProgram(t)})},n.prototype.setProgram=function(t){var e=this;this.throwIfDisposed(),this.program=t,this.program!=null&&this.debug&&Hp(this.gl,this.debug,this.program),Me(this.gl,this.debug,function(){return e.gl.useProgram(t)})},n.prototype.getUniformLocation=function(t,e,r){return r===void 0&&(r=!0),this.throwIfDisposed(),r?sT(this.gl,this.debug,t,e):uT(this.gl,t,e)},n.prototype.getAttributeLocation=function(t,e){var r=this;return this.throwIfDisposed(),Me(this.gl,this.debug,function(){return r.gl.getAttribLocation(t,e)})},n.prototype.getUniformLocationNoThrow=function(t,e){return this.throwIfDisposed(),this.gl.getUniformLocation(t,e)},n.prototype.setInputMatrixTexture=function(t,e,r){this.throwIfDisposed(),this.throwIfNoProgram(),lT(this.gl,this.debug,this.program,t,e,r)},n.prototype.setOutputMatrixTexture=function(t,e,r){this.setOutputMatrixTextureDriver(t,r,e)},n.prototype.setOutputPackedMatrixTexture=function(t,e,r){this.throwIfDisposed();var a=pl(e,r),o=a[0],u=a[1];this.setOutputMatrixTextureDriver(t,o,u)},n.prototype.setOutputMatrixWriteRegion=function(t,e,r,a){this.setOutputMatrixWriteRegionDriver(r,t,a,e)},n.prototype.setOutputPackedMatrixWriteRegion=function(t,e,r,a){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},n.prototype.debugValidate=function(){this.program!=null&&Hp(this.gl,this.debug,this.program),jc(this.gl)},n.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var t=this.gl;this.debug&&this.debugValidate(),Me(t,this.debug,function(){return t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0)})},n.prototype.blockUntilAllProgramsCompleted=function(){var t=this;this.throwIfDisposed(),Me(this.gl,this.debug,function(){return t.gl.finish()})},n.prototype.getQueryTimerExtension=function(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=Uc(this.gl,this.debug,fe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},n.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},n.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},n.prototype.beginQuery=function(){if(fe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){var t=this.gl,e=this.getQueryTimerExtensionWebGL2(),r=t.createQuery();return t.beginQuery(e.TIME_ELAPSED_EXT,r),r}var a=this.getQueryTimerExtensionWebGL1(),o=a.createQueryEXT();return a.beginQueryEXT(a.TIME_ELAPSED_EXT,o),o},n.prototype.endQuery=function(){if(fe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")!==2){var t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}else{var e=this.gl,r=this.getQueryTimerExtensionWebGL2();e.endQuery(r.TIME_ELAPSED_EXT)}},n.prototype.waitForQueryAndGetTime=function(t){return Te(this,void 0,void 0,function(){var e=this;return Ne(this,function(r){switch(r.label){case 0:return[4,Bx(function(){return e.disposed||e.isQueryAvailable(t,fe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))})];case 1:return r.sent(),[2,this.getQueryTime(t,fe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))]}})})},n.prototype.getQueryTime=function(t,e){if(e===0)return null;if(e===2){var r=this.gl;return r.getQueryParameter(t,r.QUERY_RESULT)/1e6}var a=this.getQueryTimerExtensionWebGL1();return a.getQueryObjectEXT(t,a.QUERY_RESULT_EXT)/1e6},n.prototype.isQueryAvailable=function(t,e){if(e===0)return!0;if(e===2){var r=this.gl,a=this.getQueryTimerExtensionWebGL2(),o=r.getQueryParameter(t,r.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(a.GPU_DISJOINT_EXT)),o&&!this.disjoint}return o=(a=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(t,a.QUERY_RESULT_AVAILABLE_EXT),this.disjoint==null&&(this.disjoint=this.gl.getParameter(a.GPU_DISJOINT_EXT)),o&&!this.disjoint},n.prototype.pollFence=function(t){var e=this;return new Promise(function(r){e.addItemToPoll(function(){return t.isFencePassed()},function(){return r()})})},n.prototype.pollItems=function(){for(var t=function(r){for(var a=0;a<r.length&&r[a]();++a);return a-1}(this.itemsToPoll.map(function(r){return r.isDoneFn})),e=0;e<=t;++e)(0,this.itemsToPoll[e].resolveFn)();this.itemsToPoll=this.itemsToPoll.slice(t+1)},n.prototype.addItemToPoll=function(t,e){var r=this;this.itemsToPoll.push({isDoneFn:t,resolveFn:e}),this.itemsToPoll.length>1||Bx(function(){return r.pollItems(),r.itemsToPoll.length===0})},n.prototype.bindTextureToFrameBuffer=function(t){this.throwIfDisposed(),Vp(this.gl,this.debug,t,this.framebuffer),this.debug&&jc(this.gl)},n.prototype.unbindTextureToFrameBuffer=function(){this.outputTexture!=null?(Vp(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&jc(this.gl)):Hx(this.gl,this.debug,this.framebuffer)},n.prototype.downloadMatrixDriver=function(t,e){this.bindTextureToFrameBuffer(t);var r=e();return this.unbindTextureToFrameBuffer(),r},n.prototype.setOutputMatrixTextureDriver=function(t,e,r){this.throwIfDisposed();var a=this.gl;Vp(a,this.debug,t,this.framebuffer),this.debug&&jc(a),this.outputTexture=t,Me(a,this.debug,function(){return a.viewport(0,0,e,r)}),Me(a,this.debug,function(){return a.scissor(0,0,e,r)})},n.prototype.setOutputMatrixWriteRegionDriver=function(t,e,r,a){var o=this;this.throwIfDisposed(),Me(this.gl,this.debug,function(){return o.gl.scissor(t,e,r,a)})},n.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},n.prototype.throwIfNoProgram=function(){if(this.program==null)throw new Error("No GPU program is currently set.")},n}();function t1(n,t){if(n.length!==t.length)throw Error("Binary was compiled with "+n.length+" inputs, but was executed with "+t.length+" inputs");n.forEach(function(e,r){var a=e.logicalShape,o=t[r],u=o.shape;if(!pn(a,u))throw Error("Binary was compiled with different shapes than the current args. Shapes "+a+" and "+u+" must match");if(!e.isUniform||!o.isUniform){var l=e.texShape,c=o.isUniform?null:o.texData.texShape;if(!pn(l,c))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+l+" and "+c+" must match")}})}var yD=function(n,t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n;for(var r=e.filterWidth,a=e.inChannels,o=e.strideWidth,u=e.strideHeight,l=e.padInfo,c=e.outWidth,f=e.dilationWidth,h=e.dilationHeight,p=e.dataFormat,m=l.left,g=l.top,b=a*r,x=Dn(),w=p==="channelsLast",E=w?0:1,C=w?1:2,_="",R=0;R<=1;R++)for(var A=0;A<=1;A++)_+=`
          blockIndex = rc.y + `+A+`;
          pos = rc.x + `+R+`;

          if(blockIndex < `+n[1]+" && pos < "+n[0]+`) {
            offsetY = int(blockIndex / (`+c+")) * "+u+" - "+g+`;
            d0 = offsetY + `+h+" * (pos / "+b+`);

            if(d0 < `+t[E]+` && d0 >= 0) {

              offsetX = int(mod(float(blockIndex), `+c+".) * "+o+". - "+m+`.);
              d1 = offsetX + `+f+" * (int(mod(float(pos), "+b+".) / "+a+`.));

              if(d1 < `+t[C]+` && d1 >= 0) {

                ch = int(mod(float(pos), `+a+`.));

                if (`+w+`) {
                  innerDims = vec2(d1, ch);
                  result[`+(2*R+A)+`] = getChannel(
                    getA(d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[`+(2*R+A)+`] = getChannel(
                    getA(ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec2 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        `+_+`

        `+x.output+` = result;
      }
    `},bD=function(n,t,e,r,a){this.variableNames=["x"],this.outputShape=[];var o,u=t,l=n[3]-1;this.outputShape=n;var c="float("+e+") + float("+r+") * sum";o=a===.5?"inversesqrt("+c+")":a===1?"1.0/("+c+")":"exp(log("+c+") * float(-"+a+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -`+u+"; j <= "+u+`; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  `+l+`) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * `+o+`;
        setOutput(val);
      }
    `},xD=function(n,t,e,r,a){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=n,this.depth=n[3],this.depthRadius=t,this.bias=e,this.alpha=r,this.beta=a,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < `+this.depth+`; ++d) {
          int depthBegin = int(max(0.0, float(d - `+t+`)));
          int depthEnd = int(min(float(`+this.depth+`),
              float(d + `+t+` + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = `+this.depth+`;

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(`+r+") * norm + float("+e+`);

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(`+r+`)
                * float(`+a+`)
                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * `+a+`);
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `},wD=function(n,t,e,r,a){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var o,u=t,l=n[3]-1;this.outputShape=n;var c="float("+e+") + float("+r+") * sum";o=a===.5?"inversesqrt("+c+")":a===1?"1.0/("+c+")":"exp(log("+c+") * float(-"+a+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < `+this.outputShape[3]+`;
        bool hasNextRow = c < `+this.outputShape[2]+`;

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - `+u+`;
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - `+u+"; j <= "+u+`; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(`+l+`));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * `+o+`;
        setOutput(result);
      }
    `},SD=function(n){this.variableNames=["dy","maxPos"],this.outputShape=n.inShape;var t=n.strideHeight,e=n.strideWidth,r=n.dilationHeight,a=n.effectiveFilterHeight,o=n.effectiveFilterWidth,u=a-1-n.padInfo.top,l=o-1-n.padInfo.left,c=a*o-1;this.userCode=`
      const ivec2 pads = ivec2(`+u+", "+l+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+a+`;
          wR += `+r+`) {
          float dyR = float(dyRCorner + wR) / `+t+`.0;

          if (dyR < 0.0 || dyR >= `+n.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+o+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+e+`.0;

            if (dyC < 0.0 || dyC >= `+n.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = `+c+` - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * `+o+` + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `},ED=function(n){this.variableNames=["dy","maxPos"],this.outputShape=n.inShape;var t=n.strideDepth,e=n.strideHeight,r=n.strideWidth,a=n.dilationDepth,o=n.dilationHeight,u=n.dilationWidth,l=n.effectiveFilterDepth,c=n.effectiveFilterHeight,f=n.effectiveFilterWidth,h=l-1-n.padInfo.front,p=c-1-n.padInfo.top,m=f-1-n.padInfo.left,g=l*c*f-1;this.userCode=`
      const ivec3 pads = ivec3(`+h+", "+p+", "+m+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+l+`;
           wD += `+a+`) {
          float dyD = float(dyDCorner + wD) / `+t+`.0;

          if (dyD < 0.0 || dyD >= `+n.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+c+`;
              wR += `+o+`) {
            float dyR = float(dyRCorner + wR) / `+e+`.0;

            if (dyR < 0.0 || dyR >= `+n.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+f+`;
                wC += `+u+`) {
              float dyC = float(dyCCorner + wC) / `+r+`.0;

              if (dyC < 0.0 || dyC >= `+n.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = `+g+` -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * `+c+" * "+f+` +
                  wR * `+f+` + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `},Yp=function(n,t,e,r,a,o,u){e===void 0&&(e=!1),r===void 0&&(r=!1),a===void 0&&(a=!1),o===void 0&&(o=null),u===void 0&&(u=!1),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;var l=e?n[1]:n[2],c=Math.ceil(l/2),f=e?"i * 2, rc.y":"rc.y, i * 2",h=r?"rc.z, i * 2":"i * 2, rc.z",p=e?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],m=r?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],g="",b="";o&&(g=u?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+o+`
        }`:`vec4 activation(vec4 x) {
          `+o+`
        }`,b="result = activation(result);");var x=a?"result += getBiasAtOutCoords();":"";a&&this.variableNames.push("bias"),u&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+g+`

      const float sharedDimension = `+c+`.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        for (int i = 0; i < `+c+`; i++) {
          vec4 a = getMatrixA(rc.x, `+f+`);
          vec4 b = getMatrixB(rc.x, `+h+`);

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (`+p[0]+" * "+m[0]+`);
          result += (`+p[1]+" * "+m[1]+`);
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        `+x+`

        `+b+`

        setOutput(result);
      }
    `},CD=function(){function n(t,e,r){this.variableNames=["probs"],this.outputShape=[t,r],this.userCode=`
      uniform float seed;

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < `+(e-1)+`; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(`+(e-1)+`));
      }
    `}return n.prototype.getCustomSetupFunc=function(t){var e=this;return function(r,a){e.seedLoc==null&&(e.seedLoc=r.getUniformLocation(a,"seed")),r.gl.uniform1f(e.seedLoc,t)}},n}(),_D=function(n,t,e,r){this.variableNames=["indices"],this.outputShape=[n,t],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(`+r+"), float("+e+`),
                      float(index == coords.y)));
      }
    `},RD=function(n){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=n;var t=n.length;if(t===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{var e=qn("rc",t),r=Et(t),a=function(l,c,f){if(l===1)return"rc > "+c[0];for(var h="",p=l-2;p<l;p++)h+=f[p]+" >= "+c[p],p<l-1&&(h+="||");return h}(t,n,e),o=function(l,c,f,h){if(l===1)return"";var p=h.slice(-2);return`
    int r = `+p[0]+`;
    int c = `+p[1]+`;
    int rp1 = r + 1;
    int cp1 = c + 1;

    bool cEdge = cp1 >= `+c+`;
    bool rEdge = rp1 >= `+f+`;
  `}(t,n[n.length-1],n[n.length-2],e),u=function(l,c){var f=l.length,h=function(p,m){for(var g=[],b=0;b<=1;b++)for(var x=0;x<=1;x++){for(var w=(b===0?"r":"rp1")+", "+(x===0?"c":"cp1"),E=2;E<p;E++)w=m[m.length-1-E]+","+w;g.push(w)}return g}(f,c);return f===1?`getA(rc),
            rc + 1 >= `+l[0]+` ? 0. : getA(rc + 1),
            0, 0`:"getA("+h[0]+`),
          cEdge ? 0. : getA(`+h[1]+`),
          rEdge ? 0. : getA(`+h[2]+`),
          rEdge || cEdge ? 0. : getA(`+h[3]+")"}(n,e);this.userCode=`
        void main() {
          `+r+` rc = getOutputCoords();

          if(`+a+`) {
            setOutput(vec4(0));
          } else {
            `+o+`

            setOutput(vec4(`+u+`));
          }
        }
      `}},AD=function(n,t,e){this.variableNames=["x"],this.outputShape=t.map(function(c,f){return c[0]+n[f]+c[1]});var r=n.length,a=Et(r),o=t.map(function(c){return c[0]}).join(","),u=t.map(function(c,f){return c[0]+n[f]}).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=r!==1?`
      `+a+" start = "+a+"("+o+`);
      `+a+" end = "+a+"("+u+`);

      void main() {
        `+a+` outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(float(`+e+`));
        } else {
          `+a+` coords = outC - start;
          setOutput(getX(`+l+`));
        }
      }
    `:`
        int start = `+o+`;
        int end = `+u+`;

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(float(`+e+`));
          } else {
            setOutput(getX(outC - start));
          }
        }
      `},TD=function(n,t,e){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map(function(w,E){return w[0]+n[E]+w[1]});for(var r=n.length,a=Et(r),o=t.map(function(w){return w[0]}).join(","),u=t.map(function(w,E){return w[0]+n[E]}).join(","),l=qn("rc",r),c=qn("source",r),f=l[r-1]+" < "+this.outputShape[r-1],h=r===1?"source":"vec2("+c.slice(-2).join()+")",p=[a+" rc = outputLoc;",l[r-1]+` += 1;
       if(`+f+`) {
      `,r===1?"":`}
       rc = outputLoc;
       `+l[r-2]+` += 1;
       if(`+l[r-2]+" < "+this.outputShape[r-2]+") {",r===1?"":"  "+l[r-1]+` += 1;
         if(`+f+") {"],m=r===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",g="",b=0,x=r===1?2:4;b<x;b++)g+=`
        `+p[b]+`
        if (`+m+`) {
          result[`+b+"] = float("+e+`);
        } else {
          `+a+` source = rc - start;
          result[`+b+"] = getChannel(getX("+c.join()+"), "+h+`);
        }
      `;g+=r===1?"} ":"}}",this.userCode=`
      const `+a+" start = "+a+"("+o+`);
      const `+a+" end = "+a+"("+u+`);

      void main() {
        `+a+` outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        `+g+`
        setOutput(result);
      }
    `},Kp=function(n,t,e){if(this.variableNames=["x"],t==="avg"&&e)throw new Error("Cannot compute positions for average pool.");var r=n.filterWidth,a=n.strideHeight,o=n.strideWidth,u=n.dilationHeight,l=n.dilationWidth,c=n.effectiveFilterHeight,f=n.effectiveFilterWidth,h=n.padInfo.top,p=n.padInfo.left;this.outputShape=n.outShape;var m=t==="avg",g="0.0";if(m||(g="-1.0 / 1e-20"),e)this.userCode=`
        const ivec2 strides = ivec2(`+a+", "+o+`);
        const ivec2 pads = ivec2(`+h+", "+p+`);

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < `+c+`;
              wR += `+u+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+n.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+f+`;
                wC += `+l+`) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= `+n.inWidth+`) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value >= currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = wR * `+f+` + wC;
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var b=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="avg"&&(b="avgValue / count");var x=4*Math.floor(r/4),w=r%4,E=`
      if (`+m+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(`+a+", "+o+`);
      const ivec2 pads = ivec2(`+h+", "+p+`);
      const float initializationValue = `+g+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= `+n.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+g+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < `+c+`;
            wR += `+u+`) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= `+n.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+x+`; wC += 4) {
            int xC = xCCorner + wC * `+l+`;

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+l+`, d),
              getValue(batch, xR, xC + 2 * `+l+`, d),
              getValue(batch, xR, xC + 3 * `+l+`, d)
            );

            `+E+`
          }

          int xC = xCCorner + `+x+`;
          if (`+(w===1)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            `+E+`
          } else if (`+(w===2)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+l+`, d),
              initializationValue,
              initializationValue
            );

            `+E+`
          } else if (`+(w===3)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+l+`, d),
              getValue(batch, xR, xC + 2 * `+l+`, d),
              initializationValue
            );

            `+E+`
          }
        }
        setOutput(`+b+`);
      }
    `}},Qp=function(n,t,e){if(this.variableNames=["x"],t==="avg"&&e)throw new Error("Cannot compute positions for average pool.");var r=n.filterWidth,a=n.strideDepth,o=n.strideHeight,u=n.strideWidth,l=n.dilationDepth,c=n.dilationHeight,f=n.dilationWidth,h=n.effectiveFilterDepth,p=n.effectiveFilterHeight,m=n.effectiveFilterWidth,g=n.padInfo.front,b=n.padInfo.top,x=n.padInfo.left;this.outputShape=n.outShape;var w=t==="avg",E="0.0";if(w||(E="-1.0 / 1e-20"),e)this.userCode=`
        const ivec3 strides =
            ivec3(`+a+", "+o+", "+u+`);
        const ivec3 pads = ivec3(`+g+", "+b+", "+x+`);

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < `+h+`;
              wD += `+l+`) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= `+n.inDepth+`) {
              continue;
            }

            for (int wR = 0; wR < `+p+`;
                wR += `+c+`) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= `+n.inHeight+`) {
                continue;
              }

              for (int wC = 0; wC < `+m+`;
                  wC += `+f+`) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= `+n.inWidth+`) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value >= currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition =
                      wD * `+p+" * "+m+` +
                      wR * `+m+` + wC;;
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var C=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="avg"&&(C="avgValue / count");var _=4*Math.floor(r/4),R=r%4,A=`
      if (`+w+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(`+a+", "+o+", "+u+`);
      const ivec3 pads = ivec3(`+g+", "+b+", "+x+`);
      const float initializationValue = `+E+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= `+n.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+E+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < `+h+`;
            wD += `+l+`) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= `+n.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+p+`;
            wR += `+c+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+n.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+_+`; wC += 4) {
              int xC = xCCorner + wC * `+f+`;

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+f+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+f+`, ch),
                getValue(batch, xD, xR, xC + 3 * `+f+`, ch)
              );

              `+A+`
            }

            int xC = xCCorner + `+_+`;
            if (`+(R===1)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              `+A+`
            } else if (`+(R===2)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+f+`, ch),
                initializationValue,
                initializationValue
              );

              `+A+`
            } else if (`+(R===3)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+f+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+f+`, ch),
                initializationValue
              );

              `+A+`
            }
          }
          setOutput(`+C+`);
        }
      }
    `}},ND=function(n,t){this.variableNames=["x"];var e=n.windowSize,r=n.batchSize,a=n.inSize,o=Math.ceil(a/e);this.outputShape=[r,o];var u="0.0",l="";t==="prod"?u="1.0":t==="min"?(u="1.0 / 1e-20",l="min"):t==="max"&&(u="-1.0 / 1e-20",l="max");var c=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="sum"?c="sumValue":t==="prod"?c="prodValue":t==="all"?c="allValue":t==="any"&&(c="anyValue");var f=4*Math.floor(e/4),h=e%4,p=`
      if (`+(t==="sum")+`) {
        sumValue += dot(values, ones);
      } else if (`+(t==="prod")+`) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = `+l+`(values, minMaxValue);
      }
    `,m="vec4";t==="all"?(u="1.0",p=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,m="bvec4"):t==="any"&&(u="0.0",p=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,m="bvec4");var g="";a%e>0&&(g=`
        if (inIdx < 0 || inIdx >= `+a+`) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = `+u+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        `+g+`
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+e+`;

        vec4 minMaxValue = vec4(`+u+`);
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < `+f+`; i += 4) {
          int inIdx = inOffset + i;
          `+m+" values = "+m+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          `+p+`
        }

        int inIdx = inOffset + `+f+`;
        if (`+(h===1)+`) {
          `+m+" values = "+m+`(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          `+p+`
        } else if (`+(h===2)+`) {
          `+m+" values = "+m+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          `+p+`
        } else if (`+(h===3)+`) {
          `+m+" values = "+m+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          `+p+`
        }
        setOutput(`+c+`);
      }
    `},DD=function(n,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n;for(var e="",r=0;r<4;r++){var a="thisRC = rc;";r%2==1&&(a+="thisRC.z += 1;"),r>1&&(a+="thisRC.y += 1;"),e+=`
        `+a+`
        `+(r>0?"if(thisRC.y < rows && thisRC.z < cols){":"")+`
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[`+r+`] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        `+(r>0?"}":"")+`
      `}this.userCode=`
      
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      `+si(["r","c","d"],t)+`
      return ivec3(r, c, d);
    }
  
      `+Am(n)+`

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = `+n[1]+`;
        int cols = `+n[2]+`;

        `+e+`

        setOutput(result);
      }
    `},kD=function(n,t,e){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var r=t.shape,a=r[1],o=r[2],u=n.shape,l=u[1],c=u[2],f=[e&&l>1?a-1:a,e&&c>1?o-1:o],h=[e&&l>1?l-1:l,e&&c>1?c-1:c],p=f[0]/h[0],m=f[1]/h[1],g=1/p,b=1/m,x=2*Math.ceil(g)+2,w=2*Math.ceil(b)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+p+`);
        const float widthScale = float(`+m+`);

        const float invHeightScale = float(`+g+`);
        const float invWidthScale = float(`+b+`);

        const int winHeight = int(`+x+`);
        const int winWidth = int(`+w+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+l+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+c+`) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), `+(a-1)+`.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), `+(o-1)+`.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},MD=function(n,t,e,r){this.variableNames=["A"],this.outputShape=[];var a=n[0],o=n[1],u=n[2],l=n[3];this.outputShape=[a,t,e,l];var c=[r&&t>1?o-1:o,r&&e>1?u-1:u],f=[r&&t>1?t-1:t,r&&e>1?e-1:e];this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+c[0]/f[0]+`,
          `+c[1]/f[1]+`);
      const vec2 inputShapeRC = vec2(`+o+".0, "+u+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `},OD=function(n,t,e,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var a=n[0],o=n[1],u=n[2],l=n[3];this.outputShape=[a,t,e,l];var c=[r&&t>1?o-1:o,r&&e>1?u-1:u],f=[r&&t>1?t-1:t,r&&e>1?e-1:e];this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          `+c[0]/f[0]+`,
          `+c[1]/f[1]+`,
          `+c[1]/f[1]+`);
      const vec3 inputShapeRC = vec3(`+o+".0, "+u+`.0,
                                     `+u+`.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < `+(l-1)+`;
        bool hasNextRow = coords.z < `+(e-1)+`;

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `},ID=function(n,t,e){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var r=t.shape,a=r[1],o=r[2],u=n.shape,l=u[1],c=u[2],f=[e&&l>1?a-1:a,e&&c>1?o-1:o],h=[e&&l>1?l-1:l,e&&c>1?c-1:c],p=f[0]/h[0],m=f[1]/h[1],g=1/p,b=1/m,x=2*Math.ceil(g)+2,w=2*Math.ceil(b)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+p+`);
        const float widthScale = float(`+m+`);

        const float invHeightScale = float(`+g+`);
        const float invWidthScale = float(`+b+`);

        const int winHeight = int(`+x+`);
        const int winWidth = int(`+w+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+l+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+c+`) {
              continue;
            }

            float sourceFracRow =
              float(`+f[0]+`) *
                (float(dyR) / float(`+h[0]+`));

            float sourceFracCol =
                float(`+f[1]+`) *
                  (float(dyC) / float(`+h[1]+`));

            int sourceNearestRow = int(min(
                float(int(`+a+`) - 1),
                `+e+` ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(`+o+`) - 1),
                `+e+` ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},BD=function(n,t,e,r){this.variableNames=["A"],this.outputShape=[];var a=n[0],o=n[1],u=n[2],l=n[3];this.outputShape=[a,t,e,l];var c=[r&&t>1?o-1:o,r&&e>1?u-1:u],f=[r&&t>1?t-1:t,r&&e>1?e-1:e],h=r?"0.5":"0.0";this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+c[0]/f[0]+`,
          `+c[1]/f[1]+`);
      const vec2 inputShapeRC = vec2(`+o+".0, "+u+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + `+h+`)));

        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `},FD=function(n,t){this.variableNames=["x"];var e=n.length;if(e>4)throw new Error("WebGL backend: Reverse of rank-"+e+" tensor is not yet supported");if(this.outputShape=n,e!==1){var r=n.map(function(o,u){return function(l){return t.indexOf(l)!==-1&&n[l]!==1?n[l]+" - coords["+l+"] - 1":"coords["+l+"]"}(u)}).join(","),a=Et(e);this.userCode=`
      void main() {
        `+a+` coords = getOutputCoords();
        setOutput(getX(`+r+`));
      }
    `}else this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(`+n[0]+` - coord - 1));
        }
      `},PD=function(n,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var e=n.length;if(e>4)throw new Error("WebGL backend: Reverse of rank-"+e+" tensor is not yet supported");this.outputShape=n;var r=qn("rc",e),a=r[e-1]+" + 1 < "+this.outputShape[e-1],o=r[e-2]+" + 1 < "+this.outputShape[e-2],u=Et(e);function l(c){var f=n.map(function(h,p){return function(m,g){return t.indexOf(m)!==-1&&n[m]!==1?n[m]+" - "+g[m]+" - 1":""+g[m]}(p,c)});return"getChannel(getX("+f.join(",")+"), vec2("+f.slice(-2).join(",")+"))"}this.userCode=e===1?`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(`+n[0]+` - rc - 1),
            `+n[0]+` - rc - 1);
          if(`+a+`){
              result.g = getChannel(getX(`+n[0]+` - (rc  + 1) - 1),
                `+n[0]+` - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:`
        void main() {
          `+u+` rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = `+function(c){return l(c)}(r.slice())+`;
          if(`+a+`){
            result.g = `+function(c){return c[e-1]="("+c[e-1]+" + 1)",l(c)}(r.slice())+`;
          }
          if(`+o+`) {
            result.b = `+function(c){return c[e-2]="("+c[e-2]+" + 1)",l(c)}(r.slice())+`;
            if(`+a+`) {
              result.a = `+function(c){return c[e-1]="("+c[e-1]+" + 1)",c[e-2]="("+c[e-2]+" + 1)",l(c)}(r.slice())+`;
            }
          }
          setOutput(result);
        }
    `},n1=function(n,t,e,r,a,o,u){this.variableNames=["updates","indices","defaultValue"],this.outputShape=o;var l=Et(a.length),c=Et(o.length),f="";e===1?f="i":e===2&&(f="i, j");var h="getIndices("+f+")",p="";r===1?p="i":r===2&&(p="i, coords[1]");var m="getUpdates("+p+")",g=t>1?"strides[j]":"strides";this.userCode=`
        `+l+" strides = "+l+"("+a+`);

        void main() {
          `+c+` coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < `+n+`; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < `+t+`; j++) {
              int index = round(`+h+`);
              flattenedIndex += index * `+g+`;
            }
            if (flattenedIndex == coords[0]) {
              sum += `+m+`;
              found = true;
            }
          }
          setOutput(mix(getDefaultValue(), sum, float(found)));
        }
      `},LD=function(n,t){this.variableNames=["x","segmentIds"];var e=n.windowSize,r=n.batchSize,a=n.inSize,o=n.numSegments,u=o*Math.ceil(a/e);this.outputShape=[r,u];var l=4*Math.floor(e/4),c=e%4,f=`
        sumValue += dot(values, segFilter);
    `,h="";a%e>0&&(h=`
        if (inIdx < 0 || inIdx >= `+a+`) {
          return initializationValue;
        }
      `);var p="";a%e>0&&(p=`
        if (inIdx < 0 || inIdx >= `+a+`) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = 0.0;

      float getValue(int batch, int inIdx) {
        `+h+`
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        `+p+`
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          `+o+")) * float("+e+`));
        int currentSeg = int(mod(float(outIdx), float(`+o+`)));

        float sumValue = 0.0;

        for (int i = 0; i < `+l+`; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          `+f+`
        }

        int inIdx = inOffset + `+l+`;
        if (`+(c===1)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          `+f+`
        } else if (`+(c===2)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          `+f+`
        } else if (`+(c===3)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          `+f+`
        }
        setOutput(sumValue);
      }
    `},zD=function(n,t,e){var r,a;if(this.variableNames=["c","a","b"],this.outputShape=t,e>4)throw Error("Where for rank "+e+" is not yet supported");if(e===1)a="resRC",r="resRC";else{for(var o=["resRC.x","resRC.y","resRC.z","resRC.w"],u=[],l=[],c=0;c<t.length;c++)l.push(""+o[c]),c<n&&u.push(""+o[c]);r=u.join(),a=l.join()}var f=Et(e);this.userCode=`
      void main() {
        `+f+` resRC = getOutputCoords();
        float cVal = getC(`+r+`);
        if (cVal >= 1.0) {
          setOutput(getA(`+a+`));
        } else {
          setOutput(getB(`+a+`));
        }
      }
    `},UD=function(){function n(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;var e,r=Et(this.rank),a="uniform int start["+this.rank+"];",o=function(u){if(u===1)return"sourceLoc";if(u<=6)return $p.slice(0,u).map(function(l){return"sourceLoc."+l}).join(",");throw Error("Slicing for rank "+u+" is not yet supported")}(this.rank);e=`
        `+r+` sourceLoc;
        `+r+` coords = getOutputCoords();
        `+t.map(function(u,l){return"sourceLoc."+$p[l]+" = start["+l+"] + coords."+$p[l]+";"}).join(`
`)+`
      `,this.userCode=`
      `+a+`
      void main() {
        `+e+`
        setOutput(getSource(`+o+`));
      }
    `}return n.prototype.getCustomSetupFunc=function(t){var e=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(r,a){e.startLoc==null&&(e.startLoc=r.getUniformLocationNoThrow(a,"start"),e.startLoc==null)||r.gl.uniform1iv(e.startLoc,t)}},n}(),$p=["x","y","z","w","u","v"],jD=function(){function n(t){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length;var e=Et(this.rank),r=qn("coords",this.rank),a=qn("sourceLoc",this.rank),o=this.rank===1?"sourceLoc":"vec2("+a.slice(-2).join()+")",u="getChannel(getSource("+a.join()+"), "+o+")",l=`
      result.x = `+u+`;
      if (++`+r[this.rank-1]+" < "+t[this.rank-1]+`) {
        ++`+a[this.rank-1]+`;
        result.y = `+u+`;
        --`+a[this.rank-1]+`;
      }
    `,c=this.rank===1?"":`
      --`+r[this.rank-1]+`;
      if (++`+r[this.rank-2]+" < "+t[this.rank-2]+`) {
        ++`+a[this.rank-2]+`;
        result.z = `+u+`;
        if (++`+r[this.rank-1]+" < "+t[this.rank-1]+`) {
          ++`+a[this.rank-1]+`;
          result.w = `+u+`;
        }
      }
    `,f=this.rank<=4?`sourceLoc = coords +
            `+e+"("+t.map(function(h,p){return"start["+p+"]"}).join()+");":t.map(function(h,p){return a[p]+" = "+r[p]+" + start["+p+"];"}).join(`
`);this.userCode=`
      uniform int start[`+this.rank+`];
      void main() {
        `+e+` coords = getOutputCoords();
        `+e+` sourceLoc;
        `+f+`
        vec4 result = vec4(0.);
        `+l+`
        `+c+`
        setOutput(result);
      }
    `}return n.prototype.getCustomSetupFunc=function(t){var e=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(r,a){e.startLoc==null&&(e.startLoc=r.getUniformLocationNoThrow(a,"start"),e.startLoc==null)||r.gl.uniform1iv(e.startLoc,t)}},n}(),HD=function(n,t,e){this.variableNames=["x"],this.outputShape=e;var r=e.length,a=Et(e.length),o=Et(e.length),u="";if(r===1)u="coords * strides + begin";else{var l=0;u=e.map(function(c,f){return l++,e.length===1?"coords * strides["+f+"] + begin["+f+"]":"coords["+(l-1)+"] * strides["+f+"] + begin["+f+"]"}).join(",")}this.userCode=`
      `+a+" begin = "+a+"("+n+`);
      `+a+" strides = "+a+"("+t+`);

      void main() {
        `+o+` coords = getOutputCoords();
        setOutput(getX(`+u+`));
      }
    `},VD=function(){function n(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return n.prototype.acquireTexture=function(t,e,r){var a,o=r1(e,r),u=a1(t,o,r);if(u in this.freeTextures||(this.freeTextures[u]=[]),u in this.usedTextures||(this.usedTextures[u]=[]),this.freeTextures[u].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var l=this.freeTextures[u].shift();return this.usedTextures[u].push(l),l}return this.numUsedTextures++,this.log(),o===or.PACKED_2X2_FLOAT32?a=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):o===or.PACKED_2X2_FLOAT16?a=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):o===or.UNPACKED_FLOAT32?a=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):o===or.UNPACKED_FLOAT16?a=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):o===or.PACKED_4X1_UNSIGNED_BYTE&&(a=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[u].push(a),a},n.prototype.releaseTexture=function(t,e,r,a){if(this.freeTextures!=null){var o=a1(e,r1(r,a),a);o in this.freeTextures||(this.freeTextures[o]=[]),this.freeTextures[o].push(t),this.numFreeTextures++,this.numUsedTextures--;var u=this.usedTextures[o],l=u.indexOf(t);if(l<0)throw new Error("Cannot release a texture that was never provided by this texture manager");u.splice(l,1),this.log()}},n.prototype.log=function(){if(this.logEnabled){var t=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+t+")")}},n.prototype.getNumUsedTextures=function(){return this.numUsedTextures},n.prototype.getNumFreeTextures=function(){return this.numFreeTextures},n.prototype.dispose=function(){var t=this;if(this.freeTextures!=null){for(var e in this.freeTextures)this.freeTextures[e].forEach(function(r){t.gpgpu.deleteMatrixTexture(r)});for(var e in this.usedTextures)this.usedTextures[e].forEach(function(a){t.gpgpu.deleteMatrixTexture(a)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}},n}();function r1(n,t){if(n===sr.UPLOAD)return or.PACKED_2X2_FLOAT32;if(n===sr.RENDER||n==null)return function(e){return fe().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?e?or.PACKED_2X2_FLOAT32:or.UNPACKED_FLOAT32:e?or.PACKED_2X2_FLOAT16:or.UNPACKED_FLOAT16}(t);if(n===sr.DOWNLOAD||n===sr.PIXELS)return or.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+n)}function a1(n,t,e){return n[0]+"_"+n[1]+"_"+t+"_"+e}var WD=function(n,t){this.variableNames=["A"];for(var e=new Array(n.length),r=0;r<e.length;r++)e[r]=n[r]*t[r];this.outputShape=e,this.rank=e.length;var a=Et(this.rank),o=function(u){var l=u.length;if(l>5)throw Error("Tile for rank "+l+" is not yet supported");if(l===1)return"imod(resRC, "+u[0]+")";for(var c=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],f=[],h=0;h<u.length;h++)f.push("imod("+c[h]+", "+u[h]+")");return f.join()}(n);this.userCode=`
      void main() {
        `+a+` resRC = getOutputCoords();
        setOutput(getA(`+o+`));
      }
    `},GD=function(n,t){this.variableNames=["A"];for(var e=new Array(n.length),r=0;r<e.length;r++)e[r]=n[t[r]];this.outputShape=e,this.rank=e.length;var a=Et(this.rank),o=function(u){var l=u.length;if(l>6)throw Error("Transpose for rank "+l+" is not yet supported");for(var c=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],f=new Array(l),h=0;h<u.length;h++)f[u[h]]=c[h];return f.join()}(t);this.userCode=`
    void main() {
      `+a+` resRC = getOutputCoords();
      setOutput(getA(`+o+`));
    }
    `},qD=function(n,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var e=new Array(n.length),r=0;r<e.length;r++)e[r]=n[t[r]];if(this.outputShape=e,this.rank=e.length,this.rank>6)throw Error("Packed transpose for rank "+this.rank+" is not yet supported.");var a=Et(this.rank),o=u2("rc",this.rank),u=new Array(this.rank);for(r=0;r<t.length;r++)u[t[r]]=o[r];var l="vec2("+u.slice(-2).join()+")",c="++"+o[this.rank-1]+" < "+e[this.rank-1],f="getChannel(getA("+u.join()+"), "+l+")";this.userCode=`
    void main() {
      `+a+` rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = `+f+`;
      if(`+c+`) {
        result[1] = `+f+`;
      }
      --`+o[this.rank-1]+`;
      if(++`+o[this.rank-2]+" < "+e[this.rank-2]+`) {
        result[2] = `+f+`;
        if(`+c+`) {
          result[3] = `+f+`;
        }
      }
      setOutput(result);
    }
    `},Tm=1.7580993408473768,Nm=1.0507009873554805,qe=function(n,t){this.variableNames=["A"],this.outputShape=n,this.userCode=`
      float unaryOperation(float x) {
        `+t+`
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `},Hr="if (isnan(x)) return x;",XD="return x;",o1="return abs(x);",h2=Hr+`
  return (x < 0.0) ? 0.0 : x;
`,p2=Hr+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,v2="return (x >= 0.0) ? x : (exp(x) - 1.0);",YD=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = `+Tm+`;
  float scale = `+Nm+`;
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,i1="return -x;",s1="return ceil(x);",u1="return floor(x);",l1="return exp(x);",c1="return exp(x) - 1.0;",KD=Hr+`
  return sin(x);
`,QD=Hr+`
  return cos(x);
`,$D=Hr+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,ZD=Hr+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,JD=Hr+`
  return atan(x);
`,ek=Hr+"return log(x + sqrt(x * x + 1.0));",tk=Hr+`
  if (x < 1.0) return NAN;
  return log(x + sqrt(x * x - 1.0));`,nk=Hr+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
  return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,Gc="return x;",rk="return x;",m2=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,g2=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,y2=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,qu=function(n,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n,this.userCode=`
      vec4 unaryOperation(vec4 x) {
        `+t+`
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `},ak=function(n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=n;var t=n.length,e=qn("rc",t),r=Et(t),a=function(l,c){if(l===1)return"rc";for(var f="",h=0;h<l;h++)f+=c[h],h<l-1&&(f+=",");return f}(t,e),o=e.slice(-2),u=t<=1?"rc":"vec2("+o.join(",")+")";this.userCode=`
      void main() {
        `+r+` rc = getOutputCoords();
        vec4 packedInput = getA(`+a+`);

        setOutput(getChannel(packedInput, `+u+`));
      }
    `},qc={};function Xc(n,t){if(t===void 0&&(t=!1),n==="linear")return t?rk:XD;if(n==="relu")return t?m2:h2;if(n==="elu")return t?y2:v2;if(n==="relu6")return t?g2:p2;if(n==="prelu")return t?d2:f2;throw new Error("Activation "+n+" has not been implemented for the WebGL backend.")}var ok=600,ik=function(n){function t(e){var r,a=n.call(this)||this;if(a.pendingRead=new WeakMap,a.pendingDisposal=new WeakSet,a.dataRefCount=new WeakMap,a.numBytesInGPU=0,a.uploadWaitMs=0,a.downloadWaitMs=0,a.warnedAboutMemory=!1,a.pendingDeletes=0,a.disposed=!1,!fe().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(e==null){var o=da(fe().getNumber("WEBGL_VERSION"));a.binaryCache=((r=fe().getNumber("WEBGL_VERSION"))in qc||(qc[r]={}),qc[r]),a.gpgpu=new gD(o),a.canvas=o.canvas,a.gpgpuCreatedLocally=!0}else a.gpgpu=e,a.binaryCache={},a.gpgpuCreatedLocally=!1,a.canvas=e.gl.canvas;return a.textureManager=new VD(a.gpgpu),a.numMBBeforeWarning=fe().global.screen==null?1024:fe().global.screen.height*fe().global.screen.width*window.devicePixelRatio*ok/1024/1024,a.texData=new Jw(a,Q),a}return jr(t,n),t.prototype.numDataIds=function(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes},t.prototype.write=function(e,r,a){if(fe().getBool("DEBUG")&&this.checkNumericalProblems(e),a==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var o={};return this.texData.set(o,{shape:r,dtype:a,values:e,usage:sr.UPLOAD}),o},t.prototype.move=function(e,r,a,o){if(fe().getBool("DEBUG")&&this.checkNumericalProblems(r),o==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:a,dtype:o,values:r,usage:sr.UPLOAD})},t.prototype.readSync=function(e){var r=this.texData.get(e),a=r.values,o=r.dtype,u=r.complexTensors,l=r.slice,c=r.shape,f=r.isPacked;if(l!=null){var h=void 0;h=f?new qu(c,Gc):new qe(c,Gc);var p=this.runWebGLProgram(h,[{dataId:e,shape:c,dtype:o}],o),m=this.readSync(p.dataId);return this.disposeData(p.dataId),m}if(a!=null)return this.convertAndCacheOnCPU(e);if(o==="string")return a;var g,b,x=this.activeTimers!=null;return x&&(g=Zr()),o==="complex64"?b=Lv(u.real.dataSync(),u.imag.dataSync()):b=this.getValuesFromTexture(e),x&&(this.downloadWaitMs+=Zr()-g),this.convertAndCacheOnCPU(e,b)},t.prototype.read=function(e){return Te(this,void 0,void 0,function(){var r,a,o,u,l,c,f,h,p,m,g,b,x,w,E,C,_,R,A,D,M,k;return Ne(this,function(B){switch(B.label){case 0:if(this.pendingRead.has(e))return r=this.pendingRead.get(e),[2,new Promise(function(O){return r.push(O)})];if(a=this.texData.get(e),o=a.values,u=a.shape,l=a.slice,c=a.dtype,f=a.complexTensors,h=a.isPacked,l!=null)return p=void 0,p=h?new qu(u,Gc):new qe(u,Gc),m=this.runWebGLProgram(p,[{dataId:e,shape:u,dtype:c}],c),g=this.read(m.dataId),this.disposeData(m.dataId),[2,g];if(o!=null)return[2,this.convertAndCacheOnCPU(e)];if(!fe().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&fe().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");return b=null,c!=="complex64"&&fe().get("WEBGL_BUFFER_SUPPORTED")&&(x=this.decode(e),w=this.texData.get(x.dataId),b=(k=this.gpgpu).createBufferFromTexture.apply(k,[w.texture].concat(Ku(u)))),this.pendingRead.set(e,[]),c==="complex64"?[3,2]:[4,this.gpgpu.createAndWaitForFence()];case 1:B.sent(),B.label=2;case 2:return c!=="complex64"?[3,4]:[4,Promise.all([f.real.data(),f.imag.data()])];case 3:return C=B.sent(),_=C[0],R=C[1],E=Lv(_,R),[3,5];case 4:b==null?E=this.getValuesFromTexture(e):(A=ke(u),E=this.gpgpu.downloadFloat32MatrixFromBuffer(b,A)),B.label=5;case 5:return x!=null&&this.disposeData(x.dataId),D=this.convertAndCacheOnCPU(e,E),M=this.pendingRead.get(e),this.pendingRead.delete(e),M.forEach(function(O){return O(D)}),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e),this.pendingDeletes--),[2,D]}})})},t.prototype.checkNumericalProblems=function(e){if(e!=null)for(var r=0;r<e.length;r++){var a=e[r];if(!YA(a))throw fe().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error("The value "+a+" cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'"):Error("The value "+a+" cannot be represented on this device.")}},t.prototype.getValuesFromTexture=function(e){var r,a=this.texData.get(e),o=a.shape,u=a.dtype,l=a.isPacked,c=ke(o);if(fe().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var f=this.decode(e),h=this.texData.get(f.dataId),p=(r=this.gpgpu).downloadMatrixFromPackedTexture.apply(r,[h.texture].concat(Ku(o))).subarray(0,c);return this.disposeData(f.dataId),p}var m=fe().getBool("WEBGL_PACK")&&l===!0,g=m?Wp(o):o,b=m?new XN(g):new qN(g),x=this.runWebGLProgram(b,[{shape:g,dtype:u,dataId:e}],"float32"),w=this.texData.get(x.dataId),E=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(w.texture,w.texShape[0],w.texShape[1]).subarray(0,c);return this.disposeData(x.dataId),E},t.prototype.time=function(e){return Te(this,void 0,void 0,function(){var r,a,o,u,l,c,f;return Ne(this,function(h){switch(h.label){case 0:return r=this.activeTimers,a=[],o=!1,this.programTimersStack==null?(this.programTimersStack=a,o=!0):this.activeTimers.push(a),this.activeTimers=a,e(),u=Ns(this.activeTimers.map(function(p){return p.query})).filter(function(p){return p!=null}),l=Ns(this.activeTimers.map(function(p){return p.name})).filter(function(p){return p!=null}),this.activeTimers=r,o&&(this.programTimersStack=null),c={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},fe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[4,Promise.all(u)]:[3,2];case 1:return f=h.sent(),c.kernelMs=TA(f),c.getExtraProfileInfo=function(){return f.map(function(p,m){return{name:l[m],ms:p}}).map(function(p){return p.name+": "+p.ms}).join(", ")},[3,3];case 2:c.kernelMs={error:"WebGL query timers are not supported in this environment."},h.label=3;case 3:return this.uploadWaitMs=0,this.downloadWaitMs=0,[2,c]}})})},t.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}},t.prototype.startTimer=function(){return fe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:Zr(),endMs:null}},t.prototype.endTimer=function(e){return fe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=Zr(),e)},t.prototype.getQueryTime=function(e){return Te(this,void 0,void 0,function(){var r;return Ne(this,function(a){return fe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[2,this.gpgpu.waitForQueryAndGetTime(e)]:[2,(r=e).endMs-r.startMs]})})},t.prototype.disposeData=function(e){if(!this.pendingDisposal.has(e)){if(this.pendingRead.has(e))return this.pendingDisposal.add(e),void this.pendingDeletes++;if(this.texData.has(e)){this.releaseGPUData(e);var r=this.texData.get(e).complexTensors;r!=null&&(r.real.dispose(),r.imag.dispose()),this.texData.delete(e)}}},t.prototype.releaseGPUData=function(e){var r=this.texData.get(e),a=r.texture,o=r.dtype,u=r.texShape,l=r.usage,c=r.isPacked,f=r.slice,h=f&&f.origDataId||e,p=this.dataRefCount.get(h);p>1?this.dataRefCount.set(h,p-1):(this.dataRefCount.delete(h),a!=null&&(this.numBytesInGPU-=this.computeBytes(u,o),this.textureManager.releaseTexture(a,u,l,c)));var m=this.texData.get(e);m.texture=null,m.texShape=null,m.isPacked=!1,m.slice=null},t.prototype.getTexture=function(e){return this.uploadToGPU(e),this.texData.get(e).texture},t.prototype.getDataInfo=function(e){return this.texData.get(e)},t.prototype.getCPUBackend=function(){return fe().getBool("WEBGL_CPU_FORWARD")?(this.cpuBackend==null&&(this.cpuBackend=Q.findBackend("cpu")),this.cpuBackend):null},t.prototype.shouldExecuteOnCPU=function(e,r){var a=this;return r===void 0&&(r=128),this.getCPUBackend()!=null&&e.every(function(o){return a.texData.get(o.dataId).texture==null&&o.size<r})},t.prototype.getGPGPUContext=function(){return this.gpgpu},t.prototype.complex=function(e,r){var a=this.makeOutput(e.shape,"complex64");return this.texData.get(a.dataId).complexTensors={real:Q.keep(e.clone()),imag:Q.keep(r.clone())},a},t.prototype.real=function(e){return this.texData.get(e.dataId).complexTensors.real.clone()},t.prototype.imag=function(e){return this.texData.get(e.dataId).complexTensors.imag.clone()},t.prototype.slice=function(e,r,a){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.slice(e,r,a);if(ke(a)===0)return En([],a,e.dtype);var o=this.texData.get(e.dataId).isPacked,u=$w(e.shape,r,a);if(o||!u){var l=fe().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new jD(a):new UD(a),c=l.getCustomSetupFunc(r);return this.compileAndRun(l,[e],null,c)}return this.uploadToGPU(e.dataId),this.shallowSlice(e,r,a)},t.prototype.shallowSlice=function(e,r,a){var o=this.texData.get(e.dataId),u=this.makeOutput(a,e.dtype),l=this.texData.get(u.dataId);Object.assign(l,o),l.shape=a,l.dtype=e.dtype;var c=Zw(r,e.strides);o.slice&&(c+=o.slice.flatOffset),l.slice={flatOffset:c,origDataId:o.slice&&o.slice.origDataId||e.dataId};var f=this.dataRefCount.get(l.slice.origDataId)||1;return this.dataRefCount.set(l.slice.origDataId,f+1),u},t.prototype.stridedSlice=function(e,r,a,o){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.stridedSlice(e,r,a,o);var u=Sm(r,a,o);if(u.some(function(c){return c===0}))return En([],u);var l=new HD(r,o,u);return this.compileAndRun(l,[e])},t.prototype.reverse=function(e,r){var a=fe().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new PD(e.shape,r):new FD(e.shape,r);return this.compileAndRun(a,[e])},t.prototype.concat=function(e,r){if(e[0].dtype==="complex64"){var a=e.map(function(g){return _r(g)}),o=e.map(function(g){return ea(g)});return wn(this.concat(a,r),this.concat(o,r))}if(this.shouldExecuteOnCPU(e))return this.cpuBackend.concat(e,r);if(e.length===1)return e[0];if(e.length>fe().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var u=Math.floor(e.length/2),l=this.concat(e.slice(0,u),r),c=this.concat(e.slice(u),r);return this.concat([l,c],r)}if(fe().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&e[0].rank>1){var f=new MN(e.map(function(g){return g.shape}),r);return this.compileAndRun(f,e)}var h=ks(e.map(function(g){return g.shape}),r),p=e.map(function(g){return g.as2D(-1,ke(g.shape.slice(r)))}),m=new kN(p.map(function(g){return g.shape}));return this.compileAndRun(m,p).reshape(h)},t.prototype.neg=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.neg(e);if(fe().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,i1,e.dtype);var r=new qe(e.shape,i1);return this.compileAndRun(r,[e])},t.prototype.batchMatMul=function(e,r,a,o){var u=a?e.shape[2]:e.shape[1],l=o?r.shape[1]:r.shape[2],c=a?e.shape[1]:e.shape[2],f=e.shape[0];if((u===1||l===1)&&c>1e3){a&&(e=e.transpose([0,2,1])),o&&(r=r.transpose([0,2,1]));var h=l===1?e:e.as3D(f,c,1),p=l===1?2:1,m=l===1?r.as3D(f,1,c):r;return this.multiply(h,m).sum(p,!0)}var g=Sn(e.dtype,r.dtype),b=new Yp(e.shape,[f,u,l],a,o);return this.compileAndRun(b,[e,r],g)},t.prototype.fusedBatchMatMul=function(e){var r=e.a,a=e.b,o=e.transposeA,u=e.transposeB,l=e.bias,c=e.activation,f=e.preluActivationWeights,h=o?r.shape[2]:r.shape[1],p=u?a.shape[1]:a.shape[2],m=r.shape[0],g=Sn(r.dtype,a.dtype),b=l!=null,x=f!=null,w=c?Xc(c,!0):null,E=new Yp(r.shape,[m,h,p],o,u,b,w,x),C=[r,a];return l&&C.push(l),f&&C.push(f),this.compileAndRun(E,C,g)},t.prototype.multiply=function(e,r){if(e.dtype==="complex64"){var a=this.texData.get(e.dataId),o=this.texData.get(r.dataId),u=new Yx(RN,e.shape,r.shape),l=new Yx(AN,e.shape,r.shape),c=[this.makeComplexComponentTensorInfo(e,a.complexTensors.real),this.makeComplexComponentTensorInfo(e,a.complexTensors.imag),this.makeComplexComponentTensorInfo(r,o.complexTensors.real),this.makeComplexComponentTensorInfo(r,o.complexTensors.imag)],f=this.compileAndRun(u,c),h=this.compileAndRun(l,c),p=this.complex(f,h);return f.dispose(),h.dispose(),p}if(this.shouldExecuteOnCPU([e,r]))return this.cpuBackend.multiply(e,r);if(fe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,Kx,e.dtype);var m=new Pt(Kx,e.shape,r.shape);return this.compileAndRun(m,[e,r],e.dtype)},t.prototype.batchNormalization=function(e,r,a,o,u,l){var c=[e,r,a],f=null;l!=null&&(f=l.shape,c.push(l));var h=null;if(u!=null&&(h=u.shape,c.push(u)),fe().getBool("WEBGL_PACK_NORMALIZATION")){var p=new _N(e.shape,r.shape,a.shape,f,h,o);return this.compileAndRun(p,c)}var m=new CN(e.shape,r.shape,a.shape,f,h,o);return this.compileAndRun(m,c)},t.prototype.localResponseNormalization4D=function(e,r,a,o,u){var l=fe().getBool("WEBGL_PACK_NORMALIZATION")?new wD(e.shape,r,a,o,u):new bD(e.shape,r,a,o,u);return this.compileAndRun(l,[e])},t.prototype.LRNGrad=function(e,r,a,o,u,l,c){var f=new xD(r.shape,o,u,l,c);return this.compileAndRun(f,[r,a,e])},t.prototype.tile=function(e,r){if(e.dtype==="string"){var a=this.readSync(e.dataId).map(function(u){return bf(u)});return i2(We(e.shape,e.dtype,a),r)}var o=new WD(e.shape,r);return this.compileAndRun(o,[e])},t.prototype.pad=function(e,r,a){var o=fe().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new TD(e.shape,r,a):new AD(e.shape,r,a);return this.compileAndRun(o,[e])},t.prototype.transpose=function(e,r){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.transpose(e,r);var a=fe().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new qD(e.shape,r):new GD(e.shape,r);return this.compileAndRun(a,[e])},t.prototype.gather=function(e,r,a){if(this.shouldExecuteOnCPU([e,r]))return this.cpuBackend.gather(e,r,a);var o=new JN(e.shape,r.size,a);return this.compileAndRun(o,[e,r])},t.prototype.batchToSpaceND=function(e,r,a){j(e.rank<=4,function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"});var o=r.reduce(function(p,m){return p*m}),u=_f(e.shape,r,o),l=Rf(u.length,r.length),c=Af(e.shape,r,o),f=Xw(a,r.length),h=Yw(c,a,r.length);return e.reshape(u).transpose(l).reshape(c).slice(f,h)},t.prototype.spaceToBatchND=function(e,r,a){j(e.rank<=4,function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"});var o=r.reduce(function(m,g){return m*g}),u=[[0,0]];u.push.apply(u,a);for(var l=1+r.length;l<e.shape.length;++l)u.push([0,0]);var c=e.pad(u),f=_f(c.shape,r,o,!1),h=Rf(f.length,r.length,!1),p=Af(c.shape,r,o,!1);return c.reshape(f).transpose(h).reshape(p)},t.prototype.reduce=function(e,r,a){var o=e.shape[0],u=e.shape[1],l=Gp(u),c=new ND({windowSize:l,inSize:u,batchSize:o},r),f=this.compileAndRun(c,[e],a);return f.shape[1]===1?f:this.reduce(f,r,a)},t.prototype.argReduce=function(e,r,a){a===void 0&&(a=null);var o=e.shape[0],u=e.shape[1];a!=null&&(o=a.shape[0],u=a.shape[1]);var l=Gp(u),c=new vN({windowSize:l,inSize:u,batchSize:o},r,a==null),f=[e];a!=null&&f.push(a);var h=this.compileAndRun(c,f,"int32");return h.shape[1]===1?h:this.argReduce(e,r,h)},t.prototype.argReducePacked=function(e,r,a){a===void 0&&(a=null);var o=a!=null?a.shape:e.shape,u=Gp(o[o.length-1]),l=new wN(o,u,r,a==null),c=a==null?[e]:[e,a],f=this.compileAndRun(l,c,"int32");return f.rank===e.rank?this.argReducePacked(e,r,f):f},t.prototype.sum=function(e,r){ar("sum",r,e.rank);var a=Tn(e.shape,r),o=a[0],u=ke(a[1]),l=e.as2D(-1,u),c=Pp(e.dtype);return this.reduce(l,"sum",c).reshape(o)},t.prototype.prod=function(e,r){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.prod(e,r);var a=Tn(e.shape,r),o=a[0],u=ke(a[1]),l=e.as2D(-1,u),c=Pp(e.dtype);return this.reduce(l,"prod",c).reshape(o)},t.prototype.unsortedSegmentSum=function(e,r,a){var o=0,u=ha([o],e.rank),l=e;u!=null&&(l=e.transpose(u),o=pa(1,e.rank)[0]);var c=function(g,b,x){for(var w=[],E=g.length,C=0;C<E;C++)C!==b?w.push(g[C]):w.push(x);return w}(l.shape,o,a),f=ke([l.shape[o]]),h=l.as2D(-1,f),p=Pp(e.dtype),m=this.segOpCompute(h,"unsortedSegmentSum",r,p,a).reshape(c);return u!=null&&(m=m.transpose(ym(u))),m},t.prototype.segOpCompute=function(e,r,a,o,u){var l=e.shape[0],c=e.shape[1],f=function(m,g){var b,x=!1;for(m<=Qw?(b=m,x=!0):b=Nv(m,Math.floor(Math.sqrt(m)));!x;)b>g||b===m?x=!0:b=Nv(m,b+1);return b}(c,u),h=new LD({windowSize:f,inSize:c,batchSize:l,numSegments:u}),p=this.compileAndRun(h,[e,a],o);return p.shape[1]===u?p:(a=Cf(0,u).tile([c/f]),this.segOpCompute(p,r,a,o,u))},t.prototype.argMinMaxReduce=function(e,r,a){var o=[r];if(ar("arg"+a.charAt(0).toUpperCase()+a.slice(1),o,e.rank),!fe().getBool("WEBGL_PACK_REDUCE")||e.rank<=2){var u=Tn(e.shape,o),l=u[0],c=ke(u[1]),f=e.as2D(-1,c);return this.argReduce(f,a).reshape(l)}return this.argReducePacked(e,a)},t.prototype.argMin=function(e,r){return this.argMinMaxReduce(e,r,"min")},t.prototype.argMax=function(e,r){return this.argMinMaxReduce(e,r,"max")},t.prototype.cumsum=function(e,r,a,o){if(r!==e.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis="+(e.rank-1)+" but got axis="+r);var u=new jN(e.shape,a,o);return this.compileAndRun(u,[e])},t.prototype.equal=function(e,r){if(fe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,`
  return vec4(equal(a, b));
`,"bool");var a=new Pt("return float(a == b);",e.shape,r.shape);return this.compileAndRun(a,[e,r],"bool")},t.prototype.notEqual=function(e,r){if(fe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,`
  return vec4(notEqual(a, b));
`,"bool");var a=new Pt("return float(a != b);",e.shape,r.shape);return this.compileAndRun(a,[e,r],"bool")},t.prototype.less=function(e,r){if(this.shouldExecuteOnCPU([e,r]))return this.cpuBackend.less(e,r);if(fe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,`
  return vec4(lessThan(a, b));
`,"bool");var a=new Pt("return float(a < b);",e.shape,r.shape);return this.compileAndRun(a,[e,r],"bool")},t.prototype.lessEqual=function(e,r){if(fe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,`
  return vec4(lessThanEqual(a, b));
`,"bool");var a=new Pt("return float(a <= b);",e.shape,r.shape);return this.compileAndRun(a,[e,r],"bool")},t.prototype.greater=function(e,r){if(this.shouldExecuteOnCPU([e,r]))return this.cpuBackend.greater(e,r);if(fe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,`
  return vec4(greaterThan(a, b));
`,"bool");var a=new Pt("return float(a > b);",e.shape,r.shape);return this.compileAndRun(a,[e,r],"bool")},t.prototype.greaterEqual=function(e,r){if(fe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,`
  return vec4(greaterThanEqual(a, b));
`,"bool");var a=new Pt("return float(a >= b);",e.shape,r.shape);return this.compileAndRun(a,[e,r],"bool")},t.prototype.logicalNot=function(e){var r=new qe(e.shape,"return float(!(x >= 1.0));");return this.compileAndRun(r,[e])},t.prototype.logicalAnd=function(e,r){if(fe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,"bool");var a=new Pt("return float(a >= 1.0 && b >= 1.0);",e.shape,r.shape);return this.compileAndRun(a,[e,r],"bool")},t.prototype.logicalOr=function(e,r){if(fe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,"bool");var a=new Pt("return float(a >= 1.0 || b >= 1.0);",e.shape,r.shape);return this.compileAndRun(a,[e,r],"bool")},t.prototype.select=function(e,r,a){var o=new zD(e.rank,r.shape,r.rank);return this.compileAndRun(o,[e,r,a],Sn(r.dtype,a.dtype))},t.prototype.where=function(e){Sf("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var r=e.dataSync();return Rm(e.shape,r)},t.prototype.topk=function(e,r,a){return s2(e.dataSync(),e.shape,e.dtype,r)},t.prototype.min=function(e,r){ar("min",r,e.rank);var a=Tn(e.shape,r),o=a[0],u=ke(a[1]),l=e.as2D(-1,u);return this.reduce(l,"min",l.dtype).reshape(o)},t.prototype.minimum=function(e,r){if(this.shouldExecuteOnCPU([e,r]))return this.cpuBackend.minimum(e,r);var a=fe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ba(`
  vec4 result = vec4(min(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,e.shape,r.shape):new Pt(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return min(a, b);
`,e.shape,r.shape);return this.compileAndRun(a,[e,r])},t.prototype.mod=function(e,r){var a=fe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ba(`
  vec4 result = mod(a, b);
  vec4 isNaN = vec4(equal(b, vec4(0.0)));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,e.shape,r.shape):new Pt(`if (b == 0.0) return NAN;
  return mod(a, b);`,e.shape,r.shape);return this.compileAndRun(a,[e,r])},t.prototype.max=function(e,r){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.max(e,r);ar("max",r,e.rank);var a=Tn(e.shape,r),o=a[0],u=ke(a[1]),l=e.as2D(-1,u);return this.reduce(l,"max",l.dtype).reshape(o)},t.prototype.maximum=function(e,r){if(this.shouldExecuteOnCPU([e,r]))return this.cpuBackend.maximum(e,r);var a=fe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ba(`
  vec4 result = vec4(max(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,e.shape,r.shape):new Pt(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return max(a, b);
`,e.shape,r.shape);return this.compileAndRun(a,[e,r])},t.prototype.all=function(e,r){ar("all",r,e.rank);var a=Tn(e.shape,r),o=a[0],u=ke(a[1]),l=e.as2D(-1,u);return this.reduce(l,"all",l.dtype).reshape(o)},t.prototype.any=function(e,r){ar("any",r,e.rank);var a=Tn(e.shape,r),o=a[0],u=ke(a[1]),l=e.as2D(-1,u);return this.reduce(l,"any",l.dtype).reshape(o)},t.prototype.realDivide=function(e,r){if(fe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,"float32",!0);var a=new Pt(`
if (a == b) {
  return 1.0;
};
return a / b;`,e.shape,r.shape);return this.compileAndRun(a,[e,r],"float32")},t.prototype.floorDiv=function(e,r){if(fe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,"int32");var a=new Pt(`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,e.shape,r.shape);return this.compileAndRun(a,[e,r],"int32")},t.prototype.add=function(e,r){if(e.dtype==="complex64"&&r.dtype==="complex64")return this.complexSeparableBinaryOp(e,r,qp);if(this.shouldExecuteOnCPU([e,r]))return this.cpuBackend.add(e,r);var a=Sn(e.dtype,r.dtype);if(fe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,qp,a);var o=new Pt(qp,e.shape,r.shape);return this.compileAndRun(o,[e,r],a)},t.prototype.packedUnaryOp=function(e,r,a){var o=new qu(e.shape,r);return this.compileAndRun(o,[e],a)},t.prototype.packedBinaryOp=function(e,r,a,o,u){u===void 0&&(u=!1);var l=new Ba(a,e.shape,r.shape,u);return this.compileAndRun(l,[e,r],o)},t.prototype.complexSeparableBinaryOp=function(e,r,a){var o=this,u=this.texData.get(e.dataId),l=this.texData.get(r.dataId),c=[[u.complexTensors.real,l.complexTensors.real],[u.complexTensors.imag,l.complexTensors.imag]].map(function(m){var g=m[0],b=m[1],x=o.makeComplexComponentTensorInfo(e,g),w=o.makeComplexComponentTensorInfo(r,b),E=new Pt(a,e.shape,r.shape);return o.compileAndRun(E,[x,w],Sn(g.dtype,b.dtype))}),f=c[0],h=c[1],p=this.complex(f,h);return f.dispose(),h.dispose(),p},t.prototype.makeComplexComponentTensorInfo=function(e,r){return{dataId:r.dataId,dtype:r.dtype,shape:e.shape}},t.prototype.addN=function(e){if(e.length===1)return e[0];if(e.length>fe().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var r=Math.floor(e.length/2),a=this.addN(e.slice(0,r)),o=this.addN(e.slice(r));return this.addN([a,o])}var u=e.map(function(f){return f.dtype}).reduce(function(f,h){return Sn(f,h)}),l=e.map(function(f){return f.shape}),c=fe().getBool("WEBGL_PACK")?new pN(e[0].shape,l):new hN(e[0].shape,l);return this.compileAndRun(c,e,u)},t.prototype.subtract=function(e,r){if(e.dtype==="complex64"&&r.dtype==="complex64")return this.complexSeparableBinaryOp(e,r,Xp);if(this.shouldExecuteOnCPU([e,r]))return this.cpuBackend.subtract(e,r);var a=Sn(e.dtype,r.dtype);if(fe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,Xp,e.dtype);var o=new Pt(Xp,e.shape,r.shape);return this.compileAndRun(o,[e,r],a)},t.prototype.pow=function(e,r){var a=fe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ba(`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,e.shape,r.shape):new Pt(`
if(a < 0.0 && floor(b) < b){
  return NAN;
}
if (b == 0.0) {
  return 1.0;
}
return (round(mod(b, 2.0)) != 1) ?
    pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,e.shape,r.shape),o=Sn(e.dtype,r.dtype);return this.compileAndRun(a,[e,r],o)},t.prototype.ceil=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.ceil(e);if(fe().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,s1,e.dtype);var r=new qe(e.shape,s1);return this.compileAndRun(r,[e])},t.prototype.floor=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.floor(e);if(fe().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,u1,e.dtype);var r=new qe(e.shape,u1);return this.compileAndRun(r,[e])},t.prototype.sign=function(e){var r=new qe(e.shape,`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`);return this.compileAndRun(r,[e])},t.prototype.isNaN=function(e){var r=new qe(e.shape,"return float(isnan(x));");return this.compileAndRun(r,[e],"bool")},t.prototype.isInf=function(e){var r=new qe(e.shape,"return float(isinf(x));");return this.compileAndRun(r,[e],"bool")},t.prototype.isFinite=function(e){var r=new qe(e.shape,"return float(!isnan(x) && !isinf(x));");return this.compileAndRun(r,[e],"bool")},t.prototype.round=function(e){var r=new qe(e.shape,`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`);return this.compileAndRun(r,[e])},t.prototype.exp=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.exp(e);if(fe().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,l1,e.dtype);var r=new qe(e.shape,l1);return this.compileAndRun(r,[e])},t.prototype.expm1=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.expm1(e);if(fe().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,c1,e.dtype);var r=new qe(e.shape,c1);return this.compileAndRun(r,[e])},t.prototype.softmax=function(e,r){var a=sn([r],e.shape),o=this.max(e,a),u=Yn(o.shape,a),l=this.subtract(e,o.reshape(u)),c=this.exp(l),f=this.sum(c,a).reshape(u);return this.realDivide(c,f)},t.prototype.log=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.log(e);if(fe().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,`
  vec4 result = log(x);
  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));
  result.r = isNaN.r == 1.0 ? NAN : result.r;
  result.g = isNaN.g == 1.0 ? NAN : result.g;
  result.b = isNaN.b == 1.0 ? NAN : result.b;
  result.a = isNaN.a == 1.0 ? NAN : result.a;

  return result;
`,e.dtype);var r=new qe(e.shape,`if (x < 0.0) return NAN;
  return log(x);`);return this.compileAndRun(r,[e])},t.prototype.log1p=function(e){var r=new qe(e.shape,"return log(1.0 + x);");return this.compileAndRun(r,[e])},t.prototype.sqrt=function(e){var r=new qe(e.shape,"return sqrt(x);");return this.compileAndRun(r,[e])},t.prototype.rsqrt=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.rsqrt(e);var r=new qe(e.shape,"return inversesqrt(x);");return this.compileAndRun(r,[e])},t.prototype.reciprocal=function(e){var r=new qe(e.shape,"return 1.0 / x;");return this.compileAndRun(r,[e])},t.prototype.relu=function(e){var r;return r=fe().getBool("WEBGL_PACK")?new qu(e.shape,m2):new qe(e.shape,h2),this.compileAndRun(r,[e])},t.prototype.relu6=function(e){var r;return r=fe().getBool("WEBGL_PACK")?new qu(e.shape,g2):new qe(e.shape,p2),this.compileAndRun(r,[e])},t.prototype.prelu=function(e,r){var a=fe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ba(d2,e.shape,r.shape):new Pt(f2,e.shape,r.shape);return this.compileAndRun(a,[e,r])},t.prototype.elu=function(e){if(fe().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,y2,e.dtype);var r=new qe(e.shape,v2);return this.compileAndRun(r,[e])},t.prototype.eluDer=function(e,r){var a=fe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ba(`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,e.shape,r.shape):new Pt("return (b >= 1.0) ? a : a * (b + 1.0);",e.shape,r.shape);return this.compileAndRun(a,[e,r])},t.prototype.selu=function(e){var r=new qe(e.shape,YD);return this.compileAndRun(r,[e])},t.prototype.int=function(e){var r=new qe(e.shape,"return float(int(x));");return this.compileAndRun(r,[e],"int32")},t.prototype.clip=function(e,r,a){var o,u=(o=fe().getBool("WEBGL_PACK_CLIP")?new NN(e.shape):new TN(e.shape)).getCustomSetupFunc(r,a);return this.compileAndRun(o,[e],null,u)},t.prototype.abs=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.abs(e);if(fe().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,o1,e.dtype);var r=new qe(e.shape,o1);return this.compileAndRun(r,[e])},t.prototype.complexAbs=function(e){var r=this.texData.get(e.dataId),a=new DN(e.shape),o=[this.makeComplexComponentTensorInfo(e,r.complexTensors.real),this.makeComplexComponentTensorInfo(e,r.complexTensors.imag)];return this.compileAndRun(a,o)},t.prototype.sigmoid=function(e){var r=new qe(e.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(r,[e])},t.prototype.softplus=function(e){var r=new qe(e.shape,`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`);return this.compileAndRun(r,[e])},t.prototype.sin=function(e){var r=new qe(e.shape,KD);return this.compileAndRun(r,[e])},t.prototype.cos=function(e){var r=new qe(e.shape,QD);return this.compileAndRun(r,[e])},t.prototype.tan=function(e){var r=new qe(e.shape,"return tan(x);");return this.compileAndRun(r,[e])},t.prototype.asin=function(e){var r=new qe(e.shape,$D);return this.compileAndRun(r,[e])},t.prototype.acos=function(e){var r=new qe(e.shape,ZD);return this.compileAndRun(r,[e])},t.prototype.atan=function(e){var r=new qe(e.shape,JD);return this.compileAndRun(r,[e])},t.prototype.atan2=function(e,r){var a=fe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ba(`
  vec4 result = atan(a, b);
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,e.shape,r.shape):new Pt(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return atan(a, b);
`,e.shape,r.shape);return this.compileAndRun(a,[e,r])},t.prototype.sinh=function(e){var r=new qe(e.shape,`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`);return this.compileAndRun(r,[e])},t.prototype.cosh=function(e){var r=new qe(e.shape,`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`);return this.compileAndRun(r,[e])},t.prototype.tanh=function(e){var r=new qe(e.shape,`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`);return this.compileAndRun(r,[e])},t.prototype.asinh=function(e){var r=new qe(e.shape,ek);return this.compileAndRun(r,[e])},t.prototype.acosh=function(e){var r=new qe(e.shape,tk);return this.compileAndRun(r,[e])},t.prototype.atanh=function(e){var r=new qe(e.shape,nk);return this.compileAndRun(r,[e])},t.prototype.erf=function(e){var r=new qe(e.shape,`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = 0.3275911;
  float a1 = 0.254829592;
  float a2 = -0.284496736;
  float a3 = 1.421413741;
  float a4 = -1.453152027;
  float a5 = 1.061405429;

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`);return this.compileAndRun(r,[e])},t.prototype.step=function(e,r){var a=new qe(e.shape,function(o){return o===void 0&&(o=0),Hr+`
    return x > 0.0 ? 1.0 : float(`+o+`);
  `}(r));return this.compileAndRun(a,[e])},t.prototype.conv2dByMatMul=function(e,r,a,o,u,l){var c=e.shape,f=this.texData.get(e.dataId),h=a.inChannels,p=c[0]*c[1]*c[2],m=a.outChannels,g=a.dataFormat==="channelsLast",b=(p===1||m===1)&&h>1e3,x=c[2]%2!=0&&!!f.isPacked;if(b||!fe().getBool("WEBGL_LAZILY_UNPACK")||!fe().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!x){var w=g?c[0]*c[1]*c[2]:c[0]*c[2]*c[3],E=this.reshape(e,[1,w,a.inChannels]),C=this.reshape(r,[1,a.inChannels,a.outChannels]);return this.reshape(this.fusedBatchMatMul({a:E,b:C,transposeA:!1,transposeB:!1,bias:o,activation:u,preluActivationWeights:l}),a.outShape)}var _=g?c[0]*c[1]*(c[2]+1):c[0]*c[2]*(c[3]+1),R={dataId:e.dataId,shape:[1,_,a.inChannels],dtype:e.dtype},A=f.shape;f.shape=f.shape.slice(),f.shape[f.shape.length-2]++,j(Vc(f.shape,R.shape),function(){return"packed reshape "+f.shape+" to "+R.shape+" isn't free"});var D=this.reshape(r,[1,a.inChannels,a.outChannels]),M=this.fusedBatchMatMul({a:R,b:D,transposeA:!1,transposeB:!1,bias:o,activation:u,preluActivationWeights:l}),k=this.texData.get(M.dataId);return j(k.isPacked,function(){return"batchMatMul result is expected to be packed"}),f.shape=A,k.shape=a.outShape,Q.makeTensorFromDataId(M.dataId,a.outShape,M.dtype)},t.prototype.conv2dWithIm2Row=function(e,r,a,o,u,l){var c=a.filterWidth,f=a.filterHeight,h=a.inChannels,p=a.outWidth,m=a.outHeight,g=a.dataFormat==="channelsLast",b=c*f*h,x=m*p,w=[b,x],E=e.squeeze([0]),C=r.reshape([1,b,-1]),_=new yD(w,E.shape,a),R=this.compileAndRun(_,[E]).reshape([1,w[0],w[1]]),A=o!=null,D=l!=null,M=u?Xc(u,!0):null,k=new Yp(R.shape,[1,x,a.outChannels],!0,!1,A,M,D),B=[R,C];o&&B.push(o),D&&B.push(l);var O=this.compileAndRun(k,B);return g?O.reshape([1,m,p,a.outChannels]):O.reshape([1,a.outChannels,m,p])},t.prototype.fusedConv2d=function(e){var r=e.input,a=e.filter,o=e.convInfo,u=e.bias,l=e.activation,c=e.preluActivationWeights;if(o.filterHeight===1&&o.filterWidth===1&&o.dilationHeight===1&&o.dilationWidth===1&&o.strideHeight===1&&o.strideWidth===1&&(o.padInfo.type==="SAME"||o.padInfo.type==="VALID"))return this.conv2dByMatMul(r,a,o,u,l,c);if(fe().getBool("WEBGL_CONV_IM2COL")&&r.shape[0]===1)return this.conv2dWithIm2Row(r,a,o,u,l,c);var f=u!=null,h=c!=null,p=l?Xc(l,!1):null,m=new Qx(o,f,p,h),g=[r,a];return u&&g.push(u),c&&g.push(c),this.compileAndRun(m,g)},t.prototype.conv2d=function(e,r,a){if(a.filterHeight===1&&a.filterWidth===1&&a.dilationHeight===1&&a.dilationWidth===1&&a.strideHeight===1&&a.strideWidth===1&&(a.padInfo.type==="SAME"||a.padInfo.type==="VALID"))return this.conv2dByMatMul(e,r,a);if(fe().getBool("WEBGL_CONV_IM2COL")&&e.shape[0]===1)return this.conv2dWithIm2Row(e,r,a);var o=new Qx(a);return this.compileAndRun(o,[e,r])},t.prototype.conv2dDerInput=function(e,r,a){var o=new IN(a);return this.compileAndRun(o,[e,r])},t.prototype.conv2dDerFilter=function(e,r,a){var o=new ON(a);return this.compileAndRun(o,[e,r])},t.prototype.fusedDepthwiseConv2D=function(e){var r,a=e.input,o=e.filter,u=e.convInfo,l=e.bias,c=e.activation,f=e.preluActivationWeights,h=fe().getBool("WEBGL_PACK_DEPTHWISECONV")&&u.strideWidth<=2&&u.outChannels/u.inChannels==1,p=c?Xc(c,h):null,m=[a,o],g=l!=null,b=f!=null;return g&&m.push(l),b&&m.push(f),h?(r=new Zx(u,g,p,b),this.compileAndRun(r,m)):(r=new $x(u,g,p,b),this.compileAndRun(r,m))},t.prototype.depthwiseConv2D=function(e,r,a){var o;return fe().getBool("WEBGL_PACK_DEPTHWISECONV")&&a.strideWidth<=2&&a.outChannels/a.inChannels==1?(o=new Zx(a),this.compileAndRun(o,[e,r])):(o=new $x(a),this.compileAndRun(o,[e,r]))},t.prototype.depthwiseConv2DDerInput=function(e,r,a){var o=new LN(a);return this.compileAndRun(o,[e,r])},t.prototype.depthwiseConv2DDerFilter=function(e,r,a){var o=new PN(a);return this.compileAndRun(o,[e,r])},t.prototype.conv3d=function(e,r,a){var o=new zN(a);return this.compileAndRun(o,[e,r])},t.prototype.conv3dDerInput=function(e,r,a){var o=new FN(a);return this.compileAndRun(o,[e,r])},t.prototype.conv3dDerFilter=function(e,r,a){var o=new BN(a);return this.compileAndRun(o,[e,r])},t.prototype.maxPool=function(e,r){var a=new Kp(r,"max",!1);return this.compileAndRun(a,[e])},t.prototype.avgPool=function(e,r){var a=new Kp(r,"avg",!1);return this.compileAndRun(a,[e],"float32")},t.prototype.maxPoolBackprop=function(e,r,a,o){var u=new Kp(o,"max",!0),l=this.compileAndRun(u,[r]),c=new SD(o),f=this.compileAndRun(c,[e,l],r.dtype);return l.dispose(),f},t.prototype.avgPoolBackprop=function(e,r,a){var o=new SN(a);return this.compileAndRun(o,[e],r.dtype)},t.prototype.cast=function(e,r){return n2(e,r,this)},t.prototype.unstack=function(e,r){for(var a=e.shape[r],o=new Array(e.rank-1),u=0,l=0;l<e.rank;l++)l!==r&&(o[u++]=e.shape[l]);var c=new Array(e.rank).fill(0),f=e.shape.slice();f[r]=1;var h=new Array(a);for(l=0;l<h.length;l++)c[r]=l,h[l]=this.slice(e,c,f).reshape(o);return h},t.prototype.avgPool3d=function(e,r){var a=new Qp(r,"avg",!1);return this.compileAndRun(a,[e],"float32")},t.prototype.avgPool3dBackprop=function(e,r,a){var o=new EN(a);return this.compileAndRun(o,[e],r.dtype)},t.prototype.maxPool3d=function(e,r){var a=new Qp(r,"max",!1);return this.compileAndRun(a,[e],"float32")},t.prototype.maxPool3dBackprop=function(e,r,a,o){var u=new Qp(o,"max",!0),l=this.compileAndRun(u,[r]),c=new ED(o),f=this.compileAndRun(c,[e,l],r.dtype);return l.dispose(),f},t.prototype.reshape=function(e,r){var a=this.texData.get(e.dataId);if(a.isPacked&&!Vc(e.shape,r)&&(a.texture===null||!Vc(a.shape,r))){var o=this.packedReshape(e,r);return Q.makeTensorFromDataId(o.dataId,o.shape,o.dtype)}return Pv(e,r)},t.prototype.resizeBilinear=function(e,r,a,o){var u=fe().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new OD(e.shape,r,a,o):new MD(e.shape,r,a,o);return this.compileAndRun(u,[e],"float32")},t.prototype.resizeBilinearBackprop=function(e,r,a){var o=new kD(e,r,a);return this.compileAndRun(o,[e])},t.prototype.resizeNearestNeighbor=function(e,r,a,o){var u=new BD(e.shape,r,a,o);return this.compileAndRun(u,[e])},t.prototype.resizeNearestNeighborBackprop=function(e,r,a){var o=new ID(e,r,a);return this.compileAndRun(o,[e])},t.prototype.multinomial=function(e,r,a,o){var u=r?e:Ua(e),l=u.shape[0],c=u.shape[1],f=new CD(l,c,a),h=f.getCustomSetupFunc(o);return this.compileAndRun(f,[u],"int32",h)},t.prototype.oneHot=function(e,r,a,o){var u=new _D(e.size,r,a,o);return this.compileAndRun(u,[e])},t.prototype.diag=function(e){var r=new GN(e.size);return this.compileAndRun(r,[e])},t.prototype.nonMaxSuppression=function(e,r,a,o,u){return Sf("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead"),Cm(e.dataSync(),r.dataSync(),a,o,u)},t.prototype.cropAndResize=function(e,r,a,o,u,l){var c=new UN(e.shape,r.shape,o,u,l);return this.compileAndRun(c,[e,r,a],"float32")},t.prototype.depthToSpace=function(e,r,a){j(r>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+r});var o=e.shape[0],u=a==="NHWC"?e.shape[1]:e.shape[2],l=a==="NHWC"?e.shape[2]:e.shape[3],c=a==="NHWC"?e.shape[3]:e.shape[1],f=u*r,h=l*r,p=c/(r*r),m=new WN(a==="NHWC"?[o,f,h,p]:[o,p,f,h],r,a);return this.compileAndRun(m,[e])},t.prototype.split=function(e,r,a){return o2(e,r,a)},t.prototype.scatterND=function(e,r,a){var o=Tf(0,e,a),u=o.sliceRank,l=o.numUpdates,c=o.sliceSize,f=o.strides,h=o.outputSize,p=[h/c,c],m=e.reshape([l,u]),g=r.reshape([l,c]);if(h===0)return Pv(En([]),a);var b=Se(0),x=new n1(l,u,m.rank,g.rank,f,p);return this.compileAndRun(x,[g,m,b]).reshape(a)},t.prototype.sparseToDense=function(e,r,a,o){var u=Tf(0,e,a),l=u.sliceRank,c=u.numUpdates,f=u.strides,h=u.outputSize,p=new n1(c,l,e.rank,r.rank,f,[h,1]);return this.compileAndRun(p,[r,e,o]).reshape(a)},t.prototype.fft=function(e){return this.fftImpl(e,!1)},t.prototype.ifft=function(e){return this.fftImpl(e,!0)},t.prototype.fftImpl=function(e,r){var a=this.texData.get(e.dataId),o=new e1(QN,e.shape,r),u=new e1($N,e.shape,r),l=[this.makeComplexComponentTensorInfo(e,a.complexTensors.real),this.makeComplexComponentTensorInfo(e,a.complexTensors.imag)],c=this.compileAndRun(o,l),f=this.compileAndRun(u,l),h=this.complex(c,f).as2D(e.shape[0],e.shape[1]);return c.dispose(),f.dispose(),h},t.prototype.gatherND=function(e,r){var a=r.shape,o=a[a.length-1],u=Kw(e,r),l=u[0],c=u[1],f=u[2],h=u[3],p=r.reshape([c,o]),m=e.reshape([e.size/f,f]),g=new eD(o,h,[c,f]);return this.compileAndRun(g,[m,p]).reshape(l)},t.prototype.fill=function(e,r,a){if((a=a||dl(r))==="string"){var o=yf(a,ke(e));return o.fill(r),Q.makeTensor(o,e,a,this)}var u=new ZN(e,r),l=u.getCustomSetupFunc(r);return this.compileAndRun(u,[],a,l)},t.prototype.onesLike=function(e){if(e.dtype==="string")throw new Error("onesLike is not supported under string dtype");return this.fill(e.shape,1,e.dtype)},t.prototype.zerosLike=function(e){return this.fill(e.shape,e.dtype==="string"?"":0,e.dtype)},t.prototype.linspace=function(e,r,a){return r2(e,r,a)},t.prototype.makeTensorInfo=function(e,r){var a=this.write(null,e,r);return this.texData.get(a).usage=null,{dataId:a,shape:e,dtype:r}},t.prototype.makeOutput=function(e,r){var a=this.makeTensorInfo(e,r).dataId;return Q.makeTensorFromDataId(a,e,r,this)},t.prototype.unpackTensor=function(e){var r=new ak(e.shape);return this.runWebGLProgram(r,[e],e.dtype)},t.prototype.packTensor=function(e){var r=new RD(e.shape);return this.runWebGLProgram(r,[e],e.dtype,null,!0)},t.prototype.packedReshape=function(e,r){var a=[xf(e.shape)].concat(wf(e.shape)),o={dtype:e.dtype,shape:a,dataId:e.dataId},u=[xf(r)].concat(wf(r)),l=new DD(u,a),c=this.runWebGLProgram(l,[o],e.dtype,null,!0);return{dataId:c.dataId,shape:r,dtype:c.dtype}},t.prototype.decode=function(e){var r,a=this.texData.get(e),o=a.isPacked,u=a.shape,l=a.dtype,c=Wp(u);return r=o?new VN(c):new HN(c),{dtype:l,shape:u,dataId:this.runWebGLProgram(r,[{shape:c,dtype:l,dataId:e}],l,null,!0).dataId}},t.prototype.runWebGLProgram=function(e,r,a,o,u){var l=this;u===void 0&&(u=!1);var c=this.makeTensorInfo(e.outputShape,a),f=this.texData.get(c.dataId);if(e.packedOutput&&(f.isPacked=!0),e.outPackingScheme===tl.DENSE){var h=Ku(e.outputShape);f.texShape=h.map(function(_){return 2*_})}if(e.outTexUsage!=null&&(f.usage=e.outTexUsage),ke(c.shape)===0)return f.values=Ju(c.dtype,0),c;var p=[],m=r.map(function(_){if(_.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var R=l.texData.get(_.dataId);if(R.texture==null){if(!e.packedInputs&&ke(_.shape)<=fe().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:_.shape,texData:null,isUniform:!0,uniformValues:R.values};e.packedInputs&&(R.isPacked=!0,R.shape=_.shape)}else if(!!R.isPacked!=!!e.packedInputs)_=R.isPacked?l.unpackTensor(_):l.packTensor(_),p.push(_),R=l.texData.get(_.dataId);else if(R.isPacked&&!Vc(R.shape,_.shape)){var A=_,D=_.shape;_.shape=R.shape,_=l.packedReshape(_,D),p.push(_),R=l.texData.get(_.dataId),A.shape=D}return l.uploadToGPU(_.dataId),{shape:_.shape,texData:R,isUniform:!1}});this.uploadToGPU(c.dataId);var g,b={shape:c.shape,texData:f,isUniform:!1},x=function(_,R,A){var D="";R.concat(A).forEach(function(B){var O=B.texData!=null&&B.texData.slice!=null&&B.texData.slice.flatOffset>0,V=B.isUniform?"uniform":B.texData.texShape;D+=B.shape+"_"+V+"_"+O});var M=_.userCode,k=_.constructor.name;return k+="_"+D+"_"+M}(e,m,b),w=this.getAndSaveBinary(x,function(){return function(_,R,A,D){var M=R.userCode,k=A.map(function(U,Z){var P={logicalShape:U.shape,texShape:U.isUniform?null:U.texData.texShape,isUniform:U.isUniform,isPacked:!U.isUniform&&U.texData.isPacked,flatOffset:null};return U.texData!=null&&U.texData.slice!=null&&U.texData.slice.flatOffset>0&&(P.flatOffset=U.texData.slice.flatOffset),{name:R.variableNames[Z],shapeInfo:P}}),B=k.map(function(U){return U.shapeInfo}),O={logicalShape:D.shape,texShape:D.texData.texShape,isUniform:!1,isPacked:D.texData.isPacked,flatOffset:null},V=mN(k,O,M,R.packedInputs),H=_.createProgram(V),ee=null,$=_.getUniformLocation(H,"NAN",!1);fe().getNumber("WEBGL_VERSION")===1&&(ee=_.getUniformLocation(H,"INFINITY",!1));for(var K={},L=0;L<R.variableNames.length;L++){var W=R.variableNames[L];K[W]=_.getUniformLocation(H,W,!1),K["offset"+W]=_.getUniformLocation(H,"offset"+W,!1)}return{program:R,source:V,webGLProgram:H,uniformLocations:K,inShapeInfos:B,outShapeInfo:O,infLoc:ee,nanLoc:$}}(l.gpgpu,e,m,b)}),E=this.activeTimers!=null;if(E&&(g=this.startTimer()),function(_,R,A,D,M){t1(R.inShapeInfos,A),t1([R.outShapeInfo],[D]);var k=D.texData.texture,B=D.texData.texShape;D.texData.isPacked?_.setOutputPackedMatrixTexture(k,B[0],B[1]):_.setOutputMatrixTexture(k,B[0],B[1]),_.setProgram(R.webGLProgram),fe().getNumber("WEBGL_VERSION")===1&&R.infLoc!==null&&_.gl.uniform1f(R.infLoc,1/0),R.nanLoc!==null&&_.gl.uniform1f(R.nanLoc,NaN),A.forEach(function(O,V){var H=R.program.variableNames[V],ee=R.uniformLocations[H],$=R.uniformLocations["offset"+H];if(ee!=null)if(O.isUniform)if(ke(O.shape)<2)_.gl.uniform1f(ee,O.uniformValues[0]);else{var K=O.uniformValues;K instanceof Float32Array||(K=new Float32Array(K)),_.gl.uniform1fv(ee,K)}else O.texData.slice!=null&&$!=null&&_.gl.uniform1i($,O.texData.slice.flatOffset),_.setInputMatrixTexture(O.texData.texture,ee,V)}),M?.(_,R.webGLProgram),_.executeProgram()}(this.gpgpu,w,m,b,o),p.forEach(function(_){return l.disposeData(_.dataId)}),E&&(g=this.endTimer(g),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(g)})),!fe().getBool("WEBGL_LAZILY_UNPACK")&&f.isPacked&&u===!1){var C=this.unpackTensor(c);return this.disposeData(c.dataId),C}return c},t.prototype.compileAndRun=function(e,r,a,o,u){u===void 0&&(u=!1),a=a||r[0].dtype;var l=this.runWebGLProgram(e,r,a,o,u);return Q.makeTensorFromDataId(l.dataId,l.shape,l.dtype)},t.prototype.getAndSaveBinary=function(e,r){return e in this.binaryCache||(this.binaryCache[e]=r()),this.binaryCache[e]},t.prototype.getTextureManager=function(){return this.textureManager},t.prototype.dispose=function(){var e=this;this.disposed||(fe().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(function(r){e.gpgpu.deleteProgram(e.binaryCache[r].webGLProgram),delete e.binaryCache[r]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)},t.prototype.floatPrecision=function(){var e=this;return this.floatPrecisionValue==null&&(this.floatPrecisionValue=Ce(function(){if(!fe().get("WEBGL_RENDER_FLOAT32_ENABLED")){var r=fe().getBool("DEBUG");fe().set("DEBUG",!1);var a=e.abs(Se(1e-8)).dataSync()[0];if(fe().set("DEBUG",r),a>0)return 32}return 16})),this.floatPrecisionValue},t.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},t.prototype.uploadToGPU=function(e){var r,a=this.texData.get(e),o=a.shape,u=a.dtype,l=a.values,c=a.texture,f=a.usage,h=a.isPacked;if(c==null){var p,m=this.activeTimers!=null;m&&(p=Zr());var g=a.texShape;if(g==null&&(g=dT(o,h),a.texShape=g),l!=null){var b=Wp(o),x=void 0,w=g[1],E=g[0],C=l instanceof Uint8Array;h?(w=(r=pl(g[0],g[1]))[0],E=r[1],x=new KN(b,[E,w],C)):x=new YN(b,[E,w],C);var _=this.makeTensorInfo([E,w],u);this.texData.get(_.dataId).usage=C?sr.PIXELS:sr.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(_.dataId),w,E,l);var R=this.runWebGLProgram(x,[_],u,null,!0),A=this.texData.get(R.dataId);a.texture=A.texture,a.texShape=A.texShape,a.isPacked=A.isPacked,a.usage=A.usage,this.disposeData(_.dataId),this.texData.delete(R.dataId),a.values=null,m&&(this.uploadWaitMs+=Zr()-p)}else{var D=this.acquireTexture(g,f,u,h);a.texture=D}}},t.prototype.convertAndCacheOnCPU=function(e,r){var a=this.texData.get(e),o=a.dtype;return this.releaseGPUData(e),r!=null&&(a.values=function(u,l){if(l==="float32"||l==="complex64")return u;if(l==="int32"||l==="bool"){for(var c=l==="int32"?new Int32Array(u.length):new Uint8Array(u.length),f=0;f<c.length;++f)c[f]=Math.round(u[f]);return c}throw new Error("Unknown dtype "+l)}(r,o)),a.values},t.prototype.acquireTexture=function(e,r,a,o){if(this.numBytesInGPU+=this.computeBytes(e,a),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var u=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: "+u+" MB, most likely due to a memory leak")}return this.textureManager.acquireTexture(e,r,o)},t.prototype.computeBytes=function(e,r){return e[0]*e[1]*kw(r)},t}(e2);Lw()&&Q.registerBackend("webgl",function(){return new ik},2);var sk=X({square_:function(n){var t=z(n,"x","square"),e=[t];return Q.runKernelFunc(function(r,a){return a([t]),r.square(t)},{x:t},null,"Square",{},e,[])}}),rl="SquaredDifference",b2=X({squaredDifference_:function(n,t){var e,r=z(n,"a","squaredDifference"),a=z(t,"b","squaredDifference");e=It(r,a),r=e[0],a=e[1],tt(r.shape,a.shape);var o={a:r,b:a},u=[r,a];return Q.runKernelFunc(function(l,c){var f=l.squaredDifference(r,a);return c([r,a]),f},o,function(l,c){var f=c[0],h=c[1],p=Se(2);return{a:function(){return l.mul(f.sub(h).mul(p))},b:function(){return l.mul(h.sub(f).mul(p))}}},rl,{},u,[])}}),uk=X({abs_:function(n){var t=z(n,"x","abs");return t.dtype==="complex64"?Q.runKernelFunc(function(e){return e.complexAbs(t)},{$x:t}):Q.runKernelFunc(function(e,r){var a=e.abs(t);return r([t]),a},{x:t},function(e,r){var a=r[0];return{x:function(){return e.mul(a.toFloat().step(-1))}}},"Abs")}}),lk=X({acos_:function(n){var t=z(n,"x","acos");return Q.runKernelFunc(function(e,r){var a=e.acos(t);return r([t]),a},{$x:t},function(e,r){var a=r[0];return{$x:function(){return e.divStrict(Se(1).sub(a.toFloat().square()).sqrt()).neg()}}})}}),ck=X({acosh_:function(n){var t=z(n,"x","acosh");return Q.runKernelFunc(function(e,r){var a=e.acosh(t);return r([t]),a},{$x:t},function(e,r){var a=r[0];return{$x:function(){return e.divStrict(a.toFloat().square().sub(1).sqrt())}}})}}),fk=X({asin_:function(n){var t=z(n,"x","asin");return Q.runKernelFunc(function(e,r){var a=e.asin(t);return r([t]),a},{$x:t},function(e,r){var a=r[0];return{$x:function(){return e.divStrict(Se(1).sub(a.toFloat().square()).sqrt())}}})}}),dk=X({asinh_:function(n){var t=z(n,"x","asinh");return Q.runKernelFunc(function(e,r){var a=e.asinh(t);return r([t]),a},{$x:t},function(e,r){var a=r[0];return{$x:function(){return e.divStrict(Se(1).add(a.toFloat().square()).sqrt())}}})}}),hk=X({atan_:function(n){var t=z(n,"x","atan");return Q.runKernelFunc(function(e,r){var a=e.atan(t);return r([t]),a},{$x:t},function(e,r){var a=r[0];return{$x:function(){return e.div(a.toFloat().square().add(1))}}})}}),pk=X({atanh_:function(n){var t=z(n,"x","atanh");return Q.runKernelFunc(function(e,r){var a=e.atanh(t);return r([t]),a},{$x:t},function(e,r){var a=r[0];return{$x:function(){return e.div(Se(1).sub(a.toFloat().square()))}}})}}),vk=X({ceil_:function(n){var t=z(n,"x","ceil");return Q.runKernelFunc(function(e){return e.ceil(t)},{$x:t},function(e){return{$x:function(){return ot(e)}}})}}),Dm=X({clipByValue_:function(n,t,e){var r=z(n,"x","clipByValue");j(t<=e,function(){return"Error in clip: min ("+t+") must be less than or equal to max ("+e+")."});var a=[r],o={min:t,max:e};return Q.runKernelFunc(function(u,l){var c=u.clip(r,t,e);return l([r]),c},{x:r},function(u,l){var c=l[0];return{x:function(){return u.where(c.greaterEqual(t).logicalAnd(c.lessEqual(e)),ot(u))}}},"ClipByValue",o,a)}}),mk=X({cos_:function(n){var t=z(n,"x","cos"),e=[t];return Q.runKernelFunc(function(r,a){var o=r.cos(t);return a([t]),o},{x:t},function(r,a){var o=a[0];return{x:function(){return o.toFloat().sin().neg().mul(r)}}},"Cos",{},e)}}),gk=X({cosh_:function(n){var t=z(n,"x","cosh");return Q.runKernelFunc(function(e,r){var a=e.cosh(t);return r([t]),a},{$x:t},function(e,r){var a=r[0];return{$x:function(){return a.toFloat().sinh().mulStrict(e)}}})}}),yk=X({erf_:function(n){var t=z(n,"x","erf");return j(t.dtype==="int32"||t.dtype==="float32",function(){return"Input dtype must be `int32` or `float32`."}),t.dtype==="int32"&&(t=t.toFloat()),Q.runKernelFunc(function(e,r){var a=e.erf(t);return r([t]),a},{$x:t},function(e,r){var a=r[0];return{$x:function(){return e.mul(a.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}})}}),zv=X({exp_:function(n){var t=z(n,"x","exp");return Q.runKernelFunc(function(e,r){var a=e.exp(t);return r([a]),a},{x:t},function(e,r){return{x:function(){return e.mulStrict(r[0])}}},"Exp",{},[],[!0])}}),bk=X({expm1_:function(n){var t=z(n,"x","expm1");return Q.runKernelFunc(function(e,r){var a=e.expm1(t);return r([t]),a},{$x:t},function(e,r){var a=r[0];return{$x:function(){return e.mul(a.exp())}}})}}),xk=X({floor_:function(n){var t=z(n,"x","floor");return Q.runKernelFunc(function(e){return e.floor(t)},{$x:t},function(e){return{$x:function(){return ot(e)}}})}}),wk=X({log_:function(n){var t=z(n,"x","log"),e=[t];return Q.runKernelFunc(function(r,a){var o=r.log(t);return a([t]),o},{x:t},function(r,a){var o=a[0];return{x:function(){return r.div(o.toFloat())}}},"Log",{},e)}}),Sk=X({log1p_:function(n){var t=z(n,"x","log1p");return Q.runKernelFunc(function(e,r){var a=e.log1p(t);return r([t]),a},{$x:t},function(e,r){var a=r[0];return{$x:function(){return e.div(a.add(1))}}})}}),Ek=X({logSigmoid_:function(n){var t=z(n,"x","logSigmoid");return Q.runKernelFunc(function(e,r){var a=e.softplus(t.neg()).neg();return r([t]),a},{$x:t},function(e,r){var a=r[0];return{$x:function(){return e.mul(a.neg().sigmoid())}}})}}),Mf=X({neg_:function(n){var t=z(n,"x","neg"),e=[t];return Q.runKernelFunc(function(r){return r.neg(t)},{x:t},function(r){return{x:function(){return r.neg()}}},"Neg",{},e)}}),Ck=X({reciprocal_:function(n){var t=z(n,"x","reciprocal");return Q.runKernelFunc(function(e,r){var a=e.reciprocal(t);return r([t]),a},{$x:t},function(e,r){var a=r[0];return{$x:function(){return e.div(a.square().neg())}}})}}),_k=X({round_:function(n){var t=z(n,"x","round");return Q.runKernelFunc(function(e){return e.round(t)},{$x:t},function(e){return{$x:function(){return ot(e)}}})}}),x2=X({rsqrt_:function(n){var t=z(n,"x","rsqrt"),e=[t];return Q.runKernelFunc(function(r,a){var o=r.rsqrt(t);return a([t]),o},{x:t},function(r,a){var o=a[0];return{x:function(){return r.div(o.pow(1.5).mul(2)).neg()}}},"Rsqrt",{},e)}}),w2=X({sigmoid_:function(n){var t=z(n,"x","sigmoid");return Q.runKernelFunc(function(e,r){var a=e.sigmoid(t);return r([a]),a},{x:t},function(e,r){var a=r[0];return{x:function(){return e.mul(a.mul(Se(1).sub(a)))}}},"Sigmoid")}}),Rk=X({sign_:function(n){var t=z(n,"x","sign");return Q.runKernelFunc(function(e){return e.sign(t)},{$x:t},function(e){return{$x:function(){return ot(e)}}})}}),Ak=X({isNaN_:function(n){var t=z(n,"x","isNaN");return Q.runKernelFunc(function(e){return e.isNaN(t)},{$x:t},function(e){return{$x:function(){return ot(e)}}})}}),Tk=X({isInf_:function(n){var t=z(n,"x","isInf");return Q.runKernelFunc(function(e){return e.isInf(t)},{$x:t},function(e){return{$x:function(){return ot(e)}}})}}),Nk=X({isFinite_:function(n){var t=z(n,"x","isFinite");return Q.runKernelFunc(function(e){return e.isFinite(t)},{$x:t},function(e){return{$x:function(){return ot(e)}}})}}),Dk=X({sin_:function(n){var t=z(n,"x","sin"),e=[t];return Q.runKernelFunc(function(r,a){var o=r.sin(t);return a([t]),o},{x:t},function(r,a){var o=a[0];return{x:function(){return o.toFloat().cos().mul(r)}}},"Sin",{},e)}}),kk=X({sinh_:function(n){var t=z(n,"x","sinh");return Q.runKernelFunc(function(e,r){var a=e.sinh(t);return r([t]),a},{$x:t},function(e,r){var a=r[0];return{$x:function(){return a.toFloat().cosh().mulStrict(e)}}})}}),Mk=X({softplus_:function(n){var t=z(n,"x","softplus");return Q.runKernelFunc(function(e,r){var a=e.softplus(t);return r([t]),a},{$x:t},function(e,r){var a=r[0];return{$x:function(){return e.mul(a.sigmoid())}}})}}),Ok=X({sqrt_:function(n){var t=z(n,"x","sqrt");return Q.runKernelFunc(function(e,r){var a=e.sqrt(t);return r([t]),a},{$x:t},function(e,r){var a=r[0];return{$x:function(){return e.div(a.toFloat().sqrt().mul(2))}}})}}),Ik=X({step_:function(n,t){t===void 0&&(t=0);var e=z(n,"x","step");return Q.runKernelFunc(function(r){return r.step(e,t)},{$x:e},function(r){return{$x:function(){return ot(r)}}})}}),Bk=X({tan_:function(n){var t=z(n,"x","tan");return Q.runKernelFunc(function(e,r){var a=e.tan(t);return r([t]),a},{$x:t},function(e,r){var a=r[0];return{$x:function(){return e.div(a.cos().square())}}})}}),Fk=X({tanh_:function(n){var t=z(n,"x","tanh");return Q.runKernelFunc(function(e,r){var a=e.tanh(t);return r([a]),a},{x:t},function(e,r){var a=r[0];return{x:function(){return Se(1).sub(a.square()).mulStrict(e)}}},"Tanh",{},null,[!0])}});function S2(n,t,e,r,a,o){var u,l,c=z(n,"x","batchNorm"),f=z(t,"mean","batchNorm"),h=z(e,"variance","batchNorm");return a!=null&&(u=z(a,"scale","batchNorm")),r!=null&&(l=z(r,"offset","batchNorm")),j(c.rank===2,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+c.rank+"."}),j(f.rank===2||f.rank===1,function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank "+f.rank+"."}),j(h.rank===2||h.rank===1,function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank "+h.rank+"."}),u!=null&&j(u.rank===2||u.rank===1,function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank "+u.rank+"."}),l!=null&&j(l.rank===2||l.rank===1,function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank "+l.rank+"."}),ml(c,f,h,l,u,o)}function E2(n,t,e,r,a,o){var u,l,c=z(n,"x","batchNorm"),f=z(t,"mean","batchNorm"),h=z(e,"variance","batchNorm");return a!=null&&(u=z(a,"scale","batchNorm")),r!=null&&(l=z(r,"offset","batchNorm")),j(c.rank===3,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+c.rank+"."}),j(f.rank===3||f.rank===1,function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank "+f.rank+"."}),j(h.rank===3||h.rank===1,function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank "+h.rank+"."}),u!=null&&j(u.rank===3||u.rank===1,function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank "+u.rank+"."}),l!=null&&j(l.rank===3||l.rank===1,function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank "+l.rank+"."}),ml(c,f,h,l,u,o)}function C2(n,t,e,r,a,o){var u,l,c=z(n,"x","batchNorm"),f=z(t,"mean","batchNorm"),h=z(e,"variance","batchNorm");return a!=null&&(u=z(a,"scale","batchNorm")),r!=null&&(l=z(r,"offset","batchNorm")),j(c.rank===4,function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+c.rank+"."}),j(f.rank===4||f.rank===1,function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank "+f.rank+"."}),j(h.rank===4||h.rank===1,function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank "+h.rank+"."}),u!=null&&j(u.rank===4||u.rank===1,function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank "+u.rank+"."}),l!=null&&j(l.rank===4||l.rank===1,function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank "+l.rank+"."}),ml(c,f,h,l,u,o)}function ml(n,t,e,r,a,o){o==null&&(o=.001);var u,l,c,f=z(n,"x","batchNorm"),h=z(t,"mean","batchNorm"),p=z(e,"variance","batchNorm");a!=null&&(u=z(a,"scale","batchNorm")),r!=null&&(l=z(r,"offset","batchNorm")),j(h.rank===p.rank,function(){return"Batch normalization gradient requires mean and variance to have equal ranks."}),j(l==null||h.rank===l.rank,function(){return"Batch normalization gradient requires mean and offset to have equal ranks."}),j(u==null||h.rank===u.rank,function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}),c=f.rank===0||f.rank===1?f.as4D(1,1,1,f.size):f.rank===2?f.as4D(1,1,f.shape[0],f.shape[1]):f.rank===3?f.as4D(1,f.shape[0],f.shape[1],f.shape[2]):f;var m=[f,h,p,u];return Q.runKernelFunc(function(g,b){var x=g.batchNormalization(c,Yc(h),Yc(p),o,Yc(u),Yc(l));return b([f,h,p,u]),x},{x:f,mean:h,variance:p,scale:u,offset:l},function(g,b){var x=b,w=x[0],E=x[1],C=x[2],_=x[3],R=_??Se(1),A=an(E.shape,c.shape),D=[];if(E.rank===1){for(var M=0;M<c.shape.length-1;++M)D.push(c.shape[M]);D.push(1)}var k=w.sub(E),B=g.mul(R),O=x2(C.add(Se(o))),V=O.mul(O).mul(O).mul(Se(-.5));return{x:function(){return E.rank===1?g.mul(ws(O.as4D(1,1,1,E.shape[0]),D)).mul(R).reshape(w.shape):g.mul(O).mul(R).reshape(w.shape)},mean:function(){var H=O.mul(Se(-1)).mul(B);return E.rank===1&&(H=H.sum(A)),H.reshape(E.shape)},variance:function(){var H=V.mul(k).mul(B);return E.rank===1&&(H=H.sum(A)),H.reshape(E.shape)},scale:function(){var H=k.mul(O),ee=g.mul(H);return E.rank===1&&(ee=ee.sum(A)),ee.reshape(E.shape)},offset:function(){var H=g;return E.rank===1&&(H=H.sum(A)),H.reshape(E.shape)}}},"BatchNormalization",{varianceEpsilon:o},m).reshape(f.shape)}function Yc(n){return n==null?null:n.rank===0?n.as1D():n.rank===1?n:n.rank===2?n.as4D(1,1,n.shape[0],n.shape[1]):n.rank===3?n.as4D(1,n.shape[0],n.shape[1],n.shape[2]):n}function $f(){zw("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}var Pk=X({batchNormalization2d_:function(n,t,e,r,a,o){return r===void 0&&(r=.001),$f(),S2(n,t,e,o,a,r)}}),Lk=X({batchNormalization3d_:function(n,t,e,r,a,o){return r===void 0&&(r=.001),$f(),E2(n,t,e,o,a,r)}}),zk=X({batchNormalization4d_:function(n,t,e,r,a,o){return r===void 0&&(r=.001),$f(),C2(n,t,e,o,a,r)}}),Uk=X({batchNormalization_:function(n,t,e,r,a,o){return r===void 0&&(r=.001),$f(),ml(n,t,e,o,a,r)}}),_2=X({batchNorm_:ml}),jk=X({batchNorm2d_:S2}),Hk=X({batchNorm3d_:E2}),Vk=X({batchNorm4d_:C2}),Zf=X({logicalAnd_:function(n,t){var e=z(n,"a","logicalAnd","bool"),r=z(t,"b","logicalAnd","bool");return tt(e.shape,r.shape),Q.runKernelFunc(function(a){return a.logicalAnd(e,r)},{a:e,b:r},null,"LogicalAnd")}}),Wk=X({logicalNot_:function(n){var t=z(n,"x","logicalNot","bool");return Q.runKernelFunc(function(e){return e.logicalNot(t)},{$x:t})}}),R2=X({logicalOr_:function(n,t){var e=z(n,"a","logicalOr","bool"),r=z(t,"b","logicalOr","bool");return tt(e.shape,r.shape),Q.runKernelFunc(function(a){return a.logicalOr(e,r)},{$a:e,$b:r})}}),Gk=X({logicalXor_:function(n,t){var e=z(n,"a","logicalXor","bool"),r=z(t,"b","logicalXor","bool");return tt(e.shape,r.shape),R2(n,t).logicalAnd(Zf(n,t).logicalNot())}}),fi=X({where_:function(n,t,e){var r=z(t,"a","where"),a=z(e,"b","where"),o=z(n,"condition","where","bool");return ft(r.shape,a.shape,"Error in where: "),o.rank===1?j(o.shape[0]===r.shape[0],function(){return"The first dimension of `a` must match the size of `condition`."}):ft(o.shape,a.shape,"Error in where: "),Q.runKernelFunc(function(u,l){var c=u.select(o,r,a);return l([o]),c},{$condition:o,$a:r,$b:a},function(u,l){var c=l[0];return{$condition:function(){return ot(c).toFloat()},$a:function(){return u.mul(c.cast(u.dtype))},$b:function(){return u.mul(c.logicalNot().cast(u.dtype))}}})}}),A2=function(n){return Te(this,void 0,void 0,function(){var t,e,r;return Ne(this,function(a){switch(a.label){case 0:return[4,(t=z(n,"condition","whereAsync","bool")).data()];case 1:return e=a.sent(),r=Rm(t.shape,e),n!==t&&t.dispose(),[2,r]}})})},$e=X({add_:function(n,t){var e,r=z(n,"a","add"),a=z(t,"b","add");e=It(r,a),r=e[0],a=e[1];var o=tt(r.shape,a.shape);return Q.runKernelFunc(function(u){return u.add(r,a)},{a:r,b:a},function(u){return{a:function(){var l=u,c=an(r.shape,o);return c.length>0&&(l=l.sum(c)),l.reshape(r.shape)},b:function(){var l=u,c=an(a.shape,o);return c.length>0&&(l=l.sum(c)),l.reshape(a.shape)}}},"Add")}}),qk=X({addN_:function(n){j(Array.isArray(n),function(){return"The argument passed to tf.addN() must be a list of tensors"}),j(n.length>=1,function(){return"Must pass at least one tensor to tf.addN(), but got "+n.length});var t=n.map(function(a,o){return z(a,"tensors"+o,"addN")}),e=t[0];t.forEach(function(a){if(a.dtype!==e.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),t.forEach(function(a){if(!pn(a.shape,e.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});var r=t;return Q.runKernelFunc(function(a){return a.addN(t)},r,function(a){var o={};return t.forEach(function(u,l){o[l]=function(){return a.clone()}}),o},"AddN")}}),Xk=X({addStrict_:function(n,t){var e=z(n,"a","addStrict"),r=z(t,"b","addStrict");return ft(e.shape,r.shape,"Error in addStrict: "),e.add(r)}}),Yk=X({atan2_:function(n,t){var e,r=z(n,"a","atan2"),a=z(t,"b","atan2");e=It(r,a),r=e[0],a=e[1];var o=tt(r.shape,a.shape);return Q.runKernelFunc(function(u,l){var c=u.atan2(r,a);return l([r,a]),c},{$a:r,$b:a},function(u,l){var c=l[0],f=l[1];return{$a:function(){var h=$e(c.square(),f.square()),p=u.mul(f.div(h)),m=an(c.shape,o);return m.length>0&&(p=p.sum(m)),p.reshape(c.shape)},$b:function(){var h=$e(c.square(),f.square()),p=Mf(u.mul(c.div(h))),m=an(f.shape,o);return m.length>0&&(p=p.sum(m)),p.reshape(f.shape)}}})}}),Fr=X({div_:function(n,t){var e,r=z(n,"a","div"),a=z(t,"b","div");if(e=It(r,a),r=e[0],a=e[1],r.dtype==="int32"&&a.dtype==="int32")return T2(r,a);var o=tt(r.shape,a.shape);return Q.runKernelFunc(function(u,l){var c=u.realDivide(r,a);return l([r,a]),c},{a:r,b:a},function(u,l){var c=l[0],f=l[1];return{a:function(){var h=u.div(f.toFloat()),p=an(c.shape,o);return p.length>0?h.sum(p).reshape(c.shape):h},b:function(){var h=u.mul(c.toFloat()),p=an(f.shape,o);p.length>0&&(h=h.sum(p).reshape(f.shape));var m=f.square();return h.div(m.toFloat()).neg()}}},"Div")}}),Kk=X({divNoNan_:function(n,t){var e,r=z(n,"a","div"),a=z(t,"b","div");r=(e=It(r,a))[0],a=e[1];var o=Fr(r,a),u=ot(o),l=a.equal(u);return fi(l,u,o)}}),Qk=X({divStrict_:function(n,t){var e=z(n,"a","div"),r=z(t,"b","div");return ft(e.shape,r.shape,"Error in divideStrict: "),e.div(r)}}),T2=X({floorDiv_:function(n,t){var e,r=z(n,"a","floorDiv"),a=z(t,"b","floorDiv");e=It(r,a),r=e[0],a=e[1];var o=tt(r.shape,a.shape);return Q.runKernelFunc(function(u,l){var c=u.floorDiv(r,a);return l([r,a]),c},{a:r,b:a},function(u,l){var c=l[0],f=l[1];return{a:function(){var h=u.div(f.toFloat()),p=an(c.shape,o);return p.length>0?h.sum(p).reshape(c.shape):h},b:function(){var h=u.mul(c.toFloat()),p=an(f.shape,o);p.length>0&&(h=h.sum(p).reshape(f.shape));var m=f.square();return h.div(m.toFloat()).neg()}}},"FloorDiv")}}),km=X({maximum_:function(n,t){var e,r=z(n,"a","maximum"),a=z(t,"b","maximum");return e=It(r,a),r=e[0],a=e[1],r.dtype==="bool"&&(r=r.toInt(),a=a.toInt()),tt(r.shape,a.shape),Q.runKernelFunc(function(o,u){var l=o.maximum(r,a);return u([r,a]),l},{a:r,b:a},function(o,u){var l=u[0],c=u[1];return{a:function(){return o.mul(l.greaterEqual(c).toFloat())},b:function(){return o.mul(l.less(c).toFloat())}}},"Maximum")}}),$k=X({maximumStrict_:function(n,t){var e=z(n,"a","maximumStrict"),r=z(t,"b","maximumStrict");return ft(e.shape,r.shape,"Error in maximumStrict: "),e.maximum(r)}}),N2=X({minimum_:function(n,t){var e,r=z(n,"a","minimum"),a=z(t,"b","minimum");return e=It(r,a),r=e[0],a=e[1],r.dtype==="bool"&&(r=r.toInt(),a=a.toInt()),tt(r.shape,a.shape),Q.runKernelFunc(function(o,u){var l=o.minimum(r,a);return u([r,a]),l},{a:r,b:a},function(o,u){var l=u[0],c=u[1];return{a:function(){return o.mul(l.lessEqual(c).toFloat())},b:function(){return o.mul(l.greater(c).toFloat())}}},"Minimum")}}),Zk=X({minimumStrict_:function(n,t){var e=z(n,"a","minimumStrict"),r=z(t,"b","minimumStrict");return ft(e.shape,r.shape,"Error in minimumStrict: "),e.minimum(r)}}),Jk=X({mod_:function(n,t){var e,r=z(n,"a","mod"),a=z(t,"b","mod");e=It(r,a),r=e[0],a=e[1];var o=tt(r.shape,a.shape);return Q.runKernelFunc(function(u,l){var c=u.mod(r,a);return l([r,a]),c},{$a:r,$b:a},function(u,l){var c=l[0],f=l[1];return{$a:function(){var h=an(c.shape,o);return h.length>0?u.sum(h).reshape(c.shape):u},$b:function(){var h=u.mul(c.div(f).floor().neg()),p=an(f.shape,o);return p.length>0?h.sum(p).reshape(f.shape):h}}})}}),e3=X({modStrict_:function(n,t){var e=z(n,"a","modStrict"),r=z(t,"b","modStrict");return ft(e.shape,r.shape,"Error in modStrict: "),e.mod(r)}}),Mn=X({mul_:function(n,t){var e,r=z(n,"a","mul"),a=z(t,"b","mul");e=It(r,a),r=e[0],a=e[1];var o=tt(r.shape,a.shape);return Q.runKernelFunc(function(u,l){var c=u.multiply(r,a);return l([r,a]),c},{a:r,b:a},function(u,l){var c=l[0],f=l[1];return{a:function(){var h=u.mul(f.toFloat()),p=an(c.shape,o);return p.length>0?h.sum(p).reshape(c.shape):h},b:function(){var h=u.mul(c.toFloat()),p=an(f.shape,o);return p.length>0?h.sum(p).reshape(f.shape):h}}},"Mul")}}),t3=X({mulStrict_:function(n,t){var e=z(n,"a","mul"),r=z(t,"b","mul");return ft(e.shape,r.shape,"Error in multiplyStrict: "),e.mul(r)}}),Of=X({pow_:function(n,t){var e,r=z(n,"base","pow"),a=z(t,"exp","pow");e=It(r,a),r=e[0],a=e[1];var o=tt(r.shape,a.shape),u=[r,a];return Q.runKernelFunc(function(l,c){var f=l.pow(r,a);return c([r,a,f]),f},{a:r,b:a},function(l,c){var f=c[0],h=c[1],p=c[2];return{a:function(){var m=h.toFloat(),g=l.mul(m.mul(f.pow(m.sub(Se(1))))),b=an(f.shape,o);return b.length>0&&(g=g.sum(b)),g.reshape(f.shape)},b:function(){var m=f.greater(0),g=f.log().where(m,ot(f)),b=l.mul(p.mul(g)),x=an(h.shape,o);return x.length>0&&(b=b.sum(x)),b.reshape(h.shape)}}},"Pow",{},u,[!0])}}),n3=X({powStrict_:function(n,t){return ft(n.shape,t.shape,"Error in powStrict: "),n.pow(t)}}),r3=X({squaredDifferenceStrict_:function(n,t){var e=z(n,"a","squaredDifferenceStrict"),r=z(t,"b","squaredDifferenceStrict");return ft(e.shape,r.shape,"Error in squaredDifferenceStrict: "),e.squaredDifference(r)}}),on=X({sub_:function(n,t){var e,r=z(n,"a","sub"),a=z(t,"b","sub");e=It(r,a),r=e[0],a=e[1];var o=tt(r.shape,a.shape);return Q.runKernelFunc(function(u){return u.subtract(r,a)},{a:r,b:a},function(u){return{a:function(){var l=u,c=an(r.shape,o);return c.length>0&&(l=l.sum(c)),l.reshape(r.shape)},b:function(){var l=u,c=an(a.shape,o);return c.length>0&&(l=l.sum(c)),l.neg().reshape(a.shape)}}},"Sub")}}),a3=X({subStrict_:function(n,t){var e=z(n,"a","subStrict"),r=z(t,"b","subStrict");return ft(e.shape,r.shape,"Error in subStrict: "),e.sub(r)}}),D2=X({equal_:function(n,t){var e,r=z(n,"a","equal"),a=z(t,"b","equal");return e=It(r,a),r=e[0],a=e[1],tt(r.shape,a.shape),Q.runKernelFunc(function(o){return o.equal(r,a)},{$a:r,$b:a})}}),o3=X({equalStrict_:function(n,t){var e=z(n,"a","equalStrict"),r=z(t,"b","equalStrict");return ft(e.shape,r.shape,"Error in equalStrict: "),e.equal(r)}}),i3=X({greater_:function(n,t){var e,r=z(n,"a","greater"),a=z(t,"b","greater");return e=It(r,a),r=e[0],a=e[1],tt(r.shape,a.shape),Q.runKernelFunc(function(o){return o.greater(r,a)},{a:r,b:a},null,"Greater")}}),k2=X({greaterEqual_:function(n,t){var e,r=z(n,"a","greaterEqual"),a=z(t,"b","greaterEqual");return e=It(r,a),r=e[0],a=e[1],tt(r.shape,a.shape),Q.runKernelFunc(function(o,u){var l=o.greaterEqual(r,a);return u([r,a]),l},{a:r,b:a},function(o,u){var l=u[0],c=u[1];return{a:function(){return ot(l)},b:function(){return ot(c)}}},"GreaterEqual")}}),s3=X({greaterEqualStrict_:function(n,t){var e=z(n,"a","greaterEqualStrict"),r=z(t,"b","greaterEqualStrict");return ft(e.shape,r.shape,"Error in greaterEqualStrict: "),e.greaterEqual(r)}}),u3=X({greaterStrict_:function(n,t){var e=z(n,"a","greaterStrict"),r=z(t,"b","greaterStrict");return ft(e.shape,r.shape,"Error in greaterStrict: "),e.greater(r)}}),l3=X({less_:function(n,t){var e,r=z(n,"a","less"),a=z(t,"b","less");return e=It(r,a),r=e[0],a=e[1],tt(r.shape,a.shape),Q.runKernelFunc(function(o){return o.less(r,a)},{a:r,b:a},null,"Less")}}),c3=X({lessEqual_:function(n,t){var e,r=z(n,"a","lessEqual"),a=z(t,"b","lessEqual");return e=It(r,a),r=e[0],a=e[1],tt(r.shape,a.shape),Q.runKernelFunc(function(o,u){var l=o.lessEqual(r,a);return u([r,a]),l},{a:r,b:a},null,"LessEqual")}}),f3=X({lessEqualStrict_:function(n,t){var e=z(n,"a","lessEqualStrict"),r=z(t,"b","lessEqualStrict");return ft(e.shape,r.shape,"Error in lessEqualStrict: "),e.lessEqual(r)}}),d3=X({lessStrict_:function(n,t){var e=z(n,"a","lessStrict"),r=z(t,"b","lessStrict");return ft(e.shape,r.shape,"Error in lessStrict: "),e.less(r)}}),h3=X({notEqual_:function(n,t){var e,r=z(n,"a","notEqual"),a=z(t,"b","notEqual");return e=It(r,a),r=e[0],a=e[1],tt(r.shape,a.shape),Q.runKernelFunc(function(o){return o.notEqual(r,a)},{a:r,b:a},null,"NotEqual")}}),p3=X({notEqualStrict_:function(n,t){var e=z(n,"a","notEqualStrict"),r=z(t,"b","notEqualStrict");return ft(e.shape,r.shape,"Error in notEqualStrict: "),e.notEqual(r)}});function f1(n,t){for(var e=[],r=n;r<t;++r)e.push(r);return e}function d1(n){for(var t=[],e=0;e<n.length;++e)for(var r=0;r<n[e].length;++r)t.push(n[e][r]);return t}var Mm=X({gather_:function(n,t,e){e===void 0&&(e=0);var r=z(n,"x","gather"),a=z(t,"indices","gather","int32");e=sn(e,r.shape)[0];var o=function(u,l,c){for(var f=u.shape[c],h=[],p=1,m=1,g=0;g<c;g++)h.push(u.shape[g]),p*=u.shape[g];for(g=0;g<l.rank;g++)h.push(l.shape[g]);for(g=c+1;g<u.rank;g++)h.push(u.shape[g]),m*=u.shape[g];return{batchSize:p,sliceSize:m,dimSize:f,outputShape:h}}(r,a,e);return Q.runKernelFunc(function(u,l){var c=u.gather(r,a.flatten(),e);return l([a]),c},{x:r,indices:a},function(u,l){var c=l[0];return{x:function(){var f=r.shape,h=c.size,p=f.slice(0,e),m=p.length,g=f.slice(e,f.length).slice(1),b=g.length,x=f1(0,m),w=f1(m+1,m+1+b),E=d1([p,[h],g]),C=u.reshape(E),_=c.reshape([h]),R=d1([[m],x,w]),A=C.transpose(R),D=M2(A,_,r.shape[e]),M=ym(R);return D=D.transpose(M)},indices:function(){return c}}},"Gather",{axis:e}).reshape(o.outputShape)}}),M2=X({unsortedSegmentSum_:function(n,t,e){var r=z(n,"x","unsortedSegmentSum"),a=z(t,"segmentIds","unsortedSegmentSum","int32");return j(Wt(e),function(){return"numSegments must be of dtype int"}),Q.runKernelFunc(function(o,u){var l=o.unsortedSegmentSum(r,a,e);return u([a]),l},{$x:r},function(o,u){var l=u[0];return{$x:function(){return function(c,f){for(var h=km(f,ot(f)),p=Mm(c,h),m=k2(f,Se(0,"int32")),g=p.rank-m.rank,b=0;b<g;++b)m=Cr(m,b+1);m=Zf(m,Ps(p.shape,"bool"));var x=ot(p);return fi(m,p,x)}(o,l)}}})}}),v3=function(n,t,e){return Te(this,void 0,void 0,function(){var r,a,o,u,l,c,f,h,p,m,g,b,x;return Ne(this,function(w){switch(w.label){case 0:for(r=z(n,"tensor","boolMask"),a=z(t,"mask","boolMask","bool"),o=e??0,u=a.rank,l=r.shape,j(u>0,function(){return"mask cannot be scalar"}),ft(l.slice(o,o+u),a.shape,"mask's shape must match the first K dimensions of tensor's shape,"),c=1,f=o;f<o+u;f++)c*=l[f];return h=l.slice(0,o).concat([c],l.slice(o+u)),p=r.reshape(h),m=a.reshape([-1]),[4,A2(m)];case 1:return g=w.sent(),b=g.squeeze([1]),x=Mm(p,b,o),n!==r&&r.dispose(),t!==a&&a.dispose(),b.dispose(),p.dispose(),m.dispose(),g.dispose(),[2,x]}})})};function O2(n,t,e,r,a,o,u){o===void 0&&(o="NHWC"),j(n.length===t.rank,function(){return"Length of inShape ("+n.length+") and rank of dy ("+t.rank+") must match"});var l=n,c=t,f=!1;t.rank===3&&(f=!0,c=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]),l=[1,n[0],n[1],n[2]]),j(l.length===4,function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+l.length+"."}),j(c.rank===4,function(){return"Error in conv2dDerInput: dy must be rank 4, but got rank "+c.rank}),j(e.rank===4,function(){return"Error in conv2dDerInput: filter must be rank 4, but got rank "+e.rank});var h=o==="NHWC"?l[3]:l[1],p=o==="NHWC"?c.shape[3]:c.shape[1];j(h===e.shape[2],function(){return"Error in conv2dDerInput: depth of input ("+h+") must match input depth for filter "+e.shape[2]+"."}),j(p===e.shape[3],function(){return"Error in conv2dDerInput: depth of output ("+p+") must match output depth for filter "+e.shape[3]+"."}),u!=null&&j(Wt(a),function(){return"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+u+" but got pad "+a+"."});var m=Em(o),g=gi(l,e.shape,r,1,a,u,!1,m),b=Q.runKernelFunc(function(x,w){var E=x.conv2dDerInput(c,e,g);return w([e,c]),E},{dy4D:c,filter:e},function(x,w){var E=w[0],C=w[1];return{dy4D:function(){return Ar(x,E,r,a,o,1,u)},filter:function(){return Om(x,C,E.shape,r,a,o,u)}}});return f?b.as3D(b.shape[1],b.shape[2],b.shape[3]):b}function Zp(n){var t=function(o){return typeof o=="number"?[o,o,o]:o.length===2?[o[0],o[1],1]:o}(n),e=t[0],r=t[1],a=t[2];return e===1&&r===1&&a===1}function I2(n,t,e,r,a){j(n.length===t.rank,function(){return"Length of inShape ("+n.length+") and rank of dy ("+t.rank+") must match"});var o=n,u=t,l=!1;t.rank===4&&(l=!0,u=t.as5D(1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]),o=[1,n[0],n[1],n[2],n[3]]);var c=o[4],f=u.shape[4];j(o.length===5,function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+o.length+"."}),j(u.rank===5,function(){return"Error in conv3dDerInput: dy must be rank 5, but got rank "+u.rank}),j(e.rank===5,function(){return"Error in conv3dDerInput: filter must be rank 5, but got rank "+e.rank}),j(c===e.shape[3],function(){return"Error in conv3dDerInput: depth of input ("+c+") must match input depth for filter "+e.shape[3]+"."}),j(f===e.shape[4],function(){return"Error in conv3dDerInput: depth of output ("+f+") must match output depth for filter "+e.shape[4]+"."});var h=Df(o,e.shape,r,1,a),p=Q.runKernelFunc(function(m){return m.conv3dDerInput(u,e,h)},{dy5D:u});return l?p.as4D(p.shape[1],p.shape[2],p.shape[3],p.shape[4]):p}var m3=X({conv1d_:function(n,t,e,r,a,o,u){a===void 0&&(a="NWC"),o===void 0&&(o=1);var l=z(n,"x","conv1d"),c=z(t,"filter","conv1d"),f=l,h=!1;l.rank===2&&(h=!0,f=l.as3D(1,l.shape[0],l.shape[1])),j(f.rank===3,function(){return"Error in conv1d: input must be rank 3, but got rank "+f.rank+"."}),j(c.rank===3,function(){return"Error in conv1d: filter must be rank 3, but got rank "+c.rank+"."}),u!=null&&j(Wt(r),function(){return"Error in conv1d: pad must be an integer when using, dimRoundingMode "+u+" but got pad "+r+"."}),j(f.shape[2]===c.shape[1],function(){return"Error in conv1d: depth of input ("+f.shape[2]+") must match input depth for filter "+c.shape[1]+"."}),j(Kn(e,o),function(){return"Error in conv1D: Either stride or dilation must be 1. Got stride "+e+" and dilation '"+o+"'"}),j(a==="NWC",function(){return"Error in conv1d: got dataFormat of "+a+" but only NWC is currently supported."});var p=c.as4D(1,c.shape[0],c.shape[1],c.shape[2]),m=f.as4D(f.shape[0],1,f.shape[1],f.shape[2]),g=Ar(m,p,[1,e],r,"NHWC",[1,o],u);return h?g.as2D(g.shape[2],g.shape[3]):g.as3D(g.shape[0],g.shape[2],g.shape[3])}}),Ar=X({conv2d_:function(n,t,e,r,a,o,u){a===void 0&&(a="NHWC"),o===void 0&&(o=[1,1]);var l=z(n,"x","conv2d"),c=z(t,"filter","conv2d"),f=l,h=!1;l.rank===3&&(h=!0,f=l.as4D(1,l.shape[0],l.shape[1],l.shape[2])),j(f.rank===4,function(){return"Error in conv2d: input must be rank 4, but got rank "+f.rank+"."}),j(c.rank===4,function(){return"Error in conv2d: filter must be rank 4, but got rank "+c.rank+"."}),u!=null&&j(Wt(r),function(){return"Error in conv2d: pad must be an integer when using, dimRoundingMode "+u+" but got pad "+r+"."});var p=a==="NHWC"?f.shape[3]:f.shape[1];j(p===c.shape[2],function(){return"Error in conv2d: depth of input ("+p+") must match input depth for filter "+c.shape[2]+"."}),j(Kn(e,o),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+o+"'"});var m=Em(a),g=gi(f.shape,c.shape,e,o,r,u,!1,m),b=[c,f],x=Q.runKernelFunc(function(w,E){var C=w.conv2d(f,c,g);return E([c,f]),C},{x:f,filter:c},function(w,E){var C=E,_=C[0],R=C[1];return j(Ms(o),function(){return"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+o+"'"}),{x:function(){return B2(R.shape,w,_,e,r,a)},filter:function(){return Om(R,w,_.shape,e,r,a)}}},"Conv2D",g,b);return h?x.as3D(x.shape[1],x.shape[2],x.shape[3]):x}}),g3=X({conv3d_:function(n,t,e,r,a,o){a===void 0&&(a="NDHWC"),o===void 0&&(o=[1,1,1]);var u=z(n,"x","conv3d"),l=z(t,"filter","conv3d"),c=u,f=!1;u.rank===4&&(f=!0,c=u.as5D(1,u.shape[0],u.shape[1],u.shape[2],u.shape[3])),j(c.rank===5,function(){return"Error in conv3d: input must be rank 5, but got rank "+c.rank+"."}),j(l.rank===5,function(){return"Error in conv3d: filter must be rank 5, but got rank "+l.rank+"."}),j(c.shape[4]===l.shape[3],function(){return"Error in conv3d: depth of input ("+c.shape[4]+") must match input depth for filter "+l.shape[3]+"."}),j(function(m,g){return Zp(m)||Zp(g)}(e,o),function(){return"Error in conv3D: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+o+"'"}),j(a==="NDHWC",function(){return"Error in conv3d: got dataFormat of "+a+" but only NDHWC is currently supported."});var h=Df(c.shape,l.shape,e,o,r),p=Q.runKernelFunc(function(m,g){var b=m.conv3d(c,l,h);return g([c,l]),b},{x:c,$filter:l},function(m,g){j(Zp(o),function(){return"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+o+"'"});var b=g[0],x=g[1];return{x:function(){return I2(b.shape,m,x,e,r)},$filter:function(){return function(w,E,C,_,R){var A=w;w.rank===4&&(A=w.as5D(1,w.shape[0],w.shape[1],w.shape[2],w.shape[3]));var D=E;D.rank===4&&(D=E.as5D(1,E.shape[0],E.shape[1],E.shape[2],E.shape[3])),j(A.rank===5,function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+A.shape+"."}),j(D.rank===5,function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+D.shape+"."}),j(C.length===5,function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+C+"."}),j(A.shape[4]===C[3],function(){return"Error in conv3dDerFilter: depth of input "+A.shape[4]+") must match input depth in filter ("+C[3]+"."}),j(D.shape[4]===C[4],function(){return"Error in conv3dDerFilter: depth of dy ("+D.shape[4]+") must match output depth for filter ("+C[4]+")."});var M=Df(A.shape,C,_,1,R);return Q.runKernelFunc(function(k){return k.conv3dDerFilter(A,D,M)},{x5D:A,dy5D:D})}(b,m,x.shape,e,r)}}});return f?p.as4D(p.shape[1],p.shape[2],p.shape[3],p.shape[4]):p}}),Om=X({conv2dDerFilter_:function(n,t,e,r,a,o,u){o===void 0&&(o="NHWC");var l=n;n.rank===3&&(l=n.as4D(1,n.shape[0],n.shape[1],n.shape[2]));var c=t;c.rank===3&&(c=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),j(l.rank===4,function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+l.shape+"."}),j(c.rank===4,function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+c.shape+"."}),j(e.length===4,function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+e+"."});var f=o==="NHWC"?l.shape[3]:l.shape[1],h=o==="NHWC"?c.shape[3]:c.shape[1];j(f===e[2],function(){return"Error in conv2dDerFilter: depth of input "+f+") must match input depth in filter ("+e[2]+"."}),j(h===e[3],function(){return"Error in conv2dDerFilter: depth of dy ("+h+") must match output depth for filter ("+e[3]+")."}),u!=null&&j(Wt(a),function(){return"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+u+" but got pad "+a+"."});var p=Em(o),m=gi(l.shape,e,r,1,a,u,!1,p);return Q.runKernelFunc(function(g){return g.conv2dDerFilter(l,c,m)},{x4D:l,dy4D:c})}}),B2=X({conv2dDerInput_:O2}),Jf=X({depthwiseConv2d_:function(n,t,e,r,a,o,u){o===void 0&&(o=[1,1]);var l=z(n,"x","depthwiseConv2d"),c=z(t,"filter","depthwiseConv2d"),f=l,h=!1;l.rank===3&&(h=!0,f=l.as4D(1,l.shape[0],l.shape[1],l.shape[2])),j(f.rank===4,function(){return"Error in depthwiseConv2d: input must be rank 4, but got rank "+f.rank+"."}),j(c.rank===4,function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+c.rank+"."}),j(f.shape[3]===c.shape[2],function(){return"Error in depthwiseConv2d: number of input channels ("+f.shape[3]+") must match the inChannels dimension in filter "+c.shape[2]+"."}),o==null&&(o=[1,1]),j(Kn(e,o),function(){return"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+o+"'"}),u!=null&&j(Wt(r),function(){return"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode "+u+" but got pad "+r+"."});var p=gi(f.shape,c.shape,e,o,r,u,!0),m=[f,c],g=Q.runKernelFunc(function(b,x){var w=b.depthwiseConv2D(f,c,p);return x([f,c]),w},{x:f,filter:c},function(b,x){j(Ms(o),function(){return"Error in gradient of depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+o+"'"});var w=x[0],E=x[1];return{x:function(){return F2(w.shape,b,E,p)},filter:function(){return P2(w,b,E.shape,p)}}},"DepthwiseConv2dNative",p,m);return h?g.as3D(g.shape[1],g.shape[2],g.shape[3]):g}}),F2=X({depthwiseConv2dDerInput_:function(n,t,e,r){var a=t,o=!1;t.rank===3&&(o=!0,a=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var u=Q.runKernelFunc(function(l){return l.depthwiseConv2DDerInput(a,e,r)},{dy4D:a});return o?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),P2=X({depthwiseConv2dDerFilter_:function(n,t,e,r){var a=n;n.rank===3&&(a=n.as4D(1,n.shape[0],n.shape[1],n.shape[2]));var o=t;return o.rank===3&&(o=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),Q.runKernelFunc(function(u){return u.depthwiseConv2DDerFilter(a,o,r)},{x4D:a,dy4D:o})}}),Im=X({separableConv2d_:function(n,t,e,r,a,o,u){o===void 0&&(o=[1,1]),u===void 0&&(u="NHWC");var l=z(n,"x","separableConv2d"),c=z(t,"depthwiseFilter","separableConv2d"),f=z(e,"pointwiseFilter","separableConv2d"),h=l,p=!1;if(l.rank===3&&(p=!0,h=l.as4D(1,l.shape[0],l.shape[1],l.shape[2])),u==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");j(h.rank===4,function(){return"Error in separableConv2d: input must be rank 4, but got rank "+h.rank+"."}),j(c.rank===4,function(){return"Error in separableConv2d: depthwise filter must be rank 4, but got rank "+c.rank+"."}),j(f.rank===4,function(){return"Error in separableConv2d: pointwise filter must be rank 4, but got rank "+c.rank+"."}),j(f.shape[0]===1,function(){return"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got "+f.shape[0]+"."}),j(f.shape[1]===1,function(){return"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got "+f.shape[1]+"."});var m=c.shape[2],g=c.shape[3];j(f.shape[2]===m*g,function(){return"Error in separableConv2d: the third dimension of pointwise filter must be "+m*g+", but got "+f.shape[2]+"."});var b=Jf(h,c,r,a,u,o),x=Ar(b,f,1,"valid",u);return p?x.as3D(x.shape[1],x.shape[2],x.shape[3]):x}}),y3=X({conv2dTranspose_:function(n,t,e,r,a,o){return O2(e,z(n,"x","conv2dTranspose"),z(t,"filter","conv2dTranspose"),r,a,"NHWC",o)}}),b3=X({conv3dTranspose_:function(n,t,e,r,a){return I2(e,z(n,"x","conv3dTranspose"),z(t,"filter","conv3dTranspose"),r,a)}}),ed=X({matMul_:function(n,t,e,r){var a;e===void 0&&(e=!1),r===void 0&&(r=!1);var o=z(n,"a","matMul"),u=z(t,"b","matMul");a=It(o,u),o=a[0],u=a[1];var l=e?o.shape[o.rank-2]:o.shape[o.rank-1],c=r?u.shape[u.rank-1]:u.shape[u.rank-2],f=e?o.shape[o.rank-1]:o.shape[o.rank-2],h=r?u.shape[u.rank-2]:u.shape[u.rank-1],p=o.shape.slice(0,-2),m=u.shape.slice(0,-2),g=ke(p),b=ke(m);j(o.rank>=2&&u.rank>=2&&o.rank===u.rank,function(){return"Error in matMul: inputs must have the same rank of at least 2, got ranks "+o.rank+" and "+u.rank+"."}),j(pn(p,m),function(){return"Error in matMul: outer dimensions ("+p+") and ("+m+") of Tensors with shapes "+o.shape+" and "+u.shape+" must match."}),j(l===c,function(){return"Error in matMul: inner shapes ("+l+") and ("+c+") of Tensors with shapes "+o.shape+" and "+u.shape+" and transposeA="+e+" and transposeB="+r+" must match."});var x=o.shape.slice(0,-2).concat([f,h]),w=e?o.as3D(g,l,f):o.as3D(g,f,l),E=r?u.as3D(b,h,c):u.as3D(b,c,h),C={transposeA:e,transposeB:r};return Q.runKernelFunc(function(_,R){var A=_.batchMatMul(w,E,e,r);return R([w,E]),A},{a:w,b:E},function(_,R){var A=R,D=A[0],M=A[1];return e||r?!e&&r?{a:function(){return _.matMul(M,!1,!1)},b:function(){return _.matMul(D,!0,!1)}}:e&&!r?{a:function(){return M.matMul(_,!1,!0)},b:function(){return D.matMul(_,!1,!1)}}:{a:function(){return M.matMul(_,!0,!0)},b:function(){return _.matMul(D,!0,!0)}}:{a:function(){return _.matMul(M,!1,!0)},b:function(){return D.matMul(_,!0,!1)}}},"BatchMatMul",C).reshape(x)}}),x3=X({dot_:function(n,t){var e=z(n,"t1","dot"),r=z(t,"t2","dot");j(!(e.rank!==1&&e.rank!==2||r.rank!==1&&r.rank!==2),function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+e.rank+" and "+r.rank+"."});var a=e.rank===1?e.size:e.shape[1],o=r.rank===1?r.size:r.shape[0];return j(a===o,function(){return"Error in dot: inner dimensions of inputs must match, but got "+a+" and "+o+"."}),e.rank===1&&r.rank===1?e.as2D(1,-1).matMul(r.as2D(-1,1)).asScalar():e.rank===1&&r.rank===2?e.as2D(1,-1).matMul(r.as2D(r.shape[0],r.shape[1])).as1D():e.rank===2&&r.rank===1?e.matMul(r.as2D(-1,1)).as1D():e.matMul(r.as2D(r.shape[0],r.shape[1]))}}),w3=X({outerProduct_:function(n,t){var e=z(n,"v1","outerProduct"),r=z(t,"v2","outerProduct");return j(e.rank===1&&r.rank===1,function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+e.rank+" and "+r.rank+"."}),e.as2D(-1,1).matMul(r.as2D(1,-1))}}),gl=X({reverse_:function(n,t){var e=z(n,"x","reverse");if(e.rank===0)return e.clone();var r=sn(t,e.shape);return Q.runKernelFunc(function(a){return a.reverse(e,r)},{$x:e},function(a){return{$x:function(){return a.reverse(r)}}}).reshapeAs(e)}}),S3=X({reverse1d_:function(n){var t=z(n,"x","reverse");return j(t.rank===1,function(){return"Error in reverse1D: x must be rank 1 but got rank "+t.rank+"."}),gl(t,0)}}),E3=X({reverse2d_:function(n,t){var e=z(n,"x","reverse");return j(e.rank===2,function(){return"Error in reverse2D: x must be rank 2 but got rank "+e.rank+"."}),gl(e,t)}}),C3=X({reverse3d_:function(n,t){var e=z(n,"x","reverse");return j(e.rank===3,function(){return"Error in reverse3D: x must be rank 3 but got rank "+e.rank+"."}),gl(e,t)}}),_3=X({reverse4d_:function(n,t){var e=z(n,"x","reverse");return j(e.rank===4,function(){return"Error in reverse4D: x must be rank 4 but got rank "+e.rank+"."}),gl(e,t)}});function L2(n,t,e,r,a,o){var u=z(n,"x","maxPool"),l=u,c=!1;u.rank===3&&(c=!0,l=u.as4D(1,u.shape[0],u.shape[1],u.shape[2])),j(l.rank===4,function(){return"Error in maxPool: input must be rank 4 but got rank "+l.rank+"."}),j(Kn(e,r),function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+r+"'"}),o!=null&&j(Wt(a),function(){return"Error in maxPool: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+a+"."});var f=nl(l.shape,t,e,r,a,o);if(f.filterWidth===1&&f.filterHeight===1&&pn(f.inShape,f.outShape))return u.clone();var h=[l],p=Q.runKernelFunc(function(m,g){var b=m.maxPool(l,f);return g([l,b]),b},{x:l},function(m,g){var b=g[0],x=g[1];return{x:function(){return function(w,E,C,_,R,A,D,M){var k=z(w,"dy","maxPoolBackprop"),B=z(E,"input","maxPoolBackprop"),O=z(C,"output","maxPoolBackprop");j(B.rank===k.rank,function(){return"Rank of input ("+B.rank+") does not match rank of dy ("+k.rank+")"}),j(Kn(R,A),function(){return"Error in maxPoolBackProp: Either strides or dilations must be 1. Got strides "+R+" and dilations '"+A+"'"}),j(k.rank===4,function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+k.rank+"."}),j(B.rank===4,function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+B.rank+"."});var V=nl(B.shape,_,R,A,D,M);return Q.runKernelFunc(function(H){return H.maxPoolBackprop(k,B,O,V)},{$dy:k,$input:B})}(m,b,x,t,e,r,a)}}},"MaxPool",f,h);return c?p.as3D(p.shape[1],p.shape[2],p.shape[3]):p}function z2(n,t,e,r,a,o){var u=z(n,"x","avgPool","float32");j(Kn(e,r),function(){return"Error in avgPool: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+r+"'"});var l=u,c=!1;u.rank===3&&(c=!0,l=u.as4D(1,u.shape[0],u.shape[1],u.shape[2])),j(l.rank===4,function(){return"Error in avgPool: x must be rank 4 but got rank "+l.rank+"."}),o!=null&&j(Wt(a),function(){return"Error in avgPool: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+a+"."});var f=nl(l.shape,t,e,r,a,o);if(f.filterWidth===1&&f.filterHeight===1&&pn(f.inShape,f.outShape))return u.clone();var h=Q.runKernelFunc(function(p){return p.avgPool(l,f)},{x:l},function(p){return{x:function(){return function(m,g,b,x,w,E){var C=z(m,"dy","avgPoolBackprop"),_=z(g,"input","avgPoolBackprop");j(_.rank===C.rank,function(){return"Rank of input ("+_.rank+") does not match rank of dy ("+C.rank+")"}),j(Kn(x,w),function(){return"Error in avgPoolBackprop: Either strides or dilations must be 1. Got strides "+x+" and dilations '"+w+"'"});var R=_,A=C,D=!1;_.rank===3&&(D=!0,R=_.as4D(1,_.shape[0],_.shape[1],_.shape[2]),A=C.as4D(1,C.shape[0],C.shape[1],C.shape[2])),j(A.rank===4,function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+A.rank+"."}),j(R.rank===4,function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+R.rank+"."});var M=nl(R.shape,b,x,w,E),k=Q.runKernelFunc(function(B){return B.avgPoolBackprop(A,R,M)},{dy4D:A,input4D:R});return D?k.as3D(k.shape[1],k.shape[2],k.shape[3]):k}(p,l,t,e,r,a)}}},"AvgPool",f);return h=h.cast(u.dtype),c?h.as3D(h.shape[1],h.shape[2],h.shape[3]):h}var hn=X({maxPool_:function(n,t,e,r,a){return L2(n,t,e,1,r,a)}}),yl=X({avgPool_:function(n,t,e,r,a){return z2(n,t,e,1,r,a)}}),R3=X({pool_:function(n,t,e,r,a,o){a==null&&(a=[1,1]),o==null&&(o=1),r===0&&(r="valid");var u=z(n,"x","maxPool"),l=u,c=!1;u.rank===3&&(c=!0,l=u.as4D(1,u.shape[0],u.shape[1],u.shape[2])),j(Kn(o,a),function(){return"Error in pool: Either strides or dilations must be 1. Got strides "+o+" and dilations '"+a+"'"});var f,h=nl(l.shape,t,o,a,r),p=[h.dilationHeight,h.dilationWidth];f=r==="same"?function(R,A){var D=R.map(function(B,O){return B+(B-1)*(A[O]-1)}).map(function(B){return B-1}),M=D.map(function(B){return Math.floor(B/2)}),k=D.map(function(B,O){return B-M[O]});return D.map(function(B,O){return[M[O],k[O]]})}([h.filterHeight,h.filterWidth],p):[[0,0],[0,0]];var m=p[0]===1&&p[1]===1,g=function(R,A,D){var M=D.map(function($){return $[0]}),k=D.map(function($){return $[1]}),B=R.concat(M,k),O=A.map(function($,K){return($-B[K]%$)%$}),V=k.map(function($,K){return $+O[K]}),H=A.map(function($,K){return[M[K],V[K]]}),ee=A.map(function($,K){return[0,O[K]]});return[H,ee]}([h.inHeight,h.inWidth],p,f),b=g[0],x=g[1],w=m?r:"valid",E=m?l:Gw(l,p,b),C=(e==="avg"?function(){return z2(E,t,o,1,w)}:function(){return L2(E,t,o,1,w)})(),_=m?C:Hw(C,p,x);return c?_.as3D(_.shape[1],_.shape[2],_.shape[3]):_}}),A3=X({maxPool3d_:function(n,t,e,r,a,o,u){o===void 0&&(o="NDHWC");var l=z(n,"x","maxPool3d"),c=l,f=!1;l.rank===4&&(f=!0,c=l.as5D(1,l.shape[0],l.shape[1],l.shape[2],l.shape[3])),u==null&&(u=[1,1,1]),j(c.rank===5,function(){return"Error in maxPool3d: x must be rank 5 but got rank "+c.rank+"."}),j(o==="NDHWC",function(){return"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of "+o}),j(Kn(e,u),function(){return"Error in maxPool3d: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+u+"'"}),a!=null&&j(Wt(r),function(){return"Error in maxPool3d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."});var h=Nf(c.shape,t,e,u,r,a,o),p=Q.runKernelFunc(function(m,g){var b=m.maxPool3d(c,h);return g([c,b]),b},{x:c},function(m,g){var b=g[0],x=g[1];return{x:function(){return function(w,E,C,_,R,A,D,M){var k=z(w,"dy","maxPool3dBackprop"),B=z(E,"input","maxPool3dBackprop"),O=z(C,"output","maxPool3dBackprop"),V=k,H=B,ee=O,$=!1;B.rank===4&&($=!0,V=k.as5D(1,k.shape[0],k.shape[1],k.shape[2],k.shape[3]),H=B.as5D(1,B.shape[0],B.shape[1],B.shape[2],B.shape[3]),ee=O.as5D(1,O.shape[0],O.shape[1],O.shape[2],O.shape[3])),j(V.rank===5,function(){return"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+V.rank+"."}),j(H.rank===5,function(){return"Error in maxPool3dBackprop: input must be rank 5 but got rank "+H.rank+"."}),j(ee.rank===5,function(){return"Error in maxPool3dBackprop: output must be rank 5 but got rank "+ee.rank+"."}),A==null&&(A=[1,1,1]),j(Kn(R,A),function(){return"Error in maxPool3dBackprop: Either strides or dilations must be 1. Got strides "+R+" and dilations '"+A+"'"}),M!=null&&j(Wt(D),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+M+" but got pad "+D+"."});var K=Nf(H.shape,_,R,A,D,M),L=Q.runKernelFunc(function(W){return W.maxPool3dBackprop(V,H,ee,K)},{dy5D:V,input5D:H});return $?L.as4D(L.shape[1],L.shape[2],L.shape[3],L.shape[4]):L}(m,b,x,t,e,u,r,a)}}});return f?p.as4D(p.shape[1],p.shape[2],p.shape[3],p.shape[4]):p}}),T3=X({avgPool3d_:function(n,t,e,r,a,o,u){o===void 0&&(o="NDHWC");var l=z(n,"x","avgPool3d","float32"),c=l,f=!1;l.rank===4&&(f=!0,c=l.as5D(1,l.shape[0],l.shape[1],l.shape[2],l.shape[3])),u==null&&(u=[1,1,1]),j(c.rank===5,function(){return"Error in avgPool3d: x must be rank 5 but got rank "+c.rank+"."}),j(o==="NDHWC",function(){return"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of "+o}),j(Kn(e,u),function(){return"Error in avgPool3d: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+u+"'"}),a!=null&&j(Wt(r),function(){return"Error in avgPool3d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."});var h=Nf(c.shape,t,e,u,r,a,o),p=Q.runKernelFunc(function(m){return m.avgPool3d(c,h)},{x:c},function(m){return{x:function(){return function(g,b,x,w,E,C,_){var R=z(g,"dy","avgPool3dBackprop"),A=z(b,"input","avgPool3dBackprop"),D=R,M=A,k=!1;A.rank===4&&(k=!0,D=R.as5D(1,R.shape[0],R.shape[1],R.shape[2],R.shape[3]),M=A.as5D(1,A.shape[0],A.shape[1],A.shape[2],A.shape[3])),j(D.rank===5,function(){return"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+D.rank+"."}),j(M.rank===5,function(){return"Error in avgPool3dBackprop: input must be rank 5 but got rank "+M.rank+"."}),E==null&&(E=[1,1,1]),j(Kn(w,E),function(){return"Error in avgPool3dBackprop: Either strides or dilations must be 1. Got strides "+w+" and dilations '"+E+"'"}),_!=null&&j(Wt(C),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+_+" but got pad "+C+"."});var B=Nf(M.shape,x,w,E,C,_),O=Q.runKernelFunc(function(V){return V.avgPool3dBackprop(D,M,B)},{dy5D:D,input5D:M});return k?O.as4D(O.shape[1],O.shape[2],O.shape[3],O.shape[4]):O}(m,c,t,e,u,r,a)}}});return p=p.cast(c.dtype),f?p.as4D(p.shape[1],p.shape[2],p.shape[3],p.shape[4]):p}}),ua=X({slice_:function(n,t,e){var r,a,o=z(n,"x","slice");if(o.rank===0)throw new Error("Slicing scalar is not possible");(r=typeof t=="number"?[t].concat(new Array(o.rank-1).fill(0)):t.length<o.rank?t.concat(new Array(o.rank-t.length).fill(0)):t.slice()).forEach(function(c){j(c!==-1,function(){return"slice() does not support negative begin indexing."})}),a=(a=e==null?new Array(o.rank).fill(-1):typeof e=="number"?[e].concat(new Array(o.rank-1).fill(-1)):e.length<o.rank?e.concat(new Array(o.rank-e.length).fill(-1)):e).map(function(c,f){return c>=0?c:(j(c===-1,function(){return"Negative size values should be exactly -1 but got "+c+" for the slice() size at index "+f+"."}),o.shape[f]-r[f])}),nN(o,r,a);var u=o.shape,l={begin:r,size:a};return Q.runKernelFunc(function(c){return c.slice(o,r,a)},{x:o},function(c){for(var f=[],h=0;h<c.rank;h++)f.push([r[h],u[h]-r[h]-a[h]]);return{x:function(){return c.pad(f)}}},"Slice",l)}}),N3=X({slice1d_:function(n,t,e){var r=z(n,"x","slice1d");return j(r.rank===1,function(){return"slice1d expects a rank-1 tensor, but got a rank-"+r.rank+" tensor"}),ua(r,[t],[e])}}),D3=X({slice2d_:function(n,t,e){var r=z(n,"x","slice2d");return j(r.rank===2,function(){return"slice2d expects a rank-2 tensor, but got a rank-"+r.rank+" tensor"}),ua(r,t,e)}}),U2=X({slice3d_:function(n,t,e){var r=z(n,"x","slice3d");return j(r.rank===3,function(){return"slice3d expects a rank-3 tensor, but got a rank-"+r.rank+" tensor"}),ua(r,t,e)}}),k3=X({slice4d_:function(n,t,e){var r=z(n,"x","slice4d");return j(r.rank===4,function(){return"slice4d expects a rank-4 tensor, but got a rank-"+r.rank+" tensor"}),ua(r,t,e)}});function j2(n,t,e,r,a){return t.rank<e.rank&&(t=t.reshape(Yn(t.shape,r))),n.rank<e.rank&&(n=n.reshape(Yn(n.shape,r))),{x:function(){var o=n.mul(e.equal(t).cast(n.dtype));return a==null?o:o.transpose(a)}}}var M3=X({all_:function(n,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var r=z(n,"x","all","bool"),a=sn(t,r.shape),o=a,u=ha(o,r.rank);u!=null&&(r=r.transpose(u),o=pa(o.length,r.rank));var l=Q.runKernelFunc(function(f){return f.all(r,o)},{$x:r});if(e){var c=Yn(l.shape,a);return l.reshape(c)}return l}}),O3=X({any_:function(n,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var r=z(n,"x","any","bool"),a=sn(t,r.shape),o=a,u=ha(o,r.rank);u!=null&&(r=r.transpose(u),o=pa(o.length,r.rank));var l=Q.runKernelFunc(function(f){return f.any(r,o)},{$x:r});if(e){var c=Yn(l.shape,a);return l.reshape(c)}return l}}),I3=X({argMax_:function(n,t){t===void 0&&(t=0);var e=z(n,"x","argMax");t==null&&(t=0);var r=sn(t,e.shape),a=ha(r,e.rank);a!=null&&(e=e.transpose(a),r=pa(r.length,e.rank));var o={axis:r[0]},u=[e];return Q.runKernelFunc(function(l,c){var f=l.argMax(e,r[0]);return c([e]),f},{x:e},function(l,c){var f=c[0];return{x:function(){return ot(f)}}},"ArgMax",o,u)}}),B3=X({argMin_:function(n,t){t===void 0&&(t=0);var e=z(n,"x","argMin");t==null&&(t=0);var r=sn(t,e.shape),a=ha(r,e.rank);return a!=null&&(e=e.transpose(a),r=pa(r.length,e.rank)),Q.runKernelFunc(function(o,u){var l=o.argMin(e,r[0]);return u([e]),l},{$x:e},function(o,u){var l=u[0];return{$x:function(){return ot(l)}}})}}),F3=X({logSumExp_:function(n,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var r=z(n,"x","logSumExp"),a=sn(t,r.shape),o=r.max(a,!0),u=r.sub(o).exp().sum(a).log(),l=o.reshape(u.shape).add(u);if(e){var c=Yn(l.shape,a);return l.reshape(c)}return l}}),td=X({max_:function(n,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var r=z(n,"x","max"),a=r,o=sn(t,r.shape),u=o,l=ha(u,r.rank);l!=null&&(r=r.transpose(l),u=pa(u.length,r.rank));var c=[r],f=Q.runKernelFunc(function(p,m){var g=p.max(r,u);return m([a,g]),g},{x:r},function(p,m){return j2(p,m[1],m[0],o,l)},"Max",{axes:u},c,[!0]);if(e){var h=Yn(f.shape,o);f=f.reshape(h)}return f}}),P3=X({mean_:function(n,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var r=z(n,"x","mean"),a=sn(t,r.shape),o=ke(Tn(r.shape,a)[1]);return Qf(function(u){var l=Se(o);return{value:(l.dtype===u.dtype?u:u.cast(l.dtype)).div(l).sum(t,e),gradFunc:function(c){var f=u.shape.slice();return a.forEach(function(h){f[h]=1}),c.reshape(f).mul(Ps(u.shape,"float32")).div(o)}}})(r)}}),L3=X({min_:function(n,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var r=z(n,"x","min"),a=r,o=sn(t,r.shape),u=o,l=ha(u,r.rank);l!=null&&(r=r.transpose(l),u=pa(u.length,r.rank));var c=[r],f=Q.runKernelFunc(function(p,m){var g=p.min(r,u);return m([a,g]),g},{x:r},function(p,m){return j2(p,m[1],m[0],o,l)},"Min",{axes:u},c,[!0]);if(e){var h=Yn(f.shape,o);f=f.reshape(h)}return f}}),z3=X({moments_:function(n,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var r=sn(t,(n=z(n,"x","moments")).shape),a=n.mean(r,e),o=a.shape;e||(o=Yn(a.shape,r));var u=n.toFloat().sub(a.reshape(o)).square();return{mean:a,variance:u.mean(r,e)}}}),H2=X({sum_:function(n,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var r=z(n,"x","sum");r.dtype==="bool"&&(r=r.toInt());var a=sn(t,r.shape);return Qf(function(o){var u=ha(a,o.rank),l=a,c=o;u!=null&&(c=o.transpose(u),l=pa(l.length,o.rank));var f=function(g){var b=o.shape.slice();return a.forEach(function(x){b[x]=1}),g.reshape(b).mul(Ps(o.shape,"float32"))},h={axes:l},p=Q.runKernelFunc(function(g){return g.sum(c,l)},{x:c},function(g){return{x:function(){return f(g)}}},"Sum",h);if(e){var m=Yn(p.shape,a);p=p.reshape(m)}return{value:p,gradFunc:f}})(r)}}),U3=X({prod_:function(n,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var r=z(n,"x","prod");r.dtype==="bool"&&(r=r.toInt());var a=sn(t,r.shape),o=ha(a,r.rank),u=a,l=r;o!=null&&(l=r.transpose(o),u=pa(u.length,r.rank));var c=Q.runKernelFunc(function(h){return h.prod(l,u)},{permutedX:l});if(e){var f=Yn(c.shape,a);c=c.reshape(f)}return c}}),V2=X({elu_:function(n){var t=z(n,"x","elu");return Q.runKernelFunc(function(e,r){var a=e.elu(t);return r([a]),a},{$x:t},function(e,r){var a=r[0];return{$x:function(){return Q.runKernelFunc(function(o){return o.eluDer(e,a)},{dy:e,y:a})}}})}}),j3=X({leakyRelu_:function(n,t){t===void 0&&(t=.2);var e=z(n,"x","leakyRelu");return km(Se(t).mul(e),e)}}),W2=X({prelu_:function(n,t){var e=z(n,"x","prelu"),r=z(t,"alpha","prelu");return Q.runKernelFunc(function(a,o){var u=a.prelu(e,r);return o([e,r]),u},{x:e,alpha:r},function(a,o){var u=o[0],l=o[1],c=u.greater(0);return{x:function(){return fi(c,a,a.mul(l))},alpha:function(){var f=fi(c,ot(a),a.mul(u)),h=an(l.shape,a.shape);return h.length>0&&(f=f.sum(h)),f.reshape(l.shape)}}},"Prelu")}}),Ot=X({relu_:function(n){var t=z(n,"x","relu");return t.dtype==="bool"?t.toInt():Q.runKernelFunc(function(e,r){var a=e.relu(t);return r([t]),a},{x:t},function(e,r){var a=r[0];return{x:function(){return e.mulStrict(a.step().toFloat())}}},"Relu")}}),G2=X({relu6_:function(n){var t=z(n,"x","relu6");return t.dtype==="bool"?t.toInt():Q.runKernelFunc(function(e,r){var a=e.relu6(t);return r([t]),a},{x:t},function(e,r){var a=r[0],o=a.lessEqual(6).mul(a.step());return{x:function(){return e.mulStrict(o.toFloat())}}},"Relu6")}}),H3=X({selu_:function(n){var t=z(n,"x","selu");return Q.runKernelFunc(function(e,r){var a=e.selu(t);return r([t]),a},{$x:t},function(e,r){var a=r[0];return{$x:function(){var o=a.greater(Se(0)),u=Se(Tm),l=Se(Nm),c=e.mul(l),f=e.mul(u).mul(a.toFloat().exp());return fi(o,c,f)}}})}}),Ao=X({transpose_:function(n,t){var e=z(n,"x","transpose");if(t==null&&(t=e.shape.map(function(a,o){return o}).reverse()),j(e.rank===t.length,function(){return"Error in transpose: rank of input "+e.rank+" must match length of perm "+t+"."}),t.forEach(function(a){j(a>=0&&a<e.rank,function(){return"All entries in 'perm' must be between 0 and "+(e.rank-1)+" but got "+t})}),e.rank<=1)return e.clone();var r={perm:t};return Q.runKernelFunc(function(a){return a.transpose(e,t)},{x:e},function(a){var o=ym(t);return{x:function(){return a.transpose(o)}}},"Transpose",r)}}),V3=X({localResponseNormalization_:function(n,t,e,r,a){t===void 0&&(t=5),e===void 0&&(e=1),r===void 0&&(r=1),a===void 0&&(a=.5);var o=z(n,"x","localResponseNormalization");j(o.rank===4||o.rank===3,function(){return`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank `+o.rank+"."}),j(Wt(t),function(){return"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius "+t+"."});var u=o,l=!1;o.rank===3&&(l=!0,u=o.as4D(1,o.shape[0],o.shape[1],o.shape[2]));var c=Q.runKernelFunc(function(f,h){var p=f.localResponseNormalization4D(u,t,e,r,a);return h([u,p]),p},{x4D:u},function(f,h){var p=h[0],m=h[1];return{x4D:function(){return Q.runKernelFunc(function(g){return g.LRNGrad(f,p,m,t,e,r,a)},{})}}});return l?c.as3D(c.shape[1],c.shape[2],c.shape[3]):c}}),q2=X({norm_:function(n,t,e,r){t===void 0&&(t="euclidean"),e===void 0&&(e=null),r===void 0&&(r=!1);var a=function l(c,f,h){if(h===void 0&&(h=null),c.rank===0)return c.abs();if(c.rank!==1&&h===null)return l(c.reshape([-1]),f,h);if(c.rank===1||typeof h=="number"||Array.isArray(h)&&h.length===1){if(f===1)return c.abs().sum(h);if(f===1/0)return c.abs().max(h);if(f===-1/0)return c.abs().min(h);if(f==="euclidean"||f===2)return c.abs().pow(Se(2,"int32")).sum(h).sqrt();throw new Error("Error in norm: invalid ord value: "+f)}if(Array.isArray(h)&&h.length===2){if(f===1)return c.abs().sum(h[0]).max(h[1]-1);if(f===1/0)return c.abs().sum(h[1]).max(h[0]);if(f===-1/0)return c.abs().sum(h[1]).min(h[0]);if(f==="fro"||f==="euclidean")return c.square().sum(h).sqrt();throw new Error("Error in norm: invalid ord value: "+f)}throw new Error("Error in norm: invalid axis: "+h)}(n=z(n,"x","norm"),t,e),o=a.shape;if(r){var u=sn(e,n.shape);o=Yn(a.shape,u)}return a.reshape(o)}}),W3=X({basicLSTMCell_:function(n,t,e,r,a,o){var u=z(n,"forgetBias","basicLSTMCell"),l=z(t,"lstmKernel","basicLSTMCell"),c=z(e,"lstmBias","basicLSTMCell"),f=z(r,"data","basicLSTMCell"),h=z(a,"c","basicLSTMCell"),p=z(o,"h","basicLSTMCell"),m=f.concat(p,1).matMul(l).add(c),g=m.shape[0],b=m.shape[1]/4,x=[g,b],w=m.slice([0,0],x),E=m.slice([0,b],x),C=m.slice([0,2*b],x),_=m.slice([0,3*b],x),R=w.sigmoid().mulStrict(E.tanh()).addStrict(h.mulStrict(u.add(C).sigmoid())),A=R.tanh().mulStrict(_.sigmoid());return[R,A]}}),G3=X({multiRNNCell_:function(n,t,e,r){for(var a=z(t,"data","multiRNNCell"),o=Ef(e,"c","multiRNNCell"),u=Ef(r,"h","multiRNNCell"),l=a,c=[],f=0;f<n.length;f++){var h=n[f](l,o[f],u[f]);c.push(h[0]),c.push(h[1]),l=h[1]}var p=[],m=[];for(f=0;f<c.length;f+=2)p.push(c[f]),m.push(c[f+1]);return[p,m]}}),q3=X({movingAverage_:function(n,t,e,r,a){a===void 0&&(a=!0);var o=z(n,"v","movingAverage"),u=z(t,"x","movingAverage"),l=z(e,"decay","movingAverage");VA(o,u),j(pn(o.shape,u.shape),function(){return"Shape mismatch in v and x"});var c=Se(1),f=c.sub(l),h=u.sub(o).mul(f);if(a){j(r!=null,function(){return"When using zeroDebias: true, step is required."});var p=z(r,"step","movingAverage");h=h.div(c.sub(Of(l,p)))}return o.add(h)}}),X3=X({stridedSlice_:function(n,t,e,r,a,o,u,l,c){if(a===void 0&&(a=0),o===void 0&&(o=0),u===void 0&&(u=0),l===void 0&&(l=0),c===void 0&&(c=0),r==null&&(r=new Array(t.length)),u!==0)throw new Error("ellipsis mask is not yet supported");var f=z(n,"x","stridedSlice"),h=Gx(l),p=f.shape.slice();h.forEach(function(w){t[w]=0,e[w]=1,p.splice(w,0,1)}),f=f.reshape(p);for(var m=0;m<f.rank;m++)t[m]=rN(a,t,r,f.shape,m),e[m]=aN(o,e,r,f.shape,m),r[m]=r[m]||1;var g=Gx(c);g.forEach(function(w){e[w]=t[w]+1,r[w]=1});var b=Sm(t,e,r),x=b.filter(function(w,E){return g.indexOf(E)===-1});return r.every(function(w){return w===1})?ua(f,t,b).reshape(x):Q.runKernelFunc(function(w){return w.stridedSlice(f,t,e,r)},{$x:f}).reshape(x)}}),Y3=X({topk_:function(n,t,e){t===void 0&&(t=1),e===void 0&&(e=!0);var r=z(n,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");var a=r.shape[r.shape.length-1];if(t>a)throw new Error("'k' passed to topk() must be <= the last dimension ("+a+") but got "+t);var o=Q.runKernelFunc(function(u){return u.topk(r,t,e)},{$x:r});return{values:o[0],indices:o[1]}}}),K3=X({scatterND_:function(n,t,e){var r=z(n,"indices","scatterND","int32"),a=z(t,"updates","scatterND");return tN(a,r,e),Q.runKernelFunc(function(o){return o.scatterND(r,a,e)},{indices:r,updates:a},null,"ScatterNd",{shape:e})}}),Bm=X({fft_:function(n){j(n.dtype==="complex64",function(){return"The dtype for tf.spectral.fft() must be complex64 but got "+n.dtype+"."});var t=n.shape[n.shape.length-1],e=n.size/t,r=n.as2D(e,t);return Q.runKernelFunc(function(a){return a.fft(r)},{input:n}).reshape(n.shape)}}),If=X({ifft_:function(n){j(n.dtype==="complex64",function(){return"The dtype for tf.spectral.ifft() must be complex64 but got "+n.dtype+"."});var t=n.shape[n.shape.length-1],e=n.size/t,r=n.as2D(e,t);return Q.runKernelFunc(function(a){return a.ifft(r)},{input:n}).reshape(n.shape)}}),Fm=X({rfft_:function(n,t){j(n.dtype==="float32",function(){return"The dtype for rfft() must be real value but got "+n.dtype});var e,r=n.shape[n.shape.length-1],a=n.size/r;if(t!=null&&t<r){var o=n.shape.map(function(E){return 0}),u=n.shape.map(function(E){return E});u[n.shape.length-1]=t,e=n.slice(o,u),r=t}else if(t!=null&&t>r){var l=n.shape.map(function(E){return E});l[n.shape.length-1]=t-r,e=n.concat(_t(l),n.shape.length-1),r=t}else e=n;var c=e.zerosLike(),f=wn(e,c).as2D(a,r),h=Bm(f),p=Math.floor(r/2)+1,m=_r(h),g=ea(h),b=m.split([p,r-p],m.shape.length-1),x=g.split([p,r-p],g.shape.length-1),w=e.shape.slice();return w[e.shape.length-1]=p,wn(b[0],x[0]).reshape(w)}}),X2=X({irfft_:function(n){var t=n.shape[n.shape.length-1],e=n.size/t;if(t<=2){var r=n.as2D(e,t),a=If(r);return _r(a)}var o=[e,2*(t-1)],u=_r(n).as2D(e,t),l=ea(n).as2D(e,t),c=u.slice([0,1],[e,t-2]).reverse(1),f=l.slice([0,1],[e,t-2]).reverse(1).mul(Se(-1)),h=u.concat(c,1),p=l.concat(f,1);return r=wn(h,p).as2D(o[0],o[1]),a=If(r),_r(a)}}),Q3=Object.freeze({fft:Bm,ifft:If,rfft:Fm,irfft:X2}),$3=X({sparseToDense_:function(n,t,e,r){r===void 0&&(r=0);var a=z(n,"sparseIndices","sparseToDense","int32"),o=z(t,"sparseValues","sparseToDense"),u=z(r,"defaultValue","sparseToDense",o.dtype);return function(l,c,f,h){if(l.dtype!=="int32")throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was "+l.dtype+".");if(l.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape "+l.shape+".");var p=l.rank>0?l.shape[0]:1,m=l.rank>1?l.shape[1]:1;if(f.length!==m)throw new Error("outputShape has incorrect number of elements:, "+f.length+", should be: "+m+".");var g=c.size;if(c.rank!==0&&(c.rank!==1||g!==p))throw new Error("sparseValues has incorrect shape "+c.shape+", should be [] or ["+p+"]");if(c.dtype!==h.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(a,o,e,u),Q.runKernelFunc(function(l){return l.sparseToDense(a,o,e,u)},{$sparseIndices:a,$sparseValues:o,$defaultValue:u})}}),Z3=X({gatherND_:function(n,t){var e=z(t,"indices","gatherND","int32"),r=z(n,"x","gatherND");return Q.runKernelFunc(function(a){return a.gatherND(r,e)},{x:r,indices:e},null,"GatherNd")}}),J3=X({diag_:function(n){var t=z(n,"x","diag").flatten(),e=n.shape.concat(n.shape);return Q.runKernelFunc(function(r){return r.diag(t)},{$x:t}).reshape(e)}}),e4=X({dropout_:function(n,t,e,r){var a=z(n,"x","dropout");if(j(a.dtype==="float32",function(){return"x has to be a floating point tensor since it's going to be scaled, but got a "+a.dtype+" tensor instead."}),j(t>=0&&t<1,function(){return"rate must be a float in the range [0, 1), but got "+t+"."}),t===0)return n instanceof Mt?a.clone():a;var o=function(c,f){if(f==null)return c.shape.slice();if(pn(c.shape,f))return f;if(c.shape.length===f.length){for(var h=[],p=0;p<c.shape.length;p++)f[p]==null&&c.shape[p]!=null?h.push(c.shape[p]):h.push(f[p]);return h}return f}(a,e),u=1-t,l=Ww(o,0,1,"float32",r).add(u).floor().div(u);return a.mul(l)}});function Y2(n,t,e){for(var r=1-n%2,a=new Float32Array(n),o=0;o<n;++o){var u=2*Math.PI*o/(n+r-1);a[o]=t-e*Math.cos(u)}return Yt(a,"float32")}var Pm=X({hannWindow_:function(n){return Y2(n,.5,.5)}}),K2=X({hammingWindow_:function(n){return Y2(n,.54,.46)}}),Lm=X({frame_:function(n,t,e,r,a){r===void 0&&(r=!1),a===void 0&&(a=0);for(var o=0,u=[];o+t<=n.size;)u.push(ua(n,o,t)),o+=e;if(r)for(;o<n.size;){var l=o+t-n.size,c=nn([ua(n,o,t-l),ia([l],a)]);u.push(c),o+=e}return u.length===0?Eo([],[0,t]):nn(u).as2D(u.length,t)}}),Q2=X({stft_:function(n,t,e,r,a){var o;a===void 0&&(a=Pm),r==null&&(o=t,r=Math.floor(Math.pow(2,Math.ceil(Math.log(o)/Math.log(2)))));for(var u=Lm(n,t,e),l=Mn(u,a(t)),c=[],f=0;f<u.shape[0];f++)c.push(Fm(l.slice([f,0],[1,t]),r));return nn(c)}}),t4=Object.freeze({hannWindow:Pm,hammingWindow:K2,frame:Lm,stft:Q2}),kn,n4=function(n,t,e){return e===void 0&&(e=1),Te(this,void 0,void 0,function(){var r,a,o,u,l,c,f,h,p,m,g,b,x,w;return Ne(this,function(E){switch(E.label){case 0:return r=z(n,"predictions","inTopK"),a=z(t,"targets","inTopK"),j(r.rank>1,function(){return"inTopK() expects the predictions to be of rank 2 or higher, but got "+r.rank}),j(r.rank-1===a.rank,function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+r.rank+" and targets rank "+a.rank}),ft(r.shape.slice(0,r.shape.length-1),a.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),o=r.shape[r.shape.length-1],j(e>0&&e<=o,function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last dimension ("+o+"), but got "+e}),[4,r.data()];case 1:return u=E.sent(),[4,a.data()];case 2:for(l=E.sent(),c=[u.length/o,o],h=c[1],p=Ju("bool",f=c[0]),m=0;m<f;m++){for(g=m*h,b=u.subarray(g,g+h),x=[],w=0;w<b.length;w++)x.push({value:b[w],index:w});for(x.sort(function(C,_){return _.value-C.value}),p[m]=0,w=0;w<e;w++)if(x[w].index===l[m]){p[m]=1;break}}return n!==r&&r.dispose(),t!==a&&a.dispose(),[2,En(p,a.shape,"bool")]}})})};(function(n){n[n.NONE=0]="NONE",n[n.MEAN=1]="MEAN",n[n.SUM=2]="SUM",n[n.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(kn||(kn={}));var r4=X({absoluteDifference_:function(n,t,e,r){r===void 0&&(r=kn.SUM_BY_NONZERO_WEIGHTS);var a=z(n,"labels","absoluteDifference"),o=z(t,"predictions","absoluteDifference"),u=null;e!=null&&(u=z(e,"weights","absoluteDifference")),ft(a.shape,o.shape,"Error in absoluteDifference: ");var l=a.sub(o).abs();return ja(l,u,r)}}),ja=X({computeWeightedLoss_:function(n,t,e){e===void 0&&(e=kn.SUM_BY_NONZERO_WEIGHTS);var r=z(n,"losses","computeWeightedLoss"),a=null;t!=null&&(a=z(t,"weights","computeWeightedLoss"));var o=a==null?r:r.mul(a);if(e===kn.NONE)return o;if(e===kn.SUM)return o.sum();if(e===kn.MEAN){if(a==null)return o.mean();var u=r.size/a.size,l=o.sum().div(a.sum());return u>1?l.div(Se(u)):l}if(e===kn.SUM_BY_NONZERO_WEIGHTS){if(a==null)return o.sum().div(Se(r.size));var c=a.mul(Ps(r.shape)).notEqual(Se(0)).sum().toFloat();return o.sum().div(c)}throw Error("Unknown reduction: "+e)}}),a4=X({cosineDistance_:function(n,t,e,r,a){a===void 0&&(a=kn.SUM_BY_NONZERO_WEIGHTS);var o=z(n,"labels","cosineDistance"),u=z(t,"predictions","cosineDistance"),l=null;r!=null&&(l=z(r,"weights","cosineDistance")),ft(o.shape,u.shape,"Error in cosineDistance: ");var c=Se(1).sub(o.mul(u).sum(e,!0));return ja(c,l,a)}}),o4=X({hingeLoss_:function(n,t,e,r){r===void 0&&(r=kn.SUM_BY_NONZERO_WEIGHTS);var a=z(n,"labels","hingeLoss"),o=z(t,"predictions","hingeLoss"),u=null;e!=null&&(u=z(e,"weights","hingeLoss")),ft(a.shape,o.shape,"Error in hingeLoss: ");var l=Se(1);a=Se(2).mul(a).sub(l);var c=l.sub(a.mul(o)).relu();return ja(c,u,r)}}),i4=X({huberLoss_:function(n,t,e,r,a){r===void 0&&(r=1),a===void 0&&(a=kn.SUM_BY_NONZERO_WEIGHTS);var o=z(n,"labels","huberLoss"),u=z(t,"predictions","huberLoss"),l=null;e!=null&&(l=z(e,"weights","huberLoss")),ft(o.shape,u.shape,"Error in huberLoss: ");var c=Se(r),f=u.sub(o).abs(),h=N2(f,c),p=f.sub(h),m=Se(.5).mul(h.square()).add(c.mul(p));return ja(m,l,a)}}),s4=X({logLoss_:function(n,t,e,r,a){r===void 0&&(r=1e-7),a===void 0&&(a=kn.SUM_BY_NONZERO_WEIGHTS);var o=z(n,"labels","logLoss"),u=z(t,"predictions","logLoss"),l=null;e!=null&&(l=z(e,"weights","logLoss")),ft(o.shape,u.shape,"Error in logLoss: ");var c=Se(1),f=Se(r),h=o.mul(u.add(f).log()).neg().sub(c.sub(o).mul(c.sub(u).add(f).log()));return ja(h,l,a)}}),u4=X({meanSquaredError_:function(n,t,e,r){r===void 0&&(r=kn.SUM_BY_NONZERO_WEIGHTS);var a=z(n,"labels","meanSquaredError"),o=z(t,"predictions","meanSquaredError"),u=null;e!=null&&(u=z(e,"weights","meanSquaredError")),ft(a.shape,o.shape,"Error in meanSquaredError: ");var l=a.squaredDifference(o);return ja(l,u,r)}}),l4=X({sigmoidCrossEntropy_:function(n,t,e,r,a){r===void 0&&(r=0),a===void 0&&(a=kn.SUM_BY_NONZERO_WEIGHTS);var o=z(n,"multiClassLabels","sigmoidCrossEntropy"),u=z(t,"logits","sigmoidCrossEntropy"),l=null;if(e!=null&&(l=z(e,"weights","sigmoidCrossEntropy")),ft(o.shape,u.shape,"Error in sigmoidCrossEntropy: "),r>0){var c=Se(r),f=Se(1),h=Se(.5);o=o.mul(f.sub(c)).add(h.mul(c))}var p=function(m,g){var b=z(m,"labels","sigmoidCrossEntropyWithLogits"),x=z(g,"logits","sigmoidCrossEntropyWithLogits");ft(b.shape,x.shape,"Error in sigmoidCrossEntropyWithLogits: ");var w=x.relu(),E=x.mul(b),C=x.abs().neg().exp().log1p();return w.sub(E).add(C)}(o,u);return ja(p,l,a)}}),c4=X({softmaxCrossEntropy_:function(n,t,e,r,a){r===void 0&&(r=0),a===void 0&&(a=kn.SUM_BY_NONZERO_WEIGHTS);var o=z(n,"onehotLabels","softmaxCrossEntropy"),u=z(t,"logits","softmaxCrossEntropy"),l=null;if(e!=null&&(l=z(e,"weights","softmaxCrossEntropy")),ft(o.shape,u.shape,"Error in softmaxCrossEntropy: "),r>0){var c=Se(r),f=Se(1),h=Se(o.shape[1]);o=o.mul(f.sub(c)).add(c.div(h))}var p=function(m,g,b){if(b===void 0&&(b=-1),b===-1&&(b=g.rank-1),b!==g.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+g.rank+" and dim was "+b);return Qf(function(x,w,E){var C=w.logSumExp([b],!0),_=w.toFloat().sub(C);return E([x,_]),{value:_.mul(x).neg().sum([b]),gradFunc:function(R,A){var D=A[0],M=A[1],k=Yn(R.shape,[b]);return[R.reshape(k).mul(D.toFloat().sub(M.exp())),R.reshape(k).mul(M.exp().sub(D.toFloat()))]}}})(m,g)}(o,u);return ja(p,l,a)}}),f4=Object.freeze({get Reduction(){return kn},absoluteDifference:r4,computeWeightedLoss:ja,cosineDistance:a4,hingeLoss:o4,huberLoss:i4,logLoss:s4,meanSquaredError:u4,sigmoidCrossEntropy:l4,softmaxCrossEntropy:c4});function h1(n,t){return t===void 0&&(t=!1),Q.tidy(function(){if(n.shape.length!==2)throw new Error("qr2d() requires a 2D Tensor, but got a "+n.shape.length+"D Tensor.");for(var e=n.shape[0],r=n.shape[1],a=Vw(e),o=n.clone(),u=Eo([[1]],[1,1]),l=u.clone(),c=e>=r?r:e,f=function(p){var m,g=o,b=l,x=a;m=Q.tidy(function(){var w=o.slice([p,p],[e-p,1]),E=w.norm(),C=o.slice([p,p],[1,1]),_=Eo([[-1]]).where(C.greater(0),Eo([[1]])),R=C.sub(_.mul(E)),A=w.div(R);l=A.shape[0]===1?u.clone():u.concat(A.slice([1,0],[A.shape[0]-1,A.shape[1]]),0);var D=_.matMul(R).div(E).neg(),M=o.slice([p,0],[e-p,r]),k=D.mul(l);if(p===0)o=M.sub(k.matMul(l.transpose().matMul(M)));else{var B=M.sub(k.matMul(l.transpose().matMul(M)));o=o.slice([0,0],[p,r]).concat(B,0)}var O=a.slice([0,p],[e,a.shape[1]-p]);if(p===0)a=O.sub(O.matMul(l).matMul(k.transpose()));else{var V=O.sub(O.matMul(l).matMul(k.transpose()));a=a.slice([0,0],[e,p]).concat(V,1)}return[l,o,a]}),l=m[0],o=m[1],a=m[2],Xn([g,b,x])},h=0;h<c;++h)f(h);return!t&&e>r&&(a=a.slice([0,0],[e,r]),o=o.slice([0,0],[r,r])),[a,o]})}var d4=X({bandPart_:function(n,t,e){if(t%1!=0)throw new Error("bandPart(): numLower must be an integer, got "+t+".");if(e%1!=0)throw new Error("bandPart(): numUpper must be an integer, got "+e+".");var r=z(n,"a","bandPart");if(r.rank<2)throw new Error("bandPart(): Rank must be at least 2, got "+r.rank+".");var a=r.shape,o=r.shape.slice(-2),u=o[0],l=o[1];if(!(t<=u))throw new Error("bandPart(): numLower ("+t+") must not be greater than the number of rows ("+u+").");if(!(e<=l))throw new Error("bandPart(): numUpper ("+e+") must not be greater than the number of columns ("+l+").");t<0&&(t=u),e<0&&(e=l);var c=Cf(0,u,1,"int32").reshape([-1,1]),f=Cf(0,l,1,"int32"),h=on(c,f),p=Zf(h.lessEqual(Se(+t,"int32")),h.greaterEqual(Se(-e,"int32"))),m=_t([u,l],r.dtype);return cr(rn(r.reshape([-1,u,l])).map(function(g){return fi(p,g,m)})).reshape(a)}}),h4=X({gramSchmidt_:function(n){var t;if(Array.isArray(n)){t=!1,j(n!=null&&n.length>0,function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"});for(var e=n[0].shape[0],r=function(c){j(n[c].shape[0]===e,function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: ("+n[c].shape[0]+" vs. "+e+")"})},a=1;a<n.length;++a)r(a)}else t=!0,n=xm(n,n.shape[0],0).map(function(c){return qw(c,[0])});j(n.length<=n[0].shape[0],function(){return"Gram-Schmidt: Number of vectors ("+n.length+") exceeds number of dimensions ("+n[0].shape[0]+")."});var o=[],u=n,l=function(c){o.push(Q.tidy(function(){var f=u[c];if(c>0)for(var h=0;h<c;++h){var p=H2(o[h].mulStrict(f)).mul(o[h]);f=f.sub(p)}return f.div(q2(f,"euclidean"))}))};for(a=0;a<n.length;++a)l(a);return t?cr(o,0):o}}),p4=X({qr_:function(n,t){if(t===void 0&&(t=!1),n.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank "+n.rank);if(n.rank===2)return h1(n,t);var e=n.shape.slice(0,n.shape.length-2).reduce(function(u,l){return u*l}),r=rn(n.reshape([e,n.shape[n.shape.length-2],n.shape[n.shape.length-1]]),0),a=[],o=[];return r.forEach(function(u){var l=h1(u,t),c=l[0],f=l[1];a.push(c),o.push(f)}),[cr(a,0).reshape(n.shape),cr(o,0).reshape(n.shape)]}}),v4=Object.freeze({bandPart:d4,gramSchmidt:h4,qr:p4});function nd(n,t,e,r,a,o){r==null&&(r=.5),a==null&&(a=Number.NEGATIVE_INFINITY),o==null&&(o=0);var u=n.shape[0];return e=Math.min(e,u),j(0<=r&&r<=1,function(){return"iouThreshold must be in [0, 1], but was '"+r+"'"}),j(n.rank===2,function(){return"boxes must be a 2D tensor, but was of rank '"+n.rank+"'"}),j(n.shape[1]===4,function(){return"boxes must have 4 columns, but 2nd dimension was "+n.shape[1]}),j(t.rank===1,function(){return"scores must be a 1D tensor"}),j(t.shape[0]===u,function(){return"scores has incompatible shape with boxes. Expected "+u+", but was "+t.shape[0]}),j(0<=o&&o<=1,function(){return"softNmsSigma must be in [0, 1], but was '"+o+"'"}),{maxOutputSize:e,iouThreshold:r,scoreThreshold:a,softNmsSigma:o}}var m4=X({resizeBilinear_:function(n,t,e){e===void 0&&(e=!1);var r=z(n,"images","resizeBilinear");j(r.rank===3||r.rank===4,function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+r.rank+"."}),j(t.length===2,function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+t+"."});var a=r,o=!1;r.rank===3&&(o=!0,a=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var u=t[0],l=t[1],c=Q.runKernelFunc(function(f,h){return h([a]),f.resizeBilinear(a,u,l,e)},{x:a},function(f,h){return{x:function(){return Q.runKernelFunc(function(p){return p.resizeBilinearBackprop(f,h[0],e)},{})}}},"ResizeBilinear",{alignCorners:e,newHeight:u,newWidth:l});return o?c.as3D(c.shape[1],c.shape[2],c.shape[3]):c}}),g4=X({resizeNearestNeighbor_:function(n,t,e){e===void 0&&(e=!1);var r=z(n,"images","resizeNearestNeighbor");j(r.rank===3||r.rank===4,function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+r.rank+"."}),j(t.length===2,function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+t+"."}),j(r.dtype==="float32"||r.dtype==="int32",function(){return"`images` must have `int32` or `float32` as dtype"});var a=r,o=!1;r.rank===3&&(o=!0,a=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var u=t[0],l=t[1],c=Q.runKernelFunc(function(f,h){return h([a]),f.resizeNearestNeighbor(a,u,l,e)},{batchImages:a},function(f,h){return{batchImages:function(){return Q.runKernelFunc(function(p){return p.resizeNearestNeighborBackprop(f,h[0],e)},{})}}});return o?c.as3D(c.shape[1],c.shape[2],c.shape[3]):c}}),y4=X({nonMaxSuppression_:function(n,t,e,r,a){r===void 0&&(r=.5),a===void 0&&(a=Number.NEGATIVE_INFINITY);var o=z(n,"boxes","nonMaxSuppression"),u=z(t,"scores","nonMaxSuppression"),l=nd(o,u,e,r,a);e=l.maxOutputSize,r=l.iouThreshold,a=l.scoreThreshold;var c={maxOutputSize:e,iouThreshold:r,scoreThreshold:a};return Q.runKernelFunc(function(f){return f.nonMaxSuppression(o,u,e,r,a)},{boxes:o,scores:u},null,"NonMaxSuppressionV3",c)}}),b4=function(n,t,e,r,a){return r===void 0&&(r=.5),a===void 0&&(a=Number.NEGATIVE_INFINITY),Te(this,void 0,void 0,function(){var o,u,l,c,f,h,p;return Ne(this,function(m){switch(m.label){case 0:return o=z(n,"boxes","nonMaxSuppressionAsync"),u=z(t,"scores","nonMaxSuppressionAsync"),l=nd(o,u,e,r,a),e=l.maxOutputSize,r=l.iouThreshold,a=l.scoreThreshold,[4,Promise.all([o.data(),u.data()])];case 1:return c=m.sent(),f=c[0],h=c[1],p=Cm(f,h,e,r,a),o!==n&&o.dispose(),u!==t&&u.dispose(),[2,p]}})})},x4=X({nonMaxSuppressionWithScore_:function(n,t,e,r,a,o){r===void 0&&(r=.5),a===void 0&&(a=Number.NEGATIVE_INFINITY),o===void 0&&(o=0);var u=z(n,"boxes","nonMaxSuppression"),l=z(t,"scores","nonMaxSuppression"),c=nd(u,l,e,r,a,o),f={maxOutputSize:e=c.maxOutputSize,iouThreshold:r=c.iouThreshold,scoreThreshold:a=c.scoreThreshold,softNmsSigma:o=c.softNmsSigma},h=Q.runKernel("NonMaxSuppressionV5",{boxes:u,scores:l},f);return{selectedIndices:h[0],selectedScores:h[1]}}}),w4=function(n,t,e,r,a,o){return r===void 0&&(r=.5),a===void 0&&(a=Number.NEGATIVE_INFINITY),o===void 0&&(o=0),Te(this,void 0,void 0,function(){var u,l,c,f,h,p,m;return Ne(this,function(g){switch(g.label){case 0:return u=z(n,"boxes","nonMaxSuppressionAsync"),l=z(t,"scores","nonMaxSuppressionAsync"),c=nd(u,l,e,r,a,o),e=c.maxOutputSize,r=c.iouThreshold,a=c.scoreThreshold,o=c.softNmsSigma,[4,Promise.all([u.data(),l.data()])];case 1:return f=g.sent(),h=f[0],p=f[1],m=_m(h,p,e,r,a,o),u!==n&&u.dispose(),l!==t&&l.dispose(),[2,m]}})})},S4=X({cropAndResize_:function(n,t,e,r,a,o){var u=z(n,"image","cropAndResize"),l=z(t,"boxes","cropAndResize","float32"),c=z(e,"boxInd","cropAndResize","int32");a=a||"bilinear",o=o||0;var f=l.shape[0];return j(u.rank===4,function(){return"Error in cropAndResize: image must be rank 4,but got rank "+u.rank+"."}),j(l.rank===2&&l.shape[1]===4,function(){return"Error in cropAndResize: boxes must be have size ["+f+",4] but had shape "+l.shape+"."}),j(c.rank===1&&c.shape[0]===f,function(){return"Error in cropAndResize: boxInd must be have size ["+f+"] but had shape "+l.shape+"."}),j(r.length===2,function(){return"Error in cropAndResize: cropSize must be of length 2, but got length "+r.length+"."}),j(r[0]>=1&&r[1]>=1,function(){return"cropSize must be atleast [1,1], but was "+r}),j(a==="bilinear"||a==="nearest",function(){return"method must be bilinear or nearest, but was "+a}),Q.runKernelFunc(function(h,p){return h.cropAndResize(u,l,c,r,a,o)},{images:u,boxes:l,boxInd:c},null,"CropAndResize",{method:a,extrapolationValue:o,cropSize:r})}}),zm=Object.freeze({resizeBilinear:m4,resizeNearestNeighbor:g4,nonMaxSuppression:y4,nonMaxSuppressionAsync:b4,nonMaxSuppressionWithScore:x4,nonMaxSuppressionWithScoreAsync:w4,cropAndResize:S4}),Um=function(n,t){return!(n>0)||t==="linear"},jm=function(n,t,e){if(e==null||e==="linear")return n;if(e==="relu")return n.mul(t.step());throw new Error("Gradient for activation "+e+" has not been implemented yet.")},Hm=function(n,t){var e=t,r=an(n.shape,t.shape);return r.length>0&&(e=e.sum(r)),e.reshape(n.shape)},Vm=function(n,t,e){if(t==="linear")return n;if(t==="relu")return Ot(n);if(t==="elu")return V2(n);if(t==="relu6")return G2(n);if(t==="prelu")return W2(n,e);throw new Error("Unknown fused activation "+t+".")},E4=X({fusedMatMul_:function(n){var t,e=n.a,r=n.b,a=n.transposeA,o=a!==void 0&&a,u=n.transposeB,l=u!==void 0&&u,c=n.bias,f=n.activation,h=f===void 0?"linear":f,p=n.preluActivationWeights;if(Um(Q.state.gradientDepth,h)===!1){var m=ed(e,r,o,l);return c!=null&&(m=$e(m,c)),Vm(m,h,p)}var g=z(e,"a","fused matMul"),b=z(r,"b","fused matMul");t=It(g,b),g=t[0],b=t[1];var x=o?g.shape[g.rank-2]:g.shape[g.rank-1],w=l?b.shape[b.rank-1]:b.shape[b.rank-2],E=o?g.shape[g.rank-1]:g.shape[g.rank-2],C=l?b.shape[b.rank-2]:b.shape[b.rank-1],_=g.shape.slice(0,-2),R=b.shape.slice(0,-2),A=ke(_),D=ke(R);j(g.rank>=2&&b.rank>=2&&g.rank===b.rank,function(){return"Error in fused matMul: inputs must have the same rank of at least 2, got ranks "+g.rank+" and "+b.rank+"."}),j(pn(_,R),function(){return"Error in fused matMul: outer dimensions ("+_+") and ("+R+") of Tensors with shapes "+g.shape+" and "+b.shape+" must match."}),j(x===w,function(){return"Error in fused matMul: inner shapes ("+x+") and ("+w+") of Tensors with shapes "+g.shape+" and "+b.shape+" and transposeA="+o+" and transposeB="+l+" must match."});var M,k,B=g.shape.slice(0,-2).concat([E,C]),O=o?g.as3D(A,x,E):g.as3D(A,E,x),V=l?b.as3D(D,C,w):b.as3D(D,w,C);c!=null&&tt(B,(M=It(M=z(c,"bias","fused matMul"),g)[0]).shape),p!=null&&(k=z(p,"prelu weights","fused matMul"));var H={a:O,b:V};c!=null&&(H.bias=M),p!=null&&(H.preluActivationWeights=k);var ee=[O,V];return Q.runKernelFunc(function($,K){var L=$.fusedBatchMatMul({a:O,b:V,transposeA:o,transposeB:l,bias:M,activation:h,preluActivationWeights:k});return K([O,V,L]),L},H,function($,K){var L=K[0],W=K[1],U=K[2],Z=jm($,U,h),P={};return c!=null&&(P={bias:function(){return Hm(M,Z)}}),Object.assign(o||l?!o&&l?{a:function(){return Z.matMul(W,!1,!1)},b:function(){return Z.matMul(L,!0,!1)}}:o&&!l?{a:function(){return W.matMul(Z,!1,!0)},b:function(){return L.matMul(Z,!1,!1)}}:{a:function(){return W.matMul(Z,!0,!0)},b:function(){return Z.matMul(L,!0,!0)}}:{a:function(){return Z.matMul(W,!1,!0)},b:function(){return L.matMul(Z,!0,!1)}},P)},"_FusedMatMul",{transposeA:o,transposeB:l,activation:h},ee,[!0]).reshape(B)}}),C4=X({fusedConv2d_:function(n){var t=n.x,e=n.filter,r=n.strides,a=n.pad,o=n.dataFormat,u=o===void 0?"NHWC":o,l=n.dilations,c=l===void 0?[1,1]:l,f=n.dimRoundingMode,h=n.bias,p=n.activation,m=p===void 0?"linear":p,g=n.preluActivationWeights;if(m=m||"linear",Um(Q.state.gradientDepth,m)===!1){var b=Ar(t,e,r,a,u,c,f);return h!=null&&(b=$e(b,h)),Vm(b,m,g)}var x=z(t,"x","conv2d"),w=z(e,"filter","conv2d"),E=x,C=!1;x.rank===3&&(C=!0,E=x.as4D(1,x.shape[0],x.shape[1],x.shape[2])),j(E.rank===4,function(){return"Error in fused conv2d: input must be rank 4, but got rank "+E.rank+"."}),j(w.rank===4,function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+w.rank+"."}),f!=null&&j(Wt(a),function(){return"Error in fused conv2d: pad must be an integer when using, dimRoundingMode "+f+" but got pad "+a+"."}),j(E.shape[3]===w.shape[2],function(){return"Error in conv2d: depth of input ("+E.shape[3]+") must match input depth for filter "+w.shape[2]+"."}),j(Kn(r,c),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+c+"'"}),j(u==="NHWC",function(){return"Error in conv2d: got dataFormat of "+u+" but only NHWC is currently supported."});var _,R,A=gi(E.shape,w.shape,r,c,a,f);h!=null&&(_=It(_=z(h,"bias","fused conv2d"),x)[0],tt(A.outShape,_.shape)),g!=null&&(R=z(g,"prelu weights","fused conv2d"));var D={x:E,filter:w};h!=null&&(D.bias=_),g!=null&&(D.preluActivationWeights=R);var M=[w,E],k=Q.runKernelFunc(function(B,O){var V=B.fusedConv2d({input:E,filter:w,convInfo:A,bias:_,activation:m,preluActivationWeights:R});return O([w,E,V]),V},D,function(B,O){var V=O,H=V[0],ee=V[1],$=V[2],K=jm(B,$,m);j(Ms(c),function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+c+"'"});var L={};return h!=null&&(L={bias:function(){return Hm(_,K)}}),Object.assign({x:function(){return B2(ee.shape,K,H,r,a)},filter:function(){return Om(ee,K,H.shape,r,a)}},L)},"FusedConv2D",{convInfo:A,activation:m},M,[!0]);return C?k.as3D(k.shape[1],k.shape[2],k.shape[3]):k}}),_4=X({fusedDepthwiseConv2d_:function(n){var t=n.x,e=n.filter,r=n.strides,a=n.pad,o=n.dataFormat,u=o===void 0?"NHWC":o,l=n.dilations,c=l===void 0?[1,1]:l,f=n.dimRoundingMode,h=n.bias,p=n.activation,m=p===void 0?"linear":p,g=n.preluActivationWeights;if(Um(Q.state.gradientDepth,m)===!1){var b=Jf(t,e,r,a,u,c,f);return h!=null&&(b=$e(b,h)),Vm(b,m,g)}var x=z(t,"x","depthwiseConv2d"),w=z(e,"filter","depthwiseConv2d"),E=x,C=!1;x.rank===3&&(C=!0,E=x.as4D(1,x.shape[0],x.shape[1],x.shape[2])),j(E.rank===4,function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got rank "+E.rank+"."}),j(w.rank===4,function(){return"Error in fused depthwiseConv2d: filter must be rank 4, but got rank "+w.rank+"."}),j(E.shape[3]===w.shape[2],function(){return"Error in fused depthwiseConv2d: number of input channels ("+E.shape[3]+") must match the inChannels dimension in filter "+w.shape[2]+"."}),c==null&&(c=[1,1]),j(Kn(r,c),function(){return"Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+c+"'"}),f!=null&&j(Wt(a),function(){return"Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode "+f+" but got pad "+a+"."});var _,R,A=gi(E.shape,w.shape,r,c,a,f,!0);h!=null&&(_=It(_=z(h,"bias","fused conv2d"),x)[0],tt(A.outShape,_.shape)),g!=null&&(R=z(g,"prelu weights","fused depthwiseConv2d"));var D={x:E,filter:w};h!=null&&(D.bias=_),g!=null&&(D.preluActivationWeights=R);var M=[w,E],k=Q.runKernelFunc(function(B,O){var V=B.fusedDepthwiseConv2D({input:E,filter:w,convInfo:A,bias:_,activation:m,preluActivationWeights:R});return O([w,E,V]),V},D,function(B,O){j(Ms(c),function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+c+"'"});var V=O[0],H=O[1],ee=O[2],$=jm(B,ee,m),K={};return h!=null&&(K={bias:function(){return Hm(_,$)}}),Object.assign({x:function(){return F2(H.shape,$,V,A)},filter:function(){return P2(H,$,V.shape,A)}},K)},"FusedDepthwiseConv2D",{convInfo:A,activation:m},M,[!0]);return C?k.as3D(k.shape[1],k.shape[2],k.shape[3]):k}}),R4=Object.freeze({matMul:E4,conv2d:C4,depthwiseConv2d:_4}),A4=Object.freeze({image:zm,linalg:v4,losses:f4,spectral:Q3,fused:R4,signal:t4,square:sk,squaredDifference:b2,conv1d:m3,conv2d:Ar,conv3d:g3,depthwiseConv2d:Jf,separableConv2d:Im,conv2dTranspose:y3,conv3dTranspose:b3,op:X,batchNormalization2d:Pk,batchNormalization3d:Lk,batchNormalization4d:zk,batchNormalization:Uk,batchNorm:_2,batchNorm2d:jk,batchNorm3d:Hk,batchNorm4d:Vk,booleanMaskAsync:v3,complex:wn,real:_r,imag:ea,concat:nn,concat1d:RT,concat2d:AT,concat3d:TT,concat4d:NT,split:xm,matMul:ed,dot:x3,outerProduct:w3,reverse:gl,reverse1d:S3,reverse2d:E3,reverse3d:C3,reverse4d:_3,maxPool:hn,avgPool:yl,pool:R3,maxPool3d:A3,avgPool3d:T3,slice:ua,slice1d:N3,slice2d:D3,slice3d:U2,slice4d:k3,abs:uk,acos:lk,acosh:ck,asin:fk,asinh:dk,atan:hk,atanh:pk,ceil:vk,clipByValue:Dm,cos:mk,cosh:gk,erf:yk,exp:zv,expm1:bk,floor:xk,log:wk,log1p:Sk,logSigmoid:Ek,neg:Mf,reciprocal:Ck,round:_k,rsqrt:x2,sigmoid:w2,sign:Rk,isNaN:Ak,isInf:Tk,isFinite:Nk,sin:Dk,sinh:kk,softplus:Mk,sqrt:Ok,step:Ik,tan:Bk,tanh:Fk,all:M3,any:O3,argMax:I3,argMin:B3,logSumExp:F3,max:td,mean:P3,min:L3,moments:z3,sum:H2,prod:U3,equal:D2,equalStrict:o3,greater:i3,greaterEqual:k2,greaterEqualStrict:s3,greaterStrict:u3,less:l3,lessEqual:c3,lessEqualStrict:f3,lessStrict:d3,notEqual:h3,notEqualStrict:p3,add:$e,addN:qk,addStrict:Xk,atan2:Yk,div:Fr,divNoNan:Kk,divStrict:Qk,floorDiv:T2,maximum:km,maximumStrict:$k,minimum:N2,minimumStrict:Zk,mod:Jk,modStrict:e3,mul:Mn,mulStrict:t3,pow:Of,powStrict:n3,squaredDifferenceStrict:r3,sub:on,subStrict:a3,elu:V2,leakyRelu:j3,prelu:W2,relu:Ot,relu6:G2,selu:H3,logicalAnd:Zf,logicalNot:Wk,logicalOr:R2,logicalXor:Gk,where:fi,whereAsync:A2,buffer:We,print:LT,batchToSpaceND:Hw,broadcastTo:zT,cast:UT,clone:jT,cumsum:HT,depthToSpace:VT,expandDims:Cr,eye:Vw,multinomial:WT,oneHot:Bv,pad:mi,pad1d:GT,pad2d:qT,pad3d:XT,pad4d:YT,rand:KT,randomNormal:QT,randomGamma:$T,randomUniform:Ww,reshape:Pr,spaceToBatchND:Gw,squeeze:qw,stack:cr,tile:ws,truncatedNormal:ZT,unstack:rn,setdiff1dAsync:JT,fill:ia,linspace:_T,ones:Ps,range:Cf,scalar:Se,tensor:En,tensor1d:Yt,tensor2d:Eo,tensor3d:bm,tensor4d:Gn,tensor5d:ST,tensor6d:ET,variable:CT,zeros:_t,onesLike:jw,zerosLike:ot,transpose:Ao,softmax:Ua,logSoftmax:iN,localResponseNormalization:V3,norm:q2,gather:Mm,unsortedSegmentSum:M2,basicLSTMCell:W3,multiRNNCell:G3,movingAverage:q3,stridedSlice:X3,topk:Y3,scatterND:K3,fft:Bm,ifft:If,rfft:Fm,irfft:X2,sparseToDense:$3,gatherND:Z3,diag:J3,dropout:e4,hannWindow:Pm,hammingWindow:K2,frame:Lm,stft:Q2,inTopKAsync:n4});function ge(n,t){Array.isArray(n)||(n=[n]),n.forEach(function(e){e!=null&&j(e.dtype!=="complex64",function(){return t+" does not support complex64 tensors."})})}function Jp(n,t,e,r){if(e==="linear")return n.linear(t);if(e==="relu")return n.relu(t);if(e==="elu")return n.elu(t);if(e==="relu6")return n.relu6(t);if(e==="prelu")return n.prelu(t,r);throw new Error("Activation "+e+" has not been implemented for the CPU backend.")}var T4=function(n){function t(){var e=n.call(this)||this;return e.blockSize=48,e.firstUse=!0,e.data=new Jw(e,Q),e}return jr(t,n),t.prototype.write=function(e,r,a){this.firstUse&&(this.firstUse=!1,fe().get("IS_NODE")&&Sf(`
============================
Hi there . Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.
============================`));var o={};return this.data.set(o,{values:e,dtype:a}),o},t.prototype.move=function(e,r,a,o){this.data.set(e,{values:r,dtype:o})},t.prototype.numDataIds=function(){return this.data.numDataIds()},t.prototype.read=function(e){return Te(this,void 0,void 0,function(){return Ne(this,function(r){return[2,this.readSync(e)]})})},t.prototype.readSync=function(e){var r=this.data.get(e),a=r.dtype,o=r.complexTensors;return a==="complex64"?Lv(this.readSync(o.real.dataId),this.readSync(o.imag.dataId)):this.data.get(e).values},t.prototype.bufferSync=function(e){var r=this.readSync(e.dataId),a=r;if(e.dtype==="string")try{a=r.map(function(o){return bf(o)})}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return We(e.shape,e.dtype,a)},t.prototype.makeOutput=function(e,r,a){var o=this.write(e,r,a);return Q.makeTensorFromDataId(o,r,a,this)},t.prototype.disposeData=function(e){if(this.data.has(e)){var r=this.data.get(e).complexTensors;r!=null&&(r.real.dispose(),r.imag.dispose()),this.data.delete(e)}},t.prototype.time=function(e){return Te(this,void 0,void 0,function(){var r;return Ne(this,function(a){return r=Zr(),e(),[2,{kernelMs:Zr()-r}]})})},t.prototype.memory=function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}},t.prototype.complex=function(e,r){var a=this.makeOutput(null,e.shape,"complex64");return this.data.get(a.dataId).complexTensors={real:Q.keep(e.clone()),imag:Q.keep(r.clone())},a},t.prototype.real=function(e){return this.data.get(e.dataId).complexTensors.real.clone()},t.prototype.imag=function(e){return this.data.get(e.dataId).complexTensors.imag.clone()},t.prototype.slice=function(e,r,a){if(ge(e,"slice"),$w(e.shape,r,a)){var o=Zw(r,e.strides),u=ke(a);return En(this.readSync(e.dataId).subarray(o,o+u),a,e.dtype)}for(var l=We(a,e.dtype),c=this.bufferSync(e),f=0;f<l.size;++f){var h=l.indexToLoc(f).map(function(p,m){return p+r[m]});l.values[f]=c.get.apply(c,h)}return l.toTensor()},t.prototype.stridedSlice=function(e,r,a,o){ge(e,"stridedSlice");var u=Sm(r,a,o);if(u.some(function(g){return g===0}))return En([],u);for(var l=We(u,e.dtype),c=this.bufferSync(e),f=0;f<l.size;f++){for(var h=l.indexToLoc(f),p=new Array(h.length),m=0;m<p.length;m++)p[m]=h[m]*o[m]+r[m];l.set.apply(l,[c.get.apply(c,p)].concat(h))}return l.toTensor()},t.prototype.diag=function(e){for(var r=this.readSync(e.dataId),a=We([e.size,e.size],e.dtype),o=a.values,u=0;u<r.length;u++)o[u*e.size+u]=r[u];return a.toTensor()},t.prototype.unstack=function(e,r){for(var a=e.shape[r],o=new Array(e.rank-1),u=0,l=0;l<e.rank;l++)l!==r&&(o[u++]=e.shape[l]);var c=new Array(e.rank).fill(0),f=e.shape.slice();f[r]=1;var h=new Array(a);for(l=0;l<h.length;l++)c[r]=l,h[l]=this.slice(e,c,f).reshape(o);return h},t.prototype.reverse=function(e,r){ge(e,"reverse");for(var a=We(e.shape,e.dtype),o=this.bufferSync(e),u=function(c){var f=a.indexToLoc(c),h=f.slice();r.forEach(function(p){return h[p]=e.shape[p]-1-h[p]}),a.set.apply(a,[o.get.apply(o,h)].concat(f))},l=0;l<a.size;l++)u(l);return a.toTensor()},t.prototype.concat=function(e,r){var a=this;if(e[0].dtype==="complex64"){var o=e.map(function(g){return _r(g)}),u=e.map(function(g){return ea(g)});return wn(this.concat(o,r),this.concat(u,r))}var l=e.map(function(g){var b=ke(g.shape.slice(r));return g.as2D(-1,b)}),c=ks(l.map(function(g){return g.shape}),1),f=We(c,e[0].dtype).values;if(l[0].shape[0]===1){var h=0;l.forEach(function(g){f.set(a.readSync(g.dataId),h),h+=g.size})}else{var p=0;l.forEach(function(g){for(var b=a.readSync(g.dataId),x=0,w=0;w<g.shape[0];++w)for(var E=w*c[1]+p,C=0;C<g.shape[1];++C)f[E+C]=b[x++];p+=g.shape[1]})}var m=ks(e.map(function(g){return g.shape}),r);return En(f,m,e[0].dtype)},t.prototype.neg=function(e){return ge(e,"neg"),this.multiply(Se(-1),e)},t.prototype.add=function(e,r){return e.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(e.cast("complex64"),r.cast("complex64"),function(a,o,u,l){return{real:a+u,imag:o+l}}):this.broadcastedBinaryOp(e,r,Sn(e.dtype,r.dtype),function(a,o){return a+o})},t.prototype.addN=function(e){var r=this;ge(e,"addN");for(var a=e.map(function(h){return r.readSync(h.dataId)}),o=We(e[0].shape,e[0].dtype),u=o.values,l=0;l<e.length;l++)for(var c=a[l],f=0;f<u.length;f++)u[f]+=c[f];return o.toTensor()},t.prototype.softmax=function(e,r){var a=sn([r],e.shape),o=this.max(e,a),u=Yn(o.shape,a),l=this.subtract(e,o.reshape(u)),c=this.exp(l),f=this.sum(c,a).reshape(u);return this.realDivide(c,f)},t.prototype.subtract=function(e,r){return e.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(e.cast("complex64"),r.cast("complex64"),function(a,o,u,l){return{real:a-u,imag:o-l}}):this.broadcastedBinaryOp(e,r,Sn(e.dtype,r.dtype),function(a,o){return a-o})},t.prototype.pow=function(e,r){return ge([e,r],"pow"),this.broadcastedBinaryOp(e,r,e.dtype,function(a,o){return Math.pow(a,o)})},t.prototype.batchMatMul=function(e,r,a,o){ge([e,r],"matMul");for(var u=a?e.shape[1]:e.shape[2],l=a?e.shape[2]:e.shape[1],c=o?r.shape[1]:r.shape[2],f=e.shape[0],h=this.readSync(e.dataId),p=this.readSync(r.dataId),m=a?[e.strides[0],1,e.strides[1]]:[e.strides[0],e.strides[1],1],g=m[0],b=m[1],x=m[2],w=o?[1,r.strides[1],r.strides[0]]:[r.strides[1],1,r.strides[0]],E=w[0],C=w[1],_=w[2],R=l*c,A=We([f,l,c],e.dtype),D=A.values,M=this.blockSize,k=0;k<f;k++)for(var B=0;B<l;B+=M)for(var O=0;O<c;O+=M)for(var V=0;V<u;V+=M)for(var H=Math.min(B+M,l),ee=Math.min(O+M,c),$=Math.min(V+M,u),K=B;K<H;K++)for(var L=O;L<ee;L++){for(var W=0,U=V;U<$;U++)W+=h[k*g+K*b+U*x]*p[U*E+L*C+k*_];D[k*R+(K*c+L)]+=W}return A.toTensor()},t.prototype.fusedBatchMatMul=function(e){var r=e.a,a=e.b,o=e.transposeA,u=e.transposeB,l=e.bias,c=e.activation,f=e.preluActivationWeights,h=this.batchMatMul(r,a,o,u);return l&&(h=this.add(h,l)),c&&(h=Jp(this,h,c,f)),h},t.prototype.multiply=function(e,r){return e.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(e.cast("complex64"),r.cast("complex64"),function(a,o,u,l){return{real:a*u-o*l,imag:a*l+o*u}}):this.broadcastedBinaryOp(e,r,Sn(e.dtype,r.dtype),function(a,o){return a*o})},t.prototype.realDivide=function(e,r){return ge([e,r],"realDivide"),this.broadcastedBinaryOp(e,r,"float32",function(a,o){return a/o})},t.prototype.floorDiv=function(e,r){return ge([e,r],"floorDiv"),this.broadcastedBinaryOp(e,r,"int32",function(a,o){return Math.floor(a/o)})},t.prototype.sum=function(e,r){ge(e,"sum"),ar("sum",r,e.rank);for(var a=Tn(e.shape,r),o=a[0],u=a[1],l=_t(o,Sn(e.dtype,"int32")),c=ke(u),f=this.readSync(l.dataId),h=this.readSync(e.dataId),p=0;p<f.length;++p){for(var m=p*c,g=0,b=0;b<c;++b)g+=h[m+b];f[p]=g}return l},t.prototype.prod=function(e,r){ge(e,"sum");for(var a=Tn(e.shape,r),o=a[0],u=a[1],l=_t(o,Sn(e.dtype,"int32")),c=ke(u),f=this.readSync(l.dataId),h=this.readSync(e.dataId),p=0;p<f.length;++p){for(var m=p*c,g=1,b=0;b<c;++b)g*=h[m+b];f[p]=g}return l},t.prototype.unsortedSegmentSum=function(e,r,a){ge(e,"unsortedSegmentSum");for(var o=[],u=e.rank-r.rank,l=0;l<u;++l)r=r.expandDims(l+1);for(l=0;l<a;++l){var c=Se(l,"int32"),f=D2(c,r).asType("float32").mul(e).sum(0);o.push(f)}return cr(o)},t.prototype.argMin=function(e,r){ge(e,"argMin");var a=[r];ar("argMin",a,e.rank);for(var o=Tn(e.shape,a),u=o[0],l=o[1],c=_t(u,"int32"),f=ke(l),h=this.readSync(c.dataId),p=this.readSync(e.dataId),m=0;m<h.length;++m){for(var g=m*f,b=p[g],x=0,w=0;w<f;++w){var E=p[g+w];E<b&&(b=E,x=w)}h[m]=x}return c},t.prototype.argMax=function(e,r){ge(e,"argMax");var a=[r];ar("argMax",a,e.rank);for(var o=Tn(e.shape,a),u=o[0],l=o[1],c=_t(u,"int32"),f=ke(l),h=this.readSync(c.dataId),p=this.readSync(e.dataId),m=0;m<h.length;++m){for(var g=m*f,b=p[g],x=0,w=0;w<f;++w){var E=p[g+w];E>b&&(b=E,x=w)}h[m]=x}return c},t.prototype.cumsum=function(e,r,a,o){if(ge(e,"cumsum"),r!==e.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis="+(e.rank-1)+" but got axis="+r);for(var u=Sn(e.dtype,"int32"),l=_t(e.shape,u),c=this.readSync(l.dataId),f=this.readSync(e.dataId),h=e.shape[e.rank-1],p=o?function(w,E){return w+h-E-1}:function(w,E){return w+E},m=0;m<f.length;m+=h)for(var g=0;g<h;g++){var b=p(m,g);if(g===0)c[b]=a?0:f[b];else{var x=p(m,g-1);c[b]=a?f[x]+c[x]:f[b]+c[x]}}return l},t.prototype.equal=function(e,r){return ge([e,r],"equal"),this.broadcastedBinaryOp(e,r,"bool",function(a,o){return a===o?1:0})},t.prototype.notEqual=function(e,r){return ge([e,r],"notEqual"),this.broadcastedBinaryOp(e,r,"bool",function(a,o){return a!==o?1:0})},t.prototype.less=function(e,r){return ge([e,r],"less"),this.broadcastedBinaryOp(e,r,"bool",function(a,o){return a<o?1:0})},t.prototype.lessEqual=function(e,r){return ge([e,r],"lessEqual"),this.broadcastedBinaryOp(e,r,"bool",function(a,o){return a<=o?1:0})},t.prototype.greater=function(e,r){return ge([e,r],"greater"),this.broadcastedBinaryOp(e,r,"bool",function(a,o){return a>o?1:0})},t.prototype.greaterEqual=function(e,r){return ge([e,r],"greaterEqual"),this.broadcastedBinaryOp(e,r,"bool",function(a,o){return a>=o?1:0})},t.prototype.logicalNot=function(e){ge(e,"logicalNot");for(var r=this.readSync(e.dataId),a=new Uint8Array(r.length),o=0;o<r.length;++o)a[o]=r[o]?0:1;return this.makeOutput(a,e.shape,"bool")},t.prototype.logicalAnd=function(e,r){return ge([e,r],"logicalAnd"),this.broadcastedBinaryOp(e,r,"bool",function(a,o){return a&&o})},t.prototype.logicalOr=function(e,r){return ge([e,r],"logicalOr"),this.broadcastedBinaryOp(e,r,"bool",function(a,o){return a||o})},t.prototype.select=function(e,r,a){ge([e,r,a],"select");for(var o=this.readSync(e.dataId),u=this.readSync(r.dataId),l=this.readSync(a.dataId),c=_t(r.shape,Sn(r.dtype,a.dtype)),f=this.readSync(c.dataId),h=0,p=e.rank===0||e.rank>1||r.rank===1?1:ke(r.shape.slice(1)),m=0;m<o.length;m++)for(var g=0;g<p;g++)o[m]===1?f[h++]=u[m]:f[h++]=l[m];return c},t.prototype.where=function(e){ge([e],"where");var r=this.readSync(e.dataId);return Rm(e.shape,r)},t.prototype.topk=function(e,r,a){return ge(e,"topk"),s2(this.readSync(e.dataId),e.shape,e.dtype,r)},t.prototype.min=function(e,r){ge(e,"min"),ar("min",r,e.rank);for(var a=Tn(e.shape,r),o=a[0],u=a[1],l=_t(o,e.dtype),c=ke(u),f=this.readSync(l.dataId),h=this.readSync(e.dataId),p=0;p<f.length;++p){for(var m=p*c,g=h[m],b=0;b<c;++b){var x=h[m+b];x<g&&(g=x)}f[p]=g}return l},t.prototype.minimum=function(e,r){return ge([e,r],"minimum"),this.broadcastedBinaryOp(e,r,e.dtype,function(a,o){return Math.min(a,o)})},t.prototype.mod=function(e,r){return ge([e,r],"mod"),this.broadcastedBinaryOp(e,r,e.dtype,function(a,o){var u=a%o;return a<0&&o<0||a>=0&&o>=0?u:(u+o)%o})},t.prototype.max=function(e,r){ge(e,"max"),ar("max",r,e.rank);for(var a=Tn(e.shape,r),o=a[0],u=a[1],l=_t(o,e.dtype),c=ke(u),f=this.readSync(l.dataId),h=this.readSync(e.dataId),p=0;p<f.length;++p){for(var m=p*c,g=h[m],b=0;b<c;++b){var x=h[m+b];x>g&&(g=x)}f[p]=g}return l},t.prototype.maximum=function(e,r){return ge([e,r],"maximum"),this.broadcastedBinaryOp(e,r,e.dtype,function(a,o){return Math.max(a,o)})},t.prototype.all=function(e,r){ge(e,"all"),ar("all",r,e.rank);for(var a=Tn(e.shape,r),o=a[0],u=a[1],l=_t(o,e.dtype),c=ke(u),f=this.readSync(l.dataId),h=this.readSync(e.dataId),p=0;p<f.length;++p){for(var m=p*c,g=h[m],b=0;b<c;++b){var x=h[m+b];g=g&&x}f[p]=g}return l},t.prototype.any=function(e,r){ge(e,"any"),ar("any",r,e.rank);for(var a=Tn(e.shape,r),o=a[0],u=a[1],l=_t(o,e.dtype),c=ke(u),f=this.readSync(l.dataId),h=this.readSync(e.dataId),p=0;p<f.length;++p){for(var m=p*c,g=h[m],b=0;b<c;++b){var x=h[m+b];g=g||x}f[p]=g}return l},t.prototype.squaredDifference=function(e,r){return ge([e,r],"squaredDifference"),this.broadcastedBinaryOp(e,r,e.dtype,function(a,o){var u=a-o;return u*u})},t.prototype.ceil=function(e){ge(e,"ceil");for(var r=this.readSync(e.dataId),a=new Float32Array(r.length),o=0;o<r.length;++o)a[o]=Math.ceil(r[o]);return this.makeOutput(a,e.shape,"float32")},t.prototype.floor=function(e){ge(e,"floor");for(var r=this.readSync(e.dataId),a=new Float32Array(r.length),o=0;o<r.length;++o)a[o]=Math.floor(r[o]);return this.makeOutput(a,e.shape,"float32")},t.prototype.sign=function(e){ge(e,"x");for(var r=this.readSync(e.dataId),a=new Float32Array(r.length),o=0;o<r.length;++o)r[o]<0?a[o]=-1:r[o]>0?a[o]=1:a[o]=0;return this.makeOutput(a,e.shape,"float32")},t.prototype.isNaN=function(e){ge(e,"x");for(var r=this.readSync(e.dataId),a=new Uint8Array(r.length),o=0;o<r.length;++o)Number.isNaN(r[o])&&(a[o]=1);return this.makeOutput(a,e.shape,"bool")},t.prototype.isInf=function(e){ge(e,"x");for(var r=this.readSync(e.dataId),a=new Uint8Array(r.length),o=0;o<r.length;++o)Math.abs(r[o])===1/0&&(a[o]=1);return this.makeOutput(a,e.shape,"bool")},t.prototype.isFinite=function(e){ge(e,"x");for(var r=this.readSync(e.dataId),a=new Uint8Array(r.length),o=0;o<r.length;++o)Number.isFinite(r[o])&&(a[o]=1);return this.makeOutput(a,e.shape,"bool")},t.prototype.round=function(e){ge(e,"round");for(var r=this.readSync(e.dataId),a=new Float32Array(r.length),o=0;o<r.length;++o){var u=Math.floor(r[o]);r[o]-u<.5?a[o]=Math.floor(r[o]):r[o]-u>.5?a[o]=Math.ceil(r[o]):a[o]=u%2==0?u:u+1}return this.makeOutput(a,e.shape,"float32")},t.prototype.exp=function(e){ge(e,"exp");for(var r=this.readSync(e.dataId),a=new Float32Array(r.length),o=0;o<r.length;++o)a[o]=Math.exp(r[o]);return this.makeOutput(a,e.shape,"float32")},t.prototype.expm1=function(e){ge(e,"expm1");for(var r=this.readSync(e.dataId),a=new Float32Array(r.length),o=0;o<r.length;++o)a[o]=Math.expm1(r[o]);return this.makeOutput(a,e.shape,"float32")},t.prototype.log=function(e){ge(e,"log");for(var r=this.readSync(e.dataId),a=new Float32Array(r.length),o=0;o<r.length;++o){var u=r[o];a[o]=Math.log(u)}return this.makeOutput(a,e.shape,"float32")},t.prototype.log1p=function(e){ge(e,"log1p");for(var r=this.readSync(e.dataId),a=new Float32Array(r.length),o=0;o<r.length;++o){var u=r[o];a[o]=Math.log1p(u)}return this.makeOutput(a,e.shape,"float32")},t.prototype.sqrt=function(e){ge(e,"sqrt");for(var r=this.readSync(e.dataId),a=new Float32Array(r.length),o=0;o<r.length;++o){var u=r[o];a[o]=Math.sqrt(u)}return this.makeOutput(a,e.shape,"float32")},t.prototype.rsqrt=function(e){ge(e,"rsqrt");for(var r=this.readSync(e.dataId),a=new Float32Array(r.length),o=0;o<r.length;++o){var u=r[o];a[o]=1/Math.sqrt(u)}return this.makeOutput(a,e.shape,"float32")},t.prototype.reciprocal=function(e){ge(e,"reciprocal");for(var r=this.readSync(e.dataId),a=new Float32Array(r.length),o=0;o<r.length;++o)a[o]=1/r[o];return this.makeOutput(a,e.shape,"float32")},t.prototype.linear=function(e){return e},t.prototype.relu=function(e){ge(e,"relu");for(var r=_t(e.shape,e.dtype),a=this.readSync(r.dataId),o=this.readSync(e.dataId),u=0;u<o.length;++u)a[u]=Math.max(0,o[u]);return r},t.prototype.relu6=function(e){ge(e,"relu");for(var r=_t(e.shape,e.dtype),a=this.readSync(r.dataId),o=this.readSync(e.dataId),u=0;u<o.length;++u)a[u]=Math.min(Math.max(0,o[u]),6);return r},t.prototype.prelu=function(e,r){return ge([e,r],"prelu"),this.broadcastedBinaryOp(e,r,e.dtype,function(a,o){return a<0?o*a:a})},t.prototype.elu=function(e){ge(e,"elu");for(var r=new Float32Array(e.size),a=this.readSync(e.dataId),o=0;o<a.length;++o){var u=a[o];r[o]=u>=0?u:Math.exp(u)-1}return this.makeOutput(r,e.shape,"float32")},t.prototype.eluDer=function(e,r){ge([e,r],"eluDer");for(var a=new Float32Array(r.size),o=this.readSync(r.dataId),u=this.readSync(e.dataId),l=0;l<o.length;++l){var c=o[l];a[l]=c>=1?u[l]:u[l]*(c+1)}return this.makeOutput(a,r.shape,"float32")},t.prototype.selu=function(e){ge(e,"selu");for(var r=Tm,a=Nm,o=new Float32Array(e.size),u=this.readSync(e.dataId),l=0;l<u.length;++l){var c=u[l];o[l]=c>=0?a*c:r*(Math.exp(c)-1)}return this.makeOutput(o,e.shape,"float32")},t.prototype.clip=function(e,r,a){ge(e,"clip");for(var o=new Float32Array(e.size),u=this.readSync(e.dataId),l=0;l<u.length;++l){var c=u[l];o[l]=c>a?a:c<r?r:c}return this.makeOutput(o,e.shape,"float32")},t.prototype.abs=function(e){for(var r=new Float32Array(e.size),a=this.readSync(e.dataId),o=0;o<a.length;++o)r[o]=Math.abs(a[o]);return this.makeOutput(r,e.shape,"float32")},t.prototype.complexAbs=function(e){for(var r=new Float32Array(e.size),a=this.readSync(e.dataId),o=0;o<e.size;++o){var u=a[2*o],l=a[2*o+1];r[o]=Math.hypot(u,l)}return this.makeOutput(r,e.shape,"float32")},t.prototype.int=function(e){ge(e,"int");for(var r=new Int32Array(e.size),a=this.readSync(e.dataId),o=0;o<a.length;++o)r[o]=a[o];return this.makeOutput(r,e.shape,"int32")},t.prototype.sigmoid=function(e){ge(e,"sigmoid");for(var r=new Float32Array(e.size),a=this.readSync(e.dataId),o=0;o<a.length;++o)r[o]=1/(1+Math.exp(-a[o]));return this.makeOutput(r,e.shape,"float32")},t.prototype.softplus=function(e){ge(e,"softplus");for(var r=Math.log(11920928955078125e-23)+2,a=new Float32Array(e.size),o=this.readSync(e.dataId),u=0;u<o.length;++u){var l=o[u]>-r,c=o[u]<r,f=Math.exp(o[u]),h=void 0;h=c?f:l?o[u]:Math.log(1+f),a[u]=h}return this.makeOutput(a,e.shape,"float32")},t.prototype.sin=function(e){ge(e,"sin");for(var r=new Float32Array(e.size),a=this.readSync(e.dataId),o=0;o<a.length;++o)r[o]=Math.sin(a[o]);return this.makeOutput(r,e.shape,"float32")},t.prototype.cos=function(e){ge(e,"cos");for(var r=new Float32Array(e.size),a=this.readSync(e.dataId),o=0;o<a.length;++o)r[o]=Math.cos(a[o]);return this.makeOutput(r,e.shape,"float32")},t.prototype.tan=function(e){ge(e,"tan");for(var r=new Float32Array(e.size),a=this.readSync(e.dataId),o=0;o<a.length;++o)r[o]=Math.tan(a[o]);return this.makeOutput(r,e.shape,"float32")},t.prototype.asin=function(e){ge(e,"asin");for(var r=new Float32Array(e.size),a=this.readSync(e.dataId),o=0;o<a.length;++o)r[o]=Math.asin(a[o]);return this.makeOutput(r,e.shape,"float32")},t.prototype.acos=function(e){ge(e,"acos");for(var r=new Float32Array(e.size),a=this.readSync(e.dataId),o=0;o<a.length;++o)r[o]=Math.acos(a[o]);return this.makeOutput(r,e.shape,"float32")},t.prototype.atan=function(e){ge(e,"atan");for(var r=new Float32Array(e.size),a=this.readSync(e.dataId),o=0;o<a.length;++o)r[o]=Math.atan(a[o]);return this.makeOutput(r,e.shape,"float32")},t.prototype.atan2=function(e,r){return ge([e,r],"atan2"),this.broadcastedBinaryOp(e,r,e.dtype,function(a,o){return Math.atan2(a,o)})},t.prototype.sinh=function(e){ge(e,"sinh");for(var r=new Float32Array(e.size),a=this.readSync(e.dataId),o=0;o<a.length;++o)r[o]=Math.sinh(a[o]);return this.makeOutput(r,e.shape,"float32")},t.prototype.cosh=function(e){ge(e,"cosh");for(var r=new Float32Array(e.size),a=this.readSync(e.dataId),o=0;o<a.length;++o)r[o]=Math.cosh(a[o]);return this.makeOutput(r,e.shape,"float32")},t.prototype.tanh=function(e){ge(e,"tanh");for(var r=new Float32Array(e.size),a=this.readSync(e.dataId),o=0;o<a.length;++o)r[o]=NA(a[o]);return this.makeOutput(r,e.shape,"float32")},t.prototype.asinh=function(e){ge(e,"asinh");for(var r=new Float32Array(e.size),a=this.readSync(e.dataId),o=0;o<a.length;++o)r[o]=Math.asinh(a[o]);return this.makeOutput(r,e.shape,"float32")},t.prototype.acosh=function(e){ge(e,"acosh");for(var r=new Float32Array(e.size),a=this.readSync(e.dataId),o=0;o<a.length;++o)r[o]=Math.acosh(a[o]);return this.makeOutput(r,e.shape,"float32")},t.prototype.atanh=function(e){ge(e,"atanh");for(var r=new Float32Array(e.size),a=this.readSync(e.dataId),o=0;o<a.length;++o)r[o]=Math.atanh(a[o]);return this.makeOutput(r,e.shape,"float32")},t.prototype.erf=function(e){ge(e,"erf");for(var r=new Float32Array(e.size),a=this.readSync(e.dataId),o=0;o<a.length;++o){var u=Math.sign(a[o]),l=Math.abs(a[o]),c=1/(1+.3275911*l);r[o]=u*(1-((((1.061405429*c-1.453152027)*c+1.421413741)*c-.284496736)*c+.254829592)*c*Math.exp(-l*l))}return this.makeOutput(r,e.shape,"float32")},t.prototype.step=function(e,r){r===void 0&&(r=0),ge(e,"step");for(var a=new Float32Array(e.size),o=this.readSync(e.dataId),u=0;u<o.length;++u){var l=o[u];isNaN(l)?a[u]=NaN:a[u]=l>0?1:r}return this.makeOutput(a,e.shape,"float32")},t.prototype.fusedConv2d=function(e){var r=e.input,a=e.filter,o=e.convInfo,u=e.bias,l=e.activation,c=e.preluActivationWeights,f=this.conv2d(r,a,o);return u&&(f=this.add(f,u)),l&&(f=Jp(this,f,l,c)),f},t.prototype.conv2d=function(e,r,a){ge([e,r],"conv2d");for(var o=a.filterHeight,u=a.filterWidth,l=a.dilationHeight,c=a.dilationWidth,f=a.padInfo.left,h=a.padInfo.top,p=a.dataFormat==="channelsLast",m=We(a.outShape,e.dtype),g=e.strides[0],b=p?e.strides[1]:e.strides[2],x=p?e.strides[2]:1,w=p?1:e.strides[1],E=m.strides[0],C=p?m.strides[1]:m.strides[2],_=p?m.strides[2]:1,R=p?1:m.strides[1],A=this.readSync(e.dataId),D=this.readSync(r.dataId),M=m.values,k=0;k<a.batchSize;++k)for(var B=k*g,O=k*E,V=0;V<a.outHeight;++V)for(var H=O+V*C,ee=V*a.strideHeight-h,$=0;$<o;$++){var K=ee+$*l;if(!(K<0||K>=a.inHeight))for(var L=$*r.strides[0],W=B+K*b,U=0;U<a.outWidth;++U)for(var Z=H+U*_,P=U*a.strideWidth-f,q=0;q<u;q++){var ne=P+q*c;if(!(ne<0||ne>=a.inWidth))for(var J=W+ne*x,le=L+q*r.strides[1],ye=0;ye<a.inChannels;++ye){for(var pe=A[J+ye*w],de=0;de<a.outChannels;++de)M[Z+de*R]+=pe*D[le+de];le+=a.outChannels}}}return m.toTensor()},t.prototype.conv3d=function(e,r,a){for(var o=a.filterDepth,u=a.filterHeight,l=a.filterWidth,c=a.dilationDepth,f=a.dilationHeight,h=a.dilationWidth,p=a.padInfo.front,m=a.padInfo.left,g=a.padInfo.top,b=We(a.outShape,e.dtype),x=this.readSync(e.dataId),w=this.readSync(r.dataId),E=b.values,C=0;C<a.batchSize;++C)for(var _=C*e.strides[0],R=C*b.strides[0],A=0;A<a.outDepth;++A)for(var D=R+A*b.strides[1],M=A*a.strideDepth-p,k=0;k<o;k++){var B=M+k*c;if(!(B<0||B>=a.inDepth))for(var O=k*r.strides[0],V=_+B*e.strides[1],H=0;H<a.outHeight;++H)for(var ee=D+H*b.strides[2],$=H*a.strideHeight-g,K=0;K<u;K++){var L=$+K*f;if(!(L<0||L>=a.inHeight))for(var W=O+K*r.strides[1],U=V+L*e.strides[2],Z=0;Z<a.outWidth;++Z)for(var P=ee+Z*a.outChannels,q=Z*a.strideWidth-m,ne=0;ne<l;ne++){var J=q+ne*h;if(!(J<0||J>=a.inWidth))for(var le=W+ne*r.strides[2],ye=U+J*a.inChannels,pe=le,de=0;de<a.inChannels;++de){for(var ce=x[ye+de],xe=0;xe<a.outChannels;++xe)E[P+xe]+=ce*w[pe+xe];pe+=a.outChannels}}}}return b.toTensor()},t.prototype.conv2dDerInput=function(e,r,a){ge([e,r],"conv2dDerInput");for(var o=We(a.inShape,"float32"),u=o.values,l=this.readSync(e.dataId),c=this.readSync(r.dataId),f=r.strides,h=f[0],p=f[1],m=f[2],g=a.batchSize,b=a.filterHeight,x=a.filterWidth,w=a.inChannels,E=a.inHeight,C=a.inWidth,_=a.outChannels,R=a.outHeight,A=a.outWidth,D=a.strideHeight,M=a.strideWidth,k=a.dataFormat,B=b-1-a.padInfo.top,O=x-1-a.padInfo.left,V=k==="channelsLast",H=o.strides[0],ee=V?o.strides[1]:o.strides[2],$=V?o.strides[2]:1,K=V?1:o.strides[1],L=e.strides[0],W=V?e.strides[1]:e.strides[2],U=V?e.strides[2]:1,Z=V?1:e.strides[1],P=0;P<g;++P)for(var q=0;q<w;++q)for(var ne=0;ne<E;++ne)for(var J=ne-B,le=Math.max(0,Math.ceil(J/D)),ye=Math.min(R,(b+J)/D),pe=0;pe<C;++pe){for(var de=pe-O,ce=Math.max(0,Math.ceil(de/M)),xe=Math.min(A,(x+de)/M),we=0,Ee=le;Ee<ye;++Ee)for(var De=Ee*D-J,Fe=ce;Fe<xe;++Fe)for(var Xe=L*P+W*Ee+U*Fe,it=h*(b-1-De)+p*(x-1-(Fe*M-de))+m*q,rt=0;rt<_;++rt)we+=l[Xe+Z*rt]*c[it+rt];u[H*P+ee*ne+$*pe+K*q]=we}return o.toTensor()},t.prototype.conv3dDerInput=function(e,r,a){for(var o=We(a.inShape,"float32"),u=o.values,l=o.strides,c=l[0],f=l[1],h=l[2],p=l[3],m=this.readSync(e.dataId),g=e.strides,b=g[0],x=g[1],w=g[2],E=g[3],C=this.readSync(r.dataId),_=r.strides,R=_[0],A=_[1],D=_[2],M=_[3],k=a.batchSize,B=a.filterDepth,O=a.filterHeight,V=a.filterWidth,H=a.inChannels,ee=a.inDepth,$=a.inHeight,K=a.inWidth,L=a.outChannels,W=a.outDepth,U=a.outHeight,Z=a.outWidth,P=a.strideDepth,q=a.strideHeight,ne=a.strideWidth,J=B-1-a.padInfo.front,le=O-1-a.padInfo.top,ye=V-1-a.padInfo.left,pe=0;pe<k;++pe)for(var de=0;de<H;++de)for(var ce=0;ce<ee;++ce)for(var xe=ce-J,we=Math.max(0,Math.ceil(xe/P)),Ee=Math.min(W,(B+xe)/P),De=0;De<$;++De)for(var Fe=De-le,Xe=Math.max(0,Math.ceil(Fe/q)),it=Math.min(U,(O+Fe)/q),rt=0;rt<K;++rt){for(var st=rt-ye,mn=Math.max(0,Math.ceil(st/ne)),pt=Math.min(Z,(V+st)/ne),Qn=0,Qt=we;Qt<Ee;++Qt)for(var xt=Qt*P-xe,Lt=Xe;Lt<it;++Lt)for(var hr=Lt*q-Fe,Bn=mn;Bn<pt;++Bn)for(var _n=b*pe+x*Qt+w*Lt+E*Bn,Rt=R*(B-1-xt)+A*(O-1-hr)+D*(V-1-(Bn*ne-st))+M*de,At=0;At<L;++At)Qn+=m[_n+At]*C[Rt+At];u[c*pe+f*ce+h*De+p*rt+de]=Qn}return o.toTensor()},t.prototype.conv2dDerFilter=function(e,r,a){ge([e,r],"conv2dDerFilter");for(var o=a.strideHeight,u=a.strideWidth,l=a.filterHeight,c=a.filterWidth,f=a.dataFormat==="channelsLast",h=We(a.filterShape,"float32"),p=a.padInfo.left,m=a.padInfo.top,g=this.bufferSync(e),b=this.bufferSync(r),x=0;x<l;++x)for(var w=Math.max(0,Math.ceil((m-x)/o)),E=Math.min(a.outHeight,(a.inHeight+m-x)/o),C=0;C<c;++C)for(var _=Math.max(0,Math.ceil((p-C)/u)),R=Math.min(a.outWidth,(a.inWidth+p-C)/u),A=0;A<a.inChannels;++A)for(var D=0;D<a.outChannels;++D){for(var M=0,k=0;k<a.batchSize;++k)for(var B=w;B<E;++B)for(var O=x+B*o-m,V=_;V<R;++V){var H=C+V*u-p;M+=f?g.get(k,O,H,A)*b.get(k,B,V,D):g.get(k,A,O,H)*b.get(k,D,B,V)}h.set(M,x,C,A,D)}return h.toTensor()},t.prototype.conv3dDerFilter=function(e,r,a){for(var o=a.strideDepth,u=a.strideHeight,l=a.strideWidth,c=a.filterDepth,f=a.filterHeight,h=a.filterWidth,p=We(a.filterShape,"float32"),m=p.values,g=p.strides,b=g[0],x=g[1],w=g[2],E=g[3],C=this.readSync(r.dataId),_=r.strides,R=_[0],A=_[1],D=_[2],M=_[3],k=this.readSync(e.dataId),B=e.strides,O=B[0],V=B[1],H=B[2],ee=B[3],$=a.padInfo.front,K=a.padInfo.left,L=a.padInfo.top,W=0;W<c;++W)for(var U=Math.max(0,Math.ceil(($-W)/o)),Z=Math.min(a.outDepth,(a.inDepth+$-W)/o),P=W*b,q=0;q<f;++q)for(var ne=Math.max(0,Math.ceil((L-q)/u)),J=Math.min(a.outHeight,(a.inHeight+L-q)/u),le=q*x+P,ye=0;ye<h;++ye)for(var pe=Math.max(0,Math.ceil((K-ye)/l)),de=Math.min(a.outWidth,(a.inWidth+K-ye)/l),ce=ye*w+le,xe=0;xe<a.inChannels;++xe)for(var we=xe*E+ce,Ee=0;Ee<a.outChannels;++Ee){for(var De=0,Fe=0;Fe<a.batchSize;++Fe)for(var Xe=Fe*O,it=Fe*R,rt=U;rt<Z;++rt)for(var st=(W+rt*o-$)*V+Xe,mn=rt*A+it,pt=ne;pt<J;++pt)for(var Qn=(q+pt*u-L)*H+st,Qt=pt*D+mn,xt=pe;xt<de;++xt){var Lt=xt*M+Qt;De+=k[(ye+xt*l-K)*ee+Qn+xe]*C[Lt+Ee]}m[we+Ee]=De}return p.toTensor()},t.prototype.fusedDepthwiseConv2D=function(e){var r=e.input,a=e.filter,o=e.convInfo,u=e.bias,l=e.activation,c=e.preluActivationWeights,f=this.depthwiseConv2D(r,a,o);return u&&(f=this.add(f,u)),l&&(f=Jp(this,f,l,c)),f},t.prototype.depthwiseConv2D=function(e,r,a){ge([e,r],"depthwiseConv2D");for(var o=a.filterHeight,u=a.filterWidth,l=a.dilationHeight,c=a.dilationWidth,f=a.padInfo.left,h=a.padInfo.top,p=a.outChannels/a.inChannels,m=We(a.outShape,e.dtype),g=this.readSync(e.dataId),b=this.readSync(r.dataId),x=m.values,w=0;w<a.batchSize;++w)for(var E=w*e.strides[0],C=w*m.strides[0],_=0;_<a.outHeight;++_)for(var R=C+_*m.strides[1],A=_*a.strideHeight-f,D=0;D<o;++D){var M=A+D*l;if(!(M<0||M>=a.inHeight))for(var k=D*r.strides[0],B=E+M*e.strides[1],O=0;O<a.outWidth;++O)for(var V=R+O*m.strides[2],H=O*a.strideWidth-h,ee=0;ee<u;++ee){var $=H+ee*c;if(!($<0||$>=a.inWidth))for(var K=k+ee*r.strides[1],L=B+$*a.inChannels,W=V,U=K,Z=0;Z<a.inChannels;++Z){for(var P=g[L+Z],q=0;q<p;++q)x[W+q]+=P*b[U+q];W+=p,U+=p}}}return m.toTensor()},t.prototype.depthwiseConv2DDerInput=function(e,r,a){ge([e,r],"depthwiseConv2DDerInput");for(var o=We(a.inShape,"float32"),u=o.values,l=o.strides,c=l[0],f=l[1],h=l[2],p=this.readSync(e.dataId),m=e.strides,g=m[0],b=m[1],x=m[2],w=this.readSync(r.dataId),E=r.strides,C=E[0],_=E[1],R=E[2],A=a.batchSize,D=a.filterHeight,M=a.filterWidth,k=a.inChannels,B=a.inHeight,O=a.inWidth,V=a.outChannels,H=a.outHeight,ee=a.outWidth,$=a.strideHeight,K=a.strideWidth,L=D-1-a.padInfo.top,W=M-1-a.padInfo.left,U=V/k,Z=0;Z<A;++Z)for(var P=0;P<k;++P)for(var q=0;q<B;++q)for(var ne=q-L,J=Math.max(0,Math.ceil(ne/$)),le=Math.min(H,(D+ne)/$),ye=0;ye<O;++ye){for(var pe=ye-W,de=Math.max(0,Math.ceil(pe/K)),ce=Math.min(ee,(M+pe)/K),xe=0,we=J;we<le;++we)for(var Ee=we*$-ne,De=de;De<ce;++De)for(var Fe=g*Z+b*we+x*De,Xe=C*(D-1-Ee)+_*(M-1-(De*K-pe))+R*P,it=0;it<U;++it)xe+=p[Fe+(P*U+it)]*w[Xe+it];u[c*Z+f*q+h*ye+P]=xe}return o.toTensor()},t.prototype.depthwiseConv2DDerFilter=function(e,r,a){ge([e,r],"depthwiseConv2DDerFilter");for(var o=a.strideHeight,u=a.strideWidth,l=a.filterHeight,c=a.filterWidth,f=We(a.filterShape,"float32"),h=a.padInfo.left,p=a.padInfo.top,m=a.outChannels/a.inChannels,g=this.bufferSync(e),b=this.bufferSync(r),x=0;x<l;++x)for(var w=Math.max(0,Math.ceil((p-x)/o)),E=Math.min(a.outHeight,(a.inHeight+p-x)/o),C=0;C<c;++C)for(var _=Math.max(0,Math.ceil((h-C)/u)),R=Math.min(a.outWidth,(a.inWidth+h-C)/u),A=0;A<a.outChannels;++A){for(var D=Math.trunc(A/m),M=A%m,k=0,B=0;B<a.batchSize;++B)for(var O=w;O<E;++O)for(var V=x+O*o-p,H=_;H<R;++H){var ee=C+H*u-h;k+=g.get(B,V,ee,D)*b.get(B,O,H,A)}f.set(k,x,C,D,M)}return f.toTensor()},t.prototype.tile=function(e,r){return ge(e,"tile"),i2(this.bufferSync(e),r)},t.prototype.pad=function(e,r,a){ge(e,"pad");var o=r.map(function(m,g){return m[0]+e.shape[g]+m[1]}),u=r.map(function(m){return m[0]}),l=this.bufferSync(e),c=We(o,e.dtype);a!==0&&c.values.fill(a);for(var f=0;f<e.size;f++){var h=l.indexToLoc(f),p=h.map(function(m,g){return m+u[g]});c.set.apply(c,[l.get.apply(l,h)].concat(p))}return c.toTensor()},t.prototype.transpose=function(e,r){ge(e,"transpose");for(var a=new Array(e.rank),o=0;o<a.length;o++)a[o]=e.shape[r[o]];var u=this.readSync(e.dataId),l=We(a,e.dtype),c=this.bufferSync(e);for(o=0;o<e.size;++o){for(var f=c.indexToLoc(o),h=new Array(f.length),p=0;p<h.length;p++)h[p]=f[r[p]];var m=l.locToIndex(h);l.values[m]=u[o]}return l.toTensor()},t.prototype.gather=function(e,r,a){ge([e,r],"gather");var o=e.shape.slice(),u=this.readSync(r.dataId);o[a]=u.length;for(var l=We(o,e.dtype),c=this.bufferSync(e),f=0;f<l.size;++f){var h=l.indexToLoc(f),p=h.slice();p[a]=u[h[a]];var m=c.locToIndex(p);l.values[f]=c.values[m]}return l.toTensor()},t.prototype.batchToSpaceND=function(e,r,a){ge([e],"batchToSpaceND");var o=r.reduce(function(p,m){return p*m}),u=_f(e.shape,r,o),l=Rf(u.length,r.length),c=Af(e.shape,r,o),f=Xw(a,r.length),h=Yw(c,a,r.length);return e.reshape(u).transpose(l).reshape(c).slice(f,h)},t.prototype.spaceToBatchND=function(e,r,a){ge([e],"spaceToBatchND");var o=r.reduce(function(m,g){return m*g}),u=[[0,0]];u.push.apply(u,a);for(var l=1+r.length;l<e.shape.length;++l)u.push([0,0]);var c=e.pad(u),f=_f(c.shape,r,o,!1),h=Rf(f.length,r.length,!1),p=Af(c.shape,r,o,!1);return c.reshape(f).transpose(h).reshape(p)},t.prototype.pool=function(e,r,a){ge(e,"pool");for(var o=r.strideHeight,u=r.strideWidth,l=r.dilationHeight,c=r.dilationWidth,f=r.effectiveFilterHeight,h=r.effectiveFilterWidth,p=r.padInfo.top,m=r.padInfo.left,g=a==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,b=this.readSync(e.dataId),x=We(r.outShape,e.dtype),w=x.values,E=r.outShape[1]*r.outShape[2]*r.outShape[3],C=r.outShape[2]*r.outShape[3],_=r.outShape[3],R=0;R<r.batchSize;++R)for(var A=R*E,D=R*e.strides[0],M=0;M<r.inChannels;++M)for(var k=0;k<r.outHeight;++k)for(var B=k*o-p,O=Math.max(0,B),V=Math.min(r.inHeight,f+B),H=A+k*C,ee=0;ee<r.outWidth;++ee){for(var $=ee*u-m,K=Math.max(0,$),L=Math.min(r.inWidth,h+$),W=g,U=0,Z=0,P=O;P<V;P+=l){for(var q=D+P*e.strides[1],ne=K;ne<L;ne+=c){var J=b[q+ne*e.strides[2]+M];a==="max"&&J>W?W=J:a==="avg"&&(U+=J,Z++)}if(isNaN(W))break}w[H+ee*_+M]=a==="avg"?U/Z:W}return x.toTensor()},t.prototype.maxPool=function(e,r){return this.pool(e,r,"max")},t.prototype.maxPoolPositions=function(e,r){for(var a=We(r.outShape,"int32"),o=r.strideHeight,u=r.strideWidth,l=r.dilationHeight,c=r.dilationWidth,f=r.effectiveFilterHeight,h=r.effectiveFilterWidth,p=r.padInfo.top,m=r.padInfo.left,g=this.bufferSync(e),b=0;b<r.batchSize;++b)for(var x=0;x<r.inChannels;++x)for(var w=0;w<r.outHeight;++w){for(var E=w*o-p,C=E;C<0;)C+=l;for(var _=Math.min(r.inHeight,f+E),R=0;R<r.outWidth;++R){for(var A=R*u-m,D=A;D<0;)D+=c;for(var M=Math.min(r.inWidth,h+A),k=Number.NEGATIVE_INFINITY,B=-1,O=C;O<_;O+=l)for(var V=O-E,H=D;H<M;H+=c){var ee=H-A,$=g.get(b,O,H,x);$>k&&(k=$,B=V*h+ee)}a.set(B,b,w,R,x)}}return a.toTensor()},t.prototype.maxPoolBackprop=function(e,r,a,o){ge([r,a],"maxPoolBackprop");for(var u=this.maxPoolPositions(r,o),l=o.strideHeight,c=o.strideWidth,f=o.dilationHeight,h=o.dilationWidth,p=o.effectiveFilterHeight,m=o.effectiveFilterWidth,g=m-1-o.padInfo.left,b=p-1-o.padInfo.top,x=We(r.shape,"float32"),w=this.bufferSync(u),E=this.bufferSync(e),C=0;C<o.batchSize;++C)for(var _=0;_<o.inChannels;++_)for(var R=0;R<o.inHeight;++R)for(var A=0;A<o.inWidth;++A){for(var D=R-b,M=A-g,k=0,B=0;B<p;B+=f){var O=(D+B)/l;if(!(O<0||O>=o.outHeight||Math.floor(O)!==O))for(var V=0;V<m;V+=h){var H=(M+V)/c;if(!(H<0||H>=o.outWidth||Math.floor(H)!==H)){var ee=p*m-1-w.get(C,O,H,_)===B*m+V?1:0;ee!==0&&(k+=E.get(C,O,H,_)*ee)}}}x.set(k,C,R,A,_)}return x.toTensor()},t.prototype.avgPoolBackprop=function(e,r,a){ge([e,r],"avgPoolBackprop");for(var o=a.strideHeight,u=a.strideWidth,l=a.filterHeight,c=a.filterWidth,f=a.dilationHeight,h=a.dilationWidth,p=a.effectiveFilterHeight,m=a.effectiveFilterWidth,g=m-1-a.padInfo.left,b=p-1-a.padInfo.top,x=We(r.shape,"float32"),w=1/(l*c),E=this.bufferSync(e),C=0;C<a.batchSize;++C)for(var _=0;_<a.inChannels;++_)for(var R=0;R<a.inHeight;++R)for(var A=0;A<a.inWidth;++A){for(var D=R-b,M=A-g,k=0,B=0;B<p;B+=f){var O=(D+B)/o;if(!(O<0||O>=a.outHeight||Math.floor(O)!==O))for(var V=0;V<m;V+=h){var H=(M+V)/u;H<0||H>=a.outWidth||Math.floor(H)!==H||(k+=E.get(C,O,H,_))}}x.set(k*w,C,R,A,_)}return x.toTensor()},t.prototype.pool3d=function(e,r,a){ge(e,"pool3d");for(var o=r.strideDepth,u=r.strideHeight,l=r.strideWidth,c=r.dilationDepth,f=r.dilationHeight,h=r.dilationWidth,p=r.effectiveFilterDepth,m=r.effectiveFilterHeight,g=r.effectiveFilterWidth,b=r.padInfo.front,x=r.padInfo.top,w=r.padInfo.left,E=a==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,C=this.readSync(e.dataId),_=We(r.outShape,e.dtype),R=_.values,A=r.outShape[1]*r.outShape[2]*r.outShape[3]*r.outShape[4],D=r.outShape[2]*r.outShape[3]*r.outShape[4],M=r.outShape[3]*r.outShape[4],k=r.outShape[4],B=0;B<r.batchSize;++B)for(var O=B*A,V=B*e.strides[0],H=0;H<r.inChannels;++H)for(var ee=0;ee<r.outDepth;++ee){for(var $=ee*o-b,K=$;K<0;)K+=c;for(var L=Math.min(r.inDepth,p+$),W=O+ee*D,U=0;U<r.outHeight;++U){for(var Z=U*u-x,P=Z;P<0;)P+=f;for(var q=Math.min(r.inHeight,m+Z),ne=W+U*M,J=0;J<r.outWidth;++J){for(var le=J*l-w,ye=le;ye<0;)ye+=h;for(var pe=Math.min(r.inWidth,g+le),de=ne+J*k,ce=E,xe=0,we=0,Ee=K;Ee<L;Ee+=c){for(var De=V+Ee*e.strides[1],Fe=P;Fe<q;Fe+=f){for(var Xe=De+Fe*e.strides[2],it=ye;it<pe;it+=h){var rt=C[Xe+it*e.strides[3]+H];if(a==="max"&&rt>ce?ce=rt:a==="avg"&&(xe+=rt,we++),isNaN(ce))break}if(isNaN(ce))break}if(isNaN(ce))break}R[de+H]=a==="avg"?xe/we:ce}}}return _.toTensor()},t.prototype.avgPool3d=function(e,r){return ge(e,"avgPool3d"),this.pool3d(e,r,"avg").toFloat()},t.prototype.avgPool3dBackprop=function(e,r,a){ge([e,r],"avgPool3dBackprop");for(var o=a.strideDepth,u=a.strideHeight,l=a.strideWidth,c=a.filterDepth,f=a.filterHeight,h=a.filterWidth,p=a.dilationDepth,m=a.dilationHeight,g=a.dilationWidth,b=a.effectiveFilterDepth,x=a.effectiveFilterHeight,w=a.effectiveFilterWidth,E=b-1-a.padInfo.front,C=w-1-a.padInfo.left,_=x-1-a.padInfo.top,R=We(r.shape,"float32"),A=1/(c*f*h),D=this.bufferSync(e),M=0;M<a.batchSize;++M)for(var k=0;k<a.inChannels;++k)for(var B=0;B<a.inDepth;++B)for(var O=0;O<a.inHeight;++O)for(var V=0;V<a.inWidth;++V){for(var H=B-E,ee=O-_,$=V-C,K=0,L=0;L<b;L+=p){var W=(H+L)/o;if(!(W<0||W>=a.outDepth||Math.floor(W)!==W))for(var U=0;U<x;U+=m){var Z=(ee+U)/u;if(!(Z<0||Z>=a.outHeight||Math.floor(Z)!==Z))for(var P=0;P<w;P+=g){var q=($+P)/l;q<0||q>=a.outWidth||Math.floor(q)!==q||(K+=D.get(M,W,Z,q,k))}}}R.set(K*A,M,B,O,V,k)}return R.toTensor()},t.prototype.maxPool3d=function(e,r){return ge(e,"maxPool3d"),this.pool3d(e,r,"max").toFloat()},t.prototype.maxPool3dPositions=function(e,r){for(var a=We(r.outShape,"int32"),o=r.strideDepth,u=r.strideHeight,l=r.strideWidth,c=r.dilationDepth,f=r.dilationHeight,h=r.dilationWidth,p=r.effectiveFilterDepth,m=r.effectiveFilterHeight,g=r.effectiveFilterWidth,b=r.padInfo.front,x=r.padInfo.top,w=r.padInfo.left,E=this.bufferSync(e),C=0;C<r.batchSize;++C)for(var _=0;_<r.inChannels;++_)for(var R=0;R<r.outDepth;++R){for(var A=R*o-b,D=A;D<0;)D+=c;for(var M=Math.min(r.inDepth,p+A),k=0;k<r.outHeight;++k){for(var B=k*u-x,O=B;O<0;)O+=f;for(var V=Math.min(r.inHeight,m+B),H=0;H<r.outWidth;++H){for(var ee=H*l-w,$=ee;$<0;)$+=h;for(var K=Math.min(r.inWidth,g+ee),L=Number.NEGATIVE_INFINITY,W=-1,U=D;U<M;U+=c)for(var Z=U-A,P=O;P<V;P+=f)for(var q=P-B,ne=$;ne<K;ne+=h){var J=ne-ee,le=E.get(C,U,P,ne,_);le>=L&&(L=le,W=Z*m*g+q*m+J)}a.set(W,C,R,k,H,_)}}}return a.toTensor()},t.prototype.maxPool3dBackprop=function(e,r,a,o){ge([r,a],"maxPool3dBackprop");for(var u=this.maxPool3dPositions(r,o),l=o.strideDepth,c=o.strideHeight,f=o.strideWidth,h=o.dilationDepth,p=o.dilationHeight,m=o.dilationWidth,g=o.effectiveFilterDepth,b=o.effectiveFilterHeight,x=o.effectiveFilterWidth,w=g-1-o.padInfo.front,E=x-1-o.padInfo.left,C=b-1-o.padInfo.top,_=We(r.shape,"float32"),R=this.bufferSync(u),A=this.bufferSync(e),D=0;D<o.batchSize;++D)for(var M=0;M<o.inChannels;++M)for(var k=0;k<o.inDepth;++k)for(var B=0;B<o.inHeight;++B)for(var O=0;O<o.inWidth;++O){for(var V=k-w,H=B-C,ee=O-E,$=0,K=0;K<g;K+=h){var L=(V+K)/l;if(!(L<0||L>=o.outDepth||Math.floor(L)!==L))for(var W=0;W<b;W+=p){var U=(H+W)/c;if(!(U<0||U>=o.outHeight||Math.floor(U)!==U))for(var Z=0;Z<x;Z+=m){var P=(ee+Z)/f;if(!(P<0||P>=o.outWidth||Math.floor(P)!==P)){var q=g*b*x-1-R.get(D,L,U,P,M)===K*b*x+W*x+Z?1:0;q!==0&&($+=A.get(D,L,U,P,M)*q)}}}}_.set($,D,k,B,O,M)}return _.toTensor()},t.prototype.cast=function(e,r){return n2(e,r,this)},t.prototype.reshape=function(e,r){return Pv(e,r)},t.prototype.avgPool=function(e,r){return ge(e,"avgPool"),this.pool(e,r,"avg").toFloat()},t.prototype.resizeBilinear=function(e,r,a,o){ge(e,"resizeBilinear");for(var u=e.shape,l=u[0],c=u[1],f=u[2],h=u[3],p=this.readSync(e.dataId),m=new Float32Array(ke([l,r,a,h])),g=[o&&r>1?c-1:c,o&&a>1?f-1:f],b=[o&&r>1?r-1:r,o&&a>1?a-1:a],x=0,w=g[0]/b[0],E=g[1]/b[1],C=0;C<l;C++)for(var _=0;_<r;_++)for(var R=w*_,A=Math.floor(R),D=R-A,M=Math.min(c-1,Math.ceil(R)),k=C*e.strides[0]+A*e.strides[1],B=C*e.strides[0]+M*e.strides[1],O=0;O<a;O++)for(var V=E*O,H=Math.floor(V),ee=V-H,$=Math.min(f-1,Math.ceil(V)),K=k+H*e.strides[2],L=B+H*e.strides[2],W=k+$*e.strides[2],U=B+$*e.strides[2],Z=0;Z<h;Z++){var P=p[K+Z],q=p[L+Z],ne=P+(p[W+Z]-P)*ee,J=ne+(q+(p[U+Z]-q)*ee-ne)*D;m[x++]=J}return En(m,[l,r,a,h])},t.prototype.resizeBilinearBackprop=function(e,r,a){ge([e,r],"resizeBilinearBackprop");for(var o=r.shape,u=o[0],l=o[1],c=o[2],f=o[3],h=e.shape,p=h[1],m=h[2],g=new Float32Array(u*l*c*f),b=[a&&p>1?l-1:l,a&&m>1?c-1:c],x=[a&&p>1?p-1:p,a&&m>1?m-1:m],w=b[0]/x[0],E=b[1]/x[1],C=this.readSync(e.dataId),_=0,R=0;R<u;R++)for(var A=R*r.strides[0],D=0;D<p;D++)for(var M=D*w,k=Math.floor(M),B=Math.min(Math.ceil(M),l-1),O=A+k*r.strides[1],V=A+B*r.strides[1],H=M-k,ee=1-H,$=0;$<m;$++)for(var K=$*E,L=Math.floor(K),W=Math.min(Math.ceil(K),c-1),U=K-L,Z=1-U,P=O+L*r.strides[2],q=O+W*r.strides[2],ne=V+L*r.strides[2],J=V+W*r.strides[2],le=ee*Z,ye=ee*U,pe=H*Z,de=H*U,ce=0;ce<f;ce++){var xe=C[_++];g[P+ce]+=xe*le,g[q+ce]+=xe*ye,g[ne+ce]+=xe*pe,g[J+ce]+=xe*de}return Gn(g,[u,c,l,f],r.dtype)},t.prototype.resizeNearestNeighbor=function(e,r,a,o){ge(e,"resizeNearestNeighbor");for(var u=e.shape,l=u[0],c=u[1],f=u[2],h=u[3],p=this.readSync(e.dataId),m=new Float32Array(l*r*a*h),g=[o&&r>1?c-1:c,o&&a>1?f-1:f],b=[o&&r>1?r-1:r,o&&a>1?a-1:a],x=g[0]/b[0],w=g[1]/b[1],E=0,C=0;C<l;C++)for(var _=C*e.strides[0],R=0;R<r;R++)for(var A=x*R,D=_+Math.min(c-1,o?Math.round(A):Math.floor(A))*e.strides[1],M=0;M<a;M++)for(var k=w*M,B=D+Math.min(f-1,o?Math.round(k):Math.floor(k))*e.strides[2],O=0;O<h;O++){var V=p[B+O];m[E++]=V}return En(m,[l,r,a,h],e.dtype)},t.prototype.resizeNearestNeighborBackprop=function(e,r,a){ge([e,r],"resizeNearestNeighborBackprop");for(var o=r.shape,u=o[0],l=o[1],c=o[2],f=o[3],h=e.shape,p=h[1],m=h[2],g=new Float32Array(u*l*c*f),b=this.readSync(e.dataId),x=[a&&p>1?l-1:l,a&&m>1?c-1:c],w=[a&&p>1?p-1:p,a&&m>1?m-1:m],E=x[0]/w[0],C=x[1]/w[1],_=1/E,R=1/C,A=2*Math.ceil(_)+2,D=2*Math.ceil(R)+2,M=0;M<u;M++)for(var k=M*r.strides[0],B=0;B<l;B++)for(var O=k+B*r.strides[1],V=Math.floor(B*_),H=Math.floor(V-A/2),ee=0;ee<c;ee++)for(var $=O+ee*r.strides[2],K=Math.floor(ee*R),L=Math.floor(K-D/2),W=0;W<f;W++){for(var U=0,Z=0;Z<A;Z++){var P=Z+H;if(!(P<0||P>=p)){var q=k+P*e.strides[1],ne=P*E;if(B===Math.min(l-1,a?Math.round(ne):Math.floor(ne)))for(var J=0;J<D;J++){var le=J+L;if(!(le<0||le>=m)){var ye=q+le*e.strides[2],pe=le*C;ee===Math.min(c-1,a?Math.round(pe):Math.floor(pe))&&(U+=b[ye+W])}}}}g[$+W]=U}return Gn(g,r.shape,r.dtype)},t.prototype.batchNormalization=function(e,r,a,o,u,l){ge([e,r,a,u,l],"batchNorm");for(var c=this.readSync(e.dataId),f=this.readSync(r.dataId),h=this.readSync(a.dataId),p=u?this.readSync(u.dataId):new Float32Array([1]),m=l?this.readSync(l.dataId):new Float32Array([0]),g=new Float32Array(c.length),b=m.length,x=p.length,w=h.length,E=f.length,C=0,_=0,R=0,A=0,D=0;D<c.length;++D)g[D]=m[C++]+(c[D]-f[_++])*p[R++]/Math.sqrt(h[A++]+o),C>=b&&(C=0),_>=E&&(_=0),R>=x&&(R=0),A>=w&&(A=0);return Gn(g,e.shape)},t.prototype.localResponseNormalization4D=function(e,r,a,o,u){ge(e,"localResponseNormalization4D");var l=e.shape[3],c=l-1,f=this.readSync(e.dataId),h=e.size,p=new Float32Array(h);function m(w){for(var E=w%l,C=w-E+Math.max(0,E-r),_=w-E+Math.min(E+r,c),R=0;C<=_;C++){var A=f[C];R+=A*A}return R}for(var g=0;g<h;g++){var b=m(g),x=f[g]*Math.pow(a+o*b,-u);p[g]=x}return Gn(p,e.shape)},t.prototype.LRNGrad=function(e,r,a,o,u,l,c){ge(e,"LRNGrad");for(var f=e.shape[3],h=this.readSync(e.dataId),p=this.readSync(r.dataId),m=this.readSync(a.dataId),g=new Float32Array(e.size),b=e.size,x=0;x<b;x++){for(var w=x%f,E=x-w+Math.max(0,w-o),C=x-w+Math.min(f,w+o+1),_=0,R=E;R<C;R++)_+=Math.pow(p[R],2);for(_=l*_+u,R=E;R<C;R++){var A=-2*l*c*p[R]*m[x]/_;x===R&&(A+=Math.pow(_,-c)),A*=h[x],g[R]+=A}}return Gn(g,e.shape)},t.prototype.multinomial=function(e,r,a,o){ge(e,"multinomial");for(var u=r?e:Ua(e),l=u.shape[0],c=u.shape[1],f=_t([l,a],"int32"),h=this.readSync(f.dataId),p=this.readSync(u.dataId),m=0;m<l;++m){var g=m*c,b=new Float32Array(c-1);b[0]=p[g];for(var x=1;x<b.length;++x)b[x]=b[x-1]+p[g+x];for(var w=Kf(o.toString()),E=m*a,C=0;C<a;++C){var _=w();h[E+C]=b.length;for(var R=0;R<b.length;R++)if(_<b[R]){h[E+C]=R;break}}}return f},t.prototype.oneHot=function(e,r,a,o){ge(e,"oneHot");var u=new Float32Array(e.size*r);u.fill(o);for(var l=this.readSync(e.dataId),c=0;c<e.size;++c)l[c]>=0&&l[c]<r&&(u[c*r+l[c]]=a);return Eo(u,[e.size,r],"int32")},t.prototype.nonMaxSuppression=function(e,r,a,o,u){return ge(e,"nonMaxSuppression"),Cm(this.readSync(e.dataId),this.readSync(r.dataId),a,o,u)},t.prototype.fft=function(e){return this.fftBatch(e,!1)},t.prototype.ifft=function(e){return this.fftBatch(e,!0)},t.prototype.fftBatch=function(e,r){for(var a=e.shape[0],o=e.shape[1],u=We(e.shape,"float32"),l=We(e.shape,"float32"),c=_r(e).as2D(a,o),f=ea(e).as2D(a,o),h=0;h<a;h++)for(var p=c.slice([h,0],[1,o]),m=f.slice([h,0],[1,o]),g=wn(p,m),b=this.readSync(this.fftImpl(g,r).dataId),x=0;x<o;x++){var w=qx(b,x);u.values[h*o+x]=w.real,l.values[h*o+x]=w.imag}return wn(u.toTensor(),l.toTensor()).as2D(a,o)},t.prototype.fftImpl=function(e,r){var a=e.as1D(),o=a.size;if(this.isExponentOf2(o)){var u=this.fftRadix2(a,o,r).as2D(e.shape[0],e.shape[1]);return r&&(u=wn(_r(u).div(Se(o)),ea(u).div(Se(o)))),u}var l=this.readSync(e.dataId),c=function(f){for(var h=new Float32Array(f.length/2),p=new Float32Array(f.length/2),m=0;m<f.length;m+=2)h[m/2]=f[m],p[m/2]=f[m+1];return{real:h,imag:p}}(this.fourierTransformByMatmul(l,o,r));return wn(c.real,c.imag).as2D(e.shape[0],e.shape[1])},t.prototype.isExponentOf2=function(e){return(e&e-1)==0},t.prototype.fftRadix2=function(e,r,a){if(r===1)return e;var o=this.readSync(e.dataId),u=r/2,l=function(E){for(var C=Math.ceil(E.length/4),_=new Float32Array(C),R=new Float32Array(C),A=0;A<E.length;A+=4)_[Math.floor(A/4)]=E[A],R[Math.floor(A/4)]=E[A+1];return{real:_,imag:R}}(o),c=wn(l.real,l.imag).as1D(),f=function(E){for(var C=Math.floor(E.length/4),_=new Float32Array(C),R=new Float32Array(C),A=2;A<E.length;A+=4)_[Math.floor(A/4)]=E[A],R[Math.floor(A/4)]=E[A+1];return{real:_,imag:R}}(o),h=wn(f.real,f.imag).as1D();c=this.fftRadix2(c,u,a),h=this.fftRadix2(h,u,a);var p=function(E,C){for(var _=new Float32Array(E/2),R=new Float32Array(E/2),A=0;A<Math.ceil(E/2);A++){var D=(C?2:-2)*Math.PI*(A/E);_[A]=Math.cos(D),R[A]=Math.sin(D)}return{real:_,imag:R}}(r,a),m=wn(p.real,p.imag).mul(h),g=c.add(m),b=c.sub(m),x=_r(g).concat(_r(b)),w=ea(g).concat(ea(b));return wn(x,w).as1D()},t.prototype.fourierTransformByMatmul=function(e,r,a){for(var o=new Float32Array(2*r),u=0;u<r;u++){for(var l=0,c=0,f=0;f<r;f++){var h=uN(u*f,r,a),p=qx(e,f);l+=p.real*h.real-p.imag*h.imag,c+=p.real*h.imag+p.imag*h.real}a&&(l/=r,c/=r),sN(o,l,c,u)}return o},t.prototype.depthToSpace=function(e,r,a){j(a==="NHWC",function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+a}),j(r>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+r});for(var o=e.shape[0],u=e.shape[1],l=e.shape[2],c=e.shape[3],f=u*r,h=l*r,p=c/(r*r),m=this.readSync(e.dataId),g=new Float32Array(o*f*h*p),b=0,x=0;x<o;++x)for(var w=0;w<f;++w)for(var E=Math.floor(w/r),C=w%r,_=0;_<h;++_)for(var R=Math.floor(_/r),A=(C*r+_%r)*p,D=0;D<p;++D){var M=D+A+c*(R+l*(E+u*x));g[b++]=m[M]}return Gn(g,[o,f,h,p])},t.prototype.broadcastedBinaryOp=function(e,r,a,o){var u=tt(e.shape,r.shape),l=We(u,a),c=this.readSync(e.dataId),f=this.readSync(r.dataId),h=xo(e.shape,u),p=xo(r.shape,u),m=l.values;if(h.length+p.length===0)for(var g=0;g<m.length;++g)m[g]=o(c[g%c.length],f[g%f.length]);else{var b=this.bufferSync(e),x=this.bufferSync(r),w=function(E){var C=l.indexToLoc(E),_=C.slice(-e.rank);h.forEach(function(M){return _[M]=0});var R=b.locToIndex(_),A=C.slice(-r.rank);p.forEach(function(M){return A[M]=0});var D=x.locToIndex(A);m[E]=o(c[R],f[D])};for(g=0;g<m.length;++g)w(g)}return l.toTensor()},t.prototype.broadcastedBinaryComplexOp=function(e,r,a){var o=tt(e.shape,r.shape),u=We(o,"float32"),l=We(o,"float32"),c=this.readSync(e.dataId),f=this.readSync(r.dataId),h=xo(e.shape,o),p=xo(r.shape,o),m=u.values,g=l.values;if(h.length+p.length===0)for(var b=0;b<m.length;b++){var x=b%c.length,w=b%f.length,E=a(c[2*x],c[2*x+1],f[2*w],f[2*w+1]);m[b]=E.real,g[b]=E.imag}else{var C=this.bufferSync(this.data.get(e.dataId).complexTensors.real),_=this.bufferSync(this.data.get(r.dataId).complexTensors.real),R=function(A){var D=u.indexToLoc(A),M=D.slice(-e.rank);h.forEach(function(H){return M[H]=0});var k=C.locToIndex(M),B=D.slice(-r.rank);p.forEach(function(H){return B[H]=0});var O=_.locToIndex(B),V=a(c[2*k],c[2*k+1],f[2*O],f[2*O+1]);m[A]=V.real,g[A]=V.imag};for(b=0;b<m.length;b++)R(b)}return this.complex(u.toTensor(),l.toTensor())},t.prototype.split=function(e,r,a){return o2(e,r,a)},t.prototype.dispose=function(){},t.prototype.floatPrecision=function(){return 32},t.prototype.epsilon=function(){return 1e-7},t.prototype.cropAndResize=function(e,r,a,o,u,l){for(var c=e.shape,f=c[0],h=c[1],p=c[2],m=c[3],g=r.shape[0],b=o[0],x=o[1],w=We([g,b,x,m],"float32"),E=this.readSync(r.dataId),C=this.readSync(a.dataId),_=this.readSync(e.dataId),R=e.strides,A=w.strides,D=0;D<g;D++){var M=4*D,k=E[M],B=E[M+1],O=E[M+2],V=E[M+3],H=C[D];if(!(H>=f))for(var ee=b>1?(O-k)*(h-1)/(b-1):0,$=x>1?(V-B)*(p-1)/(x-1):0,K=0;K<b;K++){var L=b>1?k*(h-1)+K*ee:.5*(k+O)*(h-1);if(L<0||L>h-1)for(var W=0;W<x;W++)for(var U=0;U<m;U++){var Z=U+W*A[2]+K*A[1]+D*A[0];w.values[Z]=l}else if(u==="bilinear"){var P=Math.floor(L),q=Math.ceil(L),ne=L-P;for(W=0;W<x;W++)if((Ee=x>1?B*(p-1)+W*$:.5*(B+V)*(p-1))<0||Ee>p-1)for(U=0;U<m;U++)Z=U+W*A[2]+K*A[1]+D*A[0],w.values[Z]=l;else{var J=Math.floor(Ee),le=Math.ceil(Ee),ye=Ee-J;for(U=0;U<m;U++){var pe=_[Z=U+J*R[2]+P*R[1]+H*R[0]],de=_[Z=U+le*R[2]+P*R[1]+H*R[0]],ce=_[Z=U+J*R[2]+q*R[1]+H*R[0]],xe=pe+(de-pe)*ye,we=ce+(_[Z=U+le*R[2]+q*R[1]+H*R[0]]-ce)*ye;Z=U+W*A[2]+K*A[1]+D*A[0],w.values[Z]=xe+(we-xe)*ne}}}else for(W=0;W<x;++W){var Ee;if((Ee=x>1?B*(p-1)+W*$:.5*(B+V)*(p-1))<0||Ee>p-1)for(U=0;U<m;U++)Z=U+W*A[2]+K*A[1]+D*A[0],w.values[Z]=l;else{var De=Math.round(Ee),Fe=Math.round(L);for(U=0;U<m;U++){var Xe=U+De*R[2]+Fe*R[1]+H*R[0],it=U+W*A[2]+K*A[1]+D*A[0];w.values[it]=_[Xe]}}}}}return w.toTensor()},t.prototype.sparseToDense=function(e,r,a,o){var u=Tf(0,e,a),l=u.sliceRank,c=u.numUpdates,f=u.sliceSize,h=u.strides,p=u.outputSize;return this.scatter(e,r,a,p,f,c,l,h,o,!1)},t.prototype.gatherND=function(e,r){var a=r.shape,o=a[a.length-1],u=Kw(e,r),l=u[0],c=u[1],f=u[2],h=u[3];if(c===0)return En([],l,e.dtype);for(var p=new el([c,f],e.dtype),m=this.readSync(r.dataId),g=this.readSync(e.dataId),b=0;b<c;b++){for(var x=[],w=0,E=0;E<o;E++){var C=m[b*o+E];w+=C*h[E],x.push(C)}if(w<0||w>=e.size/f)throw new Error("Invalid indices: "+x+" does not index into "+e.shape);for(var _=0;_<f;_++)p.values[b*f+_]=g[w*f+_]}return p.toTensor().reshape(l)},t.prototype.scatterND=function(e,r,a){var o=Tf(0,e,a),u=o.sliceRank,l=o.numUpdates,c=o.sliceSize,f=o.strides,h=o.outputSize,p=Se(0);return this.scatter(e,r,a,h,c,l,u,f,p,!0)},t.prototype.fill=function(e,r,a){var o=yf(a=a||dl(r),ke(e));return o.fill(r),Q.makeTensor(o,e,a,this)},t.prototype.onesLike=function(e){if(e.dtype==="string")throw new Error("onesLike is not supported for string tensors");return this.fill(e.shape,1,e.dtype)},t.prototype.zerosLike=function(e){var r=yf(e.dtype,ke(e.shape));return this.makeOutput(r,e.shape,e.dtype)},t.prototype.linspace=function(e,r,a){return r2(e,r,a)},t.prototype.scatter=function(e,r,a,o,u,l,c,f,h,p){var m=[o/u,u],g=this.readSync(e.dataId),b=this.readSync(r.dataId);if(o===0)return En([],a,r.dtype);var x=new el(m,r.dtype);x.values.fill(this.readSync(h.dataId)[0]);for(var w=0;w<l;w++){for(var E=[],C=0,_=0;_<c;_++){var R=g[w*c+_];E.push(R),C+=R*f[_]}if(C<0||C>=o/u)throw new Error("Invalid indices: "+E+" does not index into "+a);for(var A=0;A<u;A++)p?x.values[C*u+A]+=b[w*u+A]:x.values[C*u+A]=r.rank===0?b[0]:b[w*u+A]}return x.toTensor().reshape(a)},t}(e2);Q.registerBackend("cpu",function(){return new T4},1);for(var ev=0,p1=[{kernelName:"NonMaxSuppressionV5",backendName:"cpu",kernelFunc:function(n){var t=n.inputs,e=n.backend,r=n.attrs,a=t,o=a.boxes,u=a.scores,l=r,c=l.maxOutputSize,f=l.iouThreshold,h=l.scoreThreshold,p=l.softNmsSigma,m=e;ge(o,"NonMaxSuppressionWithScore");var g=_m(m.data.get(o.dataId).values,m.data.get(u.dataId).values,c,f,h,p);return[g.selectedIndices,g.selectedScores]}},{kernelName:"Square",backendName:"cpu",kernelFunc:function(n){var t=n.inputs,e=n.backend,r=t.x,a=e;ge(r,"square");for(var o=a.data.get(r.dataId).values,u=new Float32Array(o.length),l=0;l<o.length;++l){var c=o[l];u[l]=c*c}return{dataId:a.write(u,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},{kernelName:rl,backendName:"cpu",kernelFunc:function(n){var t=n.inputs,e=n.backend,r=t,a=r.a,o=r.b,u=e;ge([a,o],rl);var l=u.data.get(a.dataId).values,c=u.data.get(o.dataId).values,f=function(m,g,b,x,w,E){var C=tt(m,g),_=C.length,R=oa(C),A=Ju(w,ke(C)),D=m.length,M=g.length,k=oa(m),B=oa(g),O=xo(m,C),V=xo(g,C);if(O.length+V.length===0)for(var H=0;H<A.length;++H)A[H]=E(b[H%b.length],x[H%x.length]);else{var ee=function($){var K=LA($,_,R),L=K.slice(-D);O.forEach(function(P){return L[P]=0});var W=Px(L,D,k),U=K.slice(-M);V.forEach(function(P){return U[P]=0});var Z=Px(U,M,B);A[$]=E(b[W],x[Z])};for(H=0;H<A.length;++H)ee(H)}return[A,C]}(a.shape,o.shape,l,c,a.dtype,function(m,g){var b=m-g;return b*b}),h=f[0],p=f[1];return{dataId:u.write(h,p,a.dtype),shape:p,dtype:a.dtype}}}];ev<p1.length;ev++)Tw(p1[ev]);var ss,N4=function(n){this.variableNames=["A"];var t=Dn(),e=n[0],r=n[1];this.outputShape=n,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+r+".0, "+e+`.0);

        vec4 values = `+t.texture2D+`(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `},D4=function(n){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var t=Dn(),e=n[0],r=n[1];this.outputShape=n,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(`+r+".0, "+e+`.0);
            vec4 values = `+t.texture2D+`(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        `+t.output+` = result;
      }
    `};for(var tv=0,v1=[{kernelName:"FromPixels",backendName:"webgl",kernelFunc:function(n){var t=n.inputs,e=n.backend,r=n.attrs,a=t.pixels,o=r.numChannels,u=typeof HTMLVideoElement<"u"&&a instanceof HTMLVideoElement,l=typeof HTMLImageElement<"u"&&a instanceof HTMLImageElement,c=u?[a.videoWidth,a.videoHeight]:[a.width,a.height],f=c[0],h=c[1],p=[h,f],m=[h,f,o];(l||u)&&(ss==null&&(ss=document.createElement("canvas").getContext("2d")),ss.canvas.width=f,ss.canvas.height=h,ss.drawImage(a,0,0,f,h),a=ss.canvas);var g=e.makeTensorInfo(p,"int32");e.texData.get(g.dataId).usage=sr.PIXELS,e.gpgpu.uploadPixelDataToTexture(e.getTexture(g.dataId),a);var b=fe().getBool("WEBGL_PACK")?new D4(m):new N4(m),x=e.runWebGLProgram(b,[g],"int32");return e.disposeData(g.dataId),x}},{kernelName:"NonMaxSuppressionV5",backendName:"webgl",kernelFunc:function(n){var t=n.inputs,e=n.backend,r=n.attrs;Sf("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var a=t,o=a.boxes,u=a.scores,l=r,c=l.maxOutputSize,f=l.iouThreshold,h=l.scoreThreshold,p=l.softNmsSigma,m=e,g=_m(m.readSync(o.dataId),m.readSync(u.dataId),c,f,h,p);return[g.selectedIndices,g.selectedScores]}},{kernelName:"Square",backendName:"webgl",kernelFunc:function(n){var t=n.inputs,e=n.backend,r=t.x,a=e,o=new qe(r.shape,"return x * x;");return a.runWebGLProgram(o,[r],r.dtype)}},{kernelName:rl,backendName:"webgl",kernelFunc:function(n){var t=n.inputs,e=n.backend,r=t,a=r.a,o=r.b,u=e,l=fe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ba("return (a - b) * (a - b);",a.shape,o.shape):new Pt("return (a - b) * (a - b);",a.shape,o.shape);return u.compileAndRun(l,[a,o])}}];tv<v1.length;tv++)Tw(v1[tv]);for(var nv=0,m1=[{kernelName:"Square",gradFunc:function(n,t){var e=t[0];return{x:function(){return n.mul(e.toFloat().mul(2))}}}},{kernelName:rl,gradFunc:function(n,t){var e=t[0],r=t[1],a=Se(2);return{a:function(){return Mn(n,Mn(a,on(e,r)))},b:function(){return Mn(n,Mn(a,on(r,e)))}}}}];nv<m1.length;nv++)AA(m1[nv]);var k4=function(){function n(){}return n.prototype.fetch=function(t,e){return fetch(t,e)},n.prototype.now=function(){return performance.now()},n.prototype.encode=function(t,e){if(e!=="utf-8"&&e!=="utf8")throw new Error("Browser's encoder only supports utf-8, but got "+e);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)},n.prototype.decode=function(t,e){return new TextDecoder(e).decode(t)},n}();fe().get("IS_BROWSER")&&fe().setPlatform("browser",new k4);var rv,M4=function(){return require("node-fetch")},O4=function(){function n(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}return n.prototype.fetch=function(t,e){return fe().global.fetch!=null?fe().global.fetch(t,e):(rv==null&&(rv=M4()),rv(t,e))},n.prototype.now=function(){var t=process.hrtime();return 1e3*t[0]+t[1]/1e6},n.prototype.encode=function(t,e){if(e!=="utf-8"&&e!=="utf8")throw new Error("Node built-in encoder only supports utf-8, but got "+e);return this.textEncoder.encode(t)},n.prototype.decode=function(t,e){return t.length===0?"":new this.util.TextDecoder(e).decode(t)},n}();fe().get("IS_NODE")&&fe().setPlatform("node",new O4);var Uv={float32:4,int32:4,uint16:2,uint8:1,bool:1},Bf=4;function $2(n,t){for(var e={},r=0,a=function(l){var c=l.name,f=l.dtype,h=l.shape,p=ke(h),m=void 0;if("quantization"in l){var g=l.quantization;if(g.dtype!=="uint8"&&g.dtype!=="uint16")throw new Error("Weight "+l.name+" has unknown quantization dtype "+g.dtype+". Supported quantization dtypes are: 'uint8' and 'uint16'.");var b=Uv[g.dtype],x=n.slice(r,r+p*b),w=g.dtype==="uint8"?new Uint8Array(x):new Uint16Array(x);if(f==="float32")m=Float32Array.from(w,function(D){return D*g.scale+g.min});else{if(f!=="int32")throw new Error("Unsupported dtype in weight '"+c+"': "+f);m=Int32Array.from(w,function(D){return Math.round(D*g.scale+g.min)})}r+=p*b}else if(f==="string"){var E=ke(l.shape);m=[];for(var C=0;C<E;C++){var _=new Uint32Array(n.slice(r,r+Bf))[0];r+=Bf;var R=new Uint8Array(n.slice(r,r+_));m.push(R),r+=_}}else{var A=Uv[f];if(x=n.slice(r,r+p*A),f==="float32")m=new Float32Array(x);else if(f==="int32")m=new Int32Array(x);else{if(f!=="bool")throw new Error("Unsupported dtype in weight '"+c+"': "+f);m=new Uint8Array(x)}r+=p*A}e[c]=En(m,h,f)},o=0,u=t;o<u.length;o++)a(u[o]);return e}function I4(n){if(n===null)throw new Error("Invalid input value: "+JSON.stringify(n));var t=0,e=[];n.forEach(function(o){if(t+=o.byteLength,e.push(o.byteLength===o.buffer.byteLength?o:new o.constructor(o)),!(o instanceof Float32Array||o instanceof Int32Array||o instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+o.constructor.name)});var r=new Uint8Array(t),a=0;return e.forEach(function(o){r.set(new Uint8Array(o.buffer),a),a+=o.byteLength}),r.buffer}var jv=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function g1(n){return jv?Buffer.byteLength(n):new Blob([n]).size}function Wm(n){var t=0;n.forEach(function(a){t+=a.byteLength});var e=new Uint8Array(t),r=0;return n.forEach(function(a){e.set(new Uint8Array(a),r),r+=a.byteLength}),e.buffer}function y1(n){for(n=n.trim();n.endsWith("/");)n=n.slice(0,n.length-1);var t=n.split("/");return t[t.length-1]}function bl(n){if(n.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:n.modelTopology==null?0:g1(JSON.stringify(n.modelTopology)),weightSpecsBytes:n.weightSpecs==null?0:g1(JSON.stringify(n.weightSpecs)),weightDataBytes:n.weightData==null?0:n.weightData.byteLength}}var ur=function(){function n(){this.saveRouters=[],this.loadRouters=[]}return n.getInstance=function(){return n.instance==null&&(n.instance=new n),n.instance},n.registerSaveRouter=function(t){n.getInstance().saveRouters.push(t)},n.registerLoadRouter=function(t){n.getInstance().loadRouters.push(t)},n.getSaveHandlers=function(t){return n.getHandlers(t,"save")},n.getLoadHandlers=function(t,e){return n.getHandlers(t,"load",e)},n.getHandlers=function(t,e,r){var a=[];return(e==="load"?n.getInstance().loadRouters:n.getInstance().saveRouters).forEach(function(o){var u=o(t,r);u!==null&&a.push(u)}),a},n}(),Es="://",Co=function(){function n(){this.managers={}}return n.getInstance=function(){return n.instance==null&&(n.instance=new n),n.instance},n.registerManager=function(t,e){j(t!=null,function(){return"scheme must not be undefined or null."}),t.endsWith(Es)&&(t=t.slice(0,t.indexOf(Es))),j(t.length>0,function(){return"scheme must not be an empty string."});var r=n.getInstance();j(r.managers[t]==null,function(){return"A model store manager is already registered for scheme '"+t+"'."}),r.managers[t]=e},n.getManager=function(t){var e=this.getInstance().managers[t];if(e==null)throw new Error("Cannot find model manager for scheme '"+t+"'");return e},n.getSchemes=function(){return Object.keys(this.getInstance().managers)},n}();function ff(n){if(n.indexOf(Es)===-1)throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+Co.getSchemes().join(","));return{scheme:n.split(Es)[0],path:n.split(Es)[1]}}function b1(n,t,e){return e===void 0&&(e=!1),Te(this,void 0,void 0,function(){var r,a,o,u,l,c,f,h,p;return Ne(this,function(m){switch(m.label){case 0:return j(n!==t,function(){return"Old path and new path are the same: '"+n+"'"}),j((r=ur.getLoadHandlers(n)).length>0,function(){return"Copying failed because no load handler is found for source URL "+n+"."}),j(r.length<2,function(){return"Copying failed because more than one ("+r.length+") load handlers for source URL "+n+"."}),a=r[0],j((o=ur.getSaveHandlers(t)).length>0,function(){return"Copying failed because no save handler is found for destination URL "+t+"."}),j(o.length<2,function(){return"Copying failed because more than one ("+r.length+") save handlers for destination URL "+t+"."}),u=o[0],l=ff(n).scheme,c=ff(n).path,f=l===ff(n).scheme,[4,a.load()];case 1:return h=m.sent(),e&&f?[4,Co.getManager(l).removeModel(c)]:[3,3];case 2:m.sent(),m.label=3;case 3:return[4,u.save(h)];case 4:return p=m.sent(),!e||f?[3,6]:[4,Co.getManager(l).removeModel(c)];case 5:m.sent(),m.label=6;case 6:return[2,p.modelArtifactsInfo]}})})}var ui="models_store",wo="model_info_store";function Z2(){if(!fe().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var n=window||self,t=n.indexedDB||n.mozIndexedDB||n.webkitIndexedDB||n.msIndexedDB||n.shimIndexedDB;if(t==null)throw new Error("The current browser does not appear to support IndexedDB.");return t}function Hv(n){var t=n.result;t.createObjectStore(ui,{keyPath:"modelPath"}),t.createObjectStore(wo,{keyPath:"modelPath"})}var Cs=function(){function n(t){if(this.indexedDB=Z2(),t==null||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}return n.prototype.save=function(t){return Te(this,void 0,void 0,function(){return Ne(this,function(e){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,t)]})})},n.prototype.load=function(){return Te(this,void 0,void 0,function(){return Ne(this,function(t){return[2,this.databaseAction(this.modelPath)]})})},n.prototype.databaseAction=function(t,e){var r=this;return new Promise(function(a,o){var u=r.indexedDB.open("tensorflowjs",1);u.onupgradeneeded=function(){return Hv(u)},u.onsuccess=function(){var l=u.result;if(e==null){var c=l.transaction(ui,"readonly"),f=c.objectStore(ui).get(r.modelPath);f.onsuccess=function(){if(f.result==null)return l.close(),o(new Error("Cannot find model with path '"+r.modelPath+"' in IndexedDB."));a(f.result.modelArtifacts)},f.onerror=function(x){return l.close(),o(f.error)},c.oncomplete=function(){return l.close()}}else{var h,p=bl(e),m=l.transaction(wo,"readwrite"),g=m.objectStore(wo),b=g.put({modelPath:r.modelPath,modelArtifactsInfo:p});b.onsuccess=function(){var x=(h=l.transaction(ui,"readwrite")).objectStore(ui).put({modelPath:r.modelPath,modelArtifacts:e,modelArtifactsInfo:p});x.onsuccess=function(){return a({modelArtifactsInfo:p})},x.onerror=function(w){var E=(g=m.objectStore(wo)).delete(r.modelPath);E.onsuccess=function(){return l.close(),o(x.error)},E.onerror=function(C){return l.close(),o(x.error)}}},b.onerror=function(x){return l.close(),o(b.error)},m.oncomplete=function(){h==null?l.close():h.oncomplete=function(){return l.close()}}}},u.onerror=function(l){return o(u.error)}})},n.URL_SCHEME="indexeddb://",n}(),x1=function(n){return fe().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(Cs.URL_SCHEME)?(t=n.slice(Cs.URL_SCHEME.length),new Cs(t)):null;var t};ur.registerSaveRouter(x1),ur.registerLoadRouter(x1);var B4=function(){function n(){this.indexedDB=Z2()}return n.prototype.listModels=function(){return Te(this,void 0,void 0,function(){var t=this;return Ne(this,function(e){return[2,new Promise(function(r,a){var o=t.indexedDB.open("tensorflowjs",1);o.onupgradeneeded=function(){return Hv(o)},o.onsuccess=function(){var u=o.result,l=u.transaction(wo,"readonly"),c=l.objectStore(wo).getAll();c.onsuccess=function(){for(var f={},h=0,p=c.result;h<p.length;h++){var m=p[h];f[m.modelPath]=m.modelArtifactsInfo}r(f)},c.onerror=function(f){return u.close(),a(c.error)},l.oncomplete=function(){return u.close()}},o.onerror=function(u){return a(o.error)}})]})})},n.prototype.removeModel=function(t){return Te(this,void 0,void 0,function(){var e=this;return Ne(this,function(r){var a;return t=(a=t).startsWith(Cs.URL_SCHEME)?a.slice(Cs.URL_SCHEME.length):a,[2,new Promise(function(o,u){var l=e.indexedDB.open("tensorflowjs",1);l.onupgradeneeded=function(){return Hv(l)},l.onsuccess=function(){var c,f=l.result,h=f.transaction(wo,"readwrite"),p=h.objectStore(wo),m=p.get(t);m.onsuccess=function(){if(m.result==null)return f.close(),u(new Error("Cannot find model with path '"+t+"' in IndexedDB."));var g=p.delete(t),b=function(){var x=(c=f.transaction(ui,"readwrite")).objectStore(ui).delete(t);x.onsuccess=function(){return o(m.result.modelArtifactsInfo)},x.onerror=function(w){return u(m.error)}};g.onsuccess=b,g.onerror=function(x){return b(),f.close(),u(m.error)}},m.onerror=function(g){return f.close(),u(m.error)},h.oncomplete=function(){c==null?f.close():c.oncomplete=function(){return f.close()}}},l.onerror=function(c){return u(l.error)}})]})})},n}();if(fe().getBool("IS_BROWSER"))try{Co.registerManager(Cs.URL_SCHEME,new B4)}catch{}var Fa="/",gs="tensorflowjs_models",J2="info",F4="model_topology",P4="weight_specs",L4="weight_data",z4="model_metadata";function eS(n){return{info:[gs,n,J2].join(Fa),topology:[gs,n,F4].join(Fa),weightSpecs:[gs,n,P4].join(Fa),weightData:[gs,n,L4].join(Fa),modelMetadata:[gs,n,z4].join(Fa)}}function U4(n){var t=n.split(Fa);if(t.length<3)throw new Error("Invalid key format: "+n);return t.slice(1,t.length-1).join(Fa)}var _s=function(){function n(t){if(!fe().getBool("IS_BROWSER")||typeof window>"u"||window.localStorage===void 0)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,t==null||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=eS(this.modelPath)}return n.prototype.save=function(t){return Te(this,void 0,void 0,function(){var e,r,a;return Ne(this,function(o){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");e=JSON.stringify(t.modelTopology),r=JSON.stringify(t.weightSpecs),a=bl(t);try{return this.LS.setItem(this.keys.info,JSON.stringify(a)),this.LS.setItem(this.keys.topology,e),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,function(u){if(jv)return Buffer.from(u).toString("base64");for(var l=new Uint8Array(u),c="",f=0,h=l.length;f<h;f++)c+=String.fromCharCode(l[f]);return btoa(c)}(t.weightData)),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata})),[2,{modelArtifactsInfo:a}]}catch{throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+a.modelTopologyBytes+", weightSpecsBytes="+a.weightSpecsBytes+", weightDataBytes="+a.weightDataBytes+".")}return[2]})})},n.prototype.load=function(){return Te(this,void 0,void 0,function(){var t,e,r,a,o,u,l;return Ne(this,function(c){if((t=JSON.parse(this.LS.getItem(this.keys.info)))==null)throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if(t.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(e={},(r=JSON.parse(this.LS.getItem(this.keys.topology)))==null)throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if(e.modelTopology=r,(a=JSON.parse(this.LS.getItem(this.keys.weightSpecs)))==null)throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if(e.weightSpecs=a,(o=this.LS.getItem(this.keys.modelMetadata))!=null&&(u=JSON.parse(o),e.format=u.format,e.generatedBy=u.generatedBy,e.convertedBy=u.convertedBy,e.userDefinedMetadata=u.userDefinedMetadata),(l=this.LS.getItem(this.keys.weightData))==null)throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return e.weightData=function(f){if(jv){var h=Buffer.from(f,"base64");return h.buffer.slice(h.byteOffset,h.byteOffset+h.byteLength)}for(var p=atob(f),m=new Uint8Array(p.length),g=0;g<p.length;++g)m.set([p.charCodeAt(g)],g);return m.buffer}(l),[2,e]})})},n.URL_SCHEME="localstorage://",n}(),w1=function(n){return fe().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(_s.URL_SCHEME)?(t=n.slice(_s.URL_SCHEME.length),new _s(t)):null;var t};ur.registerSaveRouter(w1),ur.registerLoadRouter(w1);var j4=function(){function n(){j(fe().getBool("IS_BROWSER"),function(){return"Current environment is not a web browser"}),j(typeof window>"u"||window.localStorage!==void 0,function(){return"Current browser does not appear to support localStorage"}),this.LS=window.localStorage}return n.prototype.listModels=function(){return Te(this,void 0,void 0,function(){var t,e,r,a,o,u;return Ne(this,function(l){for(t={},e=gs+Fa,r=Fa+J2,a=0;a<this.LS.length;++a)(o=this.LS.key(a)).startsWith(e)&&o.endsWith(r)&&(u=U4(o),t[u]=JSON.parse(this.LS.getItem(o)));return[2,t]})})},n.prototype.removeModel=function(t){return Te(this,void 0,void 0,function(){var e,r;return Ne(this,function(a){var o;if(t=(o=t).startsWith(_s.URL_SCHEME)?o.slice(_s.URL_SCHEME.length):o,e=eS(t),this.LS.getItem(e.info)==null)throw new Error("Cannot find model at path '"+t+"'");return r=JSON.parse(this.LS.getItem(e.info)),this.LS.removeItem(e.info),this.LS.removeItem(e.topology),this.LS.removeItem(e.weightSpecs),this.LS.removeItem(e.weightData),[2,r]})})},n}();if(fe().getBool("IS_BROWSER"))try{Co.registerManager(_s.URL_SCHEME,new j4)}catch{}var H4="model",V4=".json",W4=".weights.bin";function S1(n){return new Promise(function(t){return setTimeout(t)}).then(n)}var av=function(){function n(t){if(!fe().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(n.URL_SCHEME)&&(t=t.slice(n.URL_SCHEME.length)),t!=null&&t.length!==0||(t=H4),this.modelTopologyFileName=t+V4,this.weightDataFileName=t+W4}return n.prototype.save=function(t){return Te(this,void 0,void 0,function(){var e,r,a,o,u,l;return Ne(this,function(c){switch(c.label){case 0:if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");if(e=window.URL.createObjectURL(new Blob([t.weightData],{type:"application/octet-stream"})),!(t.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 1:return r=[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}],a={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:r},o=window.URL.createObjectURL(new Blob([JSON.stringify(a)],{type:"application/json"})),(u=this.jsonAnchor==null?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,u.href=o,[4,S1(function(){return u.dispatchEvent(new MouseEvent("click"))})];case 2:return c.sent(),t.weightData==null?[3,4]:((l=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,l.href=e,[4,S1(function(){return l.dispatchEvent(new MouseEvent("click"))})]);case 3:c.sent(),c.label=4;case 4:return[2,{modelArtifactsInfo:bl(t)}]}})})},n.URL_SCHEME="downloads://",n}(),G4=function(){function n(t){if(t==null||t.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+t);this.files=t}return n.prototype.load=function(){return Te(this,void 0,void 0,function(){var t,e,r=this;return Ne(this,function(a){return t=this.files[0],e=this.files.slice(1),[2,new Promise(function(o,u){var l=new FileReader;l.onload=function(c){var f=JSON.parse(c.target.result),h=f.modelTopology;if(h!=null){e.length===0&&o({modelTopology:h});var p=f.weightsManifest;if(p!=null){var m;try{m=r.checkManifestAndWeightFiles(p,e)}catch(w){return void u(w)}var g=[],b=[],x=[];p.forEach(function(w){w.paths.forEach(function(E){b.push(E),x.push(null)}),g.push.apply(g,w.weights)}),p.forEach(function(w){w.paths.forEach(function(E){var C=new FileReader;C.onload=function(_){var R=_.target.result,A=b.indexOf(E);x[A]=R,x.indexOf(null)===-1&&o({modelTopology:h,weightSpecs:g,weightData:Wm(x),format:f.format,generatedBy:f.generatedBy,convertedBy:f.convertedBy,userDefinedMetadata:f.userDefinedMetadata})},C.onerror=function(_){return u("Failed to weights data from file of path '"+E+"'.")},C.readAsArrayBuffer(m[E])})})}else u(new Error("weightManifest field is missing from file "+t.name))}else u(new Error("modelTopology field is missing from file "+t.name))},l.onerror=function(c){return u("Failed to read model topology and weights manifest JSON from file '"+t.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")},l.readAsText(t)})]})})},n.prototype.checkManifestAndWeightFiles=function(t,e){for(var r=[],a=e.map(function(c){return y1(c.name)}),o={},u=0,l=t;u<l.length;u++)l[u].paths.forEach(function(c){var f=y1(c);if(r.indexOf(f)!==-1)throw new Error("Duplicate file basename found in weights manifest: '"+f+"'");if(r.push(f),a.indexOf(f)===-1)throw new Error("Weight file with basename '"+f+"' is not provided.");o[c]=e[a.indexOf(f)]});if(r.length!==e.length)throw new Error("Mismatch in the number of files in weights manifest ("+r.length+") and the number of weight files provided ("+e.length+").");return o},n}();function E1(n,t,e,r){(function(o){j(o!=null&&Array.isArray(o)&&o.length>0,function(){return"promises must be a none empty array"})})(n),function(o,u){j(o>=0&&o<=1,function(){return"Progress fraction must be in range [0, 1], but got startFraction "+o}),j(u>=0&&u<=1,function(){return"Progress fraction must be in range [0, 1], but got endFraction "+u}),j(u>=o,function(){return"startFraction must be no more than endFraction, but got startFraction "+o+" and endFraction "+u})}(e=e??0,r=r??1);var a=0;return Promise.all(n.map(function(o){return o.then(function(u){var l=e+ ++a/n.length*(r-e);return t(l),u}),o}))}function tS(n,t){return Te(this,void 0,void 0,function(){var e,r,a,o,u,l,c,f,h;return Ne(this,function(p){switch(p.label){case 0:return t==null&&(t={}),e=t.fetchFunc==null?fe().platform.fetch:t.fetchFunc,r=n.map(function(m){return e(m,t.requestInit,{isBinary:!0})}),a=0,o=.5,t.onProgress!=null?[3,2]:[4,Promise.all(r)];case 1:return u=p.sent(),[3,4];case 2:return[4,E1(r,t.onProgress,a,o)];case 3:u=p.sent(),p.label=4;case 4:return l=u.map(function(m){return m.arrayBuffer()}),c=.5,f=1,t.onProgress!=null?[3,6]:[4,Promise.all(l)];case 5:return h=p.sent(),[3,8];case 6:return[4,E1(l,t.onProgress,c,f)];case 7:h=p.sent(),p.label=8;case 8:return[2,h]}})})}function C1(n){var t=this;return function(e,r,a){return r===void 0&&(r=""),Te(t,void 0,void 0,function(){var o,u,l,c,f,h,p,m,g,b;return Ne(this,function(x){switch(x.label){case 0:if(o=e.map(function(){return!1}),u={},l=a!=null?a.map(function(){return!1}):[],c=[],e.forEach(function(w,E){var C=0;w.weights.forEach(function(_){var R="quantization"in _?_.quantization.dtype:_.dtype,A=Uv[R]*ke(_.shape),D=function(){o[E]=!0,u[E]==null&&(u[E]=[]),u[E].push({manifestEntry:_,groupOffset:C,sizeBytes:A})};a!=null?a.forEach(function(M,k){M===_.name&&(D(),l[k]=!0)}):D(),c.push(_.name),C+=A})}),!l.every(function(w){return w}))throw f=a.filter(function(w,E){return!l[E]}),new Error("Could not find weights in manifest with names: "+f.join(", ")+`. 
Manifest JSON has weights with names: `+c.join(", ")+".");return h=o.reduce(function(w,E,C){return E&&w.push(C),w},[]),p=[],h.forEach(function(w){e[w].paths.forEach(function(E){var C=r+(r.endsWith("/")?"":"/")+E;p.push(C)})}),[4,n(p)];case 1:return m=x.sent(),g={},b=0,h.forEach(function(w){for(var E=e[w].paths.length,C=0,_=0;_<E;_++)C+=m[b+_].byteLength;for(var R=new ArrayBuffer(C),A=new Uint8Array(R),D=0,M=0;M<E;M++){var k=new Uint8Array(m[b+M]);A.set(k,D),D+=k.byteLength}u[w].forEach(function(B){var O=$2(R.slice(B.groupOffset,B.groupOffset+B.sizeBytes),[B.manifestEntry]);for(var V in O)g[V]=O[V]}),b+=E}),[2,g]}})})}}ur.registerSaveRouter(function(n){return fe().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(av.URL_SCHEME)?function(t){return t===void 0&&(t="model"),new av(t)}(n.slice(av.URL_SCHEME.length)):null});var nS=function(){function n(t,e){if(this.DEFAULT_METHOD="POST",e==null&&(e={}),this.weightPathPrefix=e.weightPathPrefix,this.onProgress=e.onProgress,e.fetchFunc!=null?(j(typeof e.fetchFunc=="function",function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"}),this.fetch=e.fetchFunc):this.fetch=fe().platform.fetch,j(t!=null&&t.length>0,function(){return"URL path for http must not be null, undefined or empty."}),Array.isArray(t)&&j(t.length===2,function(){return"URL paths for http must have a length of 2, (actual length is "+t.length+")."}),this.path=t,e.requestInit!=null&&e.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=e.requestInit||{}}return n.prototype.save=function(t){return Te(this,void 0,void 0,function(){var e,r,a,o;return Ne(this,function(u){switch(u.label){case 0:if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(e=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,r=[{paths:["./model.weights.bin"],weights:t.weightSpecs}],a={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata,weightsManifest:r},e.body.append("model.json",new Blob([JSON.stringify(a)],{type:"application/json"}),"model.json"),t.weightData!=null&&e.body.append("model.weights.bin",new Blob([t.weightData],{type:"application/octet-stream"}),"model.weights.bin"),[4,this.fetch(this.path,e)];case 1:if((o=u.sent()).ok)return[2,{modelArtifactsInfo:bl(t),responses:[o]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+o.status+".")}})})},n.prototype.load=function(){return Te(this,void 0,void 0,function(){var t,e,r,a,o,u,l,c,f,h,p,m;return Ne(this,function(g){switch(g.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(!(t=g.sent()).ok)throw new Error("Request to "+this.path+" failed with status code "+t.status+". Please verify this URL points to the model JSON of the model to load.");g.label=2;case 2:return g.trys.push([2,4,,5]),[4,t.json()];case 3:return e=g.sent(),[3,5];case 4:throw g.sent(),r="Failed to parse model JSON of response from "+this.path+".",this.path.endsWith(".pb")?r+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":r+=" Please make sure the server is serving valid JSON for this request.",new Error(r);case 5:if(a=e.modelTopology,o=e.weightsManifest,u=e.generatedBy,l=e.convertedBy,c=e.format,f=e.userDefinedMetadata,a==null&&o==null)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");return o==null?[3,7]:[4,this.loadWeights(o)];case 6:m=g.sent(),h=m[0],p=m[1],g.label=7;case 7:return[2,{modelTopology:a,weightSpecs:h,weightData:p,userDefinedMetadata:f,generatedBy:u,convertedBy:l,format:c}]}})})},n.prototype.loadWeights=function(t){return Te(this,void 0,void 0,function(){var e,r,a,o,u,l,c,f,h,p,m;return Ne(this,function(g){switch(g.label){case 0:for(e=Array.isArray(this.path)?this.path[1]:this.path,r=function(b){var x=b.lastIndexOf("/"),w=b.lastIndexOf("?"),E=b.substring(0,x),C=w>x?b.substring(w):"";return[E+"/",C]}(e),a=r[0],o=r[1],u=this.weightPathPrefix||a,l=[],c=0,f=t;c<f.length;c++)h=f[c],l.push.apply(l,h.weights);return p=[],t.forEach(function(b){b.paths.forEach(function(x){p.push(u+x+o)})}),[4,tS(p,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})];case 1:return m=g.sent(),[2,[l,Wm(m)]]}})})},n.URL_SCHEME_REGEX=/^https?:\/\//,n}();function Vv(n){return n.match(nS.URL_SCHEME_REGEX)!=null}var _1=function(n,t){return typeof fetch>"u"?null:(Array.isArray(n)?n.every(function(e){return Vv(e)}):Vv(n))?Wv(n,{onProgress:t}):null};function Wv(n,t){return new nS(n,t)}ur.registerSaveRouter(_1),ur.registerLoadRouter(_1);var ov=function(){function n(t){this.modelArtifacts=t}return n.prototype.load=function(){return Te(this,void 0,void 0,function(){return Ne(this,function(t){return[2,this.modelArtifacts]})})},n}(),q4=function(){function n(t){this.saveHandler=t}return n.prototype.save=function(t){return Te(this,void 0,void 0,function(){return Ne(this,function(e){return[2,this.saveHandler(t)]})})},n}(),rS=Object.freeze({browserFiles:function(n){return new G4(n)},browserHTTPRequest:function(n,t){return Wv(n,t)},concatenateArrayBuffers:Wm,decodeWeights:$2,encodeWeights:function(n,t){return Te(this,void 0,void 0,function(){var e,r,a,o,u,l=this;return Ne(this,function(c){switch(c.label){case 0:for(e=[],r=[],a=Array.isArray(n)?n.map(function(f){return f.name}):Object.keys(n),o=function(f){var h=a[f],p=Array.isArray(n)?n[f].tensor:n[h];if(p.dtype!=="float32"&&p.dtype!=="int32"&&p.dtype!=="bool"&&p.dtype!=="string")throw new Error("Unsupported dtype in weight '"+h+"': "+p.dtype);var m={name:h,shape:p.shape,dtype:p.dtype};if(p.dtype==="string"){var g=new Promise(function(b){return Te(l,void 0,void 0,function(){var x,w,E,C,_,R,A;return Ne(this,function(D){switch(D.label){case 0:return[4,p.bytes()];case 1:for(x=D.sent(),w=x.reduce(function(M,k){return M+k.length},0)+Bf*x.length,E=new Uint8Array(w),C=0,_=0;_<x.length;_++)R=x[_],A=new Uint8Array(new Uint32Array([R.length]).buffer),E.set(A,C),C+=Bf,E.set(R,C),C+=R.length;return b(E),[2]}})})});r.push(g)}else r.push(p.data());t!=null&&(m.group=t),e.push(m)},u=0;u<a.length;++u)o(u);return[4,Promise.all(r)];case 1:return[2,{data:I4(c.sent()),specs:e}]}})})},fromMemory:function(n,t,e,r){return arguments.length===1?n.modelTopology!=null||n.weightSpecs!=null?new ov(n):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new ov({modelTopology:n})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new ov({modelTopology:n,weightSpecs:t,weightData:e,trainingConfig:r}))},getLoadHandlers:function(n,t){return ur.getLoadHandlers(n,t)},getModelArtifactsInfoForJSON:bl,getSaveHandlers:function(n){return ur.getSaveHandlers(n)},http:Wv,isHTTPScheme:Vv,loadWeights:function(n,t,e,r){return t===void 0&&(t=""),Te(this,void 0,void 0,function(){return Ne(this,function(a){return[2,C1(function(o){return tS(o,{requestInit:r})})(n,t,e)]})})},registerLoadRouter:function(n){return ur.registerLoadRouter(n)},registerSaveRouter:function(n){return ur.registerSaveRouter(n)},weightsLoaderFactory:C1,withSaveHandler:function(n){return new q4(n)},copyModel:function(n,t){return Te(this,void 0,void 0,function(){return Ne(this,function(e){return[2,b1(n,t,!1)]})})},listModels:function(){return Te(this,void 0,void 0,function(){var n,t,e,r,a,o,u;return Ne(this,function(l){switch(l.label){case 0:n=Co.getSchemes(),t={},e=0,r=n,l.label=1;case 1:return e<r.length?(a=r[e],[4,Co.getManager(a).listModels()]):[3,4];case 2:for(u in o=l.sent())t[a+Es+u]=o[u];l.label=3;case 3:return e++,[3,1];case 4:return[2,t]}})})},moveModel:function(n,t){return Te(this,void 0,void 0,function(){return Ne(this,function(e){return[2,b1(n,t,!0)]})})},removeModel:function(n){return Te(this,void 0,void 0,function(){var t;return Ne(this,function(e){return t=ff(n),[2,Co.getManager(t.scheme).removeModel(t.path)]})})}}),us;X({confusionMatrix_:function(n,t,e){var r=z(n,"labels","confusionMatrix"),a=z(t,"predictions","confusionMatrix");j(e==null||e>0&&Number.isInteger(e),function(){return"If provided, numClasses must be a positive integer, but got "+e}),j(r.rank===1,function(){return"Expected the rank of labels to be 1, but got "+r.rank}),j(a.rank===1,function(){return"Expected the rank of predictions to be 1, but got "+a.rank}),j(r.shape[0]===a.shape[0],function(){return"Mismatch in the number of examples: "+r.shape[0]+" vs. "+a.shape[0]+". Labels and predictions should have the same number of elements."}),j(e>0&&Number.isInteger(e),function(){return"numClasses is required to be a positive integer, but got "+e});var o=Bv(r.asType("int32"),e),u=Bv(a.asType("int32"),e);return o.transpose().matMul(u).asType("int32")}});var X4=X({fromPixels_:function(n,t){if(t===void 0&&(t=3),t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(n==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var e=!1,r=!1,a=!1,o=!1,u=!1;if(n.data instanceof Uint8Array)e=!0;else if(typeof ImageData<"u"&&n instanceof ImageData)r=!0;else if(typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement)a=!0;else if(typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement)o=!0;else{if(n.getContext==null)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+n.constructor.name);u=!0}if(a&&a&&n.readyState<2)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.");if(Aw("FromPixels",Q.backendName)!=null)return Q.runKernel("FromPixels",{pixels:n},{numChannels:t});var l,c,f=a?[n.videoWidth,n.videoHeight]:[n.width,n.height],h=f[0],p=f[1];if(u?l=n.getContext("2d").getImageData(0,0,h,p).data:r||e?l=n.data:(o||a)&&(us==null&&(us=document.createElement("canvas").getContext("2d")),us.canvas.width=h,us.canvas.height=p,us.drawImage(n,0,0,h,p),l=us.getImageData(0,0,h,p).data),t===4)c=new Int32Array(l);else{var m=h*p;c=new Int32Array(m*t);for(var g=0;g<m;g++)for(var b=0;b<t;++b)c[g*t+b]=l[4*g+b]}return bm(c,[p,h,t],"int32")}}),Gm=Object.freeze({toPixels:function(n,t){return Te(this,void 0,void 0,function(){var e,r,a,o,u,l,c,f,h,p,m,g,b,x,w,E,C,_,R,A,D,M,k;return Ne(this,function(B){switch(B.label){case 0:if(e=z(n,"img","toPixels"),n instanceof Mt||(e=e.toInt()),e.rank!==2&&e.rank!==3)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+e.rank+".");if(r=e.shape.slice(0,2),a=r[0],o=r[1],(u=e.rank===2?1:e.shape[2])>4||u===2)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+u);return[4,e.data()];case 1:return l=B.sent(),c=e.min(),f=e.max(),[4,Promise.all([c.data(),f.data()])];case 2:if(h=B.sent(),p=h[0],m=h[1],g=p[0],b=m[0],c.dispose(),f.dispose(),e.dtype==="float32"){if(g<0||b>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but got range ["+g+" - "+b+"].")}else{if(e.dtype!=="int32")throw new Error("Unsupported type for toPixels: "+e.dtype+". Please use float32 or int32 tensors.");if(g<0||b>255)throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but got range ["+g+" - "+b+"].")}for(x=e.dtype==="float32"?255:1,w=new Uint8ClampedArray(o*a*4),E=0;E<a*o;++E)C=void 0,_=void 0,R=void 0,A=void 0,u===1?(C=l[E]*x,_=l[E]*x,R=l[E]*x,A=255):u===3?(C=l[3*E]*x,_=l[3*E+1]*x,R=l[3*E+2]*x,A=255):u===4&&(C=l[4*E]*x,_=l[4*E+1]*x,R=l[4*E+2]*x,A=l[4*E+3]*x),w[(D=4*E)+0]=Math.round(C),w[D+1]=Math.round(_),w[D+2]=Math.round(R),w[D+3]=Math.round(A);return t!=null&&(t.width=o,t.height=a,M=t.getContext("2d"),k=new ImageData(w,o,a),M.putImageData(k,0,0)),e!==n&&e.dispose(),[2,w]}})})},fromPixels:X4}),Y4=function(){function n(){}return n.prototype.getClassName=function(){return this.constructor.className},n.fromConfig=function(t,e){return new t(e)},n}(),K4=function(){function n(){this.classNameMap={}}return n.getMap=function(){return n.instance==null&&(n.instance=new n),n.instance},n.register=function(t){n.getMap().classNameMap[t.className]=[t,t.fromConfig]},n}();function yi(n){j(n.className!=null,function(){return"Class being registered does not have the static className property defined."}),j(typeof n.className=="string",function(){return"className is required to be a string, but got type "+typeof n.className}),j(n.className.length>0,function(){return"Class being registered has an empty-string as its className, which is disallowed."}),K4.register(n)}var bi=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return jr(t,n),t.prototype.minimize=function(e,r,a){r===void 0&&(r=!1);var o=this.computeGradients(e,a),u=o.value,l=o.grads;if(a!=null){var c=a.map(function(f){return{name:f.name,tensor:l[f.name]}});this.applyGradients(c)}else this.applyGradients(l);return Xn(l),r?u:(u.dispose(),null)},Object.defineProperty(t.prototype,"iterations",{get:function(){return this.iterations_==null&&(this.iterations_=0),this.iterations_},enumerable:!0,configurable:!0}),t.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},t.prototype.computeGradients=function(e,r){return oN(e,r)},t.prototype.dispose=function(){this.iterations_!=null&&Xn(this.iterations_)},t.prototype.saveIterations=function(){return Te(this,void 0,void 0,function(){return Ne(this,function(e){return this.iterations_==null&&(this.iterations_=0),[2,{name:"iter",tensor:Se(this.iterations_,"int32")}]})})},t.prototype.getWeights=function(){return Te(this,void 0,void 0,function(){return Ne(this,function(e){throw new Error("getWeights() is not implemented for this optimizer yet.")})})},t.prototype.setWeights=function(e){return Te(this,void 0,void 0,function(){return Ne(this,function(r){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())})})},t.prototype.extractIterations=function(e){return Te(this,void 0,void 0,function(){var r;return Ne(this,function(a){switch(a.label){case 0:return r=this,[4,e[0].tensor.data()];case 1:return r.iterations_=a.sent()[0],[2,e.slice(1)]}})})},t}(Y4);Object.defineProperty(bi,Symbol.hasInstance,{value:function(n){return n.minimize!=null&&n.computeGradients!=null&&n.applyGradients!=null}});var Q4=function(n){function t(e,r,a){a===void 0&&(a=null);var o=n.call(this)||this;return o.learningRate=e,o.rho=r,o.epsilon=a,o.accumulatedGrads=[],o.accumulatedUpdates=[],a==null&&(o.epsilon=Q.backend.epsilon()),o}return jr(t,n),t.prototype.applyGradients=function(e){var r=this;(Array.isArray(e)?e.map(function(a){return a.name}):Object.keys(e)).forEach(function(a,o){var u=Q.registeredVariables[a];r.accumulatedGrads[o]==null&&(r.accumulatedGrads[o]={originalName:a+"/accum_grad",variable:Ce(function(){return ot(u).variable(!1)})}),r.accumulatedUpdates[o]==null&&(r.accumulatedUpdates[o]={originalName:a+"/accum_var",variable:Ce(function(){return ot(u).variable(!1)})});var l=Array.isArray(e)?e[o].tensor:e[a];if(l!=null){var c=r.accumulatedGrads[o].variable,f=r.accumulatedUpdates[o].variable;Ce(function(){var h=c.mul(r.rho).add(l.square().mul(1-r.rho)),p=f.add(r.epsilon).sqrt().div(c.add(r.epsilon).sqrt()).mul(l),m=f.mul(r.rho).add(p.square().mul(1-r.rho));c.assign(h),f.assign(m);var g=p.mul(-r.learningRate).add(u);u.assign(g)})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedUpdates!=null&&(Xn(this.accumulatedGrads.map(function(e){return e.variable})),Xn(this.accumulatedUpdates.map(function(e){return e.variable})))},t.prototype.getWeights=function(){return Te(this,void 0,void 0,function(){var e;return Ne(this,function(r){switch(r.label){case 0:return e=this.accumulatedGrads.concat(this.accumulatedUpdates),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(e.map(function(a){return{name:a.originalName,tensor:a.variable}}))]}})})},t.prototype.setWeights=function(e){return Te(this,void 0,void 0,function(){var r;return Ne(this,function(a){switch(a.label){case 0:return[4,this.extractIterations(e)];case 1:return e=a.sent(),r=e.length/2,this.accumulatedGrads=e.slice(0,r).map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}}),this.accumulatedUpdates=e.slice(r,2*r).map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},t.fromConfig=function(e,r){return new e(r.learningRate,r.rho,r.epsilon)},t.className="Adadelta",t}(bi);yi(Q4);var $4=function(n){function t(e,r){r===void 0&&(r=.1);var a=n.call(this)||this;return a.learningRate=e,a.initialAccumulatorValue=r,a.accumulatedGrads=[],a}return jr(t,n),t.prototype.applyGradients=function(e){var r=this;(Array.isArray(e)?e.map(function(a){return a.name}):Object.keys(e)).forEach(function(a,o){var u=Q.registeredVariables[a];r.accumulatedGrads[o]==null&&(r.accumulatedGrads[o]={originalName:a+"/accumulator",variable:Ce(function(){return ia(u.shape,r.initialAccumulatorValue).variable(!1)})});var l=Array.isArray(e)?e[o].tensor:e[a];if(l!=null){var c=r.accumulatedGrads[o].variable;Ce(function(){var f=c.add(l.square());c.assign(f);var h=l.div(f.add(Q.backend.epsilon()).sqrt()).mul(-r.learningRate).add(u);u.assign(h)})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedGrads!=null&&Xn(this.accumulatedGrads.map(function(e){return e.variable}))},t.prototype.getWeights=function(){return Te(this,void 0,void 0,function(){return Ne(this,function(e){switch(e.label){case 0:return[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(this.accumulatedGrads.map(function(r){return{name:r.originalName,tensor:r.variable}}))]}})})},t.prototype.setWeights=function(e){return Te(this,void 0,void 0,function(){return Ne(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(e)];case 1:return e=r.sent(),this.accumulatedGrads=e.map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},t.fromConfig=function(e,r){return new e(r.learningRate,r.initialAccumulatorValue)},t.className="Adagrad",t}(bi);yi($4);var Z4=function(n){function t(e,r,a,o){o===void 0&&(o=null);var u=n.call(this)||this;return u.learningRate=e,u.beta1=r,u.beta2=a,u.epsilon=o,u.accumulatedFirstMoment=[],u.accumulatedSecondMoment=[],Ce(function(){u.accBeta1=Se(r).variable(),u.accBeta2=Se(a).variable()}),o==null&&(u.epsilon=Q.backend.epsilon()),u}return jr(t,n),t.prototype.applyGradients=function(e){var r=this,a=Array.isArray(e)?e.map(function(o){return o.name}):Object.keys(e);Ce(function(){var o=on(1,r.accBeta1),u=on(1,r.accBeta2);a.forEach(function(l,c){var f=Q.registeredVariables[l];r.accumulatedFirstMoment[c]==null&&(r.accumulatedFirstMoment[c]={originalName:l+"/m",variable:Ce(function(){return ot(f).variable(!1)})}),r.accumulatedSecondMoment[c]==null&&(r.accumulatedSecondMoment[c]={originalName:l+"/v",variable:Ce(function(){return ot(f).variable(!1)})});var h=Array.isArray(e)?e[c].tensor:e[l];if(h!=null){var p=r.accumulatedFirstMoment[c].variable,m=r.accumulatedSecondMoment[c].variable,g=p.mul(r.beta1).add(h.mul(1-r.beta1)),b=m.mul(r.beta2).add(h.square().mul(1-r.beta2)),x=g.div(o),w=b.div(u);p.assign(g),m.assign(b);var E=x.div(w.sqrt().add(r.epsilon)).mul(-r.learningRate).add(f);f.assign(E)}}),r.accBeta1.assign(r.accBeta1.mul(r.beta1)),r.accBeta2.assign(r.accBeta2.mul(r.beta2))}),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&Xn(this.accumulatedFirstMoment.map(function(e){return e.variable})),this.accumulatedSecondMoment!=null&&Xn(this.accumulatedSecondMoment.map(function(e){return e.variable}))},t.prototype.getWeights=function(){return Te(this,void 0,void 0,function(){var e;return Ne(this,function(r){switch(r.label){case 0:return e=this.accumulatedFirstMoment.concat(this.accumulatedSecondMoment),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(e.map(function(a){return{name:a.originalName,tensor:a.variable}}))]}})})},t.prototype.setWeights=function(e){return Te(this,void 0,void 0,function(){var r,a=this;return Ne(this,function(o){switch(o.label){case 0:return[4,this.extractIterations(e)];case 1:return e=o.sent(),Ce(function(){a.accBeta1.assign(Of(a.beta1,a.iterations_+1)),a.accBeta2.assign(Of(a.beta2,a.iterations_+1))}),r=e.length/2,this.accumulatedFirstMoment=e.slice(0,r).map(function(u){return{originalName:u.name,variable:u.tensor.variable(!1)}}),this.accumulatedSecondMoment=e.slice(r,2*r).map(function(u){return{originalName:u.name,variable:u.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},t.fromConfig=function(e,r){return new e(r.learningRate,r.beta1,r.beta2,r.epsilon)},t.className="Adam",t}(bi);yi(Z4);var J4=function(n){function t(e,r,a,o,u){o===void 0&&(o=null),u===void 0&&(u=0);var l=n.call(this)||this;return l.learningRate=e,l.beta1=r,l.beta2=a,l.epsilon=o,l.decay=u,l.accumulatedFirstMoment=[],l.accumulatedWeightedInfNorm=[],Ce(function(){l.iteration=Se(0).variable(),l.accBeta1=Se(r).variable()}),o==null&&(l.epsilon=Q.backend.epsilon()),l}return jr(t,n),t.prototype.applyGradients=function(e){var r=this,a=Array.isArray(e)?e.map(function(o){return o.name}):Object.keys(e);Ce(function(){var o=on(1,r.accBeta1),u=Fr(-r.learningRate,r.iteration.mul(r.decay).add(1));a.forEach(function(l,c){var f=Q.registeredVariables[l];r.accumulatedFirstMoment[c]==null&&(r.accumulatedFirstMoment[c]={originalName:l+"/m",variable:ot(f).variable(!1)}),r.accumulatedWeightedInfNorm[c]==null&&(r.accumulatedWeightedInfNorm[c]={originalName:l+"/v",variable:ot(f).variable(!1)});var h=Array.isArray(e)?e[c].tensor:e[l];if(h!=null){var p=r.accumulatedFirstMoment[c].variable,m=r.accumulatedWeightedInfNorm[c].variable,g=p.mul(r.beta1).add(h.mul(1-r.beta1)),b=m.mul(r.beta2),x=h.abs(),w=b.maximum(x);p.assign(g),m.assign(w);var E=u.div(o).mul(g.div(w.add(r.epsilon))).add(f);f.assign(E)}}),r.iteration.assign(r.iteration.add(1)),r.accBeta1.assign(r.accBeta1.mul(r.beta1))}),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&Xn(this.accumulatedFirstMoment.map(function(e){return e.variable})),this.accumulatedWeightedInfNorm!=null&&Xn(this.accumulatedWeightedInfNorm.map(function(e){return e.variable}))},t.prototype.getWeights=function(){return Te(this,void 0,void 0,function(){return Ne(this,function(e){throw new Error("getWeights() is not implemented for Adamax yet.")})})},t.prototype.setWeights=function(e){return Te(this,void 0,void 0,function(){return Ne(this,function(r){throw new Error("setWeights() is not implemented for Adamax yet.")})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},t.fromConfig=function(e,r){return new e(r.learningRate,r.beta1,r.beta2,r.epsilon,r.decay)},t.className="Adamax",t}(bi);yi(J4);var aS=function(n){function t(e){var r=n.call(this)||this;return r.learningRate=e,r.setLearningRate(e),r}return jr(t,n),t.prototype.applyGradients=function(e){var r=this;(Array.isArray(e)?e.map(function(a){return a.name}):Object.keys(e)).forEach(function(a,o){var u=Array.isArray(e)?e[o].tensor:e[a];if(u!=null){var l=Q.registeredVariables[a];Ce(function(){var c=r.c.mul(u).add(l);l.assign(c)})}}),this.incrementIterations()},t.prototype.setLearningRate=function(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=bT(Se(-e))},t.prototype.dispose=function(){this.c.dispose()},t.prototype.getWeights=function(){return Te(this,void 0,void 0,function(){return Ne(this,function(e){switch(e.label){case 0:return[4,this.saveIterations()];case 1:return[2,[e.sent()]]}})})},t.prototype.setWeights=function(e){return Te(this,void 0,void 0,function(){return Ne(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(e)];case 1:if((e=r.sent()).length!==0)throw new Error("SGD optimizer does not have settable weights.");return[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate}},t.fromConfig=function(e,r){return new e(r.learningRate)},t.className="SGD",t}(bi);yi(aS);var eM=function(n){function t(e,r,a){a===void 0&&(a=!1);var o=n.call(this,e)||this;return o.learningRate=e,o.momentum=r,o.useNesterov=a,o.accumulations=[],o.m=Se(o.momentum),o}return jr(t,n),t.prototype.applyGradients=function(e){var r=this;(Array.isArray(e)?e.map(function(a){return a.name}):Object.keys(e)).forEach(function(a,o){var u=Q.registeredVariables[a];r.accumulations[o]==null&&(r.accumulations[o]={originalName:a+"/momentum",variable:Ce(function(){return ot(u).variable(!1)})});var l=r.accumulations[o].variable,c=Array.isArray(e)?e[o].tensor:e[a];c!=null&&Ce(function(){var f,h=r.m.mul(l).add(c);f=r.useNesterov?r.c.mul(c.add(h.mul(r.m))).add(u):r.c.mul(h).add(u),l.assign(h),u.assign(f)})}),this.incrementIterations()},t.prototype.dispose=function(){this.m.dispose(),this.accumulations!=null&&Xn(this.accumulations.map(function(e){return e.variable}))},t.prototype.setMomentum=function(e){this.momentum=e},t.prototype.getWeights=function(){return Te(this,void 0,void 0,function(){return Ne(this,function(e){switch(e.label){case 0:return[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(this.accumulations.map(function(r){return{name:r.originalName,tensor:r.variable}}))]}})})},t.prototype.setWeights=function(e){return Te(this,void 0,void 0,function(){return Ne(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(e)];case 1:return e=r.sent(),this.accumulations=e.map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},t.fromConfig=function(e,r){return new e(r.learningRate,r.momentum,r.useNesterov)},t.className="Momentum",t}(aS);yi(eM);var tM=function(n){function t(e,r,a,o,u){r===void 0&&(r=.9),a===void 0&&(a=0),o===void 0&&(o=null),u===void 0&&(u=!1);var l=n.call(this)||this;if(l.learningRate=e,l.decay=r,l.momentum=a,l.epsilon=o,l.accumulatedMeanSquares=[],l.accumulatedMoments=[],l.accumulatedMeanGrads=[],l.centered=u,o==null&&(l.epsilon=Q.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.");return l}return jr(t,n),t.prototype.applyGradients=function(e){var r=this;(Array.isArray(e)?e.map(function(a){return a.name}):Object.keys(e)).forEach(function(a,o){var u=Q.registeredVariables[a];r.accumulatedMeanSquares[o]==null&&(r.accumulatedMeanSquares[o]={originalName:a+"/rms",variable:Ce(function(){return ot(u).variable(!1)})}),r.accumulatedMoments[o]==null&&(r.accumulatedMoments[o]={originalName:a+"/momentum",variable:Ce(function(){return ot(u).variable(!1)})}),r.accumulatedMeanGrads[o]==null&&r.centered&&(r.accumulatedMeanGrads[o]={originalName:a+"/mg",variable:Ce(function(){return ot(u).variable(!1)})});var l=Array.isArray(e)?e[o].tensor:e[a];if(l!=null){var c=r.accumulatedMeanSquares[o].variable,f=r.accumulatedMoments[o].variable;Ce(function(){var h=c.mul(r.decay).add(l.square().mul(1-r.decay));if(r.centered){var p=r.accumulatedMeanGrads[o].variable,m=p.mul(r.decay).add(l.mul(1-r.decay)),g=f.mul(r.momentum).add(l.mul(r.learningRate).div(h.sub(m.square().add(r.epsilon)).sqrt()));c.assign(h),p.assign(m),f.assign(g);var b=u.sub(g);u.assign(b)}else{var x=c.mul(r.decay).add(l.square().mul(1-r.decay));g=f.mul(r.momentum).add(l.mul(r.learningRate).div(x.add(r.epsilon).sqrt())),c.assign(x),f.assign(g),b=u.sub(g),u.assign(b)}})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedMeanSquares!=null&&Xn(this.accumulatedMeanSquares.map(function(e){return e.variable})),this.accumulatedMeanGrads!=null&&this.centered&&Xn(this.accumulatedMeanGrads.map(function(e){return e.variable})),this.accumulatedMoments!=null&&Xn(this.accumulatedMoments.map(function(e){return e.variable}))},t.prototype.getWeights=function(){return Te(this,void 0,void 0,function(){var e;return Ne(this,function(r){switch(r.label){case 0:return e=this.accumulatedMeanSquares.concat(this.accumulatedMoments),this.centered&&e.push.apply(e,this.accumulatedMeanGrads),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(e.map(function(a){return{name:a.originalName,tensor:a.variable}}))]}})})},t.prototype.setWeights=function(e){return Te(this,void 0,void 0,function(){var r;return Ne(this,function(a){switch(a.label){case 0:return[4,this.extractIterations(e)];case 1:return e=a.sent(),r=this.centered?e.length/3:e.length/2,this.accumulatedMeanSquares=e.slice(0,r).map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}}),this.accumulatedMoments=e.slice(r,2*r).map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}}),this.centered&&(this.accumulatedMeanGrads=e.slice(2*r,3*r).map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}})),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},t.fromConfig=function(e,r){return new e(r.learningRate,r.decay,r.momentum,r.epsilon,r.centered)},t.className="RMSProp",t}(bi);yi(tM);Mt.prototype.squaredDifference=function(n){return b2(this,n)},ue=A4;function ni(n,t,e){if(e===void 0&&(e=!1),n.beginPath(),t.slice(1).forEach(function(o,u){var l=o.x,c=o.y,f=t[u];n.moveTo(f.x,f.y),n.lineTo(l,c)}),e){var r=t[t.length-1],a=t[0];if(!r||!a)return;n.moveTo(r.x,r.y),n.lineTo(a.x,a.y)}n.stroke()}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Gv=function(n,t){return Gv=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var a in r)r.hasOwnProperty(a)&&(e[a]=r[a])},Gv(n,t)};function He(n,t){Gv(n,t);function e(){this.constructor=n}n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var Nn=function(){return Nn=Object.assign||function(t){for(var e,r=1,a=arguments.length;r<a;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},Nn.apply(this,arguments)};function Oe(n,t,e,r){function a(o){return o instanceof e?o:new e(function(u){u(o)})}return new(e||(e=Promise))(function(o,u){function l(h){try{f(r.next(h))}catch(p){u(p)}}function c(h){try{f(r.throw(h))}catch(p){u(p)}}function f(h){h.done?o(h.value):a(h.value).then(l,c)}f((r=r.apply(n,[])).next())})}function Ie(n,t){var e={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,a,o,u;return u={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function l(f){return function(h){return c([f,h])}}function c(f){if(r)throw new TypeError("Generator is already executing.");for(;e;)try{if(r=1,a&&(o=f[0]&2?a.return:f[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,f[1])).done)return o;switch(a=0,o&&(f=[f[0]&2,o.value]),f[0]){case 0:case 1:o=f;break;case 4:return e.label++,{value:f[1],done:!1};case 5:e.label++,a=f[1],f=[0];continue;case 7:f=e.ops.pop(),e.trys.pop();continue;default:if(o=e.trys,!(o=o.length>0&&o[o.length-1])&&(f[0]===6||f[0]===2)){e=0;continue}if(f[0]===3&&(!o||f[1]>o[0]&&f[1]<o[3])){e.label=f[1];break}if(f[0]===6&&e.label<o[1]){e.label=o[1],o=f;break}if(o&&e.label<o[2]){e.label=o[2],e.ops.push(f);break}o[2]&&e.ops.pop(),e.trys.pop();continue}f=t.call(n,e)}catch(h){f=[6,h],a=0}finally{r=o=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function $u(){for(var n=0,t=0,e=arguments.length;t<e;t++)n+=arguments[t].length;for(var r=Array(n),a=0,t=0;t<e;t++)for(var o=arguments[t],u=0,l=o.length;u<l;u++,a++)r[a]=o[u];return r}var li=function(){function n(t,e){if(!ci(t)||!ci(e))throw new Error("Dimensions.constructor - expected width and height to be valid numbers, instead have "+JSON.stringify({width:t,height:e}));this._width=t,this._height=e}return Object.defineProperty(n.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),n.prototype.reverse=function(){return new n(1/this.width,1/this.height)},n}();function rd(n,t){return n instanceof Mt&&n.shape.length===t}function nM(n){return rd(n,2)}function ad(n){return rd(n,3)}function _o(n){return rd(n,4)}function rM(n){return n%1!==0}function R1(n){return n%2===0}function oS(n,t){t===void 0&&(t=2);var e=Math.pow(10,t);return Math.floor(n*e)/e}function A1(n){return n&&n.width&&n.height}function aM(n,t){var e=n.width,r=n.height,a=t/Math.max(r,e);return new li(Math.round(e*a),Math.round(r*a))}function qm(n){return n.reduce(function(t,e){return t.add(e)},new ct(0,0)).div(new ct(n.length,n.length))}function al(n,t,e){return Array(n).fill(0).map(function(r,a){return t+a*e})}function ci(n){return!!n&&n!==1/0&&n!==-1/0&&!isNaN(n)||n===0}function T1(n){return ci(n)&&0<=n&&n<=1}var ct=function(){function n(t,e){this._x=t,this._y=e}return Object.defineProperty(n.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),n.prototype.add=function(t){return new n(this.x+t.x,this.y+t.y)},n.prototype.sub=function(t){return new n(this.x-t.x,this.y-t.y)},n.prototype.mul=function(t){return new n(this.x*t.x,this.y*t.y)},n.prototype.div=function(t){return new n(this.x/t.x,this.y/t.y)},n.prototype.abs=function(){return new n(Math.abs(this.x),Math.abs(this.y))},n.prototype.magnitude=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},n.prototype.floor=function(){return new n(Math.floor(this.x),Math.floor(this.y))},n}(),la=function(){function n(t,e){e===void 0&&(e=!0);var r=t||{},a=[r.left,r.top,r.right,r.bottom].every(ci),o=[r.x,r.y,r.width,r.height].every(ci);if(!o&&!a)throw new Error("Box.constructor - expected box to be IBoundingBox | IRect, instead have "+JSON.stringify(r));var u=o?[r.x,r.y,r.width,r.height]:[r.left,r.top,r.right-r.left,r.bottom-r.top],l=u[0],c=u[1],f=u[2],h=u[3];n.assertIsValidBox({x:l,y:c,width:f,height:h},"Box.constructor",e),this._x=l,this._y=c,this._width=f,this._height=h}return n.isRect=function(t){return!!t&&[t.x,t.y,t.width,t.height].every(ci)},n.assertIsValidBox=function(t,e,r){if(r===void 0&&(r=!1),!n.isRect(t))throw new Error(e+" - invalid box: "+JSON.stringify(t)+", expected object with properties x, y, width, height");if(!r&&(t.width<0||t.height<0))throw new Error(e+" - width ("+t.width+") and height ("+t.height+") must be positive numbers")},Object.defineProperty(n.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"area",{get:function(){return this.width*this.height},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"topLeft",{get:function(){return new ct(this.left,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"topRight",{get:function(){return new ct(this.right,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bottomLeft",{get:function(){return new ct(this.left,this.bottom)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bottomRight",{get:function(){return new ct(this.right,this.bottom)},enumerable:!0,configurable:!0}),n.prototype.round=function(){var t=[this.x,this.y,this.width,this.height].map(function(u){return Math.round(u)}),e=t[0],r=t[1],a=t[2],o=t[3];return new n({x:e,y:r,width:a,height:o})},n.prototype.floor=function(){var t=[this.x,this.y,this.width,this.height].map(function(u){return Math.floor(u)}),e=t[0],r=t[1],a=t[2],o=t[3];return new n({x:e,y:r,width:a,height:o})},n.prototype.toSquare=function(){var t=this,e=t.x,r=t.y,a=t.width,o=t.height,u=Math.abs(a-o);return a<o&&(e-=u/2,a+=u),o<a&&(r-=u/2,o+=u),new n({x:e,y:r,width:a,height:o})},n.prototype.rescale=function(t){var e=A1(t)?t.width:t,r=A1(t)?t.height:t;return new n({x:this.x*e,y:this.y*r,width:this.width*e,height:this.height*r})},n.prototype.pad=function(t,e){var r=[this.x-t/2,this.y-e/2,this.width+t,this.height+e],a=r[0],o=r[1],u=r[2],l=r[3];return new n({x:a,y:o,width:u,height:l})},n.prototype.clipAtImageBorders=function(t,e){var r=this,a=r.x,o=r.y,u=r.right,l=r.bottom,c=Math.max(a,0),f=Math.max(o,0),h=u-c,p=l-f,m=Math.min(h,t-c),g=Math.min(p,e-f);return new n({x:c,y:f,width:m,height:g}).floor()},n.prototype.shift=function(t,e){var r=this,a=r.width,o=r.height,u=this.x+t,l=this.y+e;return new n({x:u,y:l,width:a,height:o})},n.prototype.padAtBorders=function(t,e){var r=this.width+1,a=this.height+1,o=1,u=1,l=r,c=a,f=this.left,h=this.top,p=this.right,m=this.bottom;return p>e&&(l=-p+e+r,p=e),m>t&&(c=-m+t+a,m=t),f<1&&(c=2-f,f=1),h<1&&(c=2-h,h=1),{dy:u,edy:c,dx:o,edx:l,y:h,ey:m,x:f,ex:p,w:r,h:a}},n.prototype.calibrate=function(t){return new n({left:this.left+t.left*this.width,top:this.top+t.top*this.height,right:this.right+t.right*this.width,bottom:this.bottom+t.bottom*this.height}).toSquare().round()},n}(),od=function(n){He(t,n);function t(e,r,a,o,u){return u===void 0&&(u=!1),n.call(this,{left:e,top:r,right:a,bottom:o},u)||this}return t}(la),iS=function(){function n(t,e,r,a,o){this._imageDims=new li(o.width,o.height),this._score=t,this._classScore=e,this._className=r,this._box=new la(a).rescale(this._imageDims)}return Object.defineProperty(n.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"className",{get:function(){return this._className},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"box",{get:function(){return this._box},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"imageDims",{get:function(){return this._imageDims},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"imageWidth",{get:function(){return this.imageDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"imageHeight",{get:function(){return this.imageDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"relativeBox",{get:function(){return new la(this._box).rescale(this.imageDims.reverse())},enumerable:!0,configurable:!0}),n.prototype.forSize=function(t,e){return new n(this.score,this.classScore,this.className,this.relativeBox,{width:t,height:e})},n}(),dr=function(n){He(t,n);function t(e,r,a){return n.call(this,e,e,"",r,a)||this}return t.prototype.forSize=function(e,r){var a=n.prototype.forSize.call(this,e,r),o=a.score,u=a.relativeBox,l=a.imageDims;return new t(o,u,l)},t}(iS);function oM(n,t,e){e===void 0&&(e=!0);var r=Math.max(0,Math.min(n.right,t.right)-Math.max(n.left,t.left)),a=Math.max(0,Math.min(n.bottom,t.bottom)-Math.max(n.top,t.top)),o=r*a;return e?o/(n.area+t.area-o):o/Math.min(n.area,t.area)}function iM(n){var t=n.map(function(l){return l.x}),e=n.map(function(l){return l.y}),r=t.reduce(function(l,c){return c<l?c:l},1/0),a=e.reduce(function(l,c){return c<l?c:l},1/0),o=t.reduce(function(l,c){return l<c?c:l},0),u=e.reduce(function(l,c){return l<c?c:l},0);return new od(r,a,o,u)}function ol(n,t,e,r){r===void 0&&(r=!0);for(var a=t.map(function(l,c){return{score:l,boxIndex:c}}).sort(function(l,c){return l.score-c.score}).map(function(l){return l.boxIndex}),o=[],u=function(){var l=a.pop();o.push(l);for(var c=a,f=[],h=0;h<c.length;h++){var p=c[h],m=n[l],g=n[p];f.push(oM(m,g,r))}a=a.filter(function(b,x){return f[x]<=e})};a.length>0;)u();return o}function xl(n,t){return Ce(function(){var e=t[0],r=t[1],a=t[2],o=ia($u(n.shape.slice(0,3),[1]),e),u=ia($u(n.shape.slice(0,3),[1]),r),l=ia($u(n.shape.slice(0,3),[1]),a),c=nn([o,u,l],3);return on(n,c)})}function sM(n,t){return t===void 0&&(t=!1),Ce(function(){var e=n.shape.slice(1),r=e[0],a=e[1];if(r===a)return n;var o=Math.abs(r-a),u=Math.round(o*(t?.5:1)),l=r>a?2:1,c=function(g){var b=n.shape.slice();return b[l]=g,ia(b,0)},f=c(u),h=o-f.shape[l],p=t&&h?c(h):null,m=[p,n,f].filter(function(g){return!!g}).map(function(g){return g.toFloat()});return nn(m,l)})}function iv(n){return 1/(1+Math.exp(-n))}var Xm=function(n){He(t,n);function t(e,r,a,o,u){return u===void 0&&(u=!1),n.call(this,{x:e,y:r,width:a,height:o},u)||this}return t}(la),uM=.5,lM=.43,cM=.45,Os=function(){function n(t,e,r){r===void 0&&(r=new ct(0,0));var a=e.width,o=e.height;this._imgDims=new li(a,o),this._shift=r,this._positions=t.map(function(u){return u.mul(new ct(a,o)).add(r)})}return Object.defineProperty(n.prototype,"shift",{get:function(){return new ct(this._shift.x,this._shift.y)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"imageWidth",{get:function(){return this._imgDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"imageHeight",{get:function(){return this._imgDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"positions",{get:function(){return this._positions},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"relativePositions",{get:function(){var t=this;return this._positions.map(function(e){return e.sub(t._shift).div(new ct(t.imageWidth,t.imageHeight))})},enumerable:!0,configurable:!0}),n.prototype.forSize=function(t,e){return new this.constructor(this.relativePositions,{width:t,height:e})},n.prototype.shiftBy=function(t,e){return new this.constructor(this.relativePositions,this._imgDims,new ct(t,e))},n.prototype.shiftByPoint=function(t){return this.shiftBy(t.x,t.y)},n.prototype.align=function(t,e){if(e===void 0&&(e={}),t){var r=t instanceof dr?t.box.floor():new la(t);return this.shiftBy(r.x,r.y).align(null,e)}var a=Object.assign({},{useDlibAlignment:!1,minBoxPadding:.2},e),o=a.useDlibAlignment,u=a.minBoxPadding;return o?this.alignDlib():this.alignMinBbox(u)},n.prototype.alignDlib=function(){var t=this.getRefPointsForAlignment(),e=t[0],r=t[1],a=t[2],o=function(p){return a.sub(p).magnitude()},u=(o(e)+o(r))/2,l=Math.floor(u/cM),c=qm(t),f=Math.floor(Math.max(0,c.x-uM*l)),h=Math.floor(Math.max(0,c.y-lM*l));return new Xm(f,h,Math.min(l,this.imageWidth+f),Math.min(l,this.imageHeight+h))},n.prototype.alignMinBbox=function(t){var e=iM(this.positions);return e.pad(e.width*t,e.height*t)},n.prototype.getRefPointsForAlignment=function(){throw new Error("getRefPointsForAlignment not implemented by base class")},n}(),fM=function(n){He(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.getRefPointsForAlignment=function(){var e=this.positions;return[e[0],e[1],qm([e[3],e[4]])]},t}(Os),sS=function(n){He(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.getJawOutline=function(){return this.positions.slice(0,17)},t.prototype.getLeftEyeBrow=function(){return this.positions.slice(17,22)},t.prototype.getRightEyeBrow=function(){return this.positions.slice(22,27)},t.prototype.getNose=function(){return this.positions.slice(27,36)},t.prototype.getLeftEye=function(){return this.positions.slice(36,42)},t.prototype.getRightEye=function(){return this.positions.slice(42,48)},t.prototype.getMouth=function(){return this.positions.slice(48,68)},t.prototype.getRefPointsForAlignment=function(){return[this.getLeftEye(),this.getRightEye(),this.getMouth()].map(qm)},t}(Os),N1=function(){function n(t,e){this._label=t,this._distance=e}return Object.defineProperty(n.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"distance",{get:function(){return this._distance},enumerable:!0,configurable:!0}),n.prototype.toString=function(t){return t===void 0&&(t=!0),""+this.label+(t?" ("+oS(this.distance)+")":"")},n}(),D1=function(n){He(t,n);function t(e,r){var a=n.call(this,e)||this;return a._label=r,a}return t.assertIsValidLabeledBox=function(e,r){if(la.assertIsValidBox(e,r),!ci(e.label))throw new Error(r+" - expected property label ("+e.label+") to be a number")},Object.defineProperty(t.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),t}(la),ys=function(){function n(t,e){if(typeof t!="string")throw new Error("LabeledFaceDescriptors - constructor expected label to be a string");if(!Array.isArray(e)||e.some(function(r){return!(r instanceof Float32Array)}))throw new Error("LabeledFaceDescriptors - constructor expected descriptors to be an array of Float32Array");this._label=t,this._descriptors=e}return Object.defineProperty(n.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"descriptors",{get:function(){return this._descriptors},enumerable:!0,configurable:!0}),n.prototype.toJSON=function(){return{label:this.label,descriptors:this.descriptors.map(function(t){return Array.from(t)})}},n.fromJSON=function(t){var e=t.descriptors.map(function(r){return new Float32Array(r)});return new n(t.label,e)},n}();(function(n){He(t,n);function t(e,r,a,o){var u=n.call(this,e,r)||this;return u._score=a,u._classScore=o,u}return t.assertIsValidPredictedBox=function(e,r){if(D1.assertIsValidLabeledBox(e,r),!T1(e.score)||!T1(e.classScore))throw new Error(r+" - expected properties score ("+e.score+") and ("+e.classScore+") to be a number between [0, 1]")},Object.defineProperty(t.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),t})(D1);function Ff(n){return n.detection instanceof dr}function il(n,t){var e={detection:t};return Object.assign({},n,e)}function uS(){var n=window.fetch||function(){throw new Error("fetch - missing fetch implementation for browser environment")},t=function(){throw new Error("readFile - filesystem not available for browser environment")};return{Canvas:HTMLCanvasElement,CanvasRenderingContext2D,Image:HTMLImageElement,ImageData,Video:HTMLVideoElement,createCanvasElement:function(){return document.createElement("canvas")},createImageElement:function(){return document.createElement("img")},fetch:n,readFile:t}}function lS(n){var t="";if(!n)try{n=require("fs")}catch(r){t=r.toString()}var e=n?function(r){return new Promise(function(a,o){n.readFile(r,function(u,l){return u?o(u):a(l)})})}:function(){throw new Error("readFile - failed to require fs in nodejs environment with error: "+t)};return{readFile:e}}function cS(){var n=global.Canvas||global.HTMLCanvasElement,t=global.Image||global.HTMLImageElement,e=function(){if(n)return new n;throw new Error("createCanvasElement - missing Canvas implementation for nodejs environment")},r=function(){if(t)return new t;throw new Error("createImageElement - missing Image implementation for nodejs environment")},a=global.fetch||function(){throw new Error("fetch - missing fetch implementation for nodejs environment")},o=lS();return Nn({Canvas:n||function(){function u(){}return u}(),CanvasRenderingContext2D:global.CanvasRenderingContext2D||function(){function u(){}return u}(),Image:t||function(){function u(){}return u}(),ImageData:global.ImageData||function(){function u(){}return u}(),Video:global.HTMLVideoElement||function(){function u(){}return u}(),createCanvasElement:e,createImageElement:r,fetch:a},o)}function fS(){return typeof window=="object"&&typeof document<"u"&&typeof HTMLImageElement<"u"&&typeof HTMLCanvasElement<"u"&&typeof HTMLVideoElement<"u"&&typeof ImageData<"u"&&typeof CanvasRenderingContext2D<"u"}function dS(){return typeof global=="object"&&typeof require=="function"&&typeof a_<"u"&&typeof process<"u"&&!!process.version}var tn;function dM(){if(!tn)throw new Error("getEnv - environment is not defined, check isNodejs() and isBrowser()");return tn}function qv(n){tn=n}function Ym(){fS()&&qv(uS()),dS()&&qv(cS())}function hM(n){if(tn||Ym(),!tn)throw new Error("monkeyPatch - environment is not defined, check isNodejs() and isBrowser()");var t=n.Canvas,e=t===void 0?tn.Canvas:t,r=n.Image,a=r===void 0?tn.Image:r;tn.Canvas=e,tn.Image=a,tn.createCanvasElement=n.createCanvasElement||function(){return new e},tn.createImageElement=n.createImageElement||function(){return new a},tn.ImageData=n.ImageData||tn.ImageData,tn.Video=n.Video||tn.Video,tn.fetch=n.fetch||tn.fetch,tn.readFile=n.readFile||tn.readFile}var In={getEnv:dM,setEnv:qv,initialize:Ym,createBrowserEnv:uS,createFileSystem:lS,createNodejsEnv:cS,monkeyPatch:hM,isBrowser:fS,isNodejs:dS};Ym();function Km(n){return!In.isNodejs()&&typeof n=="string"?document.getElementById(n):n}function ca(n){var t=In.getEnv(),e=t.Canvas,r=t.CanvasRenderingContext2D;if(n instanceof r)return n;var a=Km(n);if(!(a instanceof e))throw new Error("resolveContext2d - expected canvas to be of instance of Canvas");var o=a.getContext("2d");if(!o)throw new Error("resolveContext2d - canvas 2d context is null");return o}var So;(function(n){n.TOP_LEFT="TOP_LEFT",n.TOP_RIGHT="TOP_RIGHT",n.BOTTOM_LEFT="BOTTOM_LEFT",n.BOTTOM_RIGHT="BOTTOM_RIGHT"})(So||(So={}));var hS=function(){function n(t){t===void 0&&(t={});var e=t.anchorPosition,r=t.backgroundColor,a=t.fontColor,o=t.fontSize,u=t.fontStyle,l=t.padding;this.anchorPosition=e||So.TOP_LEFT,this.backgroundColor=r||"rgba(0, 0, 0, 0.5)",this.fontColor=a||"rgba(255, 255, 255, 1)",this.fontSize=o||14,this.fontStyle=u||"Georgia",this.padding=l||4}return n}(),pM=function(){function n(t,e,r){r===void 0&&(r={}),this.text=typeof t=="string"?[t]:t instanceof n?t.text:t,this.anchor=e,this.options=new hS(r)}return n.prototype.measureWidth=function(t){var e=this.options.padding;return this.text.map(function(r){return t.measureText(r).width}).reduce(function(r,a){return r<a?a:r},0)+2*e},n.prototype.measureHeight=function(){var t=this.options,e=t.fontSize,r=t.padding;return this.text.length*e+2*r},n.prototype.getUpperLeft=function(t,e){var r=this.options.anchorPosition,a=r===So.BOTTOM_RIGHT||r===So.TOP_RIGHT,o=r===So.BOTTOM_LEFT||r===So.BOTTOM_RIGHT,u=this.measureWidth(t),l=this.measureHeight(),c=a?this.anchor.x-u:this.anchor.x,f=o?this.anchor.y-l:this.anchor.y;if(e){var h=e.width,p=e.height,m=Math.max(Math.min(c,h-u),0),g=Math.max(Math.min(f,p-l),0);return{x:m,y:g}}return{x:c,y:f}},n.prototype.draw=function(t){var e=Km(t),r=ca(e),a=this.options,o=a.backgroundColor,u=a.fontColor,l=a.fontSize,c=a.fontStyle,f=a.padding;r.font=l+"px "+c;var h=this.measureWidth(r),p=this.measureHeight();r.fillStyle=o;var m=this.getUpperLeft(r,e);r.fillRect(m.x,m.y,h,p),r.fillStyle=u,this.text.forEach(function(g,b){var x=f+m.x,w=f+m.y+(b+1)*l;r.fillText(g,x,w)})},n}(),vM=function(){function n(t){t===void 0&&(t={});var e=t.boxColor,r=t.lineWidth,a=t.label,o=t.drawLabelOptions;this.boxColor=e||"rgba(0, 0, 255, 1)",this.lineWidth=r||2,this.label=a;var u={anchorPosition:So.BOTTOM_LEFT,backgroundColor:this.boxColor};this.drawLabelOptions=new hS(Object.assign({},u,o))}return n}(),pS=function(){function n(t,e){e===void 0&&(e={}),this.box=new la(t),this.options=new vM(e)}return n.prototype.draw=function(t){var e=ca(t),r=this.options,a=r.boxColor,o=r.lineWidth,u=this.box,l=u.x,c=u.y,f=u.width,h=u.height;e.strokeStyle=a,e.lineWidth=o,e.strokeRect(l,c,f,h);var p=this.options.label;p&&new pM([p],{x:l-o/2,y:c},this.options.drawLabelOptions).draw(t)},n}();function mM(n,t){var e=Array.isArray(t)?t:[t];e.forEach(function(r){var a=r instanceof dr?r.score:Ff(r)?r.detection.score:void 0,o=r instanceof dr?r.box:Ff(r)?r.detection.box:new la(r),u=a?""+oS(a):void 0;new pS(o,{label:u}).draw(n)})}function vS(n){var t=In.getEnv(),e=t.Image,r=t.Video;return n instanceof e&&n.complete||n instanceof r&&n.readyState>=3}function gM(n){return new Promise(function(t,e){if(n instanceof In.getEnv().Canvas||vS(n))return t();function r(o){o.currentTarget&&(o.currentTarget.removeEventListener("load",r),o.currentTarget.removeEventListener("error",a),t(o))}function a(o){o.currentTarget&&(o.currentTarget.removeEventListener("load",r),o.currentTarget.removeEventListener("error",a),e(o))}n.addEventListener("load",r),n.addEventListener("error",a)})}function Qm(n){var t=In.getEnv(),e=t.Image,r=t.Video;return n instanceof e?new li(n.naturalWidth,n.naturalHeight):n instanceof r?new li(n.videoWidth,n.videoHeight):new li(n.width,n.height)}function id(n){var t=n.width,e=n.height,r=In.getEnv().createCanvasElement,a=r();return a.width=t,a.height=e,a}function $m(n,t){var e=In.getEnv().ImageData;if(!(n instanceof e)&&!vS(n))throw new Error("createCanvasFromMedia - media has not finished loading yet");var r=Qm(n),a=r.width,o=r.height,u=id({width:a,height:o});return n instanceof e?ca(u).putImageData(n,0,0):ca(u).drawImage(n,0,0,a,o),u}function yM(n,t){return Oe(this,void 0,void 0,function(){var e,r,a,o,u,l;return Ie(this,function(c){switch(c.label){case 0:return e=In.getEnv().createCanvasElement(),r=n.shape.slice(_o(n)?1:0),a=r[0],o=r[1],u=r[2],l=Ce(function(){return n.as3D(a,o,u).toInt()}),[4,Gm.toPixels(l,e)];case 1:return c.sent(),l.dispose(),[2,e]}})})}function k1(n){var t=In.getEnv(),e=t.Image,r=t.Canvas,a=t.Video;return n instanceof e||n instanceof r||n instanceof a}function bM(n,t,e){e===void 0&&(e=!1);var r=In.getEnv(),a=r.Image,o=r.Canvas;if(!(n instanceof a||n instanceof o))throw new Error("imageToSquare - expected arg0 to be HTMLImageElement | HTMLCanvasElement");var u=Qm(n),l=t/Math.max(u.height,u.width),c=l*u.width,f=l*u.height,h=id({width:t,height:t}),p=n instanceof o?n:$m(n),m=Math.abs(c-f)/2,g=e&&c<f?m:0,b=e&&f<c?m:0;return ca(h).drawImage(p,g,b,c,f),h}var Pf=function(){function n(t,e){var r=this;if(e===void 0&&(e=!1),this._imageTensors=[],this._canvases=[],this._treatAsBatchInput=!1,this._inputDimensions=[],!Array.isArray(t))throw new Error("NetInput.constructor - expected inputs to be an Array of TResolvedNetInput or to be instanceof tf.Tensor4D, instead have "+t);this._treatAsBatchInput=e,this._batchSize=t.length,t.forEach(function(a,o){if(ad(a)){r._imageTensors[o]=a,r._inputDimensions[o]=a.shape;return}if(_o(a)){var u=a.shape[0];if(u!==1)throw new Error("NetInput - tf.Tensor4D with batchSize "+u+" passed, but not supported in input array");r._imageTensors[o]=a,r._inputDimensions[o]=a.shape.slice(1);return}var l=a instanceof In.getEnv().Canvas?a:$m(a);r._canvases[o]=l,r._inputDimensions[o]=[l.height,l.width,3]})}return Object.defineProperty(n.prototype,"imageTensors",{get:function(){return this._imageTensors},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"canvases",{get:function(){return this._canvases},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isBatchInput",{get:function(){return this.batchSize>1||this._treatAsBatchInput},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"batchSize",{get:function(){return this._batchSize},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"inputDimensions",{get:function(){return this._inputDimensions},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"reshapedInputDimensions",{get:function(){var t=this;return al(this.batchSize,0,1).map(function(e,r){return t.getReshapedInputDimensions(r)})},enumerable:!0,configurable:!0}),n.prototype.getInput=function(t){return this.canvases[t]||this.imageTensors[t]},n.prototype.getInputDimensions=function(t){return this._inputDimensions[t]},n.prototype.getInputHeight=function(t){return this._inputDimensions[t][0]},n.prototype.getInputWidth=function(t){return this._inputDimensions[t][1]},n.prototype.getReshapedInputDimensions=function(t){if(typeof this.inputSize!="number")throw new Error("getReshapedInputDimensions - inputSize not set, toBatchTensor has not been called yet");var e=this.getInputWidth(t),r=this.getInputHeight(t);return aM({width:e,height:r},this.inputSize)},n.prototype.toBatchTensor=function(t,e){var r=this;return e===void 0&&(e=!0),this._inputSize=t,Ce(function(){var a=al(r.batchSize,0,1).map(function(u){var l=r.getInput(u);if(l instanceof Mt){var c=_o(l)?l:l.expandDims();return c=sM(c,e),(c.shape[1]!==t||c.shape[2]!==t)&&(c=zm.resizeBilinear(c,[t,t])),c.as3D(t,t,3)}if(l instanceof In.getEnv().Canvas)return Gm.fromPixels(bM(l,t,e));throw new Error("toBatchTensor - at batchIdx "+u+", expected input to be instanceof tf.Tensor or instanceof HTMLCanvasElement, instead have "+l)}),o=cr(a.map(function(u){return u.toFloat()})).as4D(r.batchSize,t,t,3);return o})},n}();function vn(n){return Oe(this,void 0,void 0,function(){var t,e,r;return Ie(this,function(a){switch(a.label){case 0:if(n instanceof Pf)return[2,n];if(t=Array.isArray(n)?n:[n],!t.length)throw new Error("toNetInput - empty array passed as input");return e=function(o){return Array.isArray(n)?" at input index "+o+":":""},r=t.map(Km),r.forEach(function(o,u){if(!k1(o)&&!ad(o)&&!_o(o))throw typeof t[u]=="string"?new Error("toNetInput -"+e(u)+" string passed, but could not resolve HTMLElement for element id "+t[u]):new Error("toNetInput -"+e(u)+" expected media to be of type HTMLImageElement | HTMLVideoElement | HTMLCanvasElement | tf.Tensor3D, or to be an element id");if(_o(o)){var l=o.shape[0];if(l!==1)throw new Error("toNetInput -"+e(u)+" tf.Tensor4D with batchSize "+l+" passed, but not supported in input array")}}),[4,Promise.all(r.map(function(o){return k1(o)&&gM(o)}))];case 1:return a.sent(),[2,new Pf(r,Array.isArray(n))]}})})}function Zm(n,t){return Oe(this,void 0,void 0,function(){var e,r,a,o,u,l,c;return Ie(this,function(f){switch(f.label){case 0:return e=In.getEnv().Canvas,r=n,n instanceof e?[3,5]:[4,vn(n)];case 1:if(a=f.sent(),a.batchSize>1)throw new Error("extractFaces - batchSize > 1 not supported");return o=a.getInput(0),o instanceof e?(u=o,[3,4]):[3,2];case 2:return[4,yM(o)];case 3:u=f.sent(),f.label=4;case 4:r=u,f.label=5;case 5:return l=ca(r),c=t.map(function(h){return h instanceof dr?h.forSize(r.width,r.height).box.floor():h}).map(function(h){return h.clipAtImageBorders(r.width,r.height)}),[2,c.map(function(h){var p=h.x,m=h.y,g=h.width,b=h.height,x=id({width:g,height:b});return ca(x).putImageData(l.getImageData(p,m,g,b),0,0),x})]}})})}function Jm(n,t){return Oe(this,void 0,void 0,function(){return Ie(this,function(e){if(!ad(n)&&!_o(n))throw new Error("extractFaceTensors - expected image tensor to be 3D or 4D");if(_o(n)&&n.shape[0]>1)throw new Error("extractFaceTensors - batchSize > 1 not supported");return[2,Ce(function(){var r=n.shape.slice(_o(n)?1:0),a=r[0],o=r[1],u=r[2],l=t.map(function(f){return f instanceof dr?f.forSize(o,a).box:f}).map(function(f){return f.clipAtImageBorders(o,a)}),c=l.map(function(f){var h=f.x,p=f.y,m=f.width,g=f.height;return U2(n.as3D(a,o,u),[p,h,0],[g,m,u])});return c})]})})}function xM(n,t){return Oe(this,void 0,void 0,function(){var e,r;return Ie(this,function(a){switch(a.label){case 0:return e=In.getEnv().fetch,[4,e(n,t)];case 1:if(r=a.sent(),!(r.status<400))throw new Error("failed to fetch: ("+r.status+") "+r.statusText+", from url: "+r.url);return[2,r]}})})}function wM(n){return Oe(this,void 0,void 0,function(){return Ie(this,function(t){switch(t.label){case 0:return[4,xM(n)];case 1:return[2,t.sent().json()]}})})}function mS(n,t){var e=t+"-weights_manifest.json";if(!n)return{modelBaseUri:"",manifestUri:e};if(n==="/")return{modelBaseUri:"/",manifestUri:"/"+e};var r=n.startsWith("http://")?"http://":n.startsWith("https://")?"https://":"";n=n.replace(r,"");var a=n.split("/").filter(function(l){return l}),o=n.endsWith(".json")?a[a.length-1]:e,u=r+(n.endsWith(".json")?a.slice(0,a.length-1):a).join("/");return u=n.startsWith("/")?"/"+u:u,{modelBaseUri:u,manifestUri:u==="/"?"/"+o:u+"/"+o}}function SM(n,t){return Oe(this,void 0,void 0,function(){var e,r,a,o;return Ie(this,function(u){switch(u.label){case 0:return e=mS(n,t),r=e.manifestUri,a=e.modelBaseUri,[4,wM(r)];case 1:return o=u.sent(),[2,rS.loadWeights(o,a)]}})})}function EM(n,t,e){e===void 0&&(e=!1);var r=e?Qm(t):t,a=r.width,o=r.height;return n.width=a,n.height=o,{width:a,height:o}}var Ha=function(){function n(t){this._name=t,this._params=void 0,this._paramMappings=[]}return Object.defineProperty(n.prototype,"params",{get:function(){return this._params},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"paramMappings",{get:function(){return this._paramMappings},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isLoaded",{get:function(){return!!this.params},enumerable:!0,configurable:!0}),n.prototype.getParamFromPath=function(t){var e=this.traversePropertyPath(t),r=e.obj,a=e.objProp;return r[a]},n.prototype.reassignParamFromPath=function(t,e){var r=this.traversePropertyPath(t),a=r.obj,o=r.objProp;a[o].dispose(),a[o]=e},n.prototype.getParamList=function(){var t=this;return this._paramMappings.map(function(e){var r=e.paramPath;return{path:r,tensor:t.getParamFromPath(r)}})},n.prototype.getTrainableParams=function(){return this.getParamList().filter(function(t){return t.tensor instanceof Ds})},n.prototype.getFrozenParams=function(){return this.getParamList().filter(function(t){return!(t.tensor instanceof Ds)})},n.prototype.variable=function(){var t=this;this.getFrozenParams().forEach(function(e){var r=e.path,a=e.tensor;t.reassignParamFromPath(r,a.variable())})},n.prototype.freeze=function(){var t=this;this.getTrainableParams().forEach(function(e){var r=e.path,a=e.tensor,o=En(a.dataSync());a.dispose(),t.reassignParamFromPath(r,o)})},n.prototype.dispose=function(t){t===void 0&&(t=!0),this.getParamList().forEach(function(e){if(t&&e.tensor.isDisposed)throw new Error("param tensor has already been disposed for path "+e.path);e.tensor.dispose()}),this._params=void 0},n.prototype.serializeParams=function(){return new Float32Array(this.getParamList().map(function(t){var e=t.tensor;return Array.from(e.dataSync())}).reduce(function(t,e){return t.concat(e)}))},n.prototype.load=function(t){return Oe(this,void 0,void 0,function(){return Ie(this,function(e){switch(e.label){case 0:return t instanceof Float32Array?(this.extractWeights(t),[2]):[4,this.loadFromUri(t)];case 1:return e.sent(),[2]}})})},n.prototype.loadFromUri=function(t){return Oe(this,void 0,void 0,function(){var e;return Ie(this,function(r){switch(r.label){case 0:if(t&&typeof t!="string")throw new Error(this._name+".loadFromUri - expected model uri");return[4,SM(t,this.getDefaultModelName())];case 1:return e=r.sent(),this.loadFromWeightMap(e),[2]}})})},n.prototype.loadFromDisk=function(t){return Oe(this,void 0,void 0,function(){var e,r,a,o,u,l,c,f,h,p;return Ie(this,function(m){switch(m.label){case 0:if(t&&typeof t!="string")throw new Error(this._name+".loadFromDisk - expected model file path");return e=In.getEnv().readFile,r=mS(t,this.getDefaultModelName()),a=r.manifestUri,o=r.modelBaseUri,u=function(g){return Promise.all(g.map(function(b){return e(b).then(function(x){return x.buffer})}))},l=rS.weightsLoaderFactory(u),h=(f=JSON).parse,[4,e(a)];case 1:return c=h.apply(f,[m.sent().toString()]),[4,l(c,o)];case 2:return p=m.sent(),this.loadFromWeightMap(p),[2]}})})},n.prototype.loadFromWeightMap=function(t){var e=this.extractParamsFromWeigthMap(t),r=e.paramMappings,a=e.params;this._paramMappings=r,this._params=a},n.prototype.extractWeights=function(t){var e=this.extractParams(t),r=e.paramMappings,a=e.params;this._paramMappings=r,this._params=a},n.prototype.traversePropertyPath=function(t){if(!this.params)throw new Error("traversePropertyPath - model has no loaded params");var e=t.split("/").reduce(function(o,u){if(!o.nextObj.hasOwnProperty(u))throw new Error("traversePropertyPath - object does not have property "+u+", for path "+t);return{obj:o.nextObj,objProp:u,nextObj:o.nextObj[u]}},{nextObj:this.params}),r=e.obj,a=e.objProp;if(!r||!a||!(r[a]instanceof Mt))throw new Error("traversePropertyPath - parameter is not a tensor, for path "+t);return{obj:r,objProp:a}},n}();function lr(n,t,e){return Ce(function(){var r=Im(n,t.depthwise_filter,t.pointwise_filter,e,"same");return r=$e(r,t.bias),r})}function sv(n,t,e){return e===void 0&&(e=!1),Ce(function(){var r=Ot(e?$e(Ar(n,t.conv0.filters,[2,2],"same"),t.conv0.bias):lr(n,t.conv0,[2,2])),a=lr(r,t.conv1,[1,1]),o=Ot($e(r,a)),u=lr(o,t.conv2,[1,1]);return Ot($e(r,$e(a,u)))})}function Kc(n,t,e,r){return e===void 0&&(e=!1),r===void 0&&(r=!0),Ce(function(){var a=Ot(e?$e(Ar(n,t.conv0.filters,r?[2,2]:[1,1],"same"),t.conv0.bias):lr(n,t.conv0,r?[2,2]:[1,1])),o=lr(a,t.conv1,[1,1]),u=Ot($e(a,o)),l=lr(u,t.conv2,[1,1]),c=Ot($e(a,$e(o,l))),f=lr(c,t.conv3,[1,1]);return Ot($e(a,$e(o,$e(l,f))))})}function Lr(n,t,e,r){return e===void 0&&(e="same"),r===void 0&&(r=!1),Ce(function(){var a=$e(Ar(n,t.filters,[1,1],e),t.bias);return r?Ot(a):a})}function Va(n,t){Object.keys(n).forEach(function(e){t.some(function(r){return r.originalPath===e})||n[e].dispose()})}function sd(n,t){return function(e,r,a,o){var u=Gn(n(e*r*a*a),[a,a,e,r]),l=Yt(n(r));return t.push({paramPath:o+"/filters"},{paramPath:o+"/bias"}),{filters:u,bias:l}}}function eg(n,t){return function(e,r,a){var o=Eo(n(e*r),[e,r]),u=Yt(n(r));return t.push({paramPath:a+"/weights"},{paramPath:a+"/bias"}),{weights:o,bias:u}}}var gS=function(){function n(t,e,r){this.depthwise_filter=t,this.pointwise_filter=e,this.bias=r}return n}();function tg(n,t){return function(e,r,a){var o=Gn(n(9*e),[3,3,e,1]),u=Gn(n(e*r),[1,1,e,r]),l=Yt(n(r));return t.push({paramPath:a+"/depthwise_filter"},{paramPath:a+"/pointwise_filter"},{paramPath:a+"/bias"}),new gS(o,u,l)}}function ng(n){return function(t){var e=n(t+"/depthwise_filter",4),r=n(t+"/pointwise_filter",4),a=n(t+"/bias",1);return new gS(e,r,a)}}function Mo(n,t){return function(e,r,a){var o=n[e];if(!rd(o,r))throw new Error("expected weightMap["+e+"] to be a Tensor"+r+"D, instead have "+o);return t.push({originalPath:e,paramPath:a||e}),o}}function Wa(n){var t=n;function e(a){var o=t.slice(0,a);return t=t.slice(a),o}function r(){return t}return{extractWeights:e,getRemainingWeights:r}}function yS(n,t){var e=sd(n,t),r=tg(n,t);function a(u,l,c,f){f===void 0&&(f=!1);var h=f?e(u,l,3,c+"/conv0"):r(u,l,c+"/conv0"),p=r(l,l,c+"/conv1"),m=r(l,l,c+"/conv2");return{conv0:h,conv1:p,conv2:m}}function o(u,l,c,f){f===void 0&&(f=!1);var h=a(u,l,c,f),p=h.conv0,m=h.conv1,g=h.conv2,b=r(l,l,c+"/conv3");return{conv0:p,conv1:m,conv2:g,conv3:b}}return{extractDenseBlock3Params:a,extractDenseBlock4Params:o}}function CM(n){var t=[],e=Wa(n),r=e.extractWeights,a=e.getRemainingWeights,o=yS(r,t).extractDenseBlock4Params,u=o(3,32,"dense0",!0),l=o(32,64,"dense1"),c=o(64,128,"dense2"),f=o(128,256,"dense3");if(a().length!==0)throw new Error("weights remaing after extract: "+a().length);return{paramMappings:t,params:{dense0:u,dense1:l,dense2:c,dense3:f}}}function bS(n){return function(t){var e=n(t+"/filters",4),r=n(t+"/bias",1);return{filters:e,bias:r}}}function xS(n,t){var e=Mo(n,t),r=bS(e),a=ng(e);function o(l,c){c===void 0&&(c=!1);var f=c?r(l+"/conv0"):a(l+"/conv0"),h=a(l+"/conv1"),p=a(l+"/conv2");return{conv0:f,conv1:h,conv2:p}}function u(l,c){c===void 0&&(c=!1);var f=c?r(l+"/conv0"):a(l+"/conv0"),h=a(l+"/conv1"),p=a(l+"/conv2"),m=a(l+"/conv3");return{conv0:f,conv1:h,conv2:p,conv3:m}}return{extractDenseBlock3Params:o,extractDenseBlock4Params:u}}function _M(n){var t=[],e=xS(n,t).extractDenseBlock4Params,r={dense0:e("dense0",!0),dense1:e("dense1"),dense2:e("dense2"),dense3:e("dense3")};return Va(n,t),{params:r,paramMappings:t}}var wS=function(n){He(t,n);function t(){return n.call(this,"FaceFeatureExtractor")||this}return t.prototype.forwardInput=function(e){var r=this.params;if(!r)throw new Error("FaceFeatureExtractor - load model before inference");return Ce(function(){var a=e.toBatchTensor(112,!0),o=[122.782,117.001,104.298],u=xl(a,o).div(Se(255)),l=Kc(u,r.dense0,!0);return l=Kc(l,r.dense1),l=Kc(l,r.dense2),l=Kc(l,r.dense3),l=yl(l,[7,7],[2,2],"valid"),l})},t.prototype.forward=function(e){return Oe(this,void 0,void 0,function(){var r;return Ie(this,function(a){switch(a.label){case 0:return r=this.forwardInput,[4,vn(e)];case 1:return[2,r.apply(this,[a.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"face_feature_extractor_model"},t.prototype.extractParamsFromWeigthMap=function(e){return _M(e)},t.prototype.extractParams=function(e){return CM(e)},t}(Ha);function na(n,t){return Ce(function(){return $e(ed(n,t.weights),t.bias)})}function RM(n,t,e){var r=[],a=Wa(n),o=a.extractWeights,u=a.getRemainingWeights,l=eg(o,r),c=l(t,e,"fc");if(u().length!==0)throw new Error("weights remaing after extract: "+u().length);return{paramMappings:r,params:{fc:c}}}function AM(n){var t=[],e=Mo(n,t);function r(o){var u=e(o+"/weights",2),l=e(o+"/bias",1);return{weights:u,bias:l}}var a={fc:r("fc")};return Va(n,t),{params:a,paramMappings:t}}function SS(n){var t={},e={};return Object.keys(n).forEach(function(r){var a=r.startsWith("fc")?e:t;a[r]=n[r]}),{featureExtractorMap:t,classifierMap:e}}var ES=function(n){He(t,n);function t(e,r){var a=n.call(this,e)||this;return a._faceFeatureExtractor=r,a}return Object.defineProperty(t.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),t.prototype.runNet=function(e){var r=this,a=this.params;if(!a)throw new Error(this._name+" - load model before inference");return Ce(function(){var o=e instanceof Pf?r.faceFeatureExtractor.forwardInput(e):e;return na(o.as2D(o.shape[0],-1),a.fc)})},t.prototype.dispose=function(e){e===void 0&&(e=!0),this.faceFeatureExtractor.dispose(e),n.prototype.dispose.call(this,e)},t.prototype.loadClassifierParams=function(e){var r=this.extractClassifierParams(e),a=r.params,o=r.paramMappings;this._params=a,this._paramMappings=o},t.prototype.extractClassifierParams=function(e){return RM(e,this.getClassifierChannelsIn(),this.getClassifierChannelsOut())},t.prototype.extractParamsFromWeigthMap=function(e){var r=SS(e),a=r.featureExtractorMap,o=r.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(a),AM(o)},t.prototype.extractParams=function(e){var r=this.getClassifierChannelsIn(),a=this.getClassifierChannelsOut(),o=a*r+a,u=e.slice(0,e.length-o),l=e.slice(e.length-o);return this.faceFeatureExtractor.extractWeights(u),this.extractClassifierParams(l)},t}(Ha),M1=["neutral","happy","sad","angry","fearful","disgusted","surprised"],TM=function(){function n(t){var e=this;if(t.length!==7)throw new Error("FaceExpressions.constructor - expected probabilities.length to be 7, have: "+t.length);M1.forEach(function(r,a){e[r]=t[a]})}return n.prototype.asSortedArray=function(){var t=this;return M1.map(function(e){return{expression:e,probability:t[e]}}).sort(function(e,r){return r.probability-e.probability})},n}(),NM=function(n){He(t,n);function t(e){return e===void 0&&(e=new wS),n.call(this,"FaceExpressionNet",e)||this}return t.prototype.forwardInput=function(e){var r=this;return Ce(function(){return Ua(r.runNet(e))})},t.prototype.forward=function(e){return Oe(this,void 0,void 0,function(){var r;return Ie(this,function(a){switch(a.label){case 0:return r=this.forwardInput,[4,vn(e)];case 1:return[2,r.apply(this,[a.sent()])]}})})},t.prototype.predictExpressions=function(e){return Oe(this,void 0,void 0,function(){var r,a,o,u,l=this;return Ie(this,function(c){switch(c.label){case 0:return[4,vn(e)];case 1:return r=c.sent(),[4,this.forwardInput(r)];case 2:return a=c.sent(),[4,Promise.all(rn(a).map(function(f){return Oe(l,void 0,void 0,function(){var h;return Ie(this,function(p){switch(p.label){case 0:return[4,f.data()];case 1:return h=p.sent(),f.dispose(),[2,h]}})})}))];case 3:return o=c.sent(),a.dispose(),u=o.map(function(f){return new TM(f)}),[2,r.isBatchInput?u:u[0]]}})})},t.prototype.getDefaultModelName=function(){return"face_expression_model"},t.prototype.getClassifierChannelsIn=function(){return 256},t.prototype.getClassifierChannelsOut=function(){return 7},t}(ES);function CS(n,t){var e={expressions:t};return Object.assign({},n,e)}function rg(n){return Ff(n)&&n.landmarks instanceof Os&&n.unshiftedLandmarks instanceof Os&&n.alignedRect instanceof dr}function ud(n,t){var e=n.detection.box,r=t.shiftBy(e.x,e.y),a=r.align(),o=n.detection.imageDims,u=new dr(n.detection.score,a.rescale(o.reverse()),o),l={landmarks:r,unshiftedLandmarks:t,alignedRect:u};return Object.assign({},n,l)}var DM=function(){function n(t){t===void 0&&(t={});var e=t.drawLines,r=e===void 0?!0:e,a=t.drawPoints,o=a===void 0?!0:a,u=t.lineWidth,l=t.lineColor,c=t.pointSize,f=t.pointColor;this.drawLines=r,this.drawPoints=o,this.lineWidth=u||1,this.pointSize=c||2,this.lineColor=l||"rgba(0, 255, 255, 1)",this.pointColor=f||"rgba(255, 0, 255, 1)"}return n}(),kM=function(){function n(t,e){e===void 0&&(e={}),this.faceLandmarks=t,this.options=new DM(e)}return n.prototype.draw=function(t){var e=ca(t),r=this.options,a=r.drawLines,o=r.drawPoints,u=r.lineWidth,l=r.lineColor,c=r.pointSize,f=r.pointColor;if(a&&this.faceLandmarks instanceof sS&&(e.strokeStyle=l,e.lineWidth=u,ni(e,this.faceLandmarks.getJawOutline()),ni(e,this.faceLandmarks.getLeftEyeBrow()),ni(e,this.faceLandmarks.getRightEyeBrow()),ni(e,this.faceLandmarks.getNose()),ni(e,this.faceLandmarks.getLeftEye(),!0),ni(e,this.faceLandmarks.getRightEye(),!0),ni(e,this.faceLandmarks.getMouth(),!0)),o){e.strokeStyle=f,e.fillStyle=f;var h=function(p){e.beginPath(),e.arc(p.x,p.y,c,0,2*Math.PI),e.fill()};this.faceLandmarks.positions.forEach(h)}},n}();function MM(n,t){var e=Array.isArray(t)?t:[t];e.forEach(function(r){var a=r instanceof Os?r:rg(r)?r.landmarks:void 0;if(!a)throw new Error("drawFaceLandmarks - expected faceExpressions to be FaceLandmarks | WithFaceLandmarks<WithFaceDetection<{}>> or array thereof");new kM(a).draw(n)})}function OM(n,t){var e=sd(n,t),r=tg(n,t);function a(u,l,c){var f=r(u,l,c+"/separable_conv0"),h=r(l,l,c+"/separable_conv1"),p=e(u,l,1,c+"/expansion_conv");return{separable_conv0:f,separable_conv1:h,expansion_conv:p}}function o(u,l){var c=r(u,u,l+"/separable_conv0"),f=r(u,u,l+"/separable_conv1"),h=r(u,u,l+"/separable_conv2");return{separable_conv0:c,separable_conv1:f,separable_conv2:h}}return{extractConvParams:e,extractSeparableConvParams:r,extractReductionBlockParams:a,extractMainBlockParams:o}}function IM(n,t){var e=[],r=Wa(n),a=r.extractWeights,o=r.getRemainingWeights,u=OM(a,e),l=u.extractConvParams,c=u.extractSeparableConvParams,f=u.extractReductionBlockParams,h=u.extractMainBlockParams,p=l(3,32,3,"entry_flow/conv_in"),m=f(32,64,"entry_flow/reduction_block_0"),g=f(64,128,"entry_flow/reduction_block_1"),b={conv_in:p,reduction_block_0:m,reduction_block_1:g},x={};al(t,0,1).forEach(function(_){x["main_block_"+_]=h(128,"middle_flow/main_block_"+_)});var w=f(128,256,"exit_flow/reduction_block"),E=c(256,512,"exit_flow/separable_conv"),C={reduction_block:w,separable_conv:E};if(o().length!==0)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:e,params:{entry_flow:b,middle_flow:x,exit_flow:C}}}function BM(n,t){var e=Mo(n,t),r=bS(e),a=ng(e);function o(l){var c=a(l+"/separable_conv0"),f=a(l+"/separable_conv1"),h=r(l+"/expansion_conv");return{separable_conv0:c,separable_conv1:f,expansion_conv:h}}function u(l){var c=a(l+"/separable_conv0"),f=a(l+"/separable_conv1"),h=a(l+"/separable_conv2");return{separable_conv0:c,separable_conv1:f,separable_conv2:h}}return{extractConvParams:r,extractSeparableConvParams:a,extractReductionBlockParams:o,extractMainBlockParams:u}}function FM(n,t){var e=[],r=BM(n,e),a=r.extractConvParams,o=r.extractSeparableConvParams,u=r.extractReductionBlockParams,l=r.extractMainBlockParams,c=a("entry_flow/conv_in"),f=u("entry_flow/reduction_block_0"),h=u("entry_flow/reduction_block_1"),p={conv_in:c,reduction_block_0:f,reduction_block_1:h},m={};al(t,0,1).forEach(function(w){m["main_block_"+w]=l("middle_flow/main_block_"+w)});var g=u("exit_flow/reduction_block"),b=o("exit_flow/separable_conv"),x={reduction_block:g,separable_conv:b};return Va(n,e),{params:{entry_flow:p,middle_flow:m,exit_flow:x},paramMappings:e}}function _S(n,t,e){return $e(Ar(n,t.filters,e,"same"),t.bias)}function uv(n,t,e){e===void 0&&(e=!0);var r=e?Ot(n):n;return r=lr(r,t.separable_conv0,[1,1]),r=lr(Ot(r),t.separable_conv1,[1,1]),r=hn(r,[3,3],[2,2],"same"),r=$e(r,_S(n,t.expansion_conv,[2,2])),r}function PM(n,t){var e=lr(Ot(n),t.separable_conv0,[1,1]);return e=lr(Ot(e),t.separable_conv1,[1,1]),e=lr(Ot(e),t.separable_conv2,[1,1]),e=$e(e,n),e}var LM=function(n){He(t,n);function t(e){var r=n.call(this,"TinyXception")||this;return r._numMainBlocks=e,r}return t.prototype.forwardInput=function(e){var r=this,a=this.params;if(!a)throw new Error("TinyXception - load model before inference");return Ce(function(){var o=e.toBatchTensor(112,!0),u=[122.782,117.001,104.298],l=xl(o,u).div(Se(256)),c=Ot(_S(l,a.entry_flow.conv_in,[2,2]));return c=uv(c,a.entry_flow.reduction_block_0,!1),c=uv(c,a.entry_flow.reduction_block_1),al(r._numMainBlocks,0,1).forEach(function(f){c=PM(c,a.middle_flow["main_block_"+f])}),c=uv(c,a.exit_flow.reduction_block),c=Ot(lr(c,a.exit_flow.separable_conv,[1,1])),c})},t.prototype.forward=function(e){return Oe(this,void 0,void 0,function(){var r;return Ie(this,function(a){switch(a.label){case 0:return r=this.forwardInput,[4,vn(e)];case 1:return[2,r.apply(this,[a.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"tiny_xception_model"},t.prototype.extractParamsFromWeigthMap=function(e){return FM(e,this._numMainBlocks)},t.prototype.extractParams=function(e){return IM(e,this._numMainBlocks)},t}(Ha);function zM(n){var t=[],e=Wa(n),r=e.extractWeights,a=e.getRemainingWeights,o=eg(r,t),u=o(512,1,"fc/age"),l=o(512,2,"fc/gender");if(a().length!==0)throw new Error("weights remaing after extract: "+a().length);return{paramMappings:t,params:{fc:{age:u,gender:l}}}}function UM(n){var t=[],e=Mo(n,t);function r(o){var u=e(o+"/weights",2),l=e(o+"/bias",1);return{weights:u,bias:l}}var a={fc:{age:r("fc/age"),gender:r("fc/gender")}};return Va(n,t),{params:a,paramMappings:t}}var Lf;(function(n){n.FEMALE="female",n.MALE="male"})(Lf||(Lf={}));var jM=function(n){He(t,n);function t(e){e===void 0&&(e=new LM(2));var r=n.call(this,"AgeGenderNet")||this;return r._faceFeatureExtractor=e,r}return Object.defineProperty(t.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),t.prototype.runNet=function(e){var r=this,a=this.params;if(!a)throw new Error(this._name+" - load model before inference");return Ce(function(){var o=e instanceof Pf?r.faceFeatureExtractor.forwardInput(e):e,u=yl(o,[7,7],[2,2],"valid").as2D(o.shape[0],-1),l=na(u,a.fc.age).as1D(),c=na(u,a.fc.gender);return{age:l,gender:c}})},t.prototype.forwardInput=function(e){var r=this;return Ce(function(){var a=r.runNet(e),o=a.age,u=a.gender;return{age:o,gender:Ua(u)}})},t.prototype.forward=function(e){return Oe(this,void 0,void 0,function(){var r;return Ie(this,function(a){switch(a.label){case 0:return r=this.forwardInput,[4,vn(e)];case 1:return[2,r.apply(this,[a.sent()])]}})})},t.prototype.predictAgeAndGender=function(e){return Oe(this,void 0,void 0,function(){var r,a,o,u,l,c,f=this;return Ie(this,function(h){switch(h.label){case 0:return[4,vn(e)];case 1:return r=h.sent(),[4,this.forwardInput(r)];case 2:return a=h.sent(),o=rn(a.age),u=rn(a.gender),l=o.map(function(p,m){return{ageTensor:p,genderTensor:u[m]}}),[4,Promise.all(l.map(function(p){var m=p.ageTensor,g=p.genderTensor;return Oe(f,void 0,void 0,function(){var b,x,w,E,C;return Ie(this,function(_){switch(_.label){case 0:return[4,m.data()];case 1:return b=_.sent()[0],[4,g.data()];case 2:return x=_.sent()[0],w=x>.5,E=w?Lf.MALE:Lf.FEMALE,C=w?x:1-x,m.dispose(),g.dispose(),[2,{age:b,gender:E,genderProbability:C}]}})})}))];case 3:return c=h.sent(),a.age.dispose(),a.gender.dispose(),[2,r.isBatchInput?c:c[0]]}})})},t.prototype.getDefaultModelName=function(){return"age_gender_model"},t.prototype.dispose=function(e){e===void 0&&(e=!0),this.faceFeatureExtractor.dispose(e),n.prototype.dispose.call(this,e)},t.prototype.loadClassifierParams=function(e){var r=this.extractClassifierParams(e),a=r.params,o=r.paramMappings;this._params=a,this._paramMappings=o},t.prototype.extractClassifierParams=function(e){return zM(e)},t.prototype.extractParamsFromWeigthMap=function(e){var r=SS(e),a=r.featureExtractorMap,o=r.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(a),UM(o)},t.prototype.extractParams=function(e){var r=1539,a=e.slice(0,e.length-r),o=e.slice(e.length-r);return this.faceFeatureExtractor.extractWeights(a),this.extractClassifierParams(o)},t}(Ha),RS=function(n){He(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.postProcess=function(e,r,a){var o=a.map(function(l){var c=l.width,f=l.height,h=r/Math.max(f,c);return{width:c*h,height:f*h}}),u=o.length;return Ce(function(){var l=function(m,g){return cr([ia([68],m),ia([68],g)],1).as2D(1,136).as1D()},c=function(m,g){var b=o[m],x=b.width,w=b.height;return g(x,w)?Math.abs(x-w)/2:0},f=function(m){return c(m,function(g,b){return g<b})},h=function(m){return c(m,function(g,b){return b<g})},p=e.mul(ia([u,136],r)).sub(cr(Array.from(Array(u),function(m,g){return l(f(g),h(g))}))).div(cr(Array.from(Array(u),function(m,g){return l(o[g].width,o[g].height)})));return p})},t.prototype.forwardInput=function(e){var r=this;return Ce(function(){var a=r.runNet(e);return r.postProcess(a,e.inputSize,e.inputDimensions.map(function(o){var u=o[0],l=o[1];return{height:u,width:l}}))})},t.prototype.forward=function(e){return Oe(this,void 0,void 0,function(){var r;return Ie(this,function(a){switch(a.label){case 0:return r=this.forwardInput,[4,vn(e)];case 1:return[2,r.apply(this,[a.sent()])]}})})},t.prototype.detectLandmarks=function(e){return Oe(this,void 0,void 0,function(){var r,a,o,u=this;return Ie(this,function(l){switch(l.label){case 0:return[4,vn(e)];case 1:return r=l.sent(),a=Ce(function(){return rn(u.forwardInput(r))}),[4,Promise.all(a.map(function(c,f){return Oe(u,void 0,void 0,function(){var h,p,m,g,b;return Ie(this,function(x){switch(x.label){case 0:return m=(p=Array).from,[4,c.data()];case 1:return h=m.apply(p,[x.sent()]),g=h.filter(function(w,E){return R1(E)}),b=h.filter(function(w,E){return!R1(E)}),[2,new sS(Array(68).fill(0).map(function(w,E){return new ct(g[E],b[E])}),{height:r.getInputHeight(f),width:r.getInputWidth(f)})]}})})}))];case 2:return o=l.sent(),a.forEach(function(c){return c.dispose()}),[2,r.isBatchInput?o:o[0]]}})})},t.prototype.getClassifierChannelsOut=function(){return 136},t}(ES),AS=function(n){He(t,n);function t(e){return e===void 0&&(e=new wS),n.call(this,"FaceLandmark68Net",e)||this}return t.prototype.getDefaultModelName=function(){return"face_landmark_68_model"},t.prototype.getClassifierChannelsIn=function(){return 256},t}(RS);function HM(n){var t=[],e=xS(n,t).extractDenseBlock3Params,r={dense0:e("dense0",!0),dense1:e("dense1"),dense2:e("dense2")};return Va(n,t),{params:r,paramMappings:t}}function VM(n){var t=[],e=Wa(n),r=e.extractWeights,a=e.getRemainingWeights,o=yS(r,t).extractDenseBlock3Params,u=o(3,32,"dense0",!0),l=o(32,64,"dense1"),c=o(64,128,"dense2");if(a().length!==0)throw new Error("weights remaing after extract: "+a().length);return{paramMappings:t,params:{dense0:u,dense1:l,dense2:c}}}var WM=function(n){He(t,n);function t(){return n.call(this,"TinyFaceFeatureExtractor")||this}return t.prototype.forwardInput=function(e){var r=this.params;if(!r)throw new Error("TinyFaceFeatureExtractor - load model before inference");return Ce(function(){var a=e.toBatchTensor(112,!0),o=[122.782,117.001,104.298],u=xl(a,o).div(Se(255)),l=sv(u,r.dense0,!0);return l=sv(l,r.dense1),l=sv(l,r.dense2),l=yl(l,[14,14],[2,2],"valid"),l})},t.prototype.forward=function(e){return Oe(this,void 0,void 0,function(){var r;return Ie(this,function(a){switch(a.label){case 0:return r=this.forwardInput,[4,vn(e)];case 1:return[2,r.apply(this,[a.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"face_feature_extractor_tiny_model"},t.prototype.extractParamsFromWeigthMap=function(e){return HM(e)},t.prototype.extractParams=function(e){return VM(e)},t}(Ha),GM=function(n){He(t,n);function t(e){return e===void 0&&(e=new WM),n.call(this,"FaceLandmark68TinyNet",e)||this}return t.prototype.getDefaultModelName=function(){return"face_landmark_68_tiny_model"},t.prototype.getClassifierChannelsIn=function(){return 128},t}(RS);(function(n){He(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t})(AS);function qM(n,t){return $e(Mn(n,t.weights),t.biases)}function ag(n,t,e,r,a){a===void 0&&(a="same");var o=t.conv,u=o.filters,l=o.bias,c=Ar(n,u,e,a);return c=$e(c,l),c=qM(c,t.scale),r?Ot(c):c}function XM(n,t){return ag(n,t,[1,1],!0)}function TS(n,t){return ag(n,t,[1,1],!1)}function NS(n,t){return ag(n,t,[2,2],!0,"valid")}function YM(n,t){function e(l,c,f){var h=n(l),p=h.length/(c*f*f);if(rM(p))throw new Error("depth has to be an integer: "+p+", weights.length: "+h.length+", numFilters: "+c+", filterSize: "+f);return Ce(function(){return Ao(Gn(h,[c,p,f,f]),[2,3,1,0])})}function r(l,c,f,h){var p=e(l,c,f),m=Yt(n(c));return t.push({paramPath:h+"/filters"},{paramPath:h+"/bias"}),{filters:p,bias:m}}function a(l,c){var f=Yt(n(l)),h=Yt(n(l));return t.push({paramPath:c+"/weights"},{paramPath:c+"/biases"}),{weights:f,biases:h}}function o(l,c,f,h){var p=r(l,c,f,h+"/conv"),m=a(c,h+"/scale");return{conv:p,scale:m}}function u(l,c,f,h,p){p===void 0&&(p=!1);var m=o((p?.5:1)*l,c,f,h+"/conv1"),g=o(l,c,f,h+"/conv2");return{conv1:m,conv2:g}}return{extractConvLayerParams:o,extractResidualLayerParams:u}}function KM(n){var t=Wa(n),e=t.extractWeights,r=t.getRemainingWeights,a=[],o=YM(e,a),u=o.extractConvLayerParams,l=o.extractResidualLayerParams,c=u(4704,32,7,"conv32_down"),f=l(9216,32,3,"conv32_1"),h=l(9216,32,3,"conv32_2"),p=l(9216,32,3,"conv32_3"),m=l(36864,64,3,"conv64_down",!0),g=l(36864,64,3,"conv64_1"),b=l(36864,64,3,"conv64_2"),x=l(36864,64,3,"conv64_3"),w=l(147456,128,3,"conv128_down",!0),E=l(147456,128,3,"conv128_1"),C=l(147456,128,3,"conv128_2"),_=l(589824,256,3,"conv256_down",!0),R=l(589824,256,3,"conv256_1"),A=l(589824,256,3,"conv256_2"),D=l(589824,256,3,"conv256_down_out"),M=Ce(function(){return Ao(Eo(e(256*128),[128,256]),[1,0])});if(a.push({paramPath:"fc"}),r().length!==0)throw new Error("weights remaing after extract: "+r().length);var k={conv32_down:c,conv32_1:f,conv32_2:h,conv32_3:p,conv64_down:m,conv64_1:g,conv64_2:b,conv64_3:x,conv128_down:w,conv128_1:E,conv128_2:C,conv256_down:_,conv256_1:R,conv256_2:A,conv256_down_out:D,fc:M};return{params:k,paramMappings:a}}function QM(n,t){var e=Mo(n,t);function r(u){var l=e(u+"/scale/weights",1),c=e(u+"/scale/biases",1);return{weights:l,biases:c}}function a(u){var l=e(u+"/conv/filters",4),c=e(u+"/conv/bias",1),f=r(u);return{conv:{filters:l,bias:c},scale:f}}function o(u){return{conv1:a(u+"/conv1"),conv2:a(u+"/conv2")}}return{extractConvLayerParams:a,extractResidualLayerParams:o}}function $M(n){var t=[],e=QM(n,t),r=e.extractConvLayerParams,a=e.extractResidualLayerParams,o=r("conv32_down"),u=a("conv32_1"),l=a("conv32_2"),c=a("conv32_3"),f=a("conv64_down"),h=a("conv64_1"),p=a("conv64_2"),m=a("conv64_3"),g=a("conv128_down"),b=a("conv128_1"),x=a("conv128_2"),w=a("conv256_down"),E=a("conv256_1"),C=a("conv256_2"),_=a("conv256_down_out"),R=n.fc;if(t.push({originalPath:"fc",paramPath:"fc"}),!nM(R))throw new Error("expected weightMap[fc] to be a Tensor2D, instead have "+R);var A={conv32_down:o,conv32_1:u,conv32_2:l,conv32_3:c,conv64_down:f,conv64_1:h,conv64_2:p,conv64_3:m,conv128_down:g,conv128_1:b,conv128_2:x,conv256_down:w,conv256_1:E,conv256_2:C,conv256_down_out:_,fc:R};return Va(n,t),{params:A,paramMappings:t}}function Kr(n,t){var e=XM(n,t.conv1);return e=TS(e,t.conv2),e=$e(e,n),e=Ot(e),e}function Qc(n,t){var e=NS(n,t.conv1);e=TS(e,t.conv2);var r=yl(n,2,2,"valid"),a=_t(r.shape),o=r.shape[3]!==e.shape[3],u=r.shape[1]!==e.shape[1]||r.shape[2]!==e.shape[2];if(u){var l=$u(e.shape);l[1]=1;var c=_t(l);e=nn([e,c],1);var f=$u(e.shape);f[2]=1;var h=_t(f);e=nn([e,h],2)}return r=o?nn([r,a],3):r,e=$e(r,e),e=Ot(e),e}var ZM=function(n){He(t,n);function t(){return n.call(this,"FaceRecognitionNet")||this}return t.prototype.forwardInput=function(e){var r=this.params;if(!r)throw new Error("FaceRecognitionNet - load model before inference");return Ce(function(){var a=e.toBatchTensor(150,!0).toFloat(),o=[122.782,117.001,104.298],u=xl(a,o).div(Se(256)),l=NS(u,r.conv32_down);l=hn(l,3,2,"valid"),l=Kr(l,r.conv32_1),l=Kr(l,r.conv32_2),l=Kr(l,r.conv32_3),l=Qc(l,r.conv64_down),l=Kr(l,r.conv64_1),l=Kr(l,r.conv64_2),l=Kr(l,r.conv64_3),l=Qc(l,r.conv128_down),l=Kr(l,r.conv128_1),l=Kr(l,r.conv128_2),l=Qc(l,r.conv256_down),l=Kr(l,r.conv256_1),l=Kr(l,r.conv256_2),l=Qc(l,r.conv256_down_out);var c=l.mean([1,2]),f=ed(c,r.fc);return f})},t.prototype.forward=function(e){return Oe(this,void 0,void 0,function(){var r;return Ie(this,function(a){switch(a.label){case 0:return r=this.forwardInput,[4,vn(e)];case 1:return[2,r.apply(this,[a.sent()])]}})})},t.prototype.computeFaceDescriptor=function(e){return Oe(this,void 0,void 0,function(){var r,a,o,u=this;return Ie(this,function(l){switch(l.label){case 0:return[4,vn(e)];case 1:return r=l.sent(),a=Ce(function(){return rn(u.forwardInput(r))}),[4,Promise.all(a.map(function(c){return c.data()}))];case 2:return o=l.sent(),a.forEach(function(c){return c.dispose()}),[2,r.isBatchInput?o:o[0]]}})})},t.prototype.getDefaultModelName=function(){return"face_recognition_model"},t.prototype.extractParamsFromWeigthMap=function(e){return $M(e)},t.prototype.extractParams=function(e){return KM(e)},t}(Ha);function DS(n,t){var e={descriptor:t};return Object.assign({},n,e)}function kS(n,t){var e={age:t};return Object.assign({},n,e)}function MS(n,t,e){var r={gender:t,genderProbability:e};return Object.assign({},n,r)}var OS=function(){function n(t){var e=t===void 0?{}:t,r=e.minFaceSize,a=e.scaleFactor,o=e.maxNumScales,u=e.scoreThresholds,l=e.scaleSteps;if(this._name="MtcnnOptions",this._minFaceSize=r||20,this._scaleFactor=a||.709,this._maxNumScales=o||10,this._scoreThresholds=u||[.6,.7,.7],this._scaleSteps=l,typeof this._minFaceSize!="number"||this._minFaceSize<0)throw new Error(this._name+" - expected minFaceSize to be a number > 0");if(typeof this._scaleFactor!="number"||this._scaleFactor<=0||this._scaleFactor>=1)throw new Error(this._name+" - expected scaleFactor to be a number between 0 and 1");if(typeof this._maxNumScales!="number"||this._maxNumScales<0)throw new Error(this._name+" - expected maxNumScales to be a number > 0");if(!Array.isArray(this._scoreThresholds)||this._scoreThresholds.length!==3||this._scoreThresholds.some(function(c){return typeof c!="number"}))throw new Error(this._name+" - expected scoreThresholds to be an array of numbers of length 3");if(this._scaleSteps&&(!Array.isArray(this._scaleSteps)||this._scaleSteps.some(function(c){return typeof c!="number"})))throw new Error(this._name+" - expected scaleSteps to be an array of numbers")}return Object.defineProperty(n.prototype,"minFaceSize",{get:function(){return this._minFaceSize},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"scaleFactor",{get:function(){return this._scaleFactor},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"maxNumScales",{get:function(){return this._maxNumScales},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"scoreThresholds",{get:function(){return this._scoreThresholds},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"scaleSteps",{get:function(){return this._scaleSteps},enumerable:!0,configurable:!0}),n}();function JM(n,t){function e(c,f){var h=Gn(n(9*c),[3,3,c,1]),p=Yt(n(c)),m=Yt(n(c)),g=Yt(n(c)),b=Yt(n(c));return t.push({paramPath:f+"/filters"},{paramPath:f+"/batch_norm_scale"},{paramPath:f+"/batch_norm_offset"},{paramPath:f+"/batch_norm_mean"},{paramPath:f+"/batch_norm_variance"}),{filters:h,batch_norm_scale:p,batch_norm_offset:m,batch_norm_mean:g,batch_norm_variance:b}}function r(c,f,h,p,m){var g=Gn(n(c*f*h*h),[h,h,c,f]),b=Yt(n(f));return t.push({paramPath:p+"/filters"},{paramPath:p+"/"+(m?"batch_norm_offset":"bias")}),{filters:g,bias:b}}function a(c,f,h,p){var m=r(c,f,h,p,!0),g=m.filters,b=m.bias;return{filters:g,batch_norm_offset:b}}function o(c,f,h){var p=e(c,h+"/depthwise_conv"),m=a(c,f,1,h+"/pointwise_conv");return{depthwise_conv:p,pointwise_conv:m}}function u(){var c=a(3,32,3,"mobilenetv1/conv_0"),f=o(32,64,"mobilenetv1/conv_1"),h=o(64,128,"mobilenetv1/conv_2"),p=o(128,128,"mobilenetv1/conv_3"),m=o(128,256,"mobilenetv1/conv_4"),g=o(256,256,"mobilenetv1/conv_5"),b=o(256,512,"mobilenetv1/conv_6"),x=o(512,512,"mobilenetv1/conv_7"),w=o(512,512,"mobilenetv1/conv_8"),E=o(512,512,"mobilenetv1/conv_9"),C=o(512,512,"mobilenetv1/conv_10"),_=o(512,512,"mobilenetv1/conv_11"),R=o(512,1024,"mobilenetv1/conv_12"),A=o(1024,1024,"mobilenetv1/conv_13");return{conv_0:c,conv_1:f,conv_2:h,conv_3:p,conv_4:m,conv_5:g,conv_6:b,conv_7:x,conv_8:w,conv_9:E,conv_10:C,conv_11:_,conv_12:R,conv_13:A}}function l(){var c=a(1024,256,1,"prediction_layer/conv_0"),f=a(256,512,3,"prediction_layer/conv_1"),h=a(512,128,1,"prediction_layer/conv_2"),p=a(128,256,3,"prediction_layer/conv_3"),m=a(256,128,1,"prediction_layer/conv_4"),g=a(128,256,3,"prediction_layer/conv_5"),b=a(256,64,1,"prediction_layer/conv_6"),x=a(64,128,3,"prediction_layer/conv_7"),w=r(512,12,1,"prediction_layer/box_predictor_0/box_encoding_predictor"),E=r(512,9,1,"prediction_layer/box_predictor_0/class_predictor"),C=r(1024,24,1,"prediction_layer/box_predictor_1/box_encoding_predictor"),_=r(1024,18,1,"prediction_layer/box_predictor_1/class_predictor"),R=r(512,24,1,"prediction_layer/box_predictor_2/box_encoding_predictor"),A=r(512,18,1,"prediction_layer/box_predictor_2/class_predictor"),D=r(256,24,1,"prediction_layer/box_predictor_3/box_encoding_predictor"),M=r(256,18,1,"prediction_layer/box_predictor_3/class_predictor"),k=r(256,24,1,"prediction_layer/box_predictor_4/box_encoding_predictor"),B=r(256,18,1,"prediction_layer/box_predictor_4/class_predictor"),O=r(128,24,1,"prediction_layer/box_predictor_5/box_encoding_predictor"),V=r(128,18,1,"prediction_layer/box_predictor_5/class_predictor"),H={box_encoding_predictor:w,class_predictor:E},ee={box_encoding_predictor:C,class_predictor:_},$={box_encoding_predictor:R,class_predictor:A},K={box_encoding_predictor:D,class_predictor:M},L={box_encoding_predictor:k,class_predictor:B},W={box_encoding_predictor:O,class_predictor:V};return{conv_0:c,conv_1:f,conv_2:h,conv_3:p,conv_4:m,conv_5:g,conv_6:b,conv_7:x,box_predictor_0:H,box_predictor_1:ee,box_predictor_2:$,box_predictor_3:K,box_predictor_4:L,box_predictor_5:W}}return{extractMobilenetV1Params:u,extractPredictionLayerParams:l}}function eO(n){var t=[],e=Wa(n),r=e.extractWeights,a=e.getRemainingWeights,o=JM(r,t),u=o.extractMobilenetV1Params,l=o.extractPredictionLayerParams,c=u(),f=l(),h=bm(r(5118*4),[1,5118,4]),p={extra_dim:h};if(t.push({paramPath:"output_layer/extra_dim"}),a().length!==0)throw new Error("weights remaing after extract: "+a().length);return{params:{mobilenetv1:c,prediction_layer:f,output_layer:p},paramMappings:t}}function tO(n,t){var e=Mo(n,t);function r(f,h,p){var m=e(f+"/Conv2d_"+h+"_pointwise/weights",4,p+"/filters"),g=e(f+"/Conv2d_"+h+"_pointwise/convolution_bn_offset",1,p+"/batch_norm_offset");return{filters:m,batch_norm_offset:g}}function a(f){var h="mobilenetv1/conv_"+f,p="MobilenetV1/Conv2d_"+f+"_depthwise",m=h+"/depthwise_conv",g=h+"/pointwise_conv",b=e(p+"/depthwise_weights",4,m+"/filters"),x=e(p+"/BatchNorm/gamma",1,m+"/batch_norm_scale"),w=e(p+"/BatchNorm/beta",1,m+"/batch_norm_offset"),E=e(p+"/BatchNorm/moving_mean",1,m+"/batch_norm_mean"),C=e(p+"/BatchNorm/moving_variance",1,m+"/batch_norm_variance");return{depthwise_conv:{filters:b,batch_norm_scale:x,batch_norm_offset:w,batch_norm_mean:E,batch_norm_variance:C},pointwise_conv:r("MobilenetV1",f,g)}}function o(){return{conv_0:r("MobilenetV1",0,"mobilenetv1/conv_0"),conv_1:a(1),conv_2:a(2),conv_3:a(3),conv_4:a(4),conv_5:a(5),conv_6:a(6),conv_7:a(7),conv_8:a(8),conv_9:a(9),conv_10:a(10),conv_11:a(11),conv_12:a(12),conv_13:a(13)}}function u(f,h){var p=e(f+"/weights",4,h+"/filters"),m=e(f+"/biases",1,h+"/bias");return{filters:p,bias:m}}function l(f){var h=u("Prediction/BoxPredictor_"+f+"/BoxEncodingPredictor","prediction_layer/box_predictor_"+f+"/box_encoding_predictor"),p=u("Prediction/BoxPredictor_"+f+"/ClassPredictor","prediction_layer/box_predictor_"+f+"/class_predictor");return{box_encoding_predictor:h,class_predictor:p}}function c(){return{conv_0:r("Prediction",0,"prediction_layer/conv_0"),conv_1:r("Prediction",1,"prediction_layer/conv_1"),conv_2:r("Prediction",2,"prediction_layer/conv_2"),conv_3:r("Prediction",3,"prediction_layer/conv_3"),conv_4:r("Prediction",4,"prediction_layer/conv_4"),conv_5:r("Prediction",5,"prediction_layer/conv_5"),conv_6:r("Prediction",6,"prediction_layer/conv_6"),conv_7:r("Prediction",7,"prediction_layer/conv_7"),box_predictor_0:l(0),box_predictor_1:l(1),box_predictor_2:l(2),box_predictor_3:l(3),box_predictor_4:l(4),box_predictor_5:l(5)}}return{extractMobilenetV1Params:o,extractPredictionLayerParams:c}}function nO(n){var t=[],e=tO(n,t),r=e.extractMobilenetV1Params,a=e.extractPredictionLayerParams,o=n["Output/extra_dim"];if(t.push({originalPath:"Output/extra_dim",paramPath:"output_layer/extra_dim"}),!ad(o))throw new Error("expected weightMap['Output/extra_dim'] to be a Tensor3D, instead have "+o);var u={mobilenetv1:r(),prediction_layer:a(),output_layer:{extra_dim:o}};return Va(n,t),{params:u,paramMappings:t}}function $r(n,t,e){return Ce(function(){var r=Ar(n,t.filters,e,"same");return r=$e(r,t.batch_norm_offset),Dm(r,0,6)})}var rO=.0010000000474974513;function aO(n,t,e){return Ce(function(){var r=Jf(n,t.filters,e,"same");return r=_2(r,t.batch_norm_mean,t.batch_norm_variance,t.batch_norm_offset,t.batch_norm_scale,rO),Dm(r,0,6)})}function oO(n){return[2,4,6,12].some(function(t){return t===n})?[2,2]:[1,1]}function iO(n,t){return Ce(function(){var e=null,r=$r(n,t.conv_0,[2,2]),a=[t.conv_1,t.conv_2,t.conv_3,t.conv_4,t.conv_5,t.conv_6,t.conv_7,t.conv_8,t.conv_9,t.conv_10,t.conv_11,t.conv_12,t.conv_13];if(a.forEach(function(o,u){var l=u+1,c=oO(l);r=aO(r,o.depthwise_conv,c),r=$r(r,o.pointwise_conv,[1,1]),l===11&&(e=r)}),e===null)throw new Error("mobileNetV1 - output of conv layer 11 is null");return{out:r,conv11:e}})}function sO(n,t,e,r,a){var o=n.shape[0],u=Math.min(e,o),l=t.map(function(h,p){return{score:h,boxIndex:p}}).filter(function(h){return h.score>a}).sort(function(h,p){return p.score-h.score}),c=function(h){return h<=r?1:0},f=[];return l.forEach(function(h){if(!(f.length>=u)){for(var p=h.score,m=f.length-1;m>=0;--m){var g=uO(n,h.boxIndex,f[m]);if(g!==0&&(h.score*=c(g),h.score<=a))break}p===h.score&&f.push(h.boxIndex)}}),f}function uO(n,t,e){var r=n.arraySync(),a=Math.min(r[t][0],r[t][2]),o=Math.min(r[t][1],r[t][3]),u=Math.max(r[t][0],r[t][2]),l=Math.max(r[t][1],r[t][3]),c=Math.min(r[e][0],r[e][2]),f=Math.min(r[e][1],r[e][3]),h=Math.max(r[e][0],r[e][2]),p=Math.max(r[e][1],r[e][3]),m=(u-a)*(l-o),g=(h-c)*(p-f);if(m<=0||g<=0)return 0;var b=Math.max(a,c),x=Math.max(o,f),w=Math.min(u,h),E=Math.min(l,p),C=Math.max(w-b,0)*Math.max(E-x,0);return C/(m+g-C)}function lO(n){var t=rn(Ao(n,[1,0])),e=[on(t[2],t[0]),on(t[3],t[1])],r=[$e(t[0],Fr(e[0],Se(2))),$e(t[1],Fr(e[1],Se(2)))];return{sizes:e,centers:r}}function cO(n,t){var e=lO(n),r=e.sizes,a=e.centers,o=rn(Ao(t,[1,0])),u=Fr(Mn(zv(Fr(o[2],Se(5))),r[0]),Se(2)),l=$e(Mn(Fr(o[0],Se(10)),r[0]),a[0]),c=Fr(Mn(zv(Fr(o[3],Se(5))),r[1]),Se(2)),f=$e(Mn(Fr(o[1],Se(10)),r[1]),a[1]);return Ao(cr([on(l,u),on(f,c),$e(l,u),$e(f,c)]),[1,0])}function fO(n,t,e){return Ce(function(){var r=n.shape[0],a=cO(Pr(ws(e.extra_dim,[r,1,1]),[-1,4]),Pr(n,[-1,4]));a=Pr(a,[r,a.shape[0]/r,4]);var o=w2(ua(t,[0,0,1],[-1,-1,-1])),u=ua(o,[0,0,0],[-1,-1,1]);u=Pr(u,[r,u.shape[1]]);var l=rn(a),c=rn(u);return{boxes:l,scores:c}})}function ls(n,t){return Ce(function(){var e=n.shape[0],r=Pr(Lr(n,t.box_encoding_predictor),[e,-1,1,4]),a=Pr(Lr(n,t.class_predictor),[e,-1,3]);return{boxPredictionEncoding:r,classPrediction:a}})}function dO(n,t,e){return Ce(function(){var r=$r(n,e.conv_0,[1,1]),a=$r(r,e.conv_1,[2,2]),o=$r(a,e.conv_2,[1,1]),u=$r(o,e.conv_3,[2,2]),l=$r(u,e.conv_4,[1,1]),c=$r(l,e.conv_5,[2,2]),f=$r(c,e.conv_6,[1,1]),h=$r(f,e.conv_7,[2,2]),p=ls(t,e.box_predictor_0),m=ls(n,e.box_predictor_1),g=ls(a,e.box_predictor_2),b=ls(u,e.box_predictor_3),x=ls(c,e.box_predictor_4),w=ls(h,e.box_predictor_5),E=nn([p.boxPredictionEncoding,m.boxPredictionEncoding,g.boxPredictionEncoding,b.boxPredictionEncoding,x.boxPredictionEncoding,w.boxPredictionEncoding],1),C=nn([p.classPrediction,m.classPrediction,g.classPrediction,b.classPrediction,x.classPrediction,w.classPrediction],1);return{boxPredictions:E,classPredictions:C}})}var Ro=function(){function n(t){var e=t===void 0?{}:t,r=e.minConfidence,a=e.maxResults;if(this._name="SsdMobilenetv1Options",this._minConfidence=r||.5,this._maxResults=a||100,typeof this._minConfidence!="number"||this._minConfidence<=0||this._minConfidence>=1)throw new Error(this._name+" - expected minConfidence to be a number between 0 and 1");if(typeof this._maxResults!="number")throw new Error(this._name+" - expected maxResults to be a number")}return Object.defineProperty(n.prototype,"minConfidence",{get:function(){return this._minConfidence},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"maxResults",{get:function(){return this._maxResults},enumerable:!0,configurable:!0}),n}(),IS=function(n){He(t,n);function t(){return n.call(this,"SsdMobilenetv1")||this}return t.prototype.forwardInput=function(e){var r=this.params;if(!r)throw new Error("SsdMobilenetv1 - load model before inference");return Ce(function(){var a=e.toBatchTensor(512,!1).toFloat(),o=on(Mn(a,Se(.007843137718737125)),Se(1)),u=iO(o,r.mobilenetv1),l=dO(u.out,u.conv11,r.prediction_layer),c=l.boxPredictions,f=l.classPredictions;return fO(c,f,r.output_layer)})},t.prototype.forward=function(e){return Oe(this,void 0,void 0,function(){var r;return Ie(this,function(a){switch(a.label){case 0:return r=this.forwardInput,[4,vn(e)];case 1:return[2,r.apply(this,[a.sent()])]}})})},t.prototype.locateFaces=function(e,r){return r===void 0&&(r={}),Oe(this,void 0,void 0,function(){var a,o,u,l,c,f,h,p,m,g,b,x,w,E,C,_,R,A,D,M,k;return Ie(this,function(B){switch(B.label){case 0:return a=new Ro(r),o=a.maxResults,u=a.minConfidence,[4,vn(e)];case 1:for(l=B.sent(),c=this.forwardInput(l),f=c.boxes,h=c.scores,p=f[0],m=h[0],g=1;g<f.length;g++)f[g].dispose(),h[g].dispose();return w=(x=Array).from,[4,m.data()];case 2:return b=w.apply(x,[B.sent()]),E=.5,C=sO(p,b,o,E,u),_=l.getReshapedInputDimensions(0),R=l.inputSize,A=R/_.width,D=R/_.height,M=p.arraySync(),k=C.map(function(O){var V=[Math.max(0,M[O][0]),Math.min(1,M[O][2])].map(function(W){return W*D}),H=V[0],ee=V[1],$=[Math.max(0,M[O][1]),Math.min(1,M[O][3])].map(function(W){return W*A}),K=$[0],L=$[1];return new dr(b[O],new Xm(K,H,L-K,ee-H),{height:l.getInputHeight(0),width:l.getInputWidth(0)})}),p.dispose(),m.dispose(),[2,k]}})})},t.prototype.getDefaultModelName=function(){return"ssd_mobilenetv1_model"},t.prototype.extractParamsFromWeigthMap=function(e){return nO(e)},t.prototype.extractParams=function(e){return eO(e)},t}(Ha);(function(n){He(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t})(IS);var hO=.4,pO=[new ct(.738768,.874946),new ct(2.42204,2.65704),new ct(4.30971,7.04493),new ct(10.246,4.59428),new ct(12.6868,11.8741)],vO=[new ct(1.603231,2.094468),new ct(6.041143,7.080126),new ct(2.882459,3.518061),new ct(4.266906,5.178857),new ct(9.041765,10.66308)],mO=[117.001,114.697,97.404],gO="tiny_yolov2_model",yO="tiny_yolov2_separable_conv_model",$c=function(n){return typeof n=="number"};function bO(n){if(!n)throw new Error("invalid config: "+n);if(typeof n.withSeparableConvs!="boolean")throw new Error("config.withSeparableConvs has to be a boolean, have: "+n.withSeparableConvs);if(!$c(n.iouThreshold)||n.iouThreshold<0||n.iouThreshold>1)throw new Error("config.iouThreshold has to be a number between [0, 1], have: "+n.iouThreshold);if(!Array.isArray(n.classes)||!n.classes.length||!n.classes.every(function(t){return typeof t=="string"}))throw new Error("config.classes has to be an array class names: string[], have: "+JSON.stringify(n.classes));if(!Array.isArray(n.anchors)||!n.anchors.length||!n.anchors.map(function(t){return t||{}}).every(function(t){return $c(t.x)&&$c(t.y)}))throw new Error("config.anchors has to be an array of { x: number, y: number }, have: "+JSON.stringify(n.anchors));if(n.meanRgb&&(!Array.isArray(n.meanRgb)||n.meanRgb.length!==3||!n.meanRgb.every($c)))throw new Error("config.meanRgb has to be an array of shape [number, number, number], have: "+JSON.stringify(n.meanRgb))}function og(n){return Ce(function(){var t=Mn(n,Se(.10000000149011612));return $e(Ot(on(n,t)),t)})}function mo(n,t){return Ce(function(){var e=mi(n,[[0,0],[1,1],[1,1],[0,0]]);return e=Ar(e,t.conv.filters,[1,1],"valid"),e=on(e,t.bn.sub),e=Mn(e,t.bn.truediv),e=$e(e,t.conv.bias),og(e)})}function go(n,t){return Ce(function(){var e=mi(n,[[0,0],[1,1],[1,1],[0,0]]);return e=Im(e,t.depthwise_filter,t.pointwise_filter,[1,1],"valid"),e=$e(e,t.bias),og(e)})}function xO(n,t){var e=sd(n,t);function r(u,l){var c=Yt(n(u)),f=Yt(n(u));return t.push({paramPath:l+"/sub"},{paramPath:l+"/truediv"}),{sub:c,truediv:f}}function a(u,l,c){var f=e(u,l,3,c+"/conv"),h=r(l,c+"/bn");return{conv:f,bn:h}}var o=tg(n,t);return{extractConvParams:e,extractConvWithBatchNormParams:a,extractSeparableConvParams:o}}function wO(n,t,e,r){var a=Wa(n),o=a.extractWeights,u=a.getRemainingWeights,l=[],c=xO(o,l),f=c.extractConvParams,h=c.extractConvWithBatchNormParams,p=c.extractSeparableConvParams,m;if(t.withSeparableConvs){var g=r[0],b=r[1],x=r[2],w=r[3],E=r[4],C=r[5],_=r[6],R=r[7],A=r[8],D=t.isFirstLayerConv2d?f(g,b,3,"conv0"):p(g,b,"conv0"),M=p(b,x,"conv1"),k=p(x,w,"conv2"),B=p(w,E,"conv3"),O=p(E,C,"conv4"),V=p(C,_,"conv5"),H=R?p(_,R,"conv6"):void 0,ee=A?p(R,A,"conv7"):void 0,$=f(A||R||_,5*e,1,"conv8");m={conv0:D,conv1:M,conv2:k,conv3:B,conv4:O,conv5:V,conv6:H,conv7:ee,conv8:$}}else{var g=r[0],b=r[1],x=r[2],w=r[3],E=r[4],C=r[5],_=r[6],R=r[7],A=r[8],D=h(g,b,"conv0"),M=h(b,x,"conv1"),k=h(x,w,"conv2"),B=h(w,E,"conv3"),O=h(E,C,"conv4"),V=h(C,_,"conv5"),H=h(_,R,"conv6"),ee=h(R,A,"conv7"),$=f(A,5*e,1,"conv8");m={conv0:D,conv1:M,conv2:k,conv3:B,conv4:O,conv5:V,conv6:H,conv7:ee,conv8:$}}if(u().length!==0)throw new Error("weights remaing after extract: "+u().length);return{params:m,paramMappings:l}}function SO(n,t){var e=Mo(n,t);function r(l){var c=e(l+"/sub",1),f=e(l+"/truediv",1);return{sub:c,truediv:f}}function a(l){var c=e(l+"/filters",4),f=e(l+"/bias",1);return{filters:c,bias:f}}function o(l){var c=a(l+"/conv"),f=r(l+"/bn");return{conv:c,bn:f}}var u=ng(e);return{extractConvParams:a,extractConvWithBatchNormParams:o,extractSeparableConvParams:u}}function EO(n,t){var e=[],r=SO(n,e),a=r.extractConvParams,o=r.extractConvWithBatchNormParams,u=r.extractSeparableConvParams,l;if(t.withSeparableConvs){var c=t.filterSizes&&t.filterSizes.length||9;l={conv0:t.isFirstLayerConv2d?a("conv0"):u("conv0"),conv1:u("conv1"),conv2:u("conv2"),conv3:u("conv3"),conv4:u("conv4"),conv5:u("conv5"),conv6:c>7?u("conv6"):void 0,conv7:c>8?u("conv7"):void 0,conv8:a("conv8")}}else l={conv0:o("conv0"),conv1:o("conv1"),conv2:o("conv2"),conv3:o("conv3"),conv4:o("conv4"),conv5:o("conv5"),conv6:o("conv6"),conv7:o("conv7"),conv8:a("conv8")};return Va(n,e),{params:l,paramMappings:e}}var O1;(function(n){n[n.XS=224]="XS",n[n.SM=320]="SM",n[n.MD=416]="MD",n[n.LG=608]="LG"})(O1||(O1={}));var ig=function(){function n(t){var e=t===void 0?{}:t,r=e.inputSize,a=e.scoreThreshold;if(this._name="TinyYolov2Options",this._inputSize=r||416,this._scoreThreshold=a||.5,typeof this._inputSize!="number"||this._inputSize%32!==0)throw new Error(this._name+" - expected inputSize to be a number divisible by 32");if(typeof this._scoreThreshold!="number"||this._scoreThreshold<=0||this._scoreThreshold>=1)throw new Error(this._name+" - expected scoreThreshold to be a number between 0 and 1")}return Object.defineProperty(n.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"scoreThreshold",{get:function(){return this._scoreThreshold},enumerable:!0,configurable:!0}),n}(),BS=function(n){He(t,n);function t(e){var r=n.call(this,"TinyYolov2")||this;return bO(e),r._config=e,r}return Object.defineProperty(t.prototype,"config",{get:function(){return this._config},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"withClassScores",{get:function(){return this.config.withClassScores||this.config.classes.length>1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"boxEncodingSize",{get:function(){return 5+(this.withClassScores?this.config.classes.length:0)},enumerable:!0,configurable:!0}),t.prototype.runTinyYolov2=function(e,r){var a=mo(e,r.conv0);return a=hn(a,[2,2],[2,2],"same"),a=mo(a,r.conv1),a=hn(a,[2,2],[2,2],"same"),a=mo(a,r.conv2),a=hn(a,[2,2],[2,2],"same"),a=mo(a,r.conv3),a=hn(a,[2,2],[2,2],"same"),a=mo(a,r.conv4),a=hn(a,[2,2],[2,2],"same"),a=mo(a,r.conv5),a=hn(a,[2,2],[1,1],"same"),a=mo(a,r.conv6),a=mo(a,r.conv7),Lr(a,r.conv8,"valid",!1)},t.prototype.runMobilenet=function(e,r){var a=this.config.isFirstLayerConv2d?og(Lr(e,r.conv0,"valid",!1)):go(e,r.conv0);return a=hn(a,[2,2],[2,2],"same"),a=go(a,r.conv1),a=hn(a,[2,2],[2,2],"same"),a=go(a,r.conv2),a=hn(a,[2,2],[2,2],"same"),a=go(a,r.conv3),a=hn(a,[2,2],[2,2],"same"),a=go(a,r.conv4),a=hn(a,[2,2],[2,2],"same"),a=go(a,r.conv5),a=hn(a,[2,2],[1,1],"same"),a=r.conv6?go(a,r.conv6):a,a=r.conv7?go(a,r.conv7):a,Lr(a,r.conv8,"valid",!1)},t.prototype.forwardInput=function(e,r){var a=this,o=this.params;if(!o)throw new Error("TinyYolov2 - load model before inference");return Ce(function(){var u=e.toBatchTensor(r,!1).toFloat();return u=a.config.meanRgb?xl(u,a.config.meanRgb):u,u=u.div(Se(256)),a.config.withSeparableConvs?a.runMobilenet(u,o):a.runTinyYolov2(u,o)})},t.prototype.forward=function(e,r){return Oe(this,void 0,void 0,function(){var a;return Ie(this,function(o){switch(o.label){case 0:return a=this.forwardInput,[4,vn(e)];case 1:return[4,a.apply(this,[o.sent(),r])];case 2:return[2,o.sent()]}})})},t.prototype.detect=function(e,r){return r===void 0&&(r={}),Oe(this,void 0,void 0,function(){var a,o,u,l,c,f,h,p,m,g,b,x,w,E,C=this;return Ie(this,function(_){switch(_.label){case 0:return a=new ig(r),o=a.inputSize,u=a.scoreThreshold,[4,vn(e)];case 1:return l=_.sent(),[4,this.forwardInput(l,o)];case 2:return c=_.sent(),f=Ce(function(){return rn(c)[0].expandDims()}),h={width:l.getInputWidth(0),height:l.getInputHeight(0)},[4,this.extractBoxes(f,l.getReshapedInputDimensions(0),u)];case 3:return p=_.sent(),c.dispose(),f.dispose(),m=p.map(function(R){return R.box}),g=p.map(function(R){return R.score}),b=p.map(function(R){return R.classScore}),x=p.map(function(R){return C.config.classes[R.label]}),w=ol(m.map(function(R){return R.rescale(o)}),g,this.config.iouThreshold,!0),E=w.map(function(R){return new iS(g[R],b[R],x[R],m[R],h)}),[2,E]}})})},t.prototype.getDefaultModelName=function(){return""},t.prototype.extractParamsFromWeigthMap=function(e){return EO(e,this.config)},t.prototype.extractParams=function(e){var r=this.config.filterSizes||t.DEFAULT_FILTER_SIZES,a=r?r.length:void 0;if(a!==7&&a!==8&&a!==9)throw new Error("TinyYolov2 - expected 7 | 8 | 9 convolutional filters, but found "+a+" filterSizes in config");return wO(e,this.config,this.boxEncodingSize,r)},t.prototype.extractBoxes=function(e,r,a){return Oe(this,void 0,void 0,function(){var o,u,l,c,f,h,p,m,g,b,x,w,E,C,_,R,A,D,M,k,B,O,V,H,ee,$,K,L,W,U=this;return Ie(this,function(Z){switch(Z.label){case 0:return o=r.width,u=r.height,l=Math.max(o,u),c=l/o,f=l/u,h=e.shape[1],p=this.config.anchors.length,m=Ce(function(){var P=e.reshape([h,h,p,U.boxEncodingSize]),q=P.slice([0,0,0,0],[h,h,p,4]),ne=P.slice([0,0,0,4],[h,h,p,1]),J=U.withClassScores?Ua(P.slice([0,0,0,5],[h,h,p,U.config.classes.length]),3):Se(0);return[q,ne,J]}),g=m[0],b=m[1],x=m[2],w=[],[4,b.array()];case 1:return E=Z.sent(),[4,g.array()];case 2:C=Z.sent(),_=0,Z.label=3;case 3:if(!(_<h))return[3,12];R=0,Z.label=4;case 4:if(!(R<h))return[3,11];A=0,Z.label=5;case 5:return A<p?(D=iv(E[_][R][A][0]),!a||D>a?(M=(R+iv(C[_][R][A][0]))/h*c,k=(_+iv(C[_][R][A][1]))/h*f,B=Math.exp(C[_][R][A][2])*this.config.anchors[A].x/h*c,O=Math.exp(C[_][R][A][3])*this.config.anchors[A].y/h*f,V=M-B/2,H=k-O/2,ee={row:_,col:R,anchor:A},this.withClassScores?[4,this.extractPredictedClass(x,ee)]:[3,7]):[3,9]):[3,10];case 6:return W=Z.sent(),[3,8];case 7:W={classScore:1,label:0},Z.label=8;case 8:$=W,K=$.classScore,L=$.label,w.push(Nn({box:new od(V,H,V+B,H+O),score:D,classScore:D*K,label:L},ee)),Z.label=9;case 9:return A++,[3,5];case 10:return R++,[3,4];case 11:return _++,[3,3];case 12:return g.dispose(),b.dispose(),x.dispose(),[2,w]}})})},t.prototype.extractPredictedClass=function(e,r){return Oe(this,void 0,void 0,function(){var a,o,u,l;return Ie(this,function(c){switch(c.label){case 0:return a=r.row,o=r.col,u=r.anchor,[4,e.array()];case 1:return l=c.sent(),[2,Array(this.config.classes.length).fill(0).map(function(f,h){return l[a][o][u][h]}).map(function(f,h){return{classScore:f,label:h}}).reduce(function(f,h){return f.classScore>h.classScore?f:h})]}})})},t.DEFAULT_FILTER_SIZES=[3,16,32,64,128,256,512,1024,1024],t}(Ha),CO=function(n){He(t,n);function t(e){e===void 0&&(e=!0);var r=this,a=Object.assign({},{withSeparableConvs:e,iouThreshold:hO,classes:["face"]},e?{anchors:vO,meanRgb:mO}:{anchors:pO,withClassScores:!0});return r=n.call(this,a)||this,r}return Object.defineProperty(t.prototype,"withSeparableConvs",{get:function(){return this.config.withSeparableConvs},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),t.prototype.locateFaces=function(e,r){return Oe(this,void 0,void 0,function(){var a;return Ie(this,function(o){switch(o.label){case 0:return[4,this.detect(e,r)];case 1:return a=o.sent(),[2,a.map(function(u){return new dr(u.score,u.relativeBox,{width:u.imageWidth,height:u.imageHeight})})]}})})},t.prototype.getDefaultModelName=function(){return this.withSeparableConvs?yO:gO},t.prototype.extractParamsFromWeigthMap=function(e){return n.prototype.extractParamsFromWeigthMap.call(this,e)},t}(BS),_O=function(n){He(t,n);function t(){var e=n!==null&&n.apply(this,arguments)||this;return e._name="TinyFaceDetectorOptions",e}return t}(ig),wl=function(){function n(){}return n.prototype.then=function(t){return Oe(this,void 0,void 0,function(){var e;return Ie(this,function(r){switch(r.label){case 0:return e=t,[4,this.run()];case 1:return[2,e.apply(void 0,[r.sent()])]}})})},n.prototype.run=function(){return Oe(this,void 0,void 0,function(){return Ie(this,function(t){throw new Error("ComposableTask - run is not implemented")})})},n}();function ld(n,t,e,r,a){return a===void 0&&(a=function(o){var u=o.alignedRect;return u}),Oe(this,void 0,void 0,function(){var o,u,l,c,f;return Ie(this,function(h){switch(h.label){case 0:return o=n.map(function(p){return rg(p)?a(p):p.detection}),l=r,l?[3,5]:t instanceof Mt?[4,Jm(t,o)]:[3,2];case 1:return c=h.sent(),[3,4];case 2:return[4,Zm(t,o)];case 3:c=h.sent(),h.label=4;case 4:l=c,h.label=5;case 5:return u=l,[4,e(u)];case 6:return f=h.sent(),u.forEach(function(p){return p instanceof Mt&&p.dispose()}),[2,f]}})})}function sg(n,t,e,r,a){return Oe(this,void 0,void 0,function(){var o=this;return Ie(this,function(u){return[2,ld([n],t,function(l){return Oe(o,void 0,void 0,function(){return Ie(this,function(c){return[2,e(l[0])]})})},r,a)]})})}function RO(n){return Ce(function(){return cr(rn(n,3).reverse(),3)})}var Zc=2,zf=12;function AO(n,t){var e=sd(n,t),r=eg(n,t);function a(f,h){var p=Yt(n(f));return t.push({paramPath:h}),p}function o(f,h,p){p===void 0&&(p=!1);var m=e(f[0],f[1],3,h+"/conv1"),g=a(f[1],h+"/prelu1_alpha"),b=e(f[1],f[2],3,h+"/conv2"),x=a(f[2],h+"/prelu2_alpha"),w=e(f[2],f[3],p?2:3,h+"/conv3"),E=a(f[3],h+"/prelu3_alpha");return{conv1:m,prelu1_alpha:g,conv2:b,prelu2_alpha:x,conv3:w,prelu3_alpha:E}}function u(){var f=o([3,10,16,32],"pnet"),h=e(32,2,1,"pnet/conv4_1"),p=e(32,4,1,"pnet/conv4_2");return Nn(Nn({},f),{conv4_1:h,conv4_2:p})}function l(){var f=o([3,28,48,64],"rnet",!0),h=r(576,128,"rnet/fc1"),p=a(128,"rnet/prelu4_alpha"),m=r(128,2,"rnet/fc2_1"),g=r(128,4,"rnet/fc2_2");return Nn(Nn({},f),{fc1:h,prelu4_alpha:p,fc2_1:m,fc2_2:g})}function c(){var f=o([3,32,64,64],"onet"),h=e(64,128,2,"onet/conv4"),p=a(128,"onet/prelu4_alpha"),m=r(1152,256,"onet/fc1"),g=a(256,"onet/prelu5_alpha"),b=r(256,2,"onet/fc2_1"),x=r(256,4,"onet/fc2_2"),w=r(256,10,"onet/fc2_3");return Nn(Nn({},f),{conv4:h,prelu4_alpha:p,fc1:m,prelu5_alpha:g,fc2_1:b,fc2_2:x,fc2_3:w})}return{extractPNetParams:u,extractRNetParams:l,extractONetParams:c}}function TO(n){var t=Wa(n),e=t.extractWeights,r=t.getRemainingWeights,a=[],o=AO(e,a),u=o.extractPNetParams,l=o.extractRNetParams,c=o.extractONetParams,f=u(),h=l(),p=c();if(r().length!==0)throw new Error("weights remaing after extract: "+r().length);return{params:{pnet:f,rnet:h,onet:p},paramMappings:a}}function NO(n,t){var e=Mo(n,t);function r(h){var p=e(h+"/weights",4,h+"/filters"),m=e(h+"/bias",1);return{filters:p,bias:m}}function a(h){var p=e(h+"/weights",2),m=e(h+"/bias",1);return{weights:p,bias:m}}function o(h){return e(h,1)}function u(h){var p=r(h+"/conv1"),m=o(h+"/prelu1_alpha"),g=r(h+"/conv2"),b=o(h+"/prelu2_alpha"),x=r(h+"/conv3"),w=o(h+"/prelu3_alpha");return{conv1:p,prelu1_alpha:m,conv2:g,prelu2_alpha:b,conv3:x,prelu3_alpha:w}}function l(){var h=u("pnet"),p=r("pnet/conv4_1"),m=r("pnet/conv4_2");return Nn(Nn({},h),{conv4_1:p,conv4_2:m})}function c(){var h=u("rnet"),p=a("rnet/fc1"),m=o("rnet/prelu4_alpha"),g=a("rnet/fc2_1"),b=a("rnet/fc2_2");return Nn(Nn({},h),{fc1:p,prelu4_alpha:m,fc2_1:g,fc2_2:b})}function f(){var h=u("onet"),p=r("onet/conv4"),m=o("onet/prelu4_alpha"),g=a("onet/fc1"),b=o("onet/prelu5_alpha"),x=a("onet/fc2_1"),w=a("onet/fc2_2"),E=a("onet/fc2_3");return Nn(Nn({},h),{conv4:p,prelu4_alpha:m,fc1:g,prelu5_alpha:b,fc2_1:x,fc2_2:w,fc2_3:E})}return{extractPNetParams:l,extractRNetParams:c,extractONetParams:f}}function DO(n){var t=[],e=NO(n,t),r=e.extractPNetParams,a=e.extractRNetParams,o=e.extractONetParams,u=r(),l=a(),c=o();return Va(n,t),{params:{pnet:u,rnet:l,onet:c},paramMappings:t}}function Xv(n,t){var e=t[0],r=t[1];return{height:Math.floor(e*n),width:Math.floor(r*n)}}function kO(n,t,e){for(var r=e[0],a=e[1],o=zf/n,u=[],l=Math.min(r,a)*o,c=0;l>=12;)u.push(o*Math.pow(t,c)),l=l*t,c+=1;return u}var ug=function(n){He(t,n);function t(e,r,a,o){return n.call(this,{left:e,top:r,right:a,bottom:o},!0)||this}return t}(la);function FS(n){return Ce(function(){return Mn(on(n,Se(127.5)),Se(.0078125))})}function Rs(n,t){return Ce(function(){return $e(Ot(n),Mn(t,Mf(Ot(Mf(n)))))})}function lg(n,t,e){return e===void 0&&(e=!1),Ce(function(){var r=Lr(n,t.conv1,"valid");return r=Rs(r,t.prelu1_alpha),r=hn(r,e?[2,2]:[3,3],[2,2],"same"),r=Lr(r,t.conv2,"valid"),r=Rs(r,t.prelu2_alpha),r=e?r:hn(r,[3,3],[2,2],"valid"),r=Lr(r,t.conv3,"valid"),r=Rs(r,t.prelu3_alpha),r})}function MO(n,t){return Ce(function(){var e=lg(n,t,!0),r=Lr(e,t.conv4_1,"valid"),a=Cr(td(r,3),3),o=Ua(on(r,a),3),u=Lr(e,t.conv4_2,"valid");return{prob:o,regions:u}})}function OO(n,t){return Ce(function(){var e=Xv(t,n.shape.slice(1)),r=e.height,a=e.width,o=zm.resizeBilinear(n,[r,a]),u=FS(o);return Ao(u,[0,2,1,3])})}function IO(n,t,e,r){for(var a=[],o=n.arraySync(),u=0;u<n.shape[0];u++)for(var l=0;l<n.shape[1];l++)o[u][l]>=r&&a.push(new ct(l,u));var c=a.map(function(f){var h=new od(Math.round((f.y*Zc+1)/e),Math.round((f.x*Zc+1)/e),Math.round((f.y*Zc+zf)/e),Math.round((f.x*Zc+zf)/e)),p=o[f.y][f.x],m=t.arraySync(),g=new ug(m[f.y][f.x][0],m[f.y][f.x][1],m[f.y][f.x][2],m[f.y][f.x][3]);return{cell:h,score:p,region:g}});return c}function BO(n,t,e,r,a){a.stage1=[];var o=t.map(function(m){return Ce(function(){var g={scale:m},b=OO(n,m),x=Date.now(),w=MO(b,r),E=w.prob,C=w.regions;g.pnet=Date.now()-x;var _=rn(rn(E,3)[1])[0],R=rn(C)[0];return{scoresTensor:_,regionsTensor:R,scale:m,statsForScale:g}})}),u=o.map(function(m){var g=m.scoresTensor,b=m.regionsTensor,x=m.scale,w=m.statsForScale,E=IO(g,b,x,e);if(g.dispose(),b.dispose(),!E.length)return a.stage1.push(w),[];var C=Date.now(),_=ol(E.map(function(R){return R.cell}),E.map(function(R){return R.score}),.5);return w.nms=Date.now()-C,w.numBoxes=_.length,a.stage1.push(w),_.map(function(R){return E[R]})}),l=u.reduce(function(m,g){return m.concat(g)},[]),c=[],f=[];if(l.length>0){var h=Date.now(),p=ol(l.map(function(m){return m.cell}),l.map(function(m){return m.score}),.7);a.stage1_nms=Date.now()-h,f=p.map(function(m){return l[m].score}),c=p.map(function(m){return l[m]}).map(function(m){var g=m.cell,b=m.region;return new od(g.left+b.left*g.width,g.top+b.top*g.height,g.right+b.right*g.width,g.bottom+b.bottom*g.height).toSquare().round()})}return{boxes:c,scores:f}}function PS(n,t,e){var r=e.width,a=e.height;return Oe(this,void 0,void 0,function(){var o,u,l,c=this;return Ie(this,function(f){switch(f.label){case 0:return o=ca(n),[4,Promise.all(t.map(function(h){return Oe(c,void 0,void 0,function(){var p,m,g,b,x,w,E,C;return Ie(this,function(_){return p=h.padAtBorders(n.height,n.width),m=p.y,g=p.ey,b=p.x,x=p.ex,w=b-1,E=m-1,C=o.getImageData(w,E,x-w,g-E),[2,In.isNodejs()?$m(C):createImageBitmap(C)]})})}))];case 1:return u=f.sent(),l=[],u.forEach(function(h){var p=id({width:r,height:a}),m=ca(p);m.drawImage(h,0,0,r,a);for(var g=m.getImageData(0,0,r,a).data,b=[],x=0;x<g.length;x+=4)b.push(g[x+2]),b.push(g[x+1]),b.push(g[x]);l.push(b)}),[2,l.map(function(h){var p=Ce(function(){var m=Ao(Gn(h,[1,r,a,3]),[0,2,1,3]).toFloat();return FS(m)});return p})]}})})}function FO(n,t){return Ce(function(){var e=lg(n,t),r=Pr(e,[e.shape[0],t.fc1.weights.shape[0]]),a=na(r,t.fc1),o=Rs(a,t.prelu4_alpha),u=na(o,t.fc2_1),l=Cr(td(u,1),1),c=Ua(on(u,l),1),f=na(o,t.fc2_2),h=rn(c,1)[1];return{scores:h,regions:f}})}function PO(n,t,e,r,a){return Oe(this,void 0,void 0,function(){var o,u,l,c,f,h,p,m,g,b,x,w,E,C;return Ie(this,function(_){switch(_.label){case 0:return o=Date.now(),[4,PS(n,t,{width:24,height:24})];case 1:return u=_.sent(),a.stage2_extractImagePatches=Date.now()-o,o=Date.now(),l=u.map(function(R){var A=FO(R,r);return R.dispose(),A}),a.stage2_rnet=Date.now()-o,c=l.length>1?nn(l.map(function(R){return R.scores})):l[0].scores,p=(h=Array).from,[4,c.data()];case 2:return f=p.apply(h,[_.sent()]),c.dispose(),m=f.map(function(R,A){return{score:R,idx:A}}).filter(function(R){return R.score>e}).map(function(R){var A=R.idx;return A}),g=m.map(function(R){return t[R]}),b=m.map(function(R){return f[R]}),x=[],w=[],g.length>0&&(o=Date.now(),E=ol(g,b,.7),a.stage2_nms=Date.now()-o,C=E.map(function(R){var A=l[m[R]].regions.arraySync();return new ug(A[0][0],A[0][1],A[0][2],A[0][3])}),w=E.map(function(R){return b[R]}),x=E.map(function(R,A){return g[R].calibrate(C[A])})),l.forEach(function(R){R.regions.dispose(),R.scores.dispose()}),[2,{boxes:x,scores:w}]}})})}function LO(n,t){return Ce(function(){var e=lg(n,t);e=hn(e,[2,2],[2,2],"same"),e=Lr(e,t.conv4,"valid"),e=Rs(e,t.prelu4_alpha);var r=Pr(e,[e.shape[0],t.fc1.weights.shape[0]]),a=na(r,t.fc1),o=Rs(a,t.prelu5_alpha),u=na(o,t.fc2_1),l=Cr(td(u,1),1),c=Ua(on(u,l),1),f=na(o,t.fc2_2),h=na(o,t.fc2_3),p=rn(c,1)[1];return{scores:p,regions:f,points:h}})}function zO(n,t,e,r,a){return Oe(this,void 0,void 0,function(){var o,u,l,c,f,h,p,m,g,b,x,w,E,C,_;return Ie(this,function(R){switch(R.label){case 0:return o=Date.now(),[4,PS(n,t,{width:48,height:48})];case 1:return u=R.sent(),a.stage3_extractImagePatches=Date.now()-o,o=Date.now(),l=u.map(function(A){var D=LO(A,r);return A.dispose(),D}),a.stage3_onet=Date.now()-o,c=l.length>1?nn(l.map(function(A){return A.scores})):l[0].scores,p=(h=Array).from,[4,c.data()];case 2:return f=p.apply(h,[R.sent()]),c.dispose(),m=f.map(function(A,D){return{score:A,idx:D}}).filter(function(A){return A.score>e}).map(function(A){var D=A.idx;return D}),g=m.map(function(A){var D=l[A].regions.arraySync();return new ug(D[0][0],D[0][1],D[0][2],D[0][3])}),b=m.map(function(A,D){return t[A].calibrate(g[D])}),x=m.map(function(A){return f[A]}),w=[],E=[],C=[],b.length>0&&(o=Date.now(),_=ol(b,x,.7,!1),a.stage3_nms=Date.now()-o,w=_.map(function(A){return b[A]}),E=_.map(function(A){return x[A]}),C=_.map(function(A,D){return Array(5).fill(0).map(function(M,k){var B=l[A].points.arraySync();return new ct(B[0][k]*(w[D].width+1)+w[D].left,B[0][k+5]*(w[D].height+1)+w[D].top)})})),l.forEach(function(A){A.regions.dispose(),A.scores.dispose(),A.points.dispose()}),[2,{boxes:w,scores:E,points:C}]}})})}var UO=function(n){He(t,n);function t(){return n.call(this,"Mtcnn")||this}return t.prototype.load=function(e){return Oe(this,void 0,void 0,function(){return Ie(this,function(r){return console.warn("mtcnn is deprecated and will be removed soon"),[2,n.prototype.load.call(this,e)]})})},t.prototype.loadFromDisk=function(e){return Oe(this,void 0,void 0,function(){return Ie(this,function(r){return console.warn("mtcnn is deprecated and will be removed soon"),[2,n.prototype.loadFromDisk.call(this,e)]})})},t.prototype.forwardInput=function(e,r){return r===void 0&&(r={}),Oe(this,void 0,void 0,function(){var a,o,u,l,c,f,h,p,m,g,b,x,w,E,C,_,R,A,D,M,k;return Ie(this,function(B){switch(B.label){case 0:if(a=this.params,!a)throw new Error("Mtcnn - load model before inference");if(o=e.canvases[0],!o)throw new Error("Mtcnn - inputCanvas is not defined, note that passing tensors into Mtcnn.forwardInput is not supported yet.");return u={},l=Date.now(),c=Ce(function(){return RO(Cr(Gm.fromPixels(o)).toFloat())}),f=function(O){return c.dispose(),u.total=Date.now()-l,O},h=c.shape.slice(1),p=h[0],m=h[1],g=new OS(r),b=g.minFaceSize,x=g.scaleFactor,w=g.maxNumScales,E=g.scoreThresholds,C=g.scaleSteps,_=(C||kO(b,x,[p,m])).filter(function(O){var V=Xv(O,[p,m]);return Math.min(V.width,V.height)>zf}).slice(0,w),u.scales=_,u.pyramid=_.map(function(O){return Xv(O,[p,m])}),R=Date.now(),[4,BO(c,_,E[0],a.pnet,u)];case 1:return A=B.sent(),u.total_stage1=Date.now()-R,A.boxes.length?(u.stage2_numInputBoxes=A.boxes.length,R=Date.now(),[4,PO(o,A.boxes,E[1],a.rnet,u)]):[2,f({results:[],stats:u})];case 2:return D=B.sent(),u.total_stage2=Date.now()-R,D.boxes.length?(u.stage3_numInputBoxes=D.boxes.length,R=Date.now(),[4,zO(o,D.boxes,E[2],a.onet,u)]):[2,f({results:[],stats:u})];case 3:return M=B.sent(),u.total_stage3=Date.now()-R,k=M.boxes.map(function(O,V){return ud(il({},new dr(M.scores[V],new Xm(O.left/m,O.top/p,O.width/m,O.height/p),{height:p,width:m})),new fM(M.points[V].map(function(H){return H.sub(new ct(O.left,O.top)).div(new ct(O.width,O.height))}),{width:O.width,height:O.height}))}),[2,f({results:k,stats:u})]}})})},t.prototype.forward=function(e,r){return r===void 0&&(r={}),Oe(this,void 0,void 0,function(){var a;return Ie(this,function(o){switch(o.label){case 0:return a=this.forwardInput,[4,vn(e)];case 1:return[4,a.apply(this,[o.sent(),r])];case 2:return[2,o.sent().results]}})})},t.prototype.forwardWithStats=function(e,r){return r===void 0&&(r={}),Oe(this,void 0,void 0,function(){var a;return Ie(this,function(o){switch(o.label){case 0:return a=this.forwardInput,[4,vn(e)];case 1:return[2,a.apply(this,[o.sent(),r])]}})})},t.prototype.getDefaultModelName=function(){return"mtcnn_model"},t.prototype.extractParamsFromWeigthMap=function(e){return DO(e)},t.prototype.extractParams=function(e){return TO(e)},t}(Ha),jO=.4,HO=[new ct(1.603231,2.094468),new ct(6.041143,7.080126),new ct(2.882459,3.518061),new ct(4.266906,5.178857),new ct(9.041765,10.66308)],VO=[117.001,114.697,97.404],WO=function(n){He(t,n);function t(){var e=this,r={withSeparableConvs:!0,iouThreshold:jO,classes:["face"],anchors:HO,meanRgb:VO,isFirstLayerConv2d:!0,filterSizes:[3,16,32,64,128,256,512]};return e=n.call(this,r)||this,e}return Object.defineProperty(t.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),t.prototype.locateFaces=function(e,r){return Oe(this,void 0,void 0,function(){var a;return Ie(this,function(o){switch(o.label){case 0:return[4,this.detect(e,r)];case 1:return a=o.sent(),[2,a.map(function(u){return new dr(u.score,u.relativeBox,{width:u.imageWidth,height:u.imageHeight})})]}})})},t.prototype.getDefaultModelName=function(){return"tiny_face_detector_model"},t.prototype.extractParamsFromWeigthMap=function(e){return n.prototype.extractParamsFromWeigthMap.call(this,e)},t}(BS),On={ssdMobilenetv1:new IS,tinyFaceDetector:new WO,tinyYolov2:new CO,mtcnn:new UO,faceLandmark68Net:new AS,faceLandmark68TinyNet:new GM,faceRecognitionNet:new ZM,faceExpressionNet:new NM,ageGenderNet:new jM},LS=function(n){He(t,n);function t(e,r,a){var o=n.call(this)||this;return o.parentTask=e,o.input=r,o.extractedFaces=a,o}return t}(wl),cg=function(n){He(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.run=function(){return Oe(this,void 0,void 0,function(){var e,r,a=this;return Ie(this,function(o){switch(o.label){case 0:return[4,this.parentTask];case 1:return e=o.sent(),[4,ld(e,this.input,function(u){return Oe(a,void 0,void 0,function(){return Ie(this,function(l){switch(l.label){case 0:return[4,Promise.all(u.map(function(c){return On.faceExpressionNet.predictExpressions(c)}))];case 1:return[2,l.sent()]}})})},this.extractedFaces)];case 2:return r=o.sent(),[2,e.map(function(u,l){return CS(u,r[l])})]}})})},t.prototype.withAgeAndGender=function(){return new pg(this,this.input)},t}(LS),fg=function(n){He(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.run=function(){return Oe(this,void 0,void 0,function(){var e,r;return Ie(this,function(a){switch(a.label){case 0:return[4,this.parentTask];case 1:return e=a.sent(),e?[4,sg(e,this.input,function(o){return On.faceExpressionNet.predictExpressions(o)},this.extractedFaces)]:[2];case 2:return r=a.sent(),[2,CS(e,r)]}})})},t.prototype.withAgeAndGender=function(){return new vg(this,this.input)},t}(LS),dg=function(n){He(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.withAgeAndGender=function(){return new mg(this,this.input)},t.prototype.withFaceDescriptors=function(){return new yg(this,this.input)},t}(cg),hg=function(n){He(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.withAgeAndGender=function(){return new gg(this,this.input)},t.prototype.withFaceDescriptor=function(){return new bg(this,this.input)},t}(fg),zS=function(n){He(t,n);function t(e,r,a){var o=n.call(this)||this;return o.parentTask=e,o.input=r,o.extractedFaces=a,o}return t}(wl),pg=function(n){He(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.run=function(){return Oe(this,void 0,void 0,function(){var e,r,a=this;return Ie(this,function(o){switch(o.label){case 0:return[4,this.parentTask];case 1:return e=o.sent(),[4,ld(e,this.input,function(u){return Oe(a,void 0,void 0,function(){return Ie(this,function(l){switch(l.label){case 0:return[4,Promise.all(u.map(function(c){return On.ageGenderNet.predictAgeAndGender(c)}))];case 1:return[2,l.sent()]}})})},this.extractedFaces)];case 2:return r=o.sent(),[2,e.map(function(u,l){var c=r[l],f=c.age,h=c.gender,p=c.genderProbability;return kS(MS(u,h,p),f)})]}})})},t.prototype.withFaceExpressions=function(){return new cg(this,this.input)},t}(zS),vg=function(n){He(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.run=function(){return Oe(this,void 0,void 0,function(){var e,r,a,o,u;return Ie(this,function(l){switch(l.label){case 0:return[4,this.parentTask];case 1:return e=l.sent(),e?[4,sg(e,this.input,function(c){return On.ageGenderNet.predictAgeAndGender(c)},this.extractedFaces)]:[2];case 2:return r=l.sent(),a=r.age,o=r.gender,u=r.genderProbability,[2,kS(MS(e,o,u),a)]}})})},t.prototype.withFaceExpressions=function(){return new fg(this,this.input)},t}(zS),mg=function(n){He(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.withFaceExpressions=function(){return new dg(this,this.input)},t.prototype.withFaceDescriptors=function(){return new yg(this,this.input)},t}(pg),gg=function(n){He(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.withFaceExpressions=function(){return new hg(this,this.input)},t.prototype.withFaceDescriptor=function(){return new bg(this,this.input)},t}(vg),US=function(n){He(t,n);function t(e,r){var a=n.call(this)||this;return a.parentTask=e,a.input=r,a}return t}(wl),yg=function(n){He(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.run=function(){return Oe(this,void 0,void 0,function(){var e,r;return Ie(this,function(a){switch(a.label){case 0:return[4,this.parentTask];case 1:return e=a.sent(),[4,ld(e,this.input,function(o){return Promise.all(o.map(function(u){return On.faceRecognitionNet.computeFaceDescriptor(u)}))},null,function(o){return o.landmarks.align(null,{useDlibAlignment:!0})})];case 2:return r=a.sent(),[2,r.map(function(o,u){return DS(e[u],o)})]}})})},t.prototype.withFaceExpressions=function(){return new dg(this,this.input)},t.prototype.withAgeAndGender=function(){return new mg(this,this.input)},t}(US),bg=function(n){He(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.run=function(){return Oe(this,void 0,void 0,function(){var e,r;return Ie(this,function(a){switch(a.label){case 0:return[4,this.parentTask];case 1:return e=a.sent(),e?[4,sg(e,this.input,function(o){return On.faceRecognitionNet.computeFaceDescriptor(o)},null,function(o){return o.landmarks.align(null,{useDlibAlignment:!0})})]:[2];case 2:return r=a.sent(),[2,DS(e,r)]}})})},t.prototype.withFaceExpressions=function(){return new hg(this,this.input)},t.prototype.withAgeAndGender=function(){return new gg(this,this.input)},t}(US),jS=function(n){He(t,n);function t(e,r,a){var o=n.call(this)||this;return o.parentTask=e,o.input=r,o.useTinyLandmarkNet=a,o}return Object.defineProperty(t.prototype,"landmarkNet",{get:function(){return this.useTinyLandmarkNet?On.faceLandmark68TinyNet:On.faceLandmark68Net},enumerable:!0,configurable:!0}),t}(wl),GO=function(n){He(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.run=function(){return Oe(this,void 0,void 0,function(){var e,r,a,o,u,l=this;return Ie(this,function(c){switch(c.label){case 0:return[4,this.parentTask];case 1:return e=c.sent(),r=e.map(function(f){return f.detection}),this.input instanceof Mt?[4,Jm(this.input,r)]:[3,3];case 2:return o=c.sent(),[3,5];case 3:return[4,Zm(this.input,r)];case 4:o=c.sent(),c.label=5;case 5:return a=o,[4,Promise.all(a.map(function(f){return l.landmarkNet.detectLandmarks(f)}))];case 6:return u=c.sent(),a.forEach(function(f){return f instanceof Mt&&f.dispose()}),[2,e.map(function(f,h){return ud(f,u[h])})]}})})},t.prototype.withFaceExpressions=function(){return new dg(this,this.input)},t.prototype.withAgeAndGender=function(){return new mg(this,this.input)},t.prototype.withFaceDescriptors=function(){return new yg(this,this.input)},t}(jS),qO=function(n){He(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.run=function(){return Oe(this,void 0,void 0,function(){var e,r,a,o,u;return Ie(this,function(l){switch(l.label){case 0:return[4,this.parentTask];case 1:return e=l.sent(),e?(r=e.detection,this.input instanceof Mt?[4,Jm(this.input,[r])]:[3,3]):[2];case 2:return o=l.sent(),[3,5];case 3:return[4,Zm(this.input,[r])];case 4:o=l.sent(),l.label=5;case 5:return a=o,[4,this.landmarkNet.detectLandmarks(a[0])];case 6:return u=l.sent(),a.forEach(function(c){return c instanceof Mt&&c.dispose()}),[2,ud(e,u)]}})})},t.prototype.withFaceExpressions=function(){return new hg(this,this.input)},t.prototype.withAgeAndGender=function(){return new gg(this,this.input)},t.prototype.withFaceDescriptor=function(){return new bg(this,this.input)},t}(jS),HS=function(n){He(t,n);function t(e,r){r===void 0&&(r=new Ro);var a=n.call(this)||this;return a.input=e,a.options=r,a}return t}(wl),VS=function(n){He(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.run=function(){return Oe(this,void 0,void 0,function(){var e,r,a,o;return Ie(this,function(u){switch(u.label){case 0:return e=this,r=e.input,a=e.options,a instanceof OS?[4,On.mtcnn.forward(r,a)]:[3,2];case 1:return[2,u.sent().map(function(l){return l.detection})];case 2:if(o=a instanceof _O?function(l){return On.tinyFaceDetector.locateFaces(l,a)}:a instanceof Ro?function(l){return On.ssdMobilenetv1.locateFaces(l,a)}:a instanceof ig?function(l){return On.tinyYolov2.locateFaces(l,a)}:null,!o)throw new Error("detectFaces - expected options to be instance of TinyFaceDetectorOptions | SsdMobilenetv1Options | MtcnnOptions | TinyYolov2Options");return[2,o(r)]}})})},t.prototype.runAndExtendWithFaceDetections=function(){var e=this;return new Promise(function(r){return Oe(e,void 0,void 0,function(){var a;return Ie(this,function(o){switch(o.label){case 0:return[4,this.run()];case 1:return a=o.sent(),[2,r(a.map(function(u){return il({},u)}))]}})})})},t.prototype.withFaceLandmarks=function(e){return e===void 0&&(e=!1),new GO(this.runAndExtendWithFaceDetections(),this.input,e)},t.prototype.withFaceExpressions=function(){return new cg(this.runAndExtendWithFaceDetections(),this.input)},t.prototype.withAgeAndGender=function(){return new pg(this.runAndExtendWithFaceDetections(),this.input)},t}(HS),XO=function(n){He(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.run=function(){return Oe(this,void 0,void 0,function(){var e,r;return Ie(this,function(a){switch(a.label){case 0:return[4,new VS(this.input,this.options)];case 1:return e=a.sent(),r=e[0],e.forEach(function(o){o.score>r.score&&(r=o)}),[2,r]}})})},t.prototype.runAndExtendWithFaceDetection=function(){var e=this;return new Promise(function(r){return Oe(e,void 0,void 0,function(){var a;return Ie(this,function(o){switch(o.label){case 0:return[4,this.run()];case 1:return a=o.sent(),[2,r(a?il({},a):void 0)]}})})})},t.prototype.withFaceLandmarks=function(e){return e===void 0&&(e=!1),new qO(this.runAndExtendWithFaceDetection(),this.input,e)},t.prototype.withFaceExpressions=function(){return new fg(this.runAndExtendWithFaceDetection(),this.input)},t.prototype.withAgeAndGender=function(){return new vg(this.runAndExtendWithFaceDetection(),this.input)},t}(HS);function YO(n,t){return t===void 0&&(t=new Ro),new XO(n,t)}function I1(n,t){return t===void 0&&(t=new Ro),new VS(n,t)}function KO(n,t){if(n.length!==t.length)throw new Error("euclideanDistance: arr1.length !== arr2.length");var e=Array.from(n),r=Array.from(t);return Math.sqrt(e.map(function(a,o){return a-r[o]}).reduce(function(a,o){return a+Math.pow(o,2)},0))}var B1=function(){function n(t,e){e===void 0&&(e=.6),this._distanceThreshold=e;var r=Array.isArray(t)?t:[t];if(!r.length)throw new Error("FaceRecognizer.constructor - expected atleast one input");var a=1,o=function(){return"person "+a++};this._labeledDescriptors=r.map(function(u){if(u instanceof ys)return u;if(u instanceof Float32Array)return new ys(o(),[u]);if(u.descriptor&&u.descriptor instanceof Float32Array)return new ys(o(),[u.descriptor]);throw new Error("FaceRecognizer.constructor - expected inputs to be of type LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array | Array<LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array>")})}return Object.defineProperty(n.prototype,"labeledDescriptors",{get:function(){return this._labeledDescriptors},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"distanceThreshold",{get:function(){return this._distanceThreshold},enumerable:!0,configurable:!0}),n.prototype.computeMeanDistance=function(t,e){return e.map(function(r){return KO(r,t)}).reduce(function(r,a){return r+a},0)/(e.length||1)},n.prototype.matchDescriptor=function(t){var e=this;return this.labeledDescriptors.map(function(r){var a=r.descriptors,o=r.label;return new N1(o,e.computeMeanDistance(t,a))}).reduce(function(r,a){return r.distance<a.distance?r:a})},n.prototype.findBestMatch=function(t){var e=this.matchDescriptor(t);return e.distance<this.distanceThreshold?e:new N1("unknown",e.distance)},n.prototype.toJSON=function(){return{distanceThreshold:this.distanceThreshold,labeledDescriptors:this.labeledDescriptors.map(function(t){return t.toJSON()})}},n.fromJSON=function(t){var e=t.labeledDescriptors.map(function(r){return ys.fromJSON(r)});return new n(e,t.distanceThreshold)},n}();function WS(n,t){var e=new li(t.width,t.height),r=e.width,a=e.height;if(r<=0||a<=0)throw new Error("resizeResults - invalid dimensions: "+JSON.stringify({width:r,height:a}));if(Array.isArray(n))return n.map(function(l){return WS(l,{width:r,height:a})});if(rg(n)){var o=n.detection.forSize(r,a),u=n.unshiftedLandmarks.forSize(o.box.width,o.box.height);return ud(il(n,o),u)}return Ff(n)?il(n,n.detection.forSize(r,a)):n instanceof Os||n instanceof dr?n.forSize(r,a):n}function GS(n){var t,e,r="";if(typeof n=="string"||typeof n=="number")r+=n;else if(typeof n=="object")if(Array.isArray(n)){var a=n.length;for(t=0;t<a;t++)n[t]&&(e=GS(n[t]))&&(r&&(r+=" "),r+=e)}else for(e in n)n[e]&&(r&&(r+=" "),r+=e);return r}function qS(){for(var n,t,e=0,r="",a=arguments.length;e<a;e++)(n=arguments[e])&&(t=GS(n))&&(r&&(r+=" "),r+=t);return r}const xg="-",QO=n=>{const t=ZO(n),{conflictingClassGroups:e,conflictingClassGroupModifiers:r}=n;return{getClassGroupId:u=>{const l=u.split(xg);return l[0]===""&&l.length!==1&&l.shift(),XS(l,t)||$O(u)},getConflictingClassGroupIds:(u,l)=>{const c=e[u]||[];return l&&r[u]?[...c,...r[u]]:c}}},XS=(n,t)=>{if(n.length===0)return t.classGroupId;const e=n[0],r=t.nextPart.get(e),a=r?XS(n.slice(1),r):void 0;if(a)return a;if(t.validators.length===0)return;const o=n.join(xg);return t.validators.find(({validator:u})=>u(o))?.classGroupId},F1=/^\[(.+)\]$/,$O=n=>{if(F1.test(n)){const t=F1.exec(n)[1],e=t?.substring(0,t.indexOf(":"));if(e)return"arbitrary.."+e}},ZO=n=>{const{theme:t,classGroups:e}=n,r={nextPart:new Map,validators:[]};for(const a in e)Yv(e[a],r,a,t);return r},Yv=(n,t,e,r)=>{n.forEach(a=>{if(typeof a=="string"){const o=a===""?t:P1(t,a);o.classGroupId=e;return}if(typeof a=="function"){if(JO(a)){Yv(a(r),t,e,r);return}t.validators.push({validator:a,classGroupId:e});return}Object.entries(a).forEach(([o,u])=>{Yv(u,P1(t,o),e,r)})})},P1=(n,t)=>{let e=n;return t.split(xg).forEach(r=>{e.nextPart.has(r)||e.nextPart.set(r,{nextPart:new Map,validators:[]}),e=e.nextPart.get(r)}),e},JO=n=>n.isThemeGetter,eI=n=>{if(n<1)return{get:()=>{},set:()=>{}};let t=0,e=new Map,r=new Map;const a=(o,u)=>{e.set(o,u),t++,t>n&&(t=0,r=e,e=new Map)};return{get(o){let u=e.get(o);if(u!==void 0)return u;if((u=r.get(o))!==void 0)return a(o,u),u},set(o,u){e.has(o)?e.set(o,u):a(o,u)}}},Kv="!",Qv=":",tI=Qv.length,nI=n=>{const{prefix:t,experimentalParseClassName:e}=n;let r=a=>{const o=[];let u=0,l=0,c=0,f;for(let b=0;b<a.length;b++){let x=a[b];if(u===0&&l===0){if(x===Qv){o.push(a.slice(c,b)),c=b+tI;continue}if(x==="/"){f=b;continue}}x==="["?u++:x==="]"?u--:x==="("?l++:x===")"&&l--}const h=o.length===0?a:a.substring(c),p=rI(h),m=p!==h,g=f&&f>c?f-c:void 0;return{modifiers:o,hasImportantModifier:m,baseClassName:p,maybePostfixModifierPosition:g}};if(t){const a=t+Qv,o=r;r=u=>u.startsWith(a)?o(u.substring(a.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:u,maybePostfixModifierPosition:void 0}}if(e){const a=r;r=o=>e({className:o,parseClassName:a})}return r},rI=n=>n.endsWith(Kv)?n.substring(0,n.length-1):n.startsWith(Kv)?n.substring(1):n,aI=n=>{const t=Object.fromEntries(n.orderSensitiveModifiers.map(r=>[r,!0]));return r=>{if(r.length<=1)return r;const a=[];let o=[];return r.forEach(u=>{u[0]==="["||t[u]?(a.push(...o.sort(),u),o=[]):o.push(u)}),a.push(...o.sort()),a}},oI=n=>({cache:eI(n.cacheSize),parseClassName:nI(n),sortModifiers:aI(n),...QO(n)}),iI=/\s+/,sI=(n,t)=>{const{parseClassName:e,getClassGroupId:r,getConflictingClassGroupIds:a,sortModifiers:o}=t,u=[],l=n.trim().split(iI);let c="";for(let f=l.length-1;f>=0;f-=1){const h=l[f],{isExternal:p,modifiers:m,hasImportantModifier:g,baseClassName:b,maybePostfixModifierPosition:x}=e(h);if(p){c=h+(c.length>0?" "+c:c);continue}let w=!!x,E=r(w?b.substring(0,x):b);if(!E){if(!w){c=h+(c.length>0?" "+c:c);continue}if(E=r(b),!E){c=h+(c.length>0?" "+c:c);continue}w=!1}const C=o(m).join(":"),_=g?C+Kv:C,R=_+E;if(u.includes(R))continue;u.push(R);const A=a(E,w);for(let D=0;D<A.length;++D){const M=A[D];u.push(_+M)}c=h+(c.length>0?" "+c:c)}return c};function uI(){let n=0,t,e,r="";for(;n<arguments.length;)(t=arguments[n++])&&(e=YS(t))&&(r&&(r+=" "),r+=e);return r}const YS=n=>{if(typeof n=="string")return n;let t,e="";for(let r=0;r<n.length;r++)n[r]&&(t=YS(n[r]))&&(e&&(e+=" "),e+=t);return e};function lI(n,...t){let e,r,a,o=u;function u(c){const f=t.reduce((h,p)=>p(h),n());return e=oI(f),r=e.cache.get,a=e.cache.set,o=l,l(c)}function l(c){const f=r(c);if(f)return f;const h=sI(c,e);return a(c,h),h}return function(){return o(uI.apply(null,arguments))}}const en=n=>{const t=e=>e[n]||[];return t.isThemeGetter=!0,t},KS=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,QS=/^\((?:(\w[\w-]*):)?(.+)\)$/i,cI=/^\d+\/\d+$/,fI=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,dI=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,hI=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,pI=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,vI=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,cs=n=>cI.test(n),Ke=n=>!!n&&!Number.isNaN(Number(n)),yo=n=>!!n&&Number.isInteger(Number(n)),lv=n=>n.endsWith("%")&&Ke(n.slice(0,-1)),Ia=n=>fI.test(n),mI=()=>!0,gI=n=>dI.test(n)&&!hI.test(n),$S=()=>!1,yI=n=>pI.test(n),bI=n=>vI.test(n),xI=n=>!Re(n)&&!Ae(n),wI=n=>Ls(n,eE,$S),Re=n=>KS.test(n),ri=n=>Ls(n,tE,gI),cv=n=>Ls(n,RI,Ke),L1=n=>Ls(n,ZS,$S),SI=n=>Ls(n,JS,bI),Jc=n=>Ls(n,nE,yI),Ae=n=>QS.test(n),Xu=n=>zs(n,tE),EI=n=>zs(n,AI),z1=n=>zs(n,ZS),CI=n=>zs(n,eE),_I=n=>zs(n,JS),ef=n=>zs(n,nE,!0),Ls=(n,t,e)=>{const r=KS.exec(n);return r?r[1]?t(r[1]):e(r[2]):!1},zs=(n,t,e=!1)=>{const r=QS.exec(n);return r?r[1]?t(r[1]):e:!1},ZS=n=>n==="position"||n==="percentage",JS=n=>n==="image"||n==="url",eE=n=>n==="length"||n==="size"||n==="bg-size",tE=n=>n==="length",RI=n=>n==="number",AI=n=>n==="family-name",nE=n=>n==="shadow",TI=()=>{const n=en("color"),t=en("font"),e=en("text"),r=en("font-weight"),a=en("tracking"),o=en("leading"),u=en("breakpoint"),l=en("container"),c=en("spacing"),f=en("radius"),h=en("shadow"),p=en("inset-shadow"),m=en("text-shadow"),g=en("drop-shadow"),b=en("blur"),x=en("perspective"),w=en("aspect"),E=en("ease"),C=en("animate"),_=()=>["auto","avoid","all","avoid-page","page","left","right","column"],R=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],A=()=>[...R(),Ae,Re],D=()=>["auto","hidden","clip","visible","scroll"],M=()=>["auto","contain","none"],k=()=>[Ae,Re,c],B=()=>[cs,"full","auto",...k()],O=()=>[yo,"none","subgrid",Ae,Re],V=()=>["auto",{span:["full",yo,Ae,Re]},yo,Ae,Re],H=()=>[yo,"auto",Ae,Re],ee=()=>["auto","min","max","fr",Ae,Re],$=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],K=()=>["start","end","center","stretch","center-safe","end-safe"],L=()=>["auto",...k()],W=()=>[cs,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...k()],U=()=>[n,Ae,Re],Z=()=>[...R(),z1,L1,{position:[Ae,Re]}],P=()=>["no-repeat",{repeat:["","x","y","space","round"]}],q=()=>["auto","cover","contain",CI,wI,{size:[Ae,Re]}],ne=()=>[lv,Xu,ri],J=()=>["","none","full",f,Ae,Re],le=()=>["",Ke,Xu,ri],ye=()=>["solid","dashed","dotted","double"],pe=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],de=()=>[Ke,lv,z1,L1],ce=()=>["","none",b,Ae,Re],xe=()=>["none",Ke,Ae,Re],we=()=>["none",Ke,Ae,Re],Ee=()=>[Ke,Ae,Re],De=()=>[cs,"full",...k()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[Ia],breakpoint:[Ia],color:[mI],container:[Ia],"drop-shadow":[Ia],ease:["in","out","in-out"],font:[xI],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[Ia],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[Ia],shadow:[Ia],spacing:["px",Ke],text:[Ia],"text-shadow":[Ia],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",cs,Re,Ae,w]}],container:["container"],columns:[{columns:[Ke,Re,Ae,l]}],"break-after":[{"break-after":_()}],"break-before":[{"break-before":_()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:A()}],overflow:[{overflow:D()}],"overflow-x":[{"overflow-x":D()}],"overflow-y":[{"overflow-y":D()}],overscroll:[{overscroll:M()}],"overscroll-x":[{"overscroll-x":M()}],"overscroll-y":[{"overscroll-y":M()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:B()}],"inset-x":[{"inset-x":B()}],"inset-y":[{"inset-y":B()}],start:[{start:B()}],end:[{end:B()}],top:[{top:B()}],right:[{right:B()}],bottom:[{bottom:B()}],left:[{left:B()}],visibility:["visible","invisible","collapse"],z:[{z:[yo,"auto",Ae,Re]}],basis:[{basis:[cs,"full","auto",l,...k()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[Ke,cs,"auto","initial","none",Re]}],grow:[{grow:["",Ke,Ae,Re]}],shrink:[{shrink:["",Ke,Ae,Re]}],order:[{order:[yo,"first","last","none",Ae,Re]}],"grid-cols":[{"grid-cols":O()}],"col-start-end":[{col:V()}],"col-start":[{"col-start":H()}],"col-end":[{"col-end":H()}],"grid-rows":[{"grid-rows":O()}],"row-start-end":[{row:V()}],"row-start":[{"row-start":H()}],"row-end":[{"row-end":H()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":ee()}],"auto-rows":[{"auto-rows":ee()}],gap:[{gap:k()}],"gap-x":[{"gap-x":k()}],"gap-y":[{"gap-y":k()}],"justify-content":[{justify:[...$(),"normal"]}],"justify-items":[{"justify-items":[...K(),"normal"]}],"justify-self":[{"justify-self":["auto",...K()]}],"align-content":[{content:["normal",...$()]}],"align-items":[{items:[...K(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...K(),{baseline:["","last"]}]}],"place-content":[{"place-content":$()}],"place-items":[{"place-items":[...K(),"baseline"]}],"place-self":[{"place-self":["auto",...K()]}],p:[{p:k()}],px:[{px:k()}],py:[{py:k()}],ps:[{ps:k()}],pe:[{pe:k()}],pt:[{pt:k()}],pr:[{pr:k()}],pb:[{pb:k()}],pl:[{pl:k()}],m:[{m:L()}],mx:[{mx:L()}],my:[{my:L()}],ms:[{ms:L()}],me:[{me:L()}],mt:[{mt:L()}],mr:[{mr:L()}],mb:[{mb:L()}],ml:[{ml:L()}],"space-x":[{"space-x":k()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":k()}],"space-y-reverse":["space-y-reverse"],size:[{size:W()}],w:[{w:[l,"screen",...W()]}],"min-w":[{"min-w":[l,"screen","none",...W()]}],"max-w":[{"max-w":[l,"screen","none","prose",{screen:[u]},...W()]}],h:[{h:["screen","lh",...W()]}],"min-h":[{"min-h":["screen","lh","none",...W()]}],"max-h":[{"max-h":["screen","lh",...W()]}],"font-size":[{text:["base",e,Xu,ri]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[r,Ae,cv]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",lv,Re]}],"font-family":[{font:[EI,Re,t]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[a,Ae,Re]}],"line-clamp":[{"line-clamp":[Ke,"none",Ae,cv]}],leading:[{leading:[o,...k()]}],"list-image":[{"list-image":["none",Ae,Re]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",Ae,Re]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:U()}],"text-color":[{text:U()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...ye(),"wavy"]}],"text-decoration-thickness":[{decoration:[Ke,"from-font","auto",Ae,ri]}],"text-decoration-color":[{decoration:U()}],"underline-offset":[{"underline-offset":[Ke,"auto",Ae,Re]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:k()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Ae,Re]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Ae,Re]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:Z()}],"bg-repeat":[{bg:P()}],"bg-size":[{bg:q()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},yo,Ae,Re],radial:["",Ae,Re],conic:[yo,Ae,Re]},_I,SI]}],"bg-color":[{bg:U()}],"gradient-from-pos":[{from:ne()}],"gradient-via-pos":[{via:ne()}],"gradient-to-pos":[{to:ne()}],"gradient-from":[{from:U()}],"gradient-via":[{via:U()}],"gradient-to":[{to:U()}],rounded:[{rounded:J()}],"rounded-s":[{"rounded-s":J()}],"rounded-e":[{"rounded-e":J()}],"rounded-t":[{"rounded-t":J()}],"rounded-r":[{"rounded-r":J()}],"rounded-b":[{"rounded-b":J()}],"rounded-l":[{"rounded-l":J()}],"rounded-ss":[{"rounded-ss":J()}],"rounded-se":[{"rounded-se":J()}],"rounded-ee":[{"rounded-ee":J()}],"rounded-es":[{"rounded-es":J()}],"rounded-tl":[{"rounded-tl":J()}],"rounded-tr":[{"rounded-tr":J()}],"rounded-br":[{"rounded-br":J()}],"rounded-bl":[{"rounded-bl":J()}],"border-w":[{border:le()}],"border-w-x":[{"border-x":le()}],"border-w-y":[{"border-y":le()}],"border-w-s":[{"border-s":le()}],"border-w-e":[{"border-e":le()}],"border-w-t":[{"border-t":le()}],"border-w-r":[{"border-r":le()}],"border-w-b":[{"border-b":le()}],"border-w-l":[{"border-l":le()}],"divide-x":[{"divide-x":le()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":le()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...ye(),"hidden","none"]}],"divide-style":[{divide:[...ye(),"hidden","none"]}],"border-color":[{border:U()}],"border-color-x":[{"border-x":U()}],"border-color-y":[{"border-y":U()}],"border-color-s":[{"border-s":U()}],"border-color-e":[{"border-e":U()}],"border-color-t":[{"border-t":U()}],"border-color-r":[{"border-r":U()}],"border-color-b":[{"border-b":U()}],"border-color-l":[{"border-l":U()}],"divide-color":[{divide:U()}],"outline-style":[{outline:[...ye(),"none","hidden"]}],"outline-offset":[{"outline-offset":[Ke,Ae,Re]}],"outline-w":[{outline:["",Ke,Xu,ri]}],"outline-color":[{outline:U()}],shadow:[{shadow:["","none",h,ef,Jc]}],"shadow-color":[{shadow:U()}],"inset-shadow":[{"inset-shadow":["none",p,ef,Jc]}],"inset-shadow-color":[{"inset-shadow":U()}],"ring-w":[{ring:le()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:U()}],"ring-offset-w":[{"ring-offset":[Ke,ri]}],"ring-offset-color":[{"ring-offset":U()}],"inset-ring-w":[{"inset-ring":le()}],"inset-ring-color":[{"inset-ring":U()}],"text-shadow":[{"text-shadow":["none",m,ef,Jc]}],"text-shadow-color":[{"text-shadow":U()}],opacity:[{opacity:[Ke,Ae,Re]}],"mix-blend":[{"mix-blend":[...pe(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":pe()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[Ke]}],"mask-image-linear-from-pos":[{"mask-linear-from":de()}],"mask-image-linear-to-pos":[{"mask-linear-to":de()}],"mask-image-linear-from-color":[{"mask-linear-from":U()}],"mask-image-linear-to-color":[{"mask-linear-to":U()}],"mask-image-t-from-pos":[{"mask-t-from":de()}],"mask-image-t-to-pos":[{"mask-t-to":de()}],"mask-image-t-from-color":[{"mask-t-from":U()}],"mask-image-t-to-color":[{"mask-t-to":U()}],"mask-image-r-from-pos":[{"mask-r-from":de()}],"mask-image-r-to-pos":[{"mask-r-to":de()}],"mask-image-r-from-color":[{"mask-r-from":U()}],"mask-image-r-to-color":[{"mask-r-to":U()}],"mask-image-b-from-pos":[{"mask-b-from":de()}],"mask-image-b-to-pos":[{"mask-b-to":de()}],"mask-image-b-from-color":[{"mask-b-from":U()}],"mask-image-b-to-color":[{"mask-b-to":U()}],"mask-image-l-from-pos":[{"mask-l-from":de()}],"mask-image-l-to-pos":[{"mask-l-to":de()}],"mask-image-l-from-color":[{"mask-l-from":U()}],"mask-image-l-to-color":[{"mask-l-to":U()}],"mask-image-x-from-pos":[{"mask-x-from":de()}],"mask-image-x-to-pos":[{"mask-x-to":de()}],"mask-image-x-from-color":[{"mask-x-from":U()}],"mask-image-x-to-color":[{"mask-x-to":U()}],"mask-image-y-from-pos":[{"mask-y-from":de()}],"mask-image-y-to-pos":[{"mask-y-to":de()}],"mask-image-y-from-color":[{"mask-y-from":U()}],"mask-image-y-to-color":[{"mask-y-to":U()}],"mask-image-radial":[{"mask-radial":[Ae,Re]}],"mask-image-radial-from-pos":[{"mask-radial-from":de()}],"mask-image-radial-to-pos":[{"mask-radial-to":de()}],"mask-image-radial-from-color":[{"mask-radial-from":U()}],"mask-image-radial-to-color":[{"mask-radial-to":U()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":R()}],"mask-image-conic-pos":[{"mask-conic":[Ke]}],"mask-image-conic-from-pos":[{"mask-conic-from":de()}],"mask-image-conic-to-pos":[{"mask-conic-to":de()}],"mask-image-conic-from-color":[{"mask-conic-from":U()}],"mask-image-conic-to-color":[{"mask-conic-to":U()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:Z()}],"mask-repeat":[{mask:P()}],"mask-size":[{mask:q()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",Ae,Re]}],filter:[{filter:["","none",Ae,Re]}],blur:[{blur:ce()}],brightness:[{brightness:[Ke,Ae,Re]}],contrast:[{contrast:[Ke,Ae,Re]}],"drop-shadow":[{"drop-shadow":["","none",g,ef,Jc]}],"drop-shadow-color":[{"drop-shadow":U()}],grayscale:[{grayscale:["",Ke,Ae,Re]}],"hue-rotate":[{"hue-rotate":[Ke,Ae,Re]}],invert:[{invert:["",Ke,Ae,Re]}],saturate:[{saturate:[Ke,Ae,Re]}],sepia:[{sepia:["",Ke,Ae,Re]}],"backdrop-filter":[{"backdrop-filter":["","none",Ae,Re]}],"backdrop-blur":[{"backdrop-blur":ce()}],"backdrop-brightness":[{"backdrop-brightness":[Ke,Ae,Re]}],"backdrop-contrast":[{"backdrop-contrast":[Ke,Ae,Re]}],"backdrop-grayscale":[{"backdrop-grayscale":["",Ke,Ae,Re]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[Ke,Ae,Re]}],"backdrop-invert":[{"backdrop-invert":["",Ke,Ae,Re]}],"backdrop-opacity":[{"backdrop-opacity":[Ke,Ae,Re]}],"backdrop-saturate":[{"backdrop-saturate":[Ke,Ae,Re]}],"backdrop-sepia":[{"backdrop-sepia":["",Ke,Ae,Re]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":k()}],"border-spacing-x":[{"border-spacing-x":k()}],"border-spacing-y":[{"border-spacing-y":k()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",Ae,Re]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[Ke,"initial",Ae,Re]}],ease:[{ease:["linear","initial",E,Ae,Re]}],delay:[{delay:[Ke,Ae,Re]}],animate:[{animate:["none",C,Ae,Re]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[x,Ae,Re]}],"perspective-origin":[{"perspective-origin":A()}],rotate:[{rotate:xe()}],"rotate-x":[{"rotate-x":xe()}],"rotate-y":[{"rotate-y":xe()}],"rotate-z":[{"rotate-z":xe()}],scale:[{scale:we()}],"scale-x":[{"scale-x":we()}],"scale-y":[{"scale-y":we()}],"scale-z":[{"scale-z":we()}],"scale-3d":["scale-3d"],skew:[{skew:Ee()}],"skew-x":[{"skew-x":Ee()}],"skew-y":[{"skew-y":Ee()}],transform:[{transform:[Ae,Re,"","none","gpu","cpu"]}],"transform-origin":[{origin:A()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:De()}],"translate-x":[{"translate-x":De()}],"translate-y":[{"translate-y":De()}],"translate-z":[{"translate-z":De()}],"translate-none":["translate-none"],accent:[{accent:U()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:U()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Ae,Re]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":k()}],"scroll-mx":[{"scroll-mx":k()}],"scroll-my":[{"scroll-my":k()}],"scroll-ms":[{"scroll-ms":k()}],"scroll-me":[{"scroll-me":k()}],"scroll-mt":[{"scroll-mt":k()}],"scroll-mr":[{"scroll-mr":k()}],"scroll-mb":[{"scroll-mb":k()}],"scroll-ml":[{"scroll-ml":k()}],"scroll-p":[{"scroll-p":k()}],"scroll-px":[{"scroll-px":k()}],"scroll-py":[{"scroll-py":k()}],"scroll-ps":[{"scroll-ps":k()}],"scroll-pe":[{"scroll-pe":k()}],"scroll-pt":[{"scroll-pt":k()}],"scroll-pr":[{"scroll-pr":k()}],"scroll-pb":[{"scroll-pb":k()}],"scroll-pl":[{"scroll-pl":k()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Ae,Re]}],fill:[{fill:["none",...U()]}],"stroke-w":[{stroke:[Ke,Xu,ri,cv]}],stroke:[{stroke:["none",...U()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},NI=lI(TI);function Ct(...n){return NI(qS(n))}function Uf({className:n,...t}){return N.jsx("div",{"data-slot":"card",className:Ct("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",n),...t})}function wg({className:n,...t}){return N.jsx("div",{"data-slot":"card-header",className:Ct("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",n),...t})}function Sg({className:n,...t}){return N.jsx("div",{"data-slot":"card-title",className:Ct("leading-none font-semibold",n),...t})}function $v({className:n,...t}){return N.jsx("div",{"data-slot":"card-content",className:Ct("px-6",n),...t})}function U1(n,t){if(typeof n=="function")return n(t);n!=null&&(n.current=t)}function rE(...n){return t=>{let e=!1;const r=n.map(a=>{const o=U1(a,t);return!e&&typeof o=="function"&&(e=!0),o});if(e)return()=>{for(let a=0;a<r.length;a++){const o=r[a];typeof o=="function"?o():U1(n[a],null)}}}}function bt(...n){return F.useCallback(rE(...n),n)}function sl(n){const t=DI(n),e=F.forwardRef((r,a)=>{const{children:o,...u}=r,l=F.Children.toArray(o),c=l.find(MI);if(c){const f=c.props.children,h=l.map(p=>p===c?F.Children.count(f)>1?F.Children.only(null):F.isValidElement(f)?f.props.children:null:p);return N.jsx(t,{...u,ref:a,children:F.isValidElement(f)?F.cloneElement(f,void 0,h):null})}return N.jsx(t,{...u,ref:a,children:o})});return e.displayName=`${n}.Slot`,e}var aE=sl("Slot");function DI(n){const t=F.forwardRef((e,r)=>{const{children:a,...o}=e;if(F.isValidElement(a)){const u=II(a),l=OI(o,a.props);return a.type!==F.Fragment&&(l.ref=r?rE(r,u):u),F.cloneElement(a,l)}return F.Children.count(a)>1?F.Children.only(null):null});return t.displayName=`${n}.SlotClone`,t}var kI=Symbol("radix.slottable");function MI(n){return F.isValidElement(n)&&typeof n.type=="function"&&"__radixId"in n.type&&n.type.__radixId===kI}function OI(n,t){const e={...t};for(const r in t){const a=n[r],o=t[r];/^on[A-Z]/.test(r)?a&&o?e[r]=(...l)=>{const c=o(...l);return a(...l),c}:a&&(e[r]=a):r==="style"?e[r]={...a,...o}:r==="className"&&(e[r]=[a,o].filter(Boolean).join(" "))}return{...n,...e}}function II(n){let t=Object.getOwnPropertyDescriptor(n.props,"ref")?.get,e=t&&"isReactWarning"in t&&t.isReactWarning;return e?n.ref:(t=Object.getOwnPropertyDescriptor(n,"ref")?.get,e=t&&"isReactWarning"in t&&t.isReactWarning,e?n.props.ref:n.props.ref||n.ref)}const j1=n=>typeof n=="boolean"?`${n}`:n===0?"0":n,H1=qS,Eg=(n,t)=>e=>{var r;if(t?.variants==null)return H1(n,e?.class,e?.className);const{variants:a,defaultVariants:o}=t,u=Object.keys(a).map(f=>{const h=e?.[f],p=o?.[f];if(h===null)return null;const m=j1(h)||j1(p);return a[f][m]}),l=e&&Object.entries(e).reduce((f,h)=>{let[p,m]=h;return m===void 0||(f[p]=m),f},{}),c=t==null||(r=t.compoundVariants)===null||r===void 0?void 0:r.reduce((f,h)=>{let{class:p,className:m,...g}=h;return Object.entries(g).every(b=>{let[x,w]=b;return Array.isArray(w)?w.includes({...o,...l}[x]):{...o,...l}[x]===w})?[...f,p,m]:f},[]);return H1(n,u,c,e?.class,e?.className)},BI=Eg("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function kt({className:n,variant:t,size:e,asChild:r=!1,...a}){const o=r?aE:"button";return N.jsx(o,{"data-slot":"button",className:Ct(BI({variant:t,size:e,className:n})),...a})}function Or({className:n,type:t,...e}){return N.jsx("input",{type:t,"data-slot":"input",className:Ct("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",n),...e})}var Sl=Cw();const oE=Sw(Sl);var FI=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],nt=FI.reduce((n,t)=>{const e=sl(`Primitive.${t}`),r=F.forwardRef((a,o)=>{const{asChild:u,...l}=a,c=u?e:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),N.jsx(c,{...l,ref:o})});return r.displayName=`Primitive.${t}`,{...n,[t]:r}},{});function PI(n,t){n&&Sl.flushSync(()=>n.dispatchEvent(t))}var LI="Label",iE=F.forwardRef((n,t)=>N.jsx(nt.label,{...n,ref:t,onMouseDown:e=>{e.target.closest("button, input, select, textarea")||(n.onMouseDown?.(e),!e.defaultPrevented&&e.detail>1&&e.preventDefault())}}));iE.displayName=LI;var zI=iE;function Ir({className:n,...t}){return N.jsx(zI,{"data-slot":"label",className:Ct("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",n),...t})}function Zv(n,[t,e]){return Math.min(e,Math.max(t,n))}function et(n,t,{checkForDefaultPrevented:e=!0}={}){return function(a){if(n?.(a),e===!1||!a.defaultPrevented)return t?.(a)}}function xi(n,t=[]){let e=[];function r(o,u){const l=F.createContext(u),c=e.length;e=[...e,u];const f=p=>{const{scope:m,children:g,...b}=p,x=m?.[n]?.[c]||l,w=F.useMemo(()=>b,Object.values(b));return N.jsx(x.Provider,{value:w,children:g})};f.displayName=o+"Provider";function h(p,m){const g=m?.[n]?.[c]||l,b=F.useContext(g);if(b)return b;if(u!==void 0)return u;throw new Error(`\`${p}\` must be used within \`${o}\``)}return[f,h]}const a=()=>{const o=e.map(u=>F.createContext(u));return function(l){const c=l?.[n]||o;return F.useMemo(()=>({[`__scope${n}`]:{...l,[n]:c}}),[l,c])}};return a.scopeName=n,[r,UI(a,...t)]}function UI(...n){const t=n[0];if(n.length===1)return t;const e=()=>{const r=n.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(o){const u=r.reduce((l,{useScope:c,scopeName:f})=>{const p=c(o)[`__scope${f}`];return{...l,...p}},{});return F.useMemo(()=>({[`__scope${t.scopeName}`]:u}),[u])}};return e.scopeName=t.scopeName,e}function sE(n){const t=n+"CollectionProvider",[e,r]=xi(t),[a,o]=e(t,{collectionRef:{current:null},itemMap:new Map}),u=x=>{const{scope:w,children:E}=x,C=be.useRef(null),_=be.useRef(new Map).current;return N.jsx(a,{scope:w,itemMap:_,collectionRef:C,children:E})};u.displayName=t;const l=n+"CollectionSlot",c=sl(l),f=be.forwardRef((x,w)=>{const{scope:E,children:C}=x,_=o(l,E),R=bt(w,_.collectionRef);return N.jsx(c,{ref:R,children:C})});f.displayName=l;const h=n+"CollectionItemSlot",p="data-radix-collection-item",m=sl(h),g=be.forwardRef((x,w)=>{const{scope:E,children:C,..._}=x,R=be.useRef(null),A=bt(w,R),D=o(h,E);return be.useEffect(()=>(D.itemMap.set(R,{ref:R,..._}),()=>void D.itemMap.delete(R))),N.jsx(m,{[p]:"",ref:A,children:C})});g.displayName=h;function b(x){const w=o(n+"CollectionConsumer",x);return be.useCallback(()=>{const C=w.collectionRef.current;if(!C)return[];const _=Array.from(C.querySelectorAll(`[${p}]`));return Array.from(w.itemMap.values()).sort((D,M)=>_.indexOf(D.ref.current)-_.indexOf(M.ref.current))},[w.collectionRef,w.itemMap])}return[{Provider:u,Slot:f,ItemSlot:g},b,r]}var jI=F.createContext(void 0);function cd(n){const t=F.useContext(jI);return n||t||"ltr"}function Ln(n){const t=F.useRef(n);return F.useEffect(()=>{t.current=n}),F.useMemo(()=>(...e)=>t.current?.(...e),[])}function HI(n,t=globalThis?.document){const e=Ln(n);F.useEffect(()=>{const r=a=>{a.key==="Escape"&&e(a)};return t.addEventListener("keydown",r,{capture:!0}),()=>t.removeEventListener("keydown",r,{capture:!0})},[e,t])}var VI="DismissableLayer",Jv="dismissableLayer.update",WI="dismissableLayer.pointerDownOutside",GI="dismissableLayer.focusOutside",V1,uE=F.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),lE=F.forwardRef((n,t)=>{const{disableOutsidePointerEvents:e=!1,onEscapeKeyDown:r,onPointerDownOutside:a,onFocusOutside:o,onInteractOutside:u,onDismiss:l,...c}=n,f=F.useContext(uE),[h,p]=F.useState(null),m=h?.ownerDocument??globalThis?.document,[,g]=F.useState({}),b=bt(t,M=>p(M)),x=Array.from(f.layers),[w]=[...f.layersWithOutsidePointerEventsDisabled].slice(-1),E=x.indexOf(w),C=h?x.indexOf(h):-1,_=f.layersWithOutsidePointerEventsDisabled.size>0,R=C>=E,A=YI(M=>{const k=M.target,B=[...f.branches].some(O=>O.contains(k));!R||B||(a?.(M),u?.(M),M.defaultPrevented||l?.())},m),D=KI(M=>{const k=M.target;[...f.branches].some(O=>O.contains(k))||(o?.(M),u?.(M),M.defaultPrevented||l?.())},m);return HI(M=>{C===f.layers.size-1&&(r?.(M),!M.defaultPrevented&&l&&(M.preventDefault(),l()))},m),F.useEffect(()=>{if(h)return e&&(f.layersWithOutsidePointerEventsDisabled.size===0&&(V1=m.body.style.pointerEvents,m.body.style.pointerEvents="none"),f.layersWithOutsidePointerEventsDisabled.add(h)),f.layers.add(h),W1(),()=>{e&&f.layersWithOutsidePointerEventsDisabled.size===1&&(m.body.style.pointerEvents=V1)}},[h,m,e,f]),F.useEffect(()=>()=>{h&&(f.layers.delete(h),f.layersWithOutsidePointerEventsDisabled.delete(h),W1())},[h,f]),F.useEffect(()=>{const M=()=>g({});return document.addEventListener(Jv,M),()=>document.removeEventListener(Jv,M)},[]),N.jsx(nt.div,{...c,ref:b,style:{pointerEvents:_?R?"auto":"none":void 0,...n.style},onFocusCapture:et(n.onFocusCapture,D.onFocusCapture),onBlurCapture:et(n.onBlurCapture,D.onBlurCapture),onPointerDownCapture:et(n.onPointerDownCapture,A.onPointerDownCapture)})});lE.displayName=VI;var qI="DismissableLayerBranch",XI=F.forwardRef((n,t)=>{const e=F.useContext(uE),r=F.useRef(null),a=bt(t,r);return F.useEffect(()=>{const o=r.current;if(o)return e.branches.add(o),()=>{e.branches.delete(o)}},[e.branches]),N.jsx(nt.div,{...n,ref:a})});XI.displayName=qI;function YI(n,t=globalThis?.document){const e=Ln(n),r=F.useRef(!1),a=F.useRef(()=>{});return F.useEffect(()=>{const o=l=>{if(l.target&&!r.current){let c=function(){cE(WI,e,f,{discrete:!0})};const f={originalEvent:l};l.pointerType==="touch"?(t.removeEventListener("click",a.current),a.current=c,t.addEventListener("click",a.current,{once:!0})):c()}else t.removeEventListener("click",a.current);r.current=!1},u=window.setTimeout(()=>{t.addEventListener("pointerdown",o)},0);return()=>{window.clearTimeout(u),t.removeEventListener("pointerdown",o),t.removeEventListener("click",a.current)}},[t,e]),{onPointerDownCapture:()=>r.current=!0}}function KI(n,t=globalThis?.document){const e=Ln(n),r=F.useRef(!1);return F.useEffect(()=>{const a=o=>{o.target&&!r.current&&cE(GI,e,{originalEvent:o},{discrete:!1})};return t.addEventListener("focusin",a),()=>t.removeEventListener("focusin",a)},[t,e]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function W1(){const n=new CustomEvent(Jv);document.dispatchEvent(n)}function cE(n,t,e,{discrete:r}){const a=e.originalEvent.target,o=new CustomEvent(n,{bubbles:!1,cancelable:!0,detail:e});t&&a.addEventListener(n,t,{once:!0}),r?PI(a,o):a.dispatchEvent(o)}var fv=0;function QI(){F.useEffect(()=>{const n=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",n[0]??G1()),document.body.insertAdjacentElement("beforeend",n[1]??G1()),fv++,()=>{fv===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),fv--}},[])}function G1(){const n=document.createElement("span");return n.setAttribute("data-radix-focus-guard",""),n.tabIndex=0,n.style.outline="none",n.style.opacity="0",n.style.position="fixed",n.style.pointerEvents="none",n}var dv="focusScope.autoFocusOnMount",hv="focusScope.autoFocusOnUnmount",q1={bubbles:!1,cancelable:!0},$I="FocusScope",fE=F.forwardRef((n,t)=>{const{loop:e=!1,trapped:r=!1,onMountAutoFocus:a,onUnmountAutoFocus:o,...u}=n,[l,c]=F.useState(null),f=Ln(a),h=Ln(o),p=F.useRef(null),m=bt(t,x=>c(x)),g=F.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;F.useEffect(()=>{if(r){let x=function(_){if(g.paused||!l)return;const R=_.target;l.contains(R)?p.current=R:bo(p.current,{select:!0})},w=function(_){if(g.paused||!l)return;const R=_.relatedTarget;R!==null&&(l.contains(R)||bo(p.current,{select:!0}))},E=function(_){if(document.activeElement===document.body)for(const A of _)A.removedNodes.length>0&&bo(l)};document.addEventListener("focusin",x),document.addEventListener("focusout",w);const C=new MutationObserver(E);return l&&C.observe(l,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",x),document.removeEventListener("focusout",w),C.disconnect()}}},[r,l,g.paused]),F.useEffect(()=>{if(l){Y1.add(g);const x=document.activeElement;if(!l.contains(x)){const E=new CustomEvent(dv,q1);l.addEventListener(dv,f),l.dispatchEvent(E),E.defaultPrevented||(ZI(rB(dE(l)),{select:!0}),document.activeElement===x&&bo(l))}return()=>{l.removeEventListener(dv,f),setTimeout(()=>{const E=new CustomEvent(hv,q1);l.addEventListener(hv,h),l.dispatchEvent(E),E.defaultPrevented||bo(x??document.body,{select:!0}),l.removeEventListener(hv,h),Y1.remove(g)},0)}}},[l,f,h,g]);const b=F.useCallback(x=>{if(!e&&!r||g.paused)return;const w=x.key==="Tab"&&!x.altKey&&!x.ctrlKey&&!x.metaKey,E=document.activeElement;if(w&&E){const C=x.currentTarget,[_,R]=JI(C);_&&R?!x.shiftKey&&E===R?(x.preventDefault(),e&&bo(_,{select:!0})):x.shiftKey&&E===_&&(x.preventDefault(),e&&bo(R,{select:!0})):E===C&&x.preventDefault()}},[e,r,g.paused]);return N.jsx(nt.div,{tabIndex:-1,...u,ref:m,onKeyDown:b})});fE.displayName=$I;function ZI(n,{select:t=!1}={}){const e=document.activeElement;for(const r of n)if(bo(r,{select:t}),document.activeElement!==e)return}function JI(n){const t=dE(n),e=X1(t,n),r=X1(t.reverse(),n);return[e,r]}function dE(n){const t=[],e=document.createTreeWalker(n,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const a=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||a?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;e.nextNode();)t.push(e.currentNode);return t}function X1(n,t){for(const e of n)if(!eB(e,{upTo:t}))return e}function eB(n,{upTo:t}){if(getComputedStyle(n).visibility==="hidden")return!0;for(;n;){if(t!==void 0&&n===t)return!1;if(getComputedStyle(n).display==="none")return!0;n=n.parentElement}return!1}function tB(n){return n instanceof HTMLInputElement&&"select"in n}function bo(n,{select:t=!1}={}){if(n&&n.focus){const e=document.activeElement;n.focus({preventScroll:!0}),n!==e&&tB(n)&&t&&n.select()}}var Y1=nB();function nB(){let n=[];return{add(t){const e=n[0];t!==e&&e?.pause(),n=K1(n,t),n.unshift(t)},remove(t){n=K1(n,t),n[0]?.resume()}}}function K1(n,t){const e=[...n],r=e.indexOf(t);return r!==-1&&e.splice(r,1),e}function rB(n){return n.filter(t=>t.tagName!=="A")}var Cn=globalThis?.document?F.useLayoutEffect:()=>{},aB=Ew[" useId ".trim().toString()]||(()=>{}),oB=0;function El(n){const[t,e]=F.useState(aB());return Cn(()=>{e(r=>r??String(oB++))},[n]),n||(t?`radix-${t}`:"")}const iB=["top","right","bottom","left"],To=Math.min,ir=Math.max,jf=Math.round,tf=Math.floor,sa=n=>({x:n,y:n}),sB={left:"right",right:"left",bottom:"top",top:"bottom"},uB={start:"end",end:"start"};function em(n,t,e){return ir(n,To(t,e))}function Pa(n,t){return typeof n=="function"?n(t):n}function La(n){return n.split("-")[0]}function Us(n){return n.split("-")[1]}function Cg(n){return n==="x"?"y":"x"}function _g(n){return n==="y"?"height":"width"}const lB=new Set(["top","bottom"]);function ra(n){return lB.has(La(n))?"y":"x"}function Rg(n){return Cg(ra(n))}function cB(n,t,e){e===void 0&&(e=!1);const r=Us(n),a=Rg(n),o=_g(a);let u=a==="x"?r===(e?"end":"start")?"right":"left":r==="start"?"bottom":"top";return t.reference[o]>t.floating[o]&&(u=Hf(u)),[u,Hf(u)]}function fB(n){const t=Hf(n);return[tm(n),t,tm(t)]}function tm(n){return n.replace(/start|end/g,t=>uB[t])}const Q1=["left","right"],$1=["right","left"],dB=["top","bottom"],hB=["bottom","top"];function pB(n,t,e){switch(n){case"top":case"bottom":return e?t?$1:Q1:t?Q1:$1;case"left":case"right":return t?dB:hB;default:return[]}}function vB(n,t,e,r){const a=Us(n);let o=pB(La(n),e==="start",r);return a&&(o=o.map(u=>u+"-"+a),t&&(o=o.concat(o.map(tm)))),o}function Hf(n){return n.replace(/left|right|bottom|top/g,t=>sB[t])}function mB(n){return{top:0,right:0,bottom:0,left:0,...n}}function hE(n){return typeof n!="number"?mB(n):{top:n,right:n,bottom:n,left:n}}function Vf(n){const{x:t,y:e,width:r,height:a}=n;return{width:r,height:a,top:e,left:t,right:t+r,bottom:e+a,x:t,y:e}}function Z1(n,t,e){let{reference:r,floating:a}=n;const o=ra(t),u=Rg(t),l=_g(u),c=La(t),f=o==="y",h=r.x+r.width/2-a.width/2,p=r.y+r.height/2-a.height/2,m=r[l]/2-a[l]/2;let g;switch(c){case"top":g={x:h,y:r.y-a.height};break;case"bottom":g={x:h,y:r.y+r.height};break;case"right":g={x:r.x+r.width,y:p};break;case"left":g={x:r.x-a.width,y:p};break;default:g={x:r.x,y:r.y}}switch(Us(t)){case"start":g[u]-=m*(e&&f?-1:1);break;case"end":g[u]+=m*(e&&f?-1:1);break}return g}const gB=async(n,t,e)=>{const{placement:r="bottom",strategy:a="absolute",middleware:o=[],platform:u}=e,l=o.filter(Boolean),c=await(u.isRTL==null?void 0:u.isRTL(t));let f=await u.getElementRects({reference:n,floating:t,strategy:a}),{x:h,y:p}=Z1(f,r,c),m=r,g={},b=0;for(let x=0;x<l.length;x++){const{name:w,fn:E}=l[x],{x:C,y:_,data:R,reset:A}=await E({x:h,y:p,initialPlacement:r,placement:m,strategy:a,middlewareData:g,rects:f,platform:u,elements:{reference:n,floating:t}});h=C??h,p=_??p,g={...g,[w]:{...g[w],...R}},A&&b<=50&&(b++,typeof A=="object"&&(A.placement&&(m=A.placement),A.rects&&(f=A.rects===!0?await u.getElementRects({reference:n,floating:t,strategy:a}):A.rects),{x:h,y:p}=Z1(f,m,c)),x=-1)}return{x:h,y:p,placement:m,strategy:a,middlewareData:g}};async function ul(n,t){var e;t===void 0&&(t={});const{x:r,y:a,platform:o,rects:u,elements:l,strategy:c}=n,{boundary:f="clippingAncestors",rootBoundary:h="viewport",elementContext:p="floating",altBoundary:m=!1,padding:g=0}=Pa(t,n),b=hE(g),w=l[m?p==="floating"?"reference":"floating":p],E=Vf(await o.getClippingRect({element:(e=await(o.isElement==null?void 0:o.isElement(w)))==null||e?w:w.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(l.floating)),boundary:f,rootBoundary:h,strategy:c})),C=p==="floating"?{x:r,y:a,width:u.floating.width,height:u.floating.height}:u.reference,_=await(o.getOffsetParent==null?void 0:o.getOffsetParent(l.floating)),R=await(o.isElement==null?void 0:o.isElement(_))?await(o.getScale==null?void 0:o.getScale(_))||{x:1,y:1}:{x:1,y:1},A=Vf(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:l,rect:C,offsetParent:_,strategy:c}):C);return{top:(E.top-A.top+b.top)/R.y,bottom:(A.bottom-E.bottom+b.bottom)/R.y,left:(E.left-A.left+b.left)/R.x,right:(A.right-E.right+b.right)/R.x}}const yB=n=>({name:"arrow",options:n,async fn(t){const{x:e,y:r,placement:a,rects:o,platform:u,elements:l,middlewareData:c}=t,{element:f,padding:h=0}=Pa(n,t)||{};if(f==null)return{};const p=hE(h),m={x:e,y:r},g=Rg(a),b=_g(g),x=await u.getDimensions(f),w=g==="y",E=w?"top":"left",C=w?"bottom":"right",_=w?"clientHeight":"clientWidth",R=o.reference[b]+o.reference[g]-m[g]-o.floating[b],A=m[g]-o.reference[g],D=await(u.getOffsetParent==null?void 0:u.getOffsetParent(f));let M=D?D[_]:0;(!M||!await(u.isElement==null?void 0:u.isElement(D)))&&(M=l.floating[_]||o.floating[b]);const k=R/2-A/2,B=M/2-x[b]/2-1,O=To(p[E],B),V=To(p[C],B),H=O,ee=M-x[b]-V,$=M/2-x[b]/2+k,K=em(H,$,ee),L=!c.arrow&&Us(a)!=null&&$!==K&&o.reference[b]/2-($<H?O:V)-x[b]/2<0,W=L?$<H?$-H:$-ee:0;return{[g]:m[g]+W,data:{[g]:K,centerOffset:$-K-W,...L&&{alignmentOffset:W}},reset:L}}}),bB=function(n){return n===void 0&&(n={}),{name:"flip",options:n,async fn(t){var e,r;const{placement:a,middlewareData:o,rects:u,initialPlacement:l,platform:c,elements:f}=t,{mainAxis:h=!0,crossAxis:p=!0,fallbackPlacements:m,fallbackStrategy:g="bestFit",fallbackAxisSideDirection:b="none",flipAlignment:x=!0,...w}=Pa(n,t);if((e=o.arrow)!=null&&e.alignmentOffset)return{};const E=La(a),C=ra(l),_=La(l)===l,R=await(c.isRTL==null?void 0:c.isRTL(f.floating)),A=m||(_||!x?[Hf(l)]:fB(l)),D=b!=="none";!m&&D&&A.push(...vB(l,x,b,R));const M=[l,...A],k=await ul(t,w),B=[];let O=((r=o.flip)==null?void 0:r.overflows)||[];if(h&&B.push(k[E]),p){const $=cB(a,u,R);B.push(k[$[0]],k[$[1]])}if(O=[...O,{placement:a,overflows:B}],!B.every($=>$<=0)){var V,H;const $=(((V=o.flip)==null?void 0:V.index)||0)+1,K=M[$];if(K&&(!(p==="alignment"?C!==ra(K):!1)||O.every(U=>U.overflows[0]>0&&ra(U.placement)===C)))return{data:{index:$,overflows:O},reset:{placement:K}};let L=(H=O.filter(W=>W.overflows[0]<=0).sort((W,U)=>W.overflows[1]-U.overflows[1])[0])==null?void 0:H.placement;if(!L)switch(g){case"bestFit":{var ee;const W=(ee=O.filter(U=>{if(D){const Z=ra(U.placement);return Z===C||Z==="y"}return!0}).map(U=>[U.placement,U.overflows.filter(Z=>Z>0).reduce((Z,P)=>Z+P,0)]).sort((U,Z)=>U[1]-Z[1])[0])==null?void 0:ee[0];W&&(L=W);break}case"initialPlacement":L=l;break}if(a!==L)return{reset:{placement:L}}}return{}}}};function J1(n,t){return{top:n.top-t.height,right:n.right-t.width,bottom:n.bottom-t.height,left:n.left-t.width}}function ew(n){return iB.some(t=>n[t]>=0)}const xB=function(n){return n===void 0&&(n={}),{name:"hide",options:n,async fn(t){const{rects:e}=t,{strategy:r="referenceHidden",...a}=Pa(n,t);switch(r){case"referenceHidden":{const o=await ul(t,{...a,elementContext:"reference"}),u=J1(o,e.reference);return{data:{referenceHiddenOffsets:u,referenceHidden:ew(u)}}}case"escaped":{const o=await ul(t,{...a,altBoundary:!0}),u=J1(o,e.floating);return{data:{escapedOffsets:u,escaped:ew(u)}}}default:return{}}}}},pE=new Set(["left","top"]);async function wB(n,t){const{placement:e,platform:r,elements:a}=n,o=await(r.isRTL==null?void 0:r.isRTL(a.floating)),u=La(e),l=Us(e),c=ra(e)==="y",f=pE.has(u)?-1:1,h=o&&c?-1:1,p=Pa(t,n);let{mainAxis:m,crossAxis:g,alignmentAxis:b}=typeof p=="number"?{mainAxis:p,crossAxis:0,alignmentAxis:null}:{mainAxis:p.mainAxis||0,crossAxis:p.crossAxis||0,alignmentAxis:p.alignmentAxis};return l&&typeof b=="number"&&(g=l==="end"?b*-1:b),c?{x:g*h,y:m*f}:{x:m*f,y:g*h}}const SB=function(n){return n===void 0&&(n=0),{name:"offset",options:n,async fn(t){var e,r;const{x:a,y:o,placement:u,middlewareData:l}=t,c=await wB(t,n);return u===((e=l.offset)==null?void 0:e.placement)&&(r=l.arrow)!=null&&r.alignmentOffset?{}:{x:a+c.x,y:o+c.y,data:{...c,placement:u}}}}},EB=function(n){return n===void 0&&(n={}),{name:"shift",options:n,async fn(t){const{x:e,y:r,placement:a}=t,{mainAxis:o=!0,crossAxis:u=!1,limiter:l={fn:w=>{let{x:E,y:C}=w;return{x:E,y:C}}},...c}=Pa(n,t),f={x:e,y:r},h=await ul(t,c),p=ra(La(a)),m=Cg(p);let g=f[m],b=f[p];if(o){const w=m==="y"?"top":"left",E=m==="y"?"bottom":"right",C=g+h[w],_=g-h[E];g=em(C,g,_)}if(u){const w=p==="y"?"top":"left",E=p==="y"?"bottom":"right",C=b+h[w],_=b-h[E];b=em(C,b,_)}const x=l.fn({...t,[m]:g,[p]:b});return{...x,data:{x:x.x-e,y:x.y-r,enabled:{[m]:o,[p]:u}}}}}},CB=function(n){return n===void 0&&(n={}),{options:n,fn(t){const{x:e,y:r,placement:a,rects:o,middlewareData:u}=t,{offset:l=0,mainAxis:c=!0,crossAxis:f=!0}=Pa(n,t),h={x:e,y:r},p=ra(a),m=Cg(p);let g=h[m],b=h[p];const x=Pa(l,t),w=typeof x=="number"?{mainAxis:x,crossAxis:0}:{mainAxis:0,crossAxis:0,...x};if(c){const _=m==="y"?"height":"width",R=o.reference[m]-o.floating[_]+w.mainAxis,A=o.reference[m]+o.reference[_]-w.mainAxis;g<R?g=R:g>A&&(g=A)}if(f){var E,C;const _=m==="y"?"width":"height",R=pE.has(La(a)),A=o.reference[p]-o.floating[_]+(R&&((E=u.offset)==null?void 0:E[p])||0)+(R?0:w.crossAxis),D=o.reference[p]+o.reference[_]+(R?0:((C=u.offset)==null?void 0:C[p])||0)-(R?w.crossAxis:0);b<A?b=A:b>D&&(b=D)}return{[m]:g,[p]:b}}}},_B=function(n){return n===void 0&&(n={}),{name:"size",options:n,async fn(t){var e,r;const{placement:a,rects:o,platform:u,elements:l}=t,{apply:c=()=>{},...f}=Pa(n,t),h=await ul(t,f),p=La(a),m=Us(a),g=ra(a)==="y",{width:b,height:x}=o.floating;let w,E;p==="top"||p==="bottom"?(w=p,E=m===(await(u.isRTL==null?void 0:u.isRTL(l.floating))?"start":"end")?"left":"right"):(E=p,w=m==="end"?"top":"bottom");const C=x-h.top-h.bottom,_=b-h.left-h.right,R=To(x-h[w],C),A=To(b-h[E],_),D=!t.middlewareData.shift;let M=R,k=A;if((e=t.middlewareData.shift)!=null&&e.enabled.x&&(k=_),(r=t.middlewareData.shift)!=null&&r.enabled.y&&(M=C),D&&!m){const O=ir(h.left,0),V=ir(h.right,0),H=ir(h.top,0),ee=ir(h.bottom,0);g?k=b-2*(O!==0||V!==0?O+V:ir(h.left,h.right)):M=x-2*(H!==0||ee!==0?H+ee:ir(h.top,h.bottom))}await c({...t,availableWidth:k,availableHeight:M});const B=await u.getDimensions(l.floating);return b!==B.width||x!==B.height?{reset:{rects:!0}}:{}}}};function fd(){return typeof window<"u"}function js(n){return vE(n)?(n.nodeName||"").toLowerCase():"#document"}function fr(n){var t;return(n==null||(t=n.ownerDocument)==null?void 0:t.defaultView)||window}function va(n){var t;return(t=(vE(n)?n.ownerDocument:n.document)||window.document)==null?void 0:t.documentElement}function vE(n){return fd()?n instanceof Node||n instanceof fr(n).Node:!1}function zr(n){return fd()?n instanceof Element||n instanceof fr(n).Element:!1}function fa(n){return fd()?n instanceof HTMLElement||n instanceof fr(n).HTMLElement:!1}function tw(n){return!fd()||typeof ShadowRoot>"u"?!1:n instanceof ShadowRoot||n instanceof fr(n).ShadowRoot}const RB=new Set(["inline","contents"]);function Cl(n){const{overflow:t,overflowX:e,overflowY:r,display:a}=Ur(n);return/auto|scroll|overlay|hidden|clip/.test(t+r+e)&&!RB.has(a)}const AB=new Set(["table","td","th"]);function TB(n){return AB.has(js(n))}const NB=[":popover-open",":modal"];function dd(n){return NB.some(t=>{try{return n.matches(t)}catch{return!1}})}const DB=["transform","translate","scale","rotate","perspective"],kB=["transform","translate","scale","rotate","perspective","filter"],MB=["paint","layout","strict","content"];function Ag(n){const t=Tg(),e=zr(n)?Ur(n):n;return DB.some(r=>e[r]?e[r]!=="none":!1)||(e.containerType?e.containerType!=="normal":!1)||!t&&(e.backdropFilter?e.backdropFilter!=="none":!1)||!t&&(e.filter?e.filter!=="none":!1)||kB.some(r=>(e.willChange||"").includes(r))||MB.some(r=>(e.contain||"").includes(r))}function OB(n){let t=No(n);for(;fa(t)&&!Is(t);){if(Ag(t))return t;if(dd(t))return null;t=No(t)}return null}function Tg(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const IB=new Set(["html","body","#document"]);function Is(n){return IB.has(js(n))}function Ur(n){return fr(n).getComputedStyle(n)}function hd(n){return zr(n)?{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}:{scrollLeft:n.scrollX,scrollTop:n.scrollY}}function No(n){if(js(n)==="html")return n;const t=n.assignedSlot||n.parentNode||tw(n)&&n.host||va(n);return tw(t)?t.host:t}function mE(n){const t=No(n);return Is(t)?n.ownerDocument?n.ownerDocument.body:n.body:fa(t)&&Cl(t)?t:mE(t)}function ll(n,t,e){var r;t===void 0&&(t=[]),e===void 0&&(e=!0);const a=mE(n),o=a===((r=n.ownerDocument)==null?void 0:r.body),u=fr(a);if(o){const l=nm(u);return t.concat(u,u.visualViewport||[],Cl(a)?a:[],l&&e?ll(l):[])}return t.concat(a,ll(a,[],e))}function nm(n){return n.parent&&Object.getPrototypeOf(n.parent)?n.frameElement:null}function gE(n){const t=Ur(n);let e=parseFloat(t.width)||0,r=parseFloat(t.height)||0;const a=fa(n),o=a?n.offsetWidth:e,u=a?n.offsetHeight:r,l=jf(e)!==o||jf(r)!==u;return l&&(e=o,r=u),{width:e,height:r,$:l}}function Ng(n){return zr(n)?n:n.contextElement}function As(n){const t=Ng(n);if(!fa(t))return sa(1);const e=t.getBoundingClientRect(),{width:r,height:a,$:o}=gE(t);let u=(o?jf(e.width):e.width)/r,l=(o?jf(e.height):e.height)/a;return(!u||!Number.isFinite(u))&&(u=1),(!l||!Number.isFinite(l))&&(l=1),{x:u,y:l}}const BB=sa(0);function yE(n){const t=fr(n);return!Tg()||!t.visualViewport?BB:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function FB(n,t,e){return t===void 0&&(t=!1),!e||t&&e!==fr(n)?!1:t}function di(n,t,e,r){t===void 0&&(t=!1),e===void 0&&(e=!1);const a=n.getBoundingClientRect(),o=Ng(n);let u=sa(1);t&&(r?zr(r)&&(u=As(r)):u=As(n));const l=FB(o,e,r)?yE(o):sa(0);let c=(a.left+l.x)/u.x,f=(a.top+l.y)/u.y,h=a.width/u.x,p=a.height/u.y;if(o){const m=fr(o),g=r&&zr(r)?fr(r):r;let b=m,x=nm(b);for(;x&&r&&g!==b;){const w=As(x),E=x.getBoundingClientRect(),C=Ur(x),_=E.left+(x.clientLeft+parseFloat(C.paddingLeft))*w.x,R=E.top+(x.clientTop+parseFloat(C.paddingTop))*w.y;c*=w.x,f*=w.y,h*=w.x,p*=w.y,c+=_,f+=R,b=fr(x),x=nm(b)}}return Vf({width:h,height:p,x:c,y:f})}function Dg(n,t){const e=hd(n).scrollLeft;return t?t.left+e:di(va(n)).left+e}function bE(n,t,e){e===void 0&&(e=!1);const r=n.getBoundingClientRect(),a=r.left+t.scrollLeft-(e?0:Dg(n,r)),o=r.top+t.scrollTop;return{x:a,y:o}}function PB(n){let{elements:t,rect:e,offsetParent:r,strategy:a}=n;const o=a==="fixed",u=va(r),l=t?dd(t.floating):!1;if(r===u||l&&o)return e;let c={scrollLeft:0,scrollTop:0},f=sa(1);const h=sa(0),p=fa(r);if((p||!p&&!o)&&((js(r)!=="body"||Cl(u))&&(c=hd(r)),fa(r))){const g=di(r);f=As(r),h.x=g.x+r.clientLeft,h.y=g.y+r.clientTop}const m=u&&!p&&!o?bE(u,c,!0):sa(0);return{width:e.width*f.x,height:e.height*f.y,x:e.x*f.x-c.scrollLeft*f.x+h.x+m.x,y:e.y*f.y-c.scrollTop*f.y+h.y+m.y}}function LB(n){return Array.from(n.getClientRects())}function zB(n){const t=va(n),e=hd(n),r=n.ownerDocument.body,a=ir(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),o=ir(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight);let u=-e.scrollLeft+Dg(n);const l=-e.scrollTop;return Ur(r).direction==="rtl"&&(u+=ir(t.clientWidth,r.clientWidth)-a),{width:a,height:o,x:u,y:l}}function UB(n,t){const e=fr(n),r=va(n),a=e.visualViewport;let o=r.clientWidth,u=r.clientHeight,l=0,c=0;if(a){o=a.width,u=a.height;const f=Tg();(!f||f&&t==="fixed")&&(l=a.offsetLeft,c=a.offsetTop)}return{width:o,height:u,x:l,y:c}}const jB=new Set(["absolute","fixed"]);function HB(n,t){const e=di(n,!0,t==="fixed"),r=e.top+n.clientTop,a=e.left+n.clientLeft,o=fa(n)?As(n):sa(1),u=n.clientWidth*o.x,l=n.clientHeight*o.y,c=a*o.x,f=r*o.y;return{width:u,height:l,x:c,y:f}}function nw(n,t,e){let r;if(t==="viewport")r=UB(n,e);else if(t==="document")r=zB(va(n));else if(zr(t))r=HB(t,e);else{const a=yE(n);r={x:t.x-a.x,y:t.y-a.y,width:t.width,height:t.height}}return Vf(r)}function xE(n,t){const e=No(n);return e===t||!zr(e)||Is(e)?!1:Ur(e).position==="fixed"||xE(e,t)}function VB(n,t){const e=t.get(n);if(e)return e;let r=ll(n,[],!1).filter(l=>zr(l)&&js(l)!=="body"),a=null;const o=Ur(n).position==="fixed";let u=o?No(n):n;for(;zr(u)&&!Is(u);){const l=Ur(u),c=Ag(u);!c&&l.position==="fixed"&&(a=null),(o?!c&&!a:!c&&l.position==="static"&&!!a&&jB.has(a.position)||Cl(u)&&!c&&xE(n,u))?r=r.filter(h=>h!==u):a=l,u=No(u)}return t.set(n,r),r}function WB(n){let{element:t,boundary:e,rootBoundary:r,strategy:a}=n;const u=[...e==="clippingAncestors"?dd(t)?[]:VB(t,this._c):[].concat(e),r],l=u[0],c=u.reduce((f,h)=>{const p=nw(t,h,a);return f.top=ir(p.top,f.top),f.right=To(p.right,f.right),f.bottom=To(p.bottom,f.bottom),f.left=ir(p.left,f.left),f},nw(t,l,a));return{width:c.right-c.left,height:c.bottom-c.top,x:c.left,y:c.top}}function GB(n){const{width:t,height:e}=gE(n);return{width:t,height:e}}function qB(n,t,e){const r=fa(t),a=va(t),o=e==="fixed",u=di(n,!0,o,t);let l={scrollLeft:0,scrollTop:0};const c=sa(0);function f(){c.x=Dg(a)}if(r||!r&&!o)if((js(t)!=="body"||Cl(a))&&(l=hd(t)),r){const g=di(t,!0,o,t);c.x=g.x+t.clientLeft,c.y=g.y+t.clientTop}else a&&f();o&&!r&&a&&f();const h=a&&!r&&!o?bE(a,l):sa(0),p=u.left+l.scrollLeft-c.x-h.x,m=u.top+l.scrollTop-c.y-h.y;return{x:p,y:m,width:u.width,height:u.height}}function pv(n){return Ur(n).position==="static"}function rw(n,t){if(!fa(n)||Ur(n).position==="fixed")return null;if(t)return t(n);let e=n.offsetParent;return va(n)===e&&(e=e.ownerDocument.body),e}function wE(n,t){const e=fr(n);if(dd(n))return e;if(!fa(n)){let a=No(n);for(;a&&!Is(a);){if(zr(a)&&!pv(a))return a;a=No(a)}return e}let r=rw(n,t);for(;r&&TB(r)&&pv(r);)r=rw(r,t);return r&&Is(r)&&pv(r)&&!Ag(r)?e:r||OB(n)||e}const XB=async function(n){const t=this.getOffsetParent||wE,e=this.getDimensions,r=await e(n.floating);return{reference:qB(n.reference,await t(n.floating),n.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function YB(n){return Ur(n).direction==="rtl"}const KB={convertOffsetParentRelativeRectToViewportRelativeRect:PB,getDocumentElement:va,getClippingRect:WB,getOffsetParent:wE,getElementRects:XB,getClientRects:LB,getDimensions:GB,getScale:As,isElement:zr,isRTL:YB};function SE(n,t){return n.x===t.x&&n.y===t.y&&n.width===t.width&&n.height===t.height}function QB(n,t){let e=null,r;const a=va(n);function o(){var l;clearTimeout(r),(l=e)==null||l.disconnect(),e=null}function u(l,c){l===void 0&&(l=!1),c===void 0&&(c=1),o();const f=n.getBoundingClientRect(),{left:h,top:p,width:m,height:g}=f;if(l||t(),!m||!g)return;const b=tf(p),x=tf(a.clientWidth-(h+m)),w=tf(a.clientHeight-(p+g)),E=tf(h),_={rootMargin:-b+"px "+-x+"px "+-w+"px "+-E+"px",threshold:ir(0,To(1,c))||1};let R=!0;function A(D){const M=D[0].intersectionRatio;if(M!==c){if(!R)return u();M?u(!1,M):r=setTimeout(()=>{u(!1,1e-7)},1e3)}M===1&&!SE(f,n.getBoundingClientRect())&&u(),R=!1}try{e=new IntersectionObserver(A,{..._,root:a.ownerDocument})}catch{e=new IntersectionObserver(A,_)}e.observe(n)}return u(!0),o}function $B(n,t,e,r){r===void 0&&(r={});const{ancestorScroll:a=!0,ancestorResize:o=!0,elementResize:u=typeof ResizeObserver=="function",layoutShift:l=typeof IntersectionObserver=="function",animationFrame:c=!1}=r,f=Ng(n),h=a||o?[...f?ll(f):[],...ll(t)]:[];h.forEach(E=>{a&&E.addEventListener("scroll",e,{passive:!0}),o&&E.addEventListener("resize",e)});const p=f&&l?QB(f,e):null;let m=-1,g=null;u&&(g=new ResizeObserver(E=>{let[C]=E;C&&C.target===f&&g&&(g.unobserve(t),cancelAnimationFrame(m),m=requestAnimationFrame(()=>{var _;(_=g)==null||_.observe(t)})),e()}),f&&!c&&g.observe(f),g.observe(t));let b,x=c?di(n):null;c&&w();function w(){const E=di(n);x&&!SE(x,E)&&e(),x=E,b=requestAnimationFrame(w)}return e(),()=>{var E;h.forEach(C=>{a&&C.removeEventListener("scroll",e),o&&C.removeEventListener("resize",e)}),p?.(),(E=g)==null||E.disconnect(),g=null,c&&cancelAnimationFrame(b)}}const ZB=SB,JB=EB,eF=bB,tF=_B,nF=xB,aw=yB,rF=CB,aF=(n,t,e)=>{const r=new Map,a={platform:KB,...e},o={...a.platform,_c:r};return gB(n,t,{...a,platform:o})};var oF=typeof document<"u",iF=function(){},df=oF?F.useLayoutEffect:iF;function Wf(n,t){if(n===t)return!0;if(typeof n!=typeof t)return!1;if(typeof n=="function"&&n.toString()===t.toString())return!0;let e,r,a;if(n&&t&&typeof n=="object"){if(Array.isArray(n)){if(e=n.length,e!==t.length)return!1;for(r=e;r--!==0;)if(!Wf(n[r],t[r]))return!1;return!0}if(a=Object.keys(n),e=a.length,e!==Object.keys(t).length)return!1;for(r=e;r--!==0;)if(!{}.hasOwnProperty.call(t,a[r]))return!1;for(r=e;r--!==0;){const o=a[r];if(!(o==="_owner"&&n.$$typeof)&&!Wf(n[o],t[o]))return!1}return!0}return n!==n&&t!==t}function EE(n){return typeof window>"u"?1:(n.ownerDocument.defaultView||window).devicePixelRatio||1}function ow(n,t){const e=EE(n);return Math.round(t*e)/e}function vv(n){const t=F.useRef(n);return df(()=>{t.current=n}),t}function sF(n){n===void 0&&(n={});const{placement:t="bottom",strategy:e="absolute",middleware:r=[],platform:a,elements:{reference:o,floating:u}={},transform:l=!0,whileElementsMounted:c,open:f}=n,[h,p]=F.useState({x:0,y:0,strategy:e,placement:t,middlewareData:{},isPositioned:!1}),[m,g]=F.useState(r);Wf(m,r)||g(r);const[b,x]=F.useState(null),[w,E]=F.useState(null),C=F.useCallback(U=>{U!==D.current&&(D.current=U,x(U))},[]),_=F.useCallback(U=>{U!==M.current&&(M.current=U,E(U))},[]),R=o||b,A=u||w,D=F.useRef(null),M=F.useRef(null),k=F.useRef(h),B=c!=null,O=vv(c),V=vv(a),H=vv(f),ee=F.useCallback(()=>{if(!D.current||!M.current)return;const U={placement:t,strategy:e,middleware:m};V.current&&(U.platform=V.current),aF(D.current,M.current,U).then(Z=>{const P={...Z,isPositioned:H.current!==!1};$.current&&!Wf(k.current,P)&&(k.current=P,Sl.flushSync(()=>{p(P)}))})},[m,t,e,V,H]);df(()=>{f===!1&&k.current.isPositioned&&(k.current.isPositioned=!1,p(U=>({...U,isPositioned:!1})))},[f]);const $=F.useRef(!1);df(()=>($.current=!0,()=>{$.current=!1}),[]),df(()=>{if(R&&(D.current=R),A&&(M.current=A),R&&A){if(O.current)return O.current(R,A,ee);ee()}},[R,A,ee,O,B]);const K=F.useMemo(()=>({reference:D,floating:M,setReference:C,setFloating:_}),[C,_]),L=F.useMemo(()=>({reference:R,floating:A}),[R,A]),W=F.useMemo(()=>{const U={position:e,left:0,top:0};if(!L.floating)return U;const Z=ow(L.floating,h.x),P=ow(L.floating,h.y);return l?{...U,transform:"translate("+Z+"px, "+P+"px)",...EE(L.floating)>=1.5&&{willChange:"transform"}}:{position:e,left:Z,top:P}},[e,l,L.floating,h.x,h.y]);return F.useMemo(()=>({...h,update:ee,refs:K,elements:L,floatingStyles:W}),[h,ee,K,L,W])}const uF=n=>{function t(e){return{}.hasOwnProperty.call(e,"current")}return{name:"arrow",options:n,fn(e){const{element:r,padding:a}=typeof n=="function"?n(e):n;return r&&t(r)?r.current!=null?aw({element:r.current,padding:a}).fn(e):{}:r?aw({element:r,padding:a}).fn(e):{}}}},lF=(n,t)=>({...ZB(n),options:[n,t]}),cF=(n,t)=>({...JB(n),options:[n,t]}),fF=(n,t)=>({...rF(n),options:[n,t]}),dF=(n,t)=>({...eF(n),options:[n,t]}),hF=(n,t)=>({...tF(n),options:[n,t]}),pF=(n,t)=>({...nF(n),options:[n,t]}),vF=(n,t)=>({...uF(n),options:[n,t]});var mF="Arrow",CE=F.forwardRef((n,t)=>{const{children:e,width:r=10,height:a=5,...o}=n;return N.jsx(nt.svg,{...o,ref:t,width:r,height:a,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:n.asChild?e:N.jsx("polygon",{points:"0,0 30,0 15,10"})})});CE.displayName=mF;var gF=CE;function _E(n){const[t,e]=F.useState(void 0);return Cn(()=>{if(n){e({width:n.offsetWidth,height:n.offsetHeight});const r=new ResizeObserver(a=>{if(!Array.isArray(a)||!a.length)return;const o=a[0];let u,l;if("borderBoxSize"in o){const c=o.borderBoxSize,f=Array.isArray(c)?c[0]:c;u=f.inlineSize,l=f.blockSize}else u=n.offsetWidth,l=n.offsetHeight;e({width:u,height:l})});return r.observe(n,{box:"border-box"}),()=>r.unobserve(n)}else e(void 0)},[n]),t}var kg="Popper",[RE,AE]=xi(kg),[yF,TE]=RE(kg),NE=n=>{const{__scopePopper:t,children:e}=n,[r,a]=F.useState(null);return N.jsx(yF,{scope:t,anchor:r,onAnchorChange:a,children:e})};NE.displayName=kg;var DE="PopperAnchor",kE=F.forwardRef((n,t)=>{const{__scopePopper:e,virtualRef:r,...a}=n,o=TE(DE,e),u=F.useRef(null),l=bt(t,u);return F.useEffect(()=>{o.onAnchorChange(r?.current||u.current)}),r?null:N.jsx(nt.div,{...a,ref:l})});kE.displayName=DE;var Mg="PopperContent",[bF,xF]=RE(Mg),ME=F.forwardRef((n,t)=>{const{__scopePopper:e,side:r="bottom",sideOffset:a=0,align:o="center",alignOffset:u=0,arrowPadding:l=0,avoidCollisions:c=!0,collisionBoundary:f=[],collisionPadding:h=0,sticky:p="partial",hideWhenDetached:m=!1,updatePositionStrategy:g="optimized",onPlaced:b,...x}=n,w=TE(Mg,e),[E,C]=F.useState(null),_=bt(t,de=>C(de)),[R,A]=F.useState(null),D=_E(R),M=D?.width??0,k=D?.height??0,B=r+(o!=="center"?"-"+o:""),O=typeof h=="number"?h:{top:0,right:0,bottom:0,left:0,...h},V=Array.isArray(f)?f:[f],H=V.length>0,ee={padding:O,boundary:V.filter(SF),altBoundary:H},{refs:$,floatingStyles:K,placement:L,isPositioned:W,middlewareData:U}=sF({strategy:"fixed",placement:B,whileElementsMounted:(...de)=>$B(...de,{animationFrame:g==="always"}),elements:{reference:w.anchor},middleware:[lF({mainAxis:a+k,alignmentAxis:u}),c&&cF({mainAxis:!0,crossAxis:!1,limiter:p==="partial"?fF():void 0,...ee}),c&&dF({...ee}),hF({...ee,apply:({elements:de,rects:ce,availableWidth:xe,availableHeight:we})=>{const{width:Ee,height:De}=ce.reference,Fe=de.floating.style;Fe.setProperty("--radix-popper-available-width",`${xe}px`),Fe.setProperty("--radix-popper-available-height",`${we}px`),Fe.setProperty("--radix-popper-anchor-width",`${Ee}px`),Fe.setProperty("--radix-popper-anchor-height",`${De}px`)}}),R&&vF({element:R,padding:l}),EF({arrowWidth:M,arrowHeight:k}),m&&pF({strategy:"referenceHidden",...ee})]}),[Z,P]=BE(L),q=Ln(b);Cn(()=>{W&&q?.()},[W,q]);const ne=U.arrow?.x,J=U.arrow?.y,le=U.arrow?.centerOffset!==0,[ye,pe]=F.useState();return Cn(()=>{E&&pe(window.getComputedStyle(E).zIndex)},[E]),N.jsx("div",{ref:$.setFloating,"data-radix-popper-content-wrapper":"",style:{...K,transform:W?K.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:ye,"--radix-popper-transform-origin":[U.transformOrigin?.x,U.transformOrigin?.y].join(" "),...U.hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}},dir:n.dir,children:N.jsx(bF,{scope:e,placedSide:Z,onArrowChange:A,arrowX:ne,arrowY:J,shouldHideArrow:le,children:N.jsx(nt.div,{"data-side":Z,"data-align":P,...x,ref:_,style:{...x.style,animation:W?void 0:"none"}})})})});ME.displayName=Mg;var OE="PopperArrow",wF={top:"bottom",right:"left",bottom:"top",left:"right"},IE=F.forwardRef(function(t,e){const{__scopePopper:r,...a}=t,o=xF(OE,r),u=wF[o.placedSide];return N.jsx("span",{ref:o.onArrowChange,style:{position:"absolute",left:o.arrowX,top:o.arrowY,[u]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[o.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[o.placedSide],visibility:o.shouldHideArrow?"hidden":void 0},children:N.jsx(gF,{...a,ref:e,style:{...a.style,display:"block"}})})});IE.displayName=OE;function SF(n){return n!==null}var EF=n=>({name:"transformOrigin",options:n,fn(t){const{placement:e,rects:r,middlewareData:a}=t,u=a.arrow?.centerOffset!==0,l=u?0:n.arrowWidth,c=u?0:n.arrowHeight,[f,h]=BE(e),p={start:"0%",center:"50%",end:"100%"}[h],m=(a.arrow?.x??0)+l/2,g=(a.arrow?.y??0)+c/2;let b="",x="";return f==="bottom"?(b=u?p:`${m}px`,x=`${-c}px`):f==="top"?(b=u?p:`${m}px`,x=`${r.floating.height+c}px`):f==="right"?(b=`${-c}px`,x=u?p:`${g}px`):f==="left"&&(b=`${r.floating.width+c}px`,x=u?p:`${g}px`),{data:{x:b,y:x}}}});function BE(n){const[t,e="center"]=n.split("-");return[t,e]}var CF=NE,_F=kE,RF=ME,AF=IE,TF="Portal",FE=F.forwardRef((n,t)=>{const{container:e,...r}=n,[a,o]=F.useState(!1);Cn(()=>o(!0),[]);const u=e||a&&globalThis?.document?.body;return u?oE.createPortal(N.jsx(nt.div,{...r,ref:t}),u):null});FE.displayName=TF;var NF=Ew[" useInsertionEffect ".trim().toString()]||Cn;function cl({prop:n,defaultProp:t,onChange:e=()=>{},caller:r}){const[a,o,u]=DF({defaultProp:t,onChange:e}),l=n!==void 0,c=l?n:a;{const h=F.useRef(n!==void 0);F.useEffect(()=>{const p=h.current;p!==l&&console.warn(`${r} is changing from ${p?"controlled":"uncontrolled"} to ${l?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),h.current=l},[l,r])}const f=F.useCallback(h=>{if(l){const p=kF(h)?h(n):h;p!==n&&u.current?.(p)}else o(h)},[l,n,o,u]);return[c,f]}function DF({defaultProp:n,onChange:t}){const[e,r]=F.useState(n),a=F.useRef(e),o=F.useRef(t);return NF(()=>{o.current=t},[t]),F.useEffect(()=>{a.current!==e&&(o.current?.(e),a.current=e)},[e,a]),[e,r,o]}function kF(n){return typeof n=="function"}function PE(n){const t=F.useRef({value:n,previous:n});return F.useMemo(()=>(t.current.value!==n&&(t.current.previous=t.current.value,t.current.value=n),t.current.previous),[n])}var LE=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),MF="VisuallyHidden",OF=F.forwardRef((n,t)=>N.jsx(nt.span,{...n,ref:t,style:{...LE,...n.style}}));OF.displayName=MF;var IF=function(n){if(typeof document>"u")return null;var t=Array.isArray(n)?n[0]:n;return t.ownerDocument.body},fs=new WeakMap,nf=new WeakMap,rf={},mv=0,zE=function(n){return n&&(n.host||zE(n.parentNode))},BF=function(n,t){return t.map(function(e){if(n.contains(e))return e;var r=zE(e);return r&&n.contains(r)?r:(console.error("aria-hidden",e,"in not contained inside",n,". Doing nothing"),null)}).filter(function(e){return!!e})},FF=function(n,t,e,r){var a=BF(t,Array.isArray(n)?n:[n]);rf[e]||(rf[e]=new WeakMap);var o=rf[e],u=[],l=new Set,c=new Set(a),f=function(p){!p||l.has(p)||(l.add(p),f(p.parentNode))};a.forEach(f);var h=function(p){!p||c.has(p)||Array.prototype.forEach.call(p.children,function(m){if(l.has(m))h(m);else try{var g=m.getAttribute(r),b=g!==null&&g!=="false",x=(fs.get(m)||0)+1,w=(o.get(m)||0)+1;fs.set(m,x),o.set(m,w),u.push(m),x===1&&b&&nf.set(m,!0),w===1&&m.setAttribute(e,"true"),b||m.setAttribute(r,"true")}catch(E){console.error("aria-hidden: cannot operate on ",m,E)}})};return h(t),l.clear(),mv++,function(){u.forEach(function(p){var m=fs.get(p)-1,g=o.get(p)-1;fs.set(p,m),o.set(p,g),m||(nf.has(p)||p.removeAttribute(r),nf.delete(p)),g||p.removeAttribute(e)}),mv--,mv||(fs=new WeakMap,fs=new WeakMap,nf=new WeakMap,rf={})}},PF=function(n,t,e){e===void 0&&(e="data-aria-hidden");var r=Array.from(Array.isArray(n)?n:[n]),a=IF(n);return a?(r.push.apply(r,Array.from(a.querySelectorAll("[aria-live], script"))),FF(r,a,e,"aria-hidden")):function(){return null}},ta=function(){return ta=Object.assign||function(t){for(var e,r=1,a=arguments.length;r<a;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},ta.apply(this,arguments)};function UE(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(n);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(n,r[a])&&(e[r[a]]=n[r[a]]);return e}function LF(n,t,e){if(e||arguments.length===2)for(var r=0,a=t.length,o;r<a;r++)(o||!(r in t))&&(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return n.concat(o||Array.prototype.slice.call(t))}var hf="right-scroll-bar-position",pf="width-before-scroll-bar",zF="with-scroll-bars-hidden",UF="--removed-body-scroll-bar-size";function gv(n,t){return typeof n=="function"?n(t):n&&(n.current=t),n}function jF(n,t){var e=F.useState(function(){return{value:n,callback:t,facade:{get current(){return e.value},set current(r){var a=e.value;a!==r&&(e.value=r,e.callback(r,a))}}}})[0];return e.callback=t,e.facade}var HF=typeof window<"u"?F.useLayoutEffect:F.useEffect,iw=new WeakMap;function VF(n,t){var e=jF(null,function(r){return n.forEach(function(a){return gv(a,r)})});return HF(function(){var r=iw.get(e);if(r){var a=new Set(r),o=new Set(n),u=e.current;a.forEach(function(l){o.has(l)||gv(l,null)}),o.forEach(function(l){a.has(l)||gv(l,u)})}iw.set(e,n)},[n]),e}function WF(n){return n}function GF(n,t){t===void 0&&(t=WF);var e=[],r=!1,a={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return e.length?e[e.length-1]:n},useMedium:function(o){var u=t(o,r);return e.push(u),function(){e=e.filter(function(l){return l!==u})}},assignSyncMedium:function(o){for(r=!0;e.length;){var u=e;e=[],u.forEach(o)}e={push:function(l){return o(l)},filter:function(){return e}}},assignMedium:function(o){r=!0;var u=[];if(e.length){var l=e;e=[],l.forEach(o),u=e}var c=function(){var h=u;u=[],h.forEach(o)},f=function(){return Promise.resolve().then(c)};f(),e={push:function(h){u.push(h),f()},filter:function(h){return u=u.filter(h),e}}}};return a}function qF(n){n===void 0&&(n={});var t=GF(null);return t.options=ta({async:!0,ssr:!1},n),t}var jE=function(n){var t=n.sideCar,e=UE(n,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=t.read();if(!r)throw new Error("Sidecar medium not found");return F.createElement(r,ta({},e))};jE.isSideCarExport=!0;function XF(n,t){return n.useMedium(t),jE}var HE=qF(),yv=function(){},pd=F.forwardRef(function(n,t){var e=F.useRef(null),r=F.useState({onScrollCapture:yv,onWheelCapture:yv,onTouchMoveCapture:yv}),a=r[0],o=r[1],u=n.forwardProps,l=n.children,c=n.className,f=n.removeScrollBar,h=n.enabled,p=n.shards,m=n.sideCar,g=n.noRelative,b=n.noIsolation,x=n.inert,w=n.allowPinchZoom,E=n.as,C=E===void 0?"div":E,_=n.gapMode,R=UE(n,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),A=m,D=VF([e,t]),M=ta(ta({},R),a);return F.createElement(F.Fragment,null,h&&F.createElement(A,{sideCar:HE,removeScrollBar:f,shards:p,noRelative:g,noIsolation:b,inert:x,setCallbacks:o,allowPinchZoom:!!w,lockRef:e,gapMode:_}),u?F.cloneElement(F.Children.only(l),ta(ta({},M),{ref:D})):F.createElement(C,ta({},M,{className:c,ref:D}),l))});pd.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};pd.classNames={fullWidth:pf,zeroRight:hf};var YF=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function KF(){if(!document)return null;var n=document.createElement("style");n.type="text/css";var t=YF();return t&&n.setAttribute("nonce",t),n}function QF(n,t){n.styleSheet?n.styleSheet.cssText=t:n.appendChild(document.createTextNode(t))}function $F(n){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(n)}var ZF=function(){var n=0,t=null;return{add:function(e){n==0&&(t=KF())&&(QF(t,e),$F(t)),n++},remove:function(){n--,!n&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},JF=function(){var n=ZF();return function(t,e){F.useEffect(function(){return n.add(t),function(){n.remove()}},[t&&e])}},VE=function(){var n=JF(),t=function(e){var r=e.styles,a=e.dynamic;return n(r,a),null};return t},eP={left:0,top:0,right:0,gap:0},bv=function(n){return parseInt(n||"",10)||0},tP=function(n){var t=window.getComputedStyle(document.body),e=t[n==="padding"?"paddingLeft":"marginLeft"],r=t[n==="padding"?"paddingTop":"marginTop"],a=t[n==="padding"?"paddingRight":"marginRight"];return[bv(e),bv(r),bv(a)]},nP=function(n){if(n===void 0&&(n="margin"),typeof window>"u")return eP;var t=tP(n),e=document.documentElement.clientWidth,r=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,r-e+t[2]-t[0])}},rP=VE(),Ts="data-scroll-locked",aP=function(n,t,e,r){var a=n.left,o=n.top,u=n.right,l=n.gap;return e===void 0&&(e="margin"),`
  .`.concat(zF,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(l,"px ").concat(r,`;
  }
  body[`).concat(Ts,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(r,";"),e==="margin"&&`
    padding-left: `.concat(a,`px;
    padding-top: `).concat(o,`px;
    padding-right: `).concat(u,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(l,"px ").concat(r,`;
    `),e==="padding"&&"padding-right: ".concat(l,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(hf,` {
    right: `).concat(l,"px ").concat(r,`;
  }
  
  .`).concat(pf,` {
    margin-right: `).concat(l,"px ").concat(r,`;
  }
  
  .`).concat(hf," .").concat(hf,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(pf," .").concat(pf,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(Ts,`] {
    `).concat(UF,": ").concat(l,`px;
  }
`)},sw=function(){var n=parseInt(document.body.getAttribute(Ts)||"0",10);return isFinite(n)?n:0},oP=function(){F.useEffect(function(){return document.body.setAttribute(Ts,(sw()+1).toString()),function(){var n=sw()-1;n<=0?document.body.removeAttribute(Ts):document.body.setAttribute(Ts,n.toString())}},[])},iP=function(n){var t=n.noRelative,e=n.noImportant,r=n.gapMode,a=r===void 0?"margin":r;oP();var o=F.useMemo(function(){return nP(a)},[a]);return F.createElement(rP,{styles:aP(o,!t,a,e?"":"!important")})},rm=!1;if(typeof window<"u")try{var af=Object.defineProperty({},"passive",{get:function(){return rm=!0,!0}});window.addEventListener("test",af,af),window.removeEventListener("test",af,af)}catch{rm=!1}var ds=rm?{passive:!1}:!1,sP=function(n){return n.tagName==="TEXTAREA"},WE=function(n,t){if(!(n instanceof Element))return!1;var e=window.getComputedStyle(n);return e[t]!=="hidden"&&!(e.overflowY===e.overflowX&&!sP(n)&&e[t]==="visible")},uP=function(n){return WE(n,"overflowY")},lP=function(n){return WE(n,"overflowX")},uw=function(n,t){var e=t.ownerDocument,r=t;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var a=GE(n,r);if(a){var o=qE(n,r),u=o[1],l=o[2];if(u>l)return!0}r=r.parentNode}while(r&&r!==e.body);return!1},cP=function(n){var t=n.scrollTop,e=n.scrollHeight,r=n.clientHeight;return[t,e,r]},fP=function(n){var t=n.scrollLeft,e=n.scrollWidth,r=n.clientWidth;return[t,e,r]},GE=function(n,t){return n==="v"?uP(t):lP(t)},qE=function(n,t){return n==="v"?cP(t):fP(t)},dP=function(n,t){return n==="h"&&t==="rtl"?-1:1},hP=function(n,t,e,r,a){var o=dP(n,window.getComputedStyle(t).direction),u=o*r,l=e.target,c=t.contains(l),f=!1,h=u>0,p=0,m=0;do{if(!l)break;var g=qE(n,l),b=g[0],x=g[1],w=g[2],E=x-w-o*b;(b||E)&&GE(n,l)&&(p+=E,m+=b);var C=l.parentNode;l=C&&C.nodeType===Node.DOCUMENT_FRAGMENT_NODE?C.host:C}while(!c&&l!==document.body||c&&(t.contains(l)||t===l));return(h&&Math.abs(p)<1||!h&&Math.abs(m)<1)&&(f=!0),f},of=function(n){return"changedTouches"in n?[n.changedTouches[0].clientX,n.changedTouches[0].clientY]:[0,0]},lw=function(n){return[n.deltaX,n.deltaY]},cw=function(n){return n&&"current"in n?n.current:n},pP=function(n,t){return n[0]===t[0]&&n[1]===t[1]},vP=function(n){return`
  .block-interactivity-`.concat(n,` {pointer-events: none;}
  .allow-interactivity-`).concat(n,` {pointer-events: all;}
`)},mP=0,hs=[];function gP(n){var t=F.useRef([]),e=F.useRef([0,0]),r=F.useRef(),a=F.useState(mP++)[0],o=F.useState(VE)[0],u=F.useRef(n);F.useEffect(function(){u.current=n},[n]),F.useEffect(function(){if(n.inert){document.body.classList.add("block-interactivity-".concat(a));var x=LF([n.lockRef.current],(n.shards||[]).map(cw),!0).filter(Boolean);return x.forEach(function(w){return w.classList.add("allow-interactivity-".concat(a))}),function(){document.body.classList.remove("block-interactivity-".concat(a)),x.forEach(function(w){return w.classList.remove("allow-interactivity-".concat(a))})}}},[n.inert,n.lockRef.current,n.shards]);var l=F.useCallback(function(x,w){if("touches"in x&&x.touches.length===2||x.type==="wheel"&&x.ctrlKey)return!u.current.allowPinchZoom;var E=of(x),C=e.current,_="deltaX"in x?x.deltaX:C[0]-E[0],R="deltaY"in x?x.deltaY:C[1]-E[1],A,D=x.target,M=Math.abs(_)>Math.abs(R)?"h":"v";if("touches"in x&&M==="h"&&D.type==="range")return!1;var k=uw(M,D);if(!k)return!0;if(k?A=M:(A=M==="v"?"h":"v",k=uw(M,D)),!k)return!1;if(!r.current&&"changedTouches"in x&&(_||R)&&(r.current=A),!A)return!0;var B=r.current||A;return hP(B,w,x,B==="h"?_:R)},[]),c=F.useCallback(function(x){var w=x;if(!(!hs.length||hs[hs.length-1]!==o)){var E="deltaY"in w?lw(w):of(w),C=t.current.filter(function(A){return A.name===w.type&&(A.target===w.target||w.target===A.shadowParent)&&pP(A.delta,E)})[0];if(C&&C.should){w.cancelable&&w.preventDefault();return}if(!C){var _=(u.current.shards||[]).map(cw).filter(Boolean).filter(function(A){return A.contains(w.target)}),R=_.length>0?l(w,_[0]):!u.current.noIsolation;R&&w.cancelable&&w.preventDefault()}}},[]),f=F.useCallback(function(x,w,E,C){var _={name:x,delta:w,target:E,should:C,shadowParent:yP(E)};t.current.push(_),setTimeout(function(){t.current=t.current.filter(function(R){return R!==_})},1)},[]),h=F.useCallback(function(x){e.current=of(x),r.current=void 0},[]),p=F.useCallback(function(x){f(x.type,lw(x),x.target,l(x,n.lockRef.current))},[]),m=F.useCallback(function(x){f(x.type,of(x),x.target,l(x,n.lockRef.current))},[]);F.useEffect(function(){return hs.push(o),n.setCallbacks({onScrollCapture:p,onWheelCapture:p,onTouchMoveCapture:m}),document.addEventListener("wheel",c,ds),document.addEventListener("touchmove",c,ds),document.addEventListener("touchstart",h,ds),function(){hs=hs.filter(function(x){return x!==o}),document.removeEventListener("wheel",c,ds),document.removeEventListener("touchmove",c,ds),document.removeEventListener("touchstart",h,ds)}},[]);var g=n.removeScrollBar,b=n.inert;return F.createElement(F.Fragment,null,b?F.createElement(o,{styles:vP(a)}):null,g?F.createElement(iP,{noRelative:n.noRelative,gapMode:n.gapMode}):null)}function yP(n){for(var t=null;n!==null;)n instanceof ShadowRoot&&(t=n.host,n=n.host),n=n.parentNode;return t}const bP=XF(HE,gP);var XE=F.forwardRef(function(n,t){return F.createElement(pd,ta({},n,{ref:t,sideCar:bP}))});XE.classNames=pd.classNames;var xP=[" ","Enter","ArrowUp","ArrowDown"],wP=[" ","Enter"],hi="Select",[vd,md,SP]=sE(hi),[Hs,zz]=xi(hi,[SP,AE]),gd=AE(),[EP,Oo]=Hs(hi),[CP,_P]=Hs(hi),YE=n=>{const{__scopeSelect:t,children:e,open:r,defaultOpen:a,onOpenChange:o,value:u,defaultValue:l,onValueChange:c,dir:f,name:h,autoComplete:p,disabled:m,required:g,form:b}=n,x=gd(t),[w,E]=F.useState(null),[C,_]=F.useState(null),[R,A]=F.useState(!1),D=cd(f),[M,k]=cl({prop:r,defaultProp:a??!1,onChange:o,caller:hi}),[B,O]=cl({prop:u,defaultProp:l,onChange:c,caller:hi}),V=F.useRef(null),H=w?b||!!w.closest("form"):!0,[ee,$]=F.useState(new Set),K=Array.from(ee).map(L=>L.props.value).join(";");return N.jsx(CF,{...x,children:N.jsxs(EP,{required:g,scope:t,trigger:w,onTriggerChange:E,valueNode:C,onValueNodeChange:_,valueNodeHasChildren:R,onValueNodeHasChildrenChange:A,contentId:El(),value:B,onValueChange:O,open:M,onOpenChange:k,dir:D,triggerPointerDownPosRef:V,disabled:m,children:[N.jsx(vd.Provider,{scope:t,children:N.jsx(CP,{scope:n.__scopeSelect,onNativeOptionAdd:F.useCallback(L=>{$(W=>new Set(W).add(L))},[]),onNativeOptionRemove:F.useCallback(L=>{$(W=>{const U=new Set(W);return U.delete(L),U})},[]),children:e})}),H?N.jsxs(mC,{"aria-hidden":!0,required:g,tabIndex:-1,name:h,autoComplete:p,value:B,onChange:L=>O(L.target.value),disabled:m,form:b,children:[B===void 0?N.jsx("option",{value:""}):null,Array.from(ee)]},K):null]})})};YE.displayName=hi;var KE="SelectTrigger",QE=F.forwardRef((n,t)=>{const{__scopeSelect:e,disabled:r=!1,...a}=n,o=gd(e),u=Oo(KE,e),l=u.disabled||r,c=bt(t,u.onTriggerChange),f=md(e),h=F.useRef("touch"),[p,m,g]=yC(x=>{const w=f().filter(_=>!_.disabled),E=w.find(_=>_.value===u.value),C=bC(w,x,E);C!==void 0&&u.onValueChange(C.value)}),b=x=>{l||(u.onOpenChange(!0),g()),x&&(u.triggerPointerDownPosRef.current={x:Math.round(x.pageX),y:Math.round(x.pageY)})};return N.jsx(_F,{asChild:!0,...o,children:N.jsx(nt.button,{type:"button",role:"combobox","aria-controls":u.contentId,"aria-expanded":u.open,"aria-required":u.required,"aria-autocomplete":"none",dir:u.dir,"data-state":u.open?"open":"closed",disabled:l,"data-disabled":l?"":void 0,"data-placeholder":gC(u.value)?"":void 0,...a,ref:c,onClick:et(a.onClick,x=>{x.currentTarget.focus(),h.current!=="mouse"&&b(x)}),onPointerDown:et(a.onPointerDown,x=>{h.current=x.pointerType;const w=x.target;w.hasPointerCapture(x.pointerId)&&w.releasePointerCapture(x.pointerId),x.button===0&&x.ctrlKey===!1&&x.pointerType==="mouse"&&(b(x),x.preventDefault())}),onKeyDown:et(a.onKeyDown,x=>{const w=p.current!=="";!(x.ctrlKey||x.altKey||x.metaKey)&&x.key.length===1&&m(x.key),!(w&&x.key===" ")&&xP.includes(x.key)&&(b(),x.preventDefault())})})})});QE.displayName=KE;var $E="SelectValue",ZE=F.forwardRef((n,t)=>{const{__scopeSelect:e,className:r,style:a,children:o,placeholder:u="",...l}=n,c=Oo($E,e),{onValueNodeHasChildrenChange:f}=c,h=o!==void 0,p=bt(t,c.onValueNodeChange);return Cn(()=>{f(h)},[f,h]),N.jsx(nt.span,{...l,ref:p,style:{pointerEvents:"none"},children:gC(c.value)?N.jsx(N.Fragment,{children:u}):o})});ZE.displayName=$E;var RP="SelectIcon",JE=F.forwardRef((n,t)=>{const{__scopeSelect:e,children:r,...a}=n;return N.jsx(nt.span,{"aria-hidden":!0,...a,ref:t,children:r||""})});JE.displayName=RP;var AP="SelectPortal",eC=n=>N.jsx(FE,{asChild:!0,...n});eC.displayName=AP;var pi="SelectContent",tC=F.forwardRef((n,t)=>{const e=Oo(pi,n.__scopeSelect),[r,a]=F.useState();if(Cn(()=>{a(new DocumentFragment)},[]),!e.open){const o=r;return o?Sl.createPortal(N.jsx(nC,{scope:n.__scopeSelect,children:N.jsx(vd.Slot,{scope:n.__scopeSelect,children:N.jsx("div",{children:n.children})})}),o):null}return N.jsx(rC,{...n,ref:t})});tC.displayName=pi;var Br=10,[nC,Io]=Hs(pi),TP="SelectContentImpl",NP=sl("SelectContent.RemoveScroll"),rC=F.forwardRef((n,t)=>{const{__scopeSelect:e,position:r="item-aligned",onCloseAutoFocus:a,onEscapeKeyDown:o,onPointerDownOutside:u,side:l,sideOffset:c,align:f,alignOffset:h,arrowPadding:p,collisionBoundary:m,collisionPadding:g,sticky:b,hideWhenDetached:x,avoidCollisions:w,...E}=n,C=Oo(pi,e),[_,R]=F.useState(null),[A,D]=F.useState(null),M=bt(t,de=>R(de)),[k,B]=F.useState(null),[O,V]=F.useState(null),H=md(e),[ee,$]=F.useState(!1),K=F.useRef(!1);F.useEffect(()=>{if(_)return PF(_)},[_]),QI();const L=F.useCallback(de=>{const[ce,...xe]=H().map(De=>De.ref.current),[we]=xe.slice(-1),Ee=document.activeElement;for(const De of de)if(De===Ee||(De?.scrollIntoView({block:"nearest"}),De===ce&&A&&(A.scrollTop=0),De===we&&A&&(A.scrollTop=A.scrollHeight),De?.focus(),document.activeElement!==Ee))return},[H,A]),W=F.useCallback(()=>L([k,_]),[L,k,_]);F.useEffect(()=>{ee&&W()},[ee,W]);const{onOpenChange:U,triggerPointerDownPosRef:Z}=C;F.useEffect(()=>{if(_){let de={x:0,y:0};const ce=we=>{de={x:Math.abs(Math.round(we.pageX)-(Z.current?.x??0)),y:Math.abs(Math.round(we.pageY)-(Z.current?.y??0))}},xe=we=>{de.x<=10&&de.y<=10?we.preventDefault():_.contains(we.target)||U(!1),document.removeEventListener("pointermove",ce),Z.current=null};return Z.current!==null&&(document.addEventListener("pointermove",ce),document.addEventListener("pointerup",xe,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",ce),document.removeEventListener("pointerup",xe,{capture:!0})}}},[_,U,Z]),F.useEffect(()=>{const de=()=>U(!1);return window.addEventListener("blur",de),window.addEventListener("resize",de),()=>{window.removeEventListener("blur",de),window.removeEventListener("resize",de)}},[U]);const[P,q]=yC(de=>{const ce=H().filter(Ee=>!Ee.disabled),xe=ce.find(Ee=>Ee.ref.current===document.activeElement),we=bC(ce,de,xe);we&&setTimeout(()=>we.ref.current.focus())}),ne=F.useCallback((de,ce,xe)=>{const we=!K.current&&!xe;(C.value!==void 0&&C.value===ce||we)&&(B(de),we&&(K.current=!0))},[C.value]),J=F.useCallback(()=>_?.focus(),[_]),le=F.useCallback((de,ce,xe)=>{const we=!K.current&&!xe;(C.value!==void 0&&C.value===ce||we)&&V(de)},[C.value]),ye=r==="popper"?am:aC,pe=ye===am?{side:l,sideOffset:c,align:f,alignOffset:h,arrowPadding:p,collisionBoundary:m,collisionPadding:g,sticky:b,hideWhenDetached:x,avoidCollisions:w}:{};return N.jsx(nC,{scope:e,content:_,viewport:A,onViewportChange:D,itemRefCallback:ne,selectedItem:k,onItemLeave:J,itemTextRefCallback:le,focusSelectedItem:W,selectedItemText:O,position:r,isPositioned:ee,searchRef:P,children:N.jsx(XE,{as:NP,allowPinchZoom:!0,children:N.jsx(fE,{asChild:!0,trapped:C.open,onMountAutoFocus:de=>{de.preventDefault()},onUnmountAutoFocus:et(a,de=>{C.trigger?.focus({preventScroll:!0}),de.preventDefault()}),children:N.jsx(lE,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:o,onPointerDownOutside:u,onFocusOutside:de=>de.preventDefault(),onDismiss:()=>C.onOpenChange(!1),children:N.jsx(ye,{role:"listbox",id:C.contentId,"data-state":C.open?"open":"closed",dir:C.dir,onContextMenu:de=>de.preventDefault(),...E,...pe,onPlaced:()=>$(!0),ref:M,style:{display:"flex",flexDirection:"column",outline:"none",...E.style},onKeyDown:et(E.onKeyDown,de=>{const ce=de.ctrlKey||de.altKey||de.metaKey;if(de.key==="Tab"&&de.preventDefault(),!ce&&de.key.length===1&&q(de.key),["ArrowUp","ArrowDown","Home","End"].includes(de.key)){let we=H().filter(Ee=>!Ee.disabled).map(Ee=>Ee.ref.current);if(["ArrowUp","End"].includes(de.key)&&(we=we.slice().reverse()),["ArrowUp","ArrowDown"].includes(de.key)){const Ee=de.target,De=we.indexOf(Ee);we=we.slice(De+1)}setTimeout(()=>L(we)),de.preventDefault()}})})})})})})});rC.displayName=TP;var DP="SelectItemAlignedPosition",aC=F.forwardRef((n,t)=>{const{__scopeSelect:e,onPlaced:r,...a}=n,o=Oo(pi,e),u=Io(pi,e),[l,c]=F.useState(null),[f,h]=F.useState(null),p=bt(t,M=>h(M)),m=md(e),g=F.useRef(!1),b=F.useRef(!0),{viewport:x,selectedItem:w,selectedItemText:E,focusSelectedItem:C}=u,_=F.useCallback(()=>{if(o.trigger&&o.valueNode&&l&&f&&x&&w&&E){const M=o.trigger.getBoundingClientRect(),k=f.getBoundingClientRect(),B=o.valueNode.getBoundingClientRect(),O=E.getBoundingClientRect();if(o.dir!=="rtl"){const Ee=O.left-k.left,De=B.left-Ee,Fe=M.left-De,Xe=M.width+Fe,it=Math.max(Xe,k.width),rt=window.innerWidth-Br,st=Zv(De,[Br,Math.max(Br,rt-it)]);l.style.minWidth=Xe+"px",l.style.left=st+"px"}else{const Ee=k.right-O.right,De=window.innerWidth-B.right-Ee,Fe=window.innerWidth-M.right-De,Xe=M.width+Fe,it=Math.max(Xe,k.width),rt=window.innerWidth-Br,st=Zv(De,[Br,Math.max(Br,rt-it)]);l.style.minWidth=Xe+"px",l.style.right=st+"px"}const V=m(),H=window.innerHeight-Br*2,ee=x.scrollHeight,$=window.getComputedStyle(f),K=parseInt($.borderTopWidth,10),L=parseInt($.paddingTop,10),W=parseInt($.borderBottomWidth,10),U=parseInt($.paddingBottom,10),Z=K+L+ee+U+W,P=Math.min(w.offsetHeight*5,Z),q=window.getComputedStyle(x),ne=parseInt(q.paddingTop,10),J=parseInt(q.paddingBottom,10),le=M.top+M.height/2-Br,ye=H-le,pe=w.offsetHeight/2,de=w.offsetTop+pe,ce=K+L+de,xe=Z-ce;if(ce<=le){const Ee=V.length>0&&w===V[V.length-1].ref.current;l.style.bottom="0px";const De=f.clientHeight-x.offsetTop-x.offsetHeight,Fe=Math.max(ye,pe+(Ee?J:0)+De+W),Xe=ce+Fe;l.style.height=Xe+"px"}else{const Ee=V.length>0&&w===V[0].ref.current;l.style.top="0px";const Fe=Math.max(le,K+x.offsetTop+(Ee?ne:0)+pe)+xe;l.style.height=Fe+"px",x.scrollTop=ce-le+x.offsetTop}l.style.margin=`${Br}px 0`,l.style.minHeight=P+"px",l.style.maxHeight=H+"px",r?.(),requestAnimationFrame(()=>g.current=!0)}},[m,o.trigger,o.valueNode,l,f,x,w,E,o.dir,r]);Cn(()=>_(),[_]);const[R,A]=F.useState();Cn(()=>{f&&A(window.getComputedStyle(f).zIndex)},[f]);const D=F.useCallback(M=>{M&&b.current===!0&&(_(),C?.(),b.current=!1)},[_,C]);return N.jsx(MP,{scope:e,contentWrapper:l,shouldExpandOnScrollRef:g,onScrollButtonChange:D,children:N.jsx("div",{ref:c,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:R},children:N.jsx(nt.div,{...a,ref:p,style:{boxSizing:"border-box",maxHeight:"100%",...a.style}})})})});aC.displayName=DP;var kP="SelectPopperPosition",am=F.forwardRef((n,t)=>{const{__scopeSelect:e,align:r="start",collisionPadding:a=Br,...o}=n,u=gd(e);return N.jsx(RF,{...u,...o,ref:t,align:r,collisionPadding:a,style:{boxSizing:"border-box",...o.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});am.displayName=kP;var[MP,Og]=Hs(pi,{}),om="SelectViewport",oC=F.forwardRef((n,t)=>{const{__scopeSelect:e,nonce:r,...a}=n,o=Io(om,e),u=Og(om,e),l=bt(t,o.onViewportChange),c=F.useRef(0);return N.jsxs(N.Fragment,{children:[N.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:r}),N.jsx(vd.Slot,{scope:e,children:N.jsx(nt.div,{"data-radix-select-viewport":"",role:"presentation",...a,ref:l,style:{position:"relative",flex:1,overflow:"hidden auto",...a.style},onScroll:et(a.onScroll,f=>{const h=f.currentTarget,{contentWrapper:p,shouldExpandOnScrollRef:m}=u;if(m?.current&&p){const g=Math.abs(c.current-h.scrollTop);if(g>0){const b=window.innerHeight-Br*2,x=parseFloat(p.style.minHeight),w=parseFloat(p.style.height),E=Math.max(x,w);if(E<b){const C=E+g,_=Math.min(b,C),R=C-_;p.style.height=_+"px",p.style.bottom==="0px"&&(h.scrollTop=R>0?R:0,p.style.justifyContent="flex-end")}}}c.current=h.scrollTop})})})]})});oC.displayName=om;var iC="SelectGroup",[OP,IP]=Hs(iC),BP=F.forwardRef((n,t)=>{const{__scopeSelect:e,...r}=n,a=El();return N.jsx(OP,{scope:e,id:a,children:N.jsx(nt.div,{role:"group","aria-labelledby":a,...r,ref:t})})});BP.displayName=iC;var sC="SelectLabel",FP=F.forwardRef((n,t)=>{const{__scopeSelect:e,...r}=n,a=IP(sC,e);return N.jsx(nt.div,{id:a.id,...r,ref:t})});FP.displayName=sC;var Gf="SelectItem",[PP,uC]=Hs(Gf),lC=F.forwardRef((n,t)=>{const{__scopeSelect:e,value:r,disabled:a=!1,textValue:o,...u}=n,l=Oo(Gf,e),c=Io(Gf,e),f=l.value===r,[h,p]=F.useState(o??""),[m,g]=F.useState(!1),b=bt(t,C=>c.itemRefCallback?.(C,r,a)),x=El(),w=F.useRef("touch"),E=()=>{a||(l.onValueChange(r),l.onOpenChange(!1))};if(r==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return N.jsx(PP,{scope:e,value:r,disabled:a,textId:x,isSelected:f,onItemTextChange:F.useCallback(C=>{p(_=>_||(C?.textContent??"").trim())},[]),children:N.jsx(vd.ItemSlot,{scope:e,value:r,disabled:a,textValue:h,children:N.jsx(nt.div,{role:"option","aria-labelledby":x,"data-highlighted":m?"":void 0,"aria-selected":f&&m,"data-state":f?"checked":"unchecked","aria-disabled":a||void 0,"data-disabled":a?"":void 0,tabIndex:a?void 0:-1,...u,ref:b,onFocus:et(u.onFocus,()=>g(!0)),onBlur:et(u.onBlur,()=>g(!1)),onClick:et(u.onClick,()=>{w.current!=="mouse"&&E()}),onPointerUp:et(u.onPointerUp,()=>{w.current==="mouse"&&E()}),onPointerDown:et(u.onPointerDown,C=>{w.current=C.pointerType}),onPointerMove:et(u.onPointerMove,C=>{w.current=C.pointerType,a?c.onItemLeave?.():w.current==="mouse"&&C.currentTarget.focus({preventScroll:!0})}),onPointerLeave:et(u.onPointerLeave,C=>{C.currentTarget===document.activeElement&&c.onItemLeave?.()}),onKeyDown:et(u.onKeyDown,C=>{c.searchRef?.current!==""&&C.key===" "||(wP.includes(C.key)&&E(),C.key===" "&&C.preventDefault())})})})})});lC.displayName=Gf;var Yu="SelectItemText",cC=F.forwardRef((n,t)=>{const{__scopeSelect:e,className:r,style:a,...o}=n,u=Oo(Yu,e),l=Io(Yu,e),c=uC(Yu,e),f=_P(Yu,e),[h,p]=F.useState(null),m=bt(t,E=>p(E),c.onItemTextChange,E=>l.itemTextRefCallback?.(E,c.value,c.disabled)),g=h?.textContent,b=F.useMemo(()=>N.jsx("option",{value:c.value,disabled:c.disabled,children:g},c.value),[c.disabled,c.value,g]),{onNativeOptionAdd:x,onNativeOptionRemove:w}=f;return Cn(()=>(x(b),()=>w(b)),[x,w,b]),N.jsxs(N.Fragment,{children:[N.jsx(nt.span,{id:c.textId,...o,ref:m}),c.isSelected&&u.valueNode&&!u.valueNodeHasChildren?Sl.createPortal(o.children,u.valueNode):null]})});cC.displayName=Yu;var fC="SelectItemIndicator",dC=F.forwardRef((n,t)=>{const{__scopeSelect:e,...r}=n;return uC(fC,e).isSelected?N.jsx(nt.span,{"aria-hidden":!0,...r,ref:t}):null});dC.displayName=fC;var im="SelectScrollUpButton",hC=F.forwardRef((n,t)=>{const e=Io(im,n.__scopeSelect),r=Og(im,n.__scopeSelect),[a,o]=F.useState(!1),u=bt(t,r.onScrollButtonChange);return Cn(()=>{if(e.viewport&&e.isPositioned){let l=function(){const f=c.scrollTop>0;o(f)};const c=e.viewport;return l(),c.addEventListener("scroll",l),()=>c.removeEventListener("scroll",l)}},[e.viewport,e.isPositioned]),a?N.jsx(vC,{...n,ref:u,onAutoScroll:()=>{const{viewport:l,selectedItem:c}=e;l&&c&&(l.scrollTop=l.scrollTop-c.offsetHeight)}}):null});hC.displayName=im;var sm="SelectScrollDownButton",pC=F.forwardRef((n,t)=>{const e=Io(sm,n.__scopeSelect),r=Og(sm,n.__scopeSelect),[a,o]=F.useState(!1),u=bt(t,r.onScrollButtonChange);return Cn(()=>{if(e.viewport&&e.isPositioned){let l=function(){const f=c.scrollHeight-c.clientHeight,h=Math.ceil(c.scrollTop)<f;o(h)};const c=e.viewport;return l(),c.addEventListener("scroll",l),()=>c.removeEventListener("scroll",l)}},[e.viewport,e.isPositioned]),a?N.jsx(vC,{...n,ref:u,onAutoScroll:()=>{const{viewport:l,selectedItem:c}=e;l&&c&&(l.scrollTop=l.scrollTop+c.offsetHeight)}}):null});pC.displayName=sm;var vC=F.forwardRef((n,t)=>{const{__scopeSelect:e,onAutoScroll:r,...a}=n,o=Io("SelectScrollButton",e),u=F.useRef(null),l=md(e),c=F.useCallback(()=>{u.current!==null&&(window.clearInterval(u.current),u.current=null)},[]);return F.useEffect(()=>()=>c(),[c]),Cn(()=>{l().find(h=>h.ref.current===document.activeElement)?.ref.current?.scrollIntoView({block:"nearest"})},[l]),N.jsx(nt.div,{"aria-hidden":!0,...a,ref:t,style:{flexShrink:0,...a.style},onPointerDown:et(a.onPointerDown,()=>{u.current===null&&(u.current=window.setInterval(r,50))}),onPointerMove:et(a.onPointerMove,()=>{o.onItemLeave?.(),u.current===null&&(u.current=window.setInterval(r,50))}),onPointerLeave:et(a.onPointerLeave,()=>{c()})})}),LP="SelectSeparator",zP=F.forwardRef((n,t)=>{const{__scopeSelect:e,...r}=n;return N.jsx(nt.div,{"aria-hidden":!0,...r,ref:t})});zP.displayName=LP;var um="SelectArrow",UP=F.forwardRef((n,t)=>{const{__scopeSelect:e,...r}=n,a=gd(e),o=Oo(um,e),u=Io(um,e);return o.open&&u.position==="popper"?N.jsx(AF,{...a,...r,ref:t}):null});UP.displayName=um;var jP="SelectBubbleInput",mC=F.forwardRef(({__scopeSelect:n,value:t,...e},r)=>{const a=F.useRef(null),o=bt(r,a),u=PE(t);return F.useEffect(()=>{const l=a.current;if(!l)return;const c=window.HTMLSelectElement.prototype,h=Object.getOwnPropertyDescriptor(c,"value").set;if(u!==t&&h){const p=new Event("change",{bubbles:!0});h.call(l,t),l.dispatchEvent(p)}},[u,t]),N.jsx(nt.select,{...e,style:{...LE,...e.style},ref:o,defaultValue:t})});mC.displayName=jP;function gC(n){return n===""||n===void 0}function yC(n){const t=Ln(n),e=F.useRef(""),r=F.useRef(0),a=F.useCallback(u=>{const l=e.current+u;t(l),function c(f){e.current=f,window.clearTimeout(r.current),f!==""&&(r.current=window.setTimeout(()=>c(""),1e3))}(l)},[t]),o=F.useCallback(()=>{e.current="",window.clearTimeout(r.current)},[]);return F.useEffect(()=>()=>window.clearTimeout(r.current),[]),[e,a,o]}function bC(n,t,e){const a=t.length>1&&Array.from(t).every(f=>f===t[0])?t[0]:t,o=e?n.indexOf(e):-1;let u=HP(n,Math.max(o,0));a.length===1&&(u=u.filter(f=>f!==e));const c=u.find(f=>f.textValue.toLowerCase().startsWith(a.toLowerCase()));return c!==e?c:void 0}function HP(n,t){return n.map((e,r)=>n[(t+r)%n.length])}var VP=YE,WP=QE,GP=ZE,qP=JE,XP=eC,YP=tC,KP=oC,QP=lC,$P=cC,ZP=dC,JP=hC,eL=pC;/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tL=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),nL=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,e,r)=>r?r.toUpperCase():e.toLowerCase()),fw=n=>{const t=nL(n);return t.charAt(0).toUpperCase()+t.slice(1)},xC=(...n)=>n.filter((t,e,r)=>!!t&&t.trim()!==""&&r.indexOf(t)===e).join(" ").trim(),rL=n=>{for(const t in n)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var aL={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oL=F.forwardRef(({color:n="currentColor",size:t=24,strokeWidth:e=2,absoluteStrokeWidth:r,className:a="",children:o,iconNode:u,...l},c)=>F.createElement("svg",{ref:c,...aL,width:t,height:t,stroke:n,strokeWidth:r?Number(e)*24/Number(t):e,className:xC("lucide",a),...!o&&!rL(l)&&{"aria-hidden":"true"},...l},[...u.map(([f,h])=>F.createElement(f,h)),...Array.isArray(o)?o:[o]]));/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kt=(n,t)=>{const e=F.forwardRef(({className:r,...a},o)=>F.createElement(oL,{ref:o,iconNode:t,className:xC(`lucide-${tL(fw(n))}`,`lucide-${n}`,r),...a}));return e.displayName=fw(n),e};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iL=[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16",key:"qmtpty"}],["path",{d:"M9.5 4h5L17 7h3a2 2 0 0 1 2 2v7.5",key:"1ufyfc"}],["path",{d:"M14.121 15.121A3 3 0 1 1 9.88 10.88",key:"11zox6"}]],dw=Kt("camera-off",iL);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sL=[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],hw=Kt("camera",sL);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uL=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],lL=Kt("check",uL);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cL=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],wC=Kt("chevron-down",cL);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fL=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],dL=Kt("chevron-up",fL);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hL=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],lm=Kt("circle-alert",hL);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pL=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],cm=Kt("circle-check-big",pL);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vL=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],SC=Kt("clock",vL);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mL=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],xv=Kt("download",mL);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gL=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],yL=Kt("eye-off",gL);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bL=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],xL=Kt("eye",bL);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wL=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],vf=Kt("file-text",wL);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SL=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],EL=Kt("log-out",SL);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CL=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],_L=Kt("save",CL);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RL=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],fm=Kt("settings",RL);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AL=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],pw=Kt("square-pen",AL);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TL=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],sf=Kt("trash-2",TL);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NL=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],DL=Kt("upload",NL);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kL=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],dm=Kt("user-plus",kL);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ML=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],bs=Kt("users",ML);function OL({...n}){return N.jsx(VP,{"data-slot":"select",...n})}function IL({...n}){return N.jsx(GP,{"data-slot":"select-value",...n})}function BL({className:n,size:t="default",children:e,...r}){return N.jsxs(WP,{"data-slot":"select-trigger","data-size":t,className:Ct("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",n),...r,children:[e,N.jsx(qP,{asChild:!0,children:N.jsx(wC,{className:"size-4 opacity-50"})})]})}function FL({className:n,children:t,position:e="popper",...r}){return N.jsx(XP,{children:N.jsxs(YP,{"data-slot":"select-content",className:Ct("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md",e==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",n),position:e,...r,children:[N.jsx(LL,{}),N.jsx(KP,{className:Ct("p-1",e==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:t}),N.jsx(zL,{})]})})}function PL({className:n,children:t,...e}){return N.jsxs(QP,{"data-slot":"select-item",className:Ct("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",n),...e,children:[N.jsx("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:N.jsx(ZP,{children:N.jsx(lL,{className:"size-4"})})}),N.jsx($P,{children:t})]})}function LL({className:n,...t}){return N.jsx(JP,{"data-slot":"select-scroll-up-button",className:Ct("flex cursor-default items-center justify-center py-1",n),...t,children:N.jsx(dL,{className:"size-4"})})}function zL({className:n,...t}){return N.jsx(eL,{"data-slot":"select-scroll-down-button",className:Ct("flex cursor-default items-center justify-center py-1",n),...t,children:N.jsx(wC,{className:"size-4"})})}function UL({className:n,...t}){return N.jsx("textarea",{"data-slot":"textarea",className:Ct("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",n),...t})}const jL=Eg("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function HL({className:n,variant:t,...e}){return N.jsx("div",{"data-slot":"alert",role:"alert",className:Ct(jL({variant:t}),n),...e})}function VL({className:n,...t}){return N.jsx("div",{"data-slot":"alert-description",className:Ct("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",n),...t})}const WL=Eg("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function GL({className:n,variant:t,asChild:e=!1,...r}){const a=e?aE:"span";return N.jsx(a,{"data-slot":"badge",className:Ct(WL({variant:t}),n),...r})}var qL="Separator",vw="horizontal",XL=["horizontal","vertical"],EC=F.forwardRef((n,t)=>{const{decorative:e,orientation:r=vw,...a}=n,o=YL(r)?r:vw,l=e?{role:"none"}:{"aria-orientation":o==="vertical"?o:void 0,role:"separator"};return N.jsx(nt.div,{"data-orientation":o,...l,...a,ref:t})});EC.displayName=qL;function YL(n){return XL.includes(n)}var KL=EC;function QL({className:n,orientation:t="horizontal",decorative:e=!0,...r}){return N.jsx(KL,{"data-slot":"separator",decorative:e,orientation:t,className:Ct("bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",n),...r})}function $L(n,t){return F.useReducer((e,r)=>t[e][r]??e,n)}var Vs=n=>{const{present:t,children:e}=n,r=ZL(t),a=typeof e=="function"?e({present:r.isPresent}):F.Children.only(e),o=bt(r.ref,JL(a));return typeof e=="function"||r.isPresent?F.cloneElement(a,{ref:o}):null};Vs.displayName="Presence";function ZL(n){const[t,e]=F.useState(),r=F.useRef(null),a=F.useRef(n),o=F.useRef("none"),u=n?"mounted":"unmounted",[l,c]=$L(u,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return F.useEffect(()=>{const f=uf(r.current);o.current=l==="mounted"?f:"none"},[l]),Cn(()=>{const f=r.current,h=a.current;if(h!==n){const m=o.current,g=uf(f);n?c("MOUNT"):g==="none"||f?.display==="none"?c("UNMOUNT"):c(h&&m!==g?"ANIMATION_OUT":"UNMOUNT"),a.current=n}},[n,c]),Cn(()=>{if(t){let f;const h=t.ownerDocument.defaultView??window,p=g=>{const x=uf(r.current).includes(g.animationName);if(g.target===t&&x&&(c("ANIMATION_END"),!a.current)){const w=t.style.animationFillMode;t.style.animationFillMode="forwards",f=h.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=w)})}},m=g=>{g.target===t&&(o.current=uf(r.current))};return t.addEventListener("animationstart",m),t.addEventListener("animationcancel",p),t.addEventListener("animationend",p),()=>{h.clearTimeout(f),t.removeEventListener("animationstart",m),t.removeEventListener("animationcancel",p),t.removeEventListener("animationend",p)}}else c("ANIMATION_END")},[t,c]),{isPresent:["mounted","unmountSuspended"].includes(l),ref:F.useCallback(f=>{r.current=f?getComputedStyle(f):null,e(f)},[])}}function uf(n){return n?.animationName||"none"}function JL(n){let t=Object.getOwnPropertyDescriptor(n.props,"ref")?.get,e=t&&"isReactWarning"in t&&t.isReactWarning;return e?n.ref:(t=Object.getOwnPropertyDescriptor(n,"ref")?.get,e=t&&"isReactWarning"in t&&t.isReactWarning,e?n.props.ref:n.props.ref||n.ref)}function e5(n,t){return F.useReducer((e,r)=>t[e][r]??e,n)}var Ig="ScrollArea",[CC,Uz]=xi(Ig),[t5,Tr]=CC(Ig),_C=F.forwardRef((n,t)=>{const{__scopeScrollArea:e,type:r="hover",dir:a,scrollHideDelay:o=600,...u}=n,[l,c]=F.useState(null),[f,h]=F.useState(null),[p,m]=F.useState(null),[g,b]=F.useState(null),[x,w]=F.useState(null),[E,C]=F.useState(0),[_,R]=F.useState(0),[A,D]=F.useState(!1),[M,k]=F.useState(!1),B=bt(t,V=>c(V)),O=cd(a);return N.jsx(t5,{scope:e,type:r,dir:O,scrollHideDelay:o,scrollArea:l,viewport:f,onViewportChange:h,content:p,onContentChange:m,scrollbarX:g,onScrollbarXChange:b,scrollbarXEnabled:A,onScrollbarXEnabledChange:D,scrollbarY:x,onScrollbarYChange:w,scrollbarYEnabled:M,onScrollbarYEnabledChange:k,onCornerWidthChange:C,onCornerHeightChange:R,children:N.jsx(nt.div,{dir:O,...u,ref:B,style:{position:"relative","--radix-scroll-area-corner-width":E+"px","--radix-scroll-area-corner-height":_+"px",...n.style}})})});_C.displayName=Ig;var RC="ScrollAreaViewport",AC=F.forwardRef((n,t)=>{const{__scopeScrollArea:e,children:r,nonce:a,...o}=n,u=Tr(RC,e),l=F.useRef(null),c=bt(t,l,u.onViewportChange);return N.jsxs(N.Fragment,{children:[N.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:a}),N.jsx(nt.div,{"data-radix-scroll-area-viewport":"",...o,ref:c,style:{overflowX:u.scrollbarXEnabled?"scroll":"hidden",overflowY:u.scrollbarYEnabled?"scroll":"hidden",...n.style},children:N.jsx("div",{ref:u.onContentChange,style:{minWidth:"100%",display:"table"},children:r})})]})});AC.displayName=RC;var ma="ScrollAreaScrollbar",TC=F.forwardRef((n,t)=>{const{forceMount:e,...r}=n,a=Tr(ma,n.__scopeScrollArea),{onScrollbarXEnabledChange:o,onScrollbarYEnabledChange:u}=a,l=n.orientation==="horizontal";return F.useEffect(()=>(l?o(!0):u(!0),()=>{l?o(!1):u(!1)}),[l,o,u]),a.type==="hover"?N.jsx(n5,{...r,ref:t,forceMount:e}):a.type==="scroll"?N.jsx(r5,{...r,ref:t,forceMount:e}):a.type==="auto"?N.jsx(NC,{...r,ref:t,forceMount:e}):a.type==="always"?N.jsx(Bg,{...r,ref:t}):null});TC.displayName=ma;var n5=F.forwardRef((n,t)=>{const{forceMount:e,...r}=n,a=Tr(ma,n.__scopeScrollArea),[o,u]=F.useState(!1);return F.useEffect(()=>{const l=a.scrollArea;let c=0;if(l){const f=()=>{window.clearTimeout(c),u(!0)},h=()=>{c=window.setTimeout(()=>u(!1),a.scrollHideDelay)};return l.addEventListener("pointerenter",f),l.addEventListener("pointerleave",h),()=>{window.clearTimeout(c),l.removeEventListener("pointerenter",f),l.removeEventListener("pointerleave",h)}}},[a.scrollArea,a.scrollHideDelay]),N.jsx(Vs,{present:e||o,children:N.jsx(NC,{"data-state":o?"visible":"hidden",...r,ref:t})})}),r5=F.forwardRef((n,t)=>{const{forceMount:e,...r}=n,a=Tr(ma,n.__scopeScrollArea),o=n.orientation==="horizontal",u=bd(()=>c("SCROLL_END"),100),[l,c]=e5("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return F.useEffect(()=>{if(l==="idle"){const f=window.setTimeout(()=>c("HIDE"),a.scrollHideDelay);return()=>window.clearTimeout(f)}},[l,a.scrollHideDelay,c]),F.useEffect(()=>{const f=a.viewport,h=o?"scrollLeft":"scrollTop";if(f){let p=f[h];const m=()=>{const g=f[h];p!==g&&(c("SCROLL"),u()),p=g};return f.addEventListener("scroll",m),()=>f.removeEventListener("scroll",m)}},[a.viewport,o,c,u]),N.jsx(Vs,{present:e||l!=="hidden",children:N.jsx(Bg,{"data-state":l==="hidden"?"hidden":"visible",...r,ref:t,onPointerEnter:et(n.onPointerEnter,()=>c("POINTER_ENTER")),onPointerLeave:et(n.onPointerLeave,()=>c("POINTER_LEAVE"))})})}),NC=F.forwardRef((n,t)=>{const e=Tr(ma,n.__scopeScrollArea),{forceMount:r,...a}=n,[o,u]=F.useState(!1),l=n.orientation==="horizontal",c=bd(()=>{if(e.viewport){const f=e.viewport.offsetWidth<e.viewport.scrollWidth,h=e.viewport.offsetHeight<e.viewport.scrollHeight;u(l?f:h)}},10);return Bs(e.viewport,c),Bs(e.content,c),N.jsx(Vs,{present:r||o,children:N.jsx(Bg,{"data-state":o?"visible":"hidden",...a,ref:t})})}),Bg=F.forwardRef((n,t)=>{const{orientation:e="vertical",...r}=n,a=Tr(ma,n.__scopeScrollArea),o=F.useRef(null),u=F.useRef(0),[l,c]=F.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),f=IC(l.viewport,l.content),h={...r,sizes:l,onSizesChange:c,hasThumb:f>0&&f<1,onThumbChange:m=>o.current=m,onThumbPointerUp:()=>u.current=0,onThumbPointerDown:m=>u.current=m};function p(m,g){return l5(m,u.current,l,g)}return e==="horizontal"?N.jsx(a5,{...h,ref:t,onThumbPositionChange:()=>{if(a.viewport&&o.current){const m=a.viewport.scrollLeft,g=mw(m,l,a.dir);o.current.style.transform=`translate3d(${g}px, 0, 0)`}},onWheelScroll:m=>{a.viewport&&(a.viewport.scrollLeft=m)},onDragScroll:m=>{a.viewport&&(a.viewport.scrollLeft=p(m,a.dir))}}):e==="vertical"?N.jsx(o5,{...h,ref:t,onThumbPositionChange:()=>{if(a.viewport&&o.current){const m=a.viewport.scrollTop,g=mw(m,l);o.current.style.transform=`translate3d(0, ${g}px, 0)`}},onWheelScroll:m=>{a.viewport&&(a.viewport.scrollTop=m)},onDragScroll:m=>{a.viewport&&(a.viewport.scrollTop=p(m))}}):null}),a5=F.forwardRef((n,t)=>{const{sizes:e,onSizesChange:r,...a}=n,o=Tr(ma,n.__scopeScrollArea),[u,l]=F.useState(),c=F.useRef(null),f=bt(t,c,o.onScrollbarXChange);return F.useEffect(()=>{c.current&&l(getComputedStyle(c.current))},[c]),N.jsx(kC,{"data-orientation":"horizontal",...a,ref:f,sizes:e,style:{bottom:0,left:o.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:o.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":yd(e)+"px",...n.style},onThumbPointerDown:h=>n.onThumbPointerDown(h.x),onDragScroll:h=>n.onDragScroll(h.x),onWheelScroll:(h,p)=>{if(o.viewport){const m=o.viewport.scrollLeft+h.deltaX;n.onWheelScroll(m),FC(m,p)&&h.preventDefault()}},onResize:()=>{c.current&&o.viewport&&u&&r({content:o.viewport.scrollWidth,viewport:o.viewport.offsetWidth,scrollbar:{size:c.current.clientWidth,paddingStart:Xf(u.paddingLeft),paddingEnd:Xf(u.paddingRight)}})}})}),o5=F.forwardRef((n,t)=>{const{sizes:e,onSizesChange:r,...a}=n,o=Tr(ma,n.__scopeScrollArea),[u,l]=F.useState(),c=F.useRef(null),f=bt(t,c,o.onScrollbarYChange);return F.useEffect(()=>{c.current&&l(getComputedStyle(c.current))},[c]),N.jsx(kC,{"data-orientation":"vertical",...a,ref:f,sizes:e,style:{top:0,right:o.dir==="ltr"?0:void 0,left:o.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":yd(e)+"px",...n.style},onThumbPointerDown:h=>n.onThumbPointerDown(h.y),onDragScroll:h=>n.onDragScroll(h.y),onWheelScroll:(h,p)=>{if(o.viewport){const m=o.viewport.scrollTop+h.deltaY;n.onWheelScroll(m),FC(m,p)&&h.preventDefault()}},onResize:()=>{c.current&&o.viewport&&u&&r({content:o.viewport.scrollHeight,viewport:o.viewport.offsetHeight,scrollbar:{size:c.current.clientHeight,paddingStart:Xf(u.paddingTop),paddingEnd:Xf(u.paddingBottom)}})}})}),[i5,DC]=CC(ma),kC=F.forwardRef((n,t)=>{const{__scopeScrollArea:e,sizes:r,hasThumb:a,onThumbChange:o,onThumbPointerUp:u,onThumbPointerDown:l,onThumbPositionChange:c,onDragScroll:f,onWheelScroll:h,onResize:p,...m}=n,g=Tr(ma,e),[b,x]=F.useState(null),w=bt(t,B=>x(B)),E=F.useRef(null),C=F.useRef(""),_=g.viewport,R=r.content-r.viewport,A=Ln(h),D=Ln(c),M=bd(p,10);function k(B){if(E.current){const O=B.clientX-E.current.left,V=B.clientY-E.current.top;f({x:O,y:V})}}return F.useEffect(()=>{const B=O=>{const V=O.target;b?.contains(V)&&A(O,R)};return document.addEventListener("wheel",B,{passive:!1}),()=>document.removeEventListener("wheel",B,{passive:!1})},[_,b,R,A]),F.useEffect(D,[r,D]),Bs(b,M),Bs(g.content,M),N.jsx(i5,{scope:e,scrollbar:b,hasThumb:a,onThumbChange:Ln(o),onThumbPointerUp:Ln(u),onThumbPositionChange:D,onThumbPointerDown:Ln(l),children:N.jsx(nt.div,{...m,ref:w,style:{position:"absolute",...m.style},onPointerDown:et(n.onPointerDown,B=>{B.button===0&&(B.target.setPointerCapture(B.pointerId),E.current=b.getBoundingClientRect(),C.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",g.viewport&&(g.viewport.style.scrollBehavior="auto"),k(B))}),onPointerMove:et(n.onPointerMove,k),onPointerUp:et(n.onPointerUp,B=>{const O=B.target;O.hasPointerCapture(B.pointerId)&&O.releasePointerCapture(B.pointerId),document.body.style.webkitUserSelect=C.current,g.viewport&&(g.viewport.style.scrollBehavior=""),E.current=null})})})}),qf="ScrollAreaThumb",MC=F.forwardRef((n,t)=>{const{forceMount:e,...r}=n,a=DC(qf,n.__scopeScrollArea);return N.jsx(Vs,{present:e||a.hasThumb,children:N.jsx(s5,{ref:t,...r})})}),s5=F.forwardRef((n,t)=>{const{__scopeScrollArea:e,style:r,...a}=n,o=Tr(qf,e),u=DC(qf,e),{onThumbPositionChange:l}=u,c=bt(t,p=>u.onThumbChange(p)),f=F.useRef(void 0),h=bd(()=>{f.current&&(f.current(),f.current=void 0)},100);return F.useEffect(()=>{const p=o.viewport;if(p){const m=()=>{if(h(),!f.current){const g=c5(p,l);f.current=g,l()}};return l(),p.addEventListener("scroll",m),()=>p.removeEventListener("scroll",m)}},[o.viewport,h,l]),N.jsx(nt.div,{"data-state":u.hasThumb?"visible":"hidden",...a,ref:c,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...r},onPointerDownCapture:et(n.onPointerDownCapture,p=>{const g=p.target.getBoundingClientRect(),b=p.clientX-g.left,x=p.clientY-g.top;u.onThumbPointerDown({x:b,y:x})}),onPointerUp:et(n.onPointerUp,u.onThumbPointerUp)})});MC.displayName=qf;var Fg="ScrollAreaCorner",OC=F.forwardRef((n,t)=>{const e=Tr(Fg,n.__scopeScrollArea),r=!!(e.scrollbarX&&e.scrollbarY);return e.type!=="scroll"&&r?N.jsx(u5,{...n,ref:t}):null});OC.displayName=Fg;var u5=F.forwardRef((n,t)=>{const{__scopeScrollArea:e,...r}=n,a=Tr(Fg,e),[o,u]=F.useState(0),[l,c]=F.useState(0),f=!!(o&&l);return Bs(a.scrollbarX,()=>{const h=a.scrollbarX?.offsetHeight||0;a.onCornerHeightChange(h),c(h)}),Bs(a.scrollbarY,()=>{const h=a.scrollbarY?.offsetWidth||0;a.onCornerWidthChange(h),u(h)}),f?N.jsx(nt.div,{...r,ref:t,style:{width:o,height:l,position:"absolute",right:a.dir==="ltr"?0:void 0,left:a.dir==="rtl"?0:void 0,bottom:0,...n.style}}):null});function Xf(n){return n?parseInt(n,10):0}function IC(n,t){const e=n/t;return isNaN(e)?0:e}function yd(n){const t=IC(n.viewport,n.content),e=n.scrollbar.paddingStart+n.scrollbar.paddingEnd,r=(n.scrollbar.size-e)*t;return Math.max(r,18)}function l5(n,t,e,r="ltr"){const a=yd(e),o=a/2,u=t||o,l=a-u,c=e.scrollbar.paddingStart+u,f=e.scrollbar.size-e.scrollbar.paddingEnd-l,h=e.content-e.viewport,p=r==="ltr"?[0,h]:[h*-1,0];return BC([c,f],p)(n)}function mw(n,t,e="ltr"){const r=yd(t),a=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,o=t.scrollbar.size-a,u=t.content-t.viewport,l=o-r,c=e==="ltr"?[0,u]:[u*-1,0],f=Zv(n,c);return BC([0,u],[0,l])(f)}function BC(n,t){return e=>{if(n[0]===n[1]||t[0]===t[1])return t[0];const r=(t[1]-t[0])/(n[1]-n[0]);return t[0]+r*(e-n[0])}}function FC(n,t){return n>0&&n<t}var c5=(n,t=()=>{})=>{let e={left:n.scrollLeft,top:n.scrollTop},r=0;return function a(){const o={left:n.scrollLeft,top:n.scrollTop},u=e.left!==o.left,l=e.top!==o.top;(u||l)&&t(),e=o,r=window.requestAnimationFrame(a)}(),()=>window.cancelAnimationFrame(r)};function bd(n,t){const e=Ln(n),r=F.useRef(0);return F.useEffect(()=>()=>window.clearTimeout(r.current),[]),F.useCallback(()=>{window.clearTimeout(r.current),r.current=window.setTimeout(e,t)},[e,t])}function Bs(n,t){const e=Ln(t);Cn(()=>{let r=0;if(n){const a=new ResizeObserver(()=>{cancelAnimationFrame(r),r=window.requestAnimationFrame(e)});return a.observe(n),()=>{window.cancelAnimationFrame(r),a.unobserve(n)}}},[n,e])}var f5=_C,d5=AC,h5=OC;function gw({className:n,children:t,...e}){return N.jsxs(f5,{"data-slot":"scroll-area",className:Ct("relative",n),...e,children:[N.jsx(d5,{"data-slot":"scroll-area-viewport",className:"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1",children:t}),N.jsx(p5,{}),N.jsx(h5,{})]})}function p5({className:n,orientation:t="vertical",...e}){return N.jsx(TC,{"data-slot":"scroll-area-scrollbar",orientation:t,className:Ct("flex touch-none p-px transition-colors select-none",t==="vertical"&&"h-full w-2.5 border-l border-l-transparent",t==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent",n),...e,children:N.jsx(MC,{"data-slot":"scroll-area-thumb",className:"bg-border relative flex-1 rounded-full"})})}var wv="rovingFocusGroup.onEntryFocus",v5={bubbles:!1,cancelable:!0},_l="RovingFocusGroup",[hm,PC,m5]=sE(_l),[g5,LC]=xi(_l,[m5]),[y5,b5]=g5(_l),zC=F.forwardRef((n,t)=>N.jsx(hm.Provider,{scope:n.__scopeRovingFocusGroup,children:N.jsx(hm.Slot,{scope:n.__scopeRovingFocusGroup,children:N.jsx(x5,{...n,ref:t})})}));zC.displayName=_l;var x5=F.forwardRef((n,t)=>{const{__scopeRovingFocusGroup:e,orientation:r,loop:a=!1,dir:o,currentTabStopId:u,defaultCurrentTabStopId:l,onCurrentTabStopIdChange:c,onEntryFocus:f,preventScrollOnEntryFocus:h=!1,...p}=n,m=F.useRef(null),g=bt(t,m),b=cd(o),[x,w]=cl({prop:u,defaultProp:l??null,onChange:c,caller:_l}),[E,C]=F.useState(!1),_=Ln(f),R=PC(e),A=F.useRef(!1),[D,M]=F.useState(0);return F.useEffect(()=>{const k=m.current;if(k)return k.addEventListener(wv,_),()=>k.removeEventListener(wv,_)},[_]),N.jsx(y5,{scope:e,orientation:r,dir:b,loop:a,currentTabStopId:x,onItemFocus:F.useCallback(k=>w(k),[w]),onItemShiftTab:F.useCallback(()=>C(!0),[]),onFocusableItemAdd:F.useCallback(()=>M(k=>k+1),[]),onFocusableItemRemove:F.useCallback(()=>M(k=>k-1),[]),children:N.jsx(nt.div,{tabIndex:E||D===0?-1:0,"data-orientation":r,...p,ref:g,style:{outline:"none",...n.style},onMouseDown:et(n.onMouseDown,()=>{A.current=!0}),onFocus:et(n.onFocus,k=>{const B=!A.current;if(k.target===k.currentTarget&&B&&!E){const O=new CustomEvent(wv,v5);if(k.currentTarget.dispatchEvent(O),!O.defaultPrevented){const V=R().filter(L=>L.focusable),H=V.find(L=>L.active),ee=V.find(L=>L.id===x),K=[H,ee,...V].filter(Boolean).map(L=>L.ref.current);HC(K,h)}}A.current=!1}),onBlur:et(n.onBlur,()=>C(!1))})})}),UC="RovingFocusGroupItem",jC=F.forwardRef((n,t)=>{const{__scopeRovingFocusGroup:e,focusable:r=!0,active:a=!1,tabStopId:o,children:u,...l}=n,c=El(),f=o||c,h=b5(UC,e),p=h.currentTabStopId===f,m=PC(e),{onFocusableItemAdd:g,onFocusableItemRemove:b,currentTabStopId:x}=h;return F.useEffect(()=>{if(r)return g(),()=>b()},[r,g,b]),N.jsx(hm.ItemSlot,{scope:e,id:f,focusable:r,active:a,children:N.jsx(nt.span,{tabIndex:p?0:-1,"data-orientation":h.orientation,...l,ref:t,onMouseDown:et(n.onMouseDown,w=>{r?h.onItemFocus(f):w.preventDefault()}),onFocus:et(n.onFocus,()=>h.onItemFocus(f)),onKeyDown:et(n.onKeyDown,w=>{if(w.key==="Tab"&&w.shiftKey){h.onItemShiftTab();return}if(w.target!==w.currentTarget)return;const E=E5(w,h.orientation,h.dir);if(E!==void 0){if(w.metaKey||w.ctrlKey||w.altKey||w.shiftKey)return;w.preventDefault();let _=m().filter(R=>R.focusable).map(R=>R.ref.current);if(E==="last")_.reverse();else if(E==="prev"||E==="next"){E==="prev"&&_.reverse();const R=_.indexOf(w.currentTarget);_=h.loop?C5(_,R+1):_.slice(R+1)}setTimeout(()=>HC(_))}}),children:typeof u=="function"?u({isCurrentTabStop:p,hasTabStop:x!=null}):u})})});jC.displayName=UC;var w5={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function S5(n,t){return t!=="rtl"?n:n==="ArrowLeft"?"ArrowRight":n==="ArrowRight"?"ArrowLeft":n}function E5(n,t,e){const r=S5(n.key,e);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return w5[r]}function HC(n,t=!1){const e=document.activeElement;for(const r of n)if(r===e||(r.focus({preventScroll:t}),document.activeElement!==e))return}function C5(n,t){return n.map((e,r)=>n[(t+r)%n.length])}var _5=zC,R5=jC,xd="Tabs",[A5,jz]=xi(xd,[LC]),VC=LC(),[T5,Pg]=A5(xd),WC=F.forwardRef((n,t)=>{const{__scopeTabs:e,value:r,onValueChange:a,defaultValue:o,orientation:u="horizontal",dir:l,activationMode:c="automatic",...f}=n,h=cd(l),[p,m]=cl({prop:r,onChange:a,defaultProp:o??"",caller:xd});return N.jsx(T5,{scope:e,baseId:El(),value:p,onValueChange:m,orientation:u,dir:h,activationMode:c,children:N.jsx(nt.div,{dir:h,"data-orientation":u,...f,ref:t})})});WC.displayName=xd;var GC="TabsList",qC=F.forwardRef((n,t)=>{const{__scopeTabs:e,loop:r=!0,...a}=n,o=Pg(GC,e),u=VC(e);return N.jsx(_5,{asChild:!0,...u,orientation:o.orientation,dir:o.dir,loop:r,children:N.jsx(nt.div,{role:"tablist","aria-orientation":o.orientation,...a,ref:t})})});qC.displayName=GC;var XC="TabsTrigger",YC=F.forwardRef((n,t)=>{const{__scopeTabs:e,value:r,disabled:a=!1,...o}=n,u=Pg(XC,e),l=VC(e),c=$C(u.baseId,r),f=ZC(u.baseId,r),h=r===u.value;return N.jsx(R5,{asChild:!0,...l,focusable:!a,active:h,children:N.jsx(nt.button,{type:"button",role:"tab","aria-selected":h,"aria-controls":f,"data-state":h?"active":"inactive","data-disabled":a?"":void 0,disabled:a,id:c,...o,ref:t,onMouseDown:et(n.onMouseDown,p=>{!a&&p.button===0&&p.ctrlKey===!1?u.onValueChange(r):p.preventDefault()}),onKeyDown:et(n.onKeyDown,p=>{[" ","Enter"].includes(p.key)&&u.onValueChange(r)}),onFocus:et(n.onFocus,()=>{const p=u.activationMode!=="manual";!h&&!a&&p&&u.onValueChange(r)})})})});YC.displayName=XC;var KC="TabsContent",QC=F.forwardRef((n,t)=>{const{__scopeTabs:e,value:r,forceMount:a,children:o,...u}=n,l=Pg(KC,e),c=$C(l.baseId,r),f=ZC(l.baseId,r),h=r===l.value,p=F.useRef(h);return F.useEffect(()=>{const m=requestAnimationFrame(()=>p.current=!1);return()=>cancelAnimationFrame(m)},[]),N.jsx(Vs,{present:a||h,children:({present:m})=>N.jsx(nt.div,{"data-state":h?"active":"inactive","data-orientation":l.orientation,role:"tabpanel","aria-labelledby":c,hidden:!m,id:f,tabIndex:0,...u,ref:t,style:{...n.style,animationDuration:p.current?"0s":void 0},children:m&&o})})});QC.displayName=KC;function $C(n,t){return`${n}-trigger-${t}`}function ZC(n,t){return`${n}-content-${t}`}var N5=WC,D5=qC,k5=YC,M5=QC;function O5({className:n,...t}){return N.jsx(N5,{"data-slot":"tabs",className:Ct("flex flex-col gap-2",n),...t})}function I5({className:n,...t}){return N.jsx(D5,{"data-slot":"tabs-list",className:Ct("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",n),...t})}function Sv({className:n,...t}){return N.jsx(k5,{"data-slot":"tabs-trigger",className:Ct("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",n),...t})}function Ev({className:n,...t}){return N.jsx(M5,{"data-slot":"tabs-content",className:Ct("flex-1 outline-none",n),...t})}const B5=({adminLoggedIn:n,adminUsername:t,setAdminUsername:e,adminPassword:r,setAdminPassword:a,showPassword:o,setShowPassword:u,loading:l,handleAdminLogin:c,handleAdminLogout:f,activeView:h,setActiveView:p})=>N.jsxs(Uf,{className:"border-0 shadow-lg bg-white/90 backdrop-blur-sm",children:[N.jsx(wg,{className:"pb-4",children:N.jsx(Sg,{className:"text-xl font-semibold text-slate-800 flex items-center gap-2",children:n?N.jsxs(N.Fragment,{children:[N.jsx(fm,{className:"h-5 w-5 text-indigo-600"}),"Admin Panel"]}):N.jsxs(N.Fragment,{children:[N.jsx(bs,{className:"h-5 w-5 text-indigo-600"}),"Admin Access"]})})}),N.jsx($v,{children:n?N.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-3",children:[N.jsxs(kt,{variant:h==="attendance"?"default":"outline",className:`flex flex-col items-center gap-2 h-auto py-4 ${h==="attendance"?"bg-gradient-to-r from-indigo-600 to-purple-600 text-white":"border-slate-200 hover:bg-slate-50"}`,onClick:()=>p("attendance"),children:[N.jsx(SC,{className:"h-5 w-5"}),N.jsx("span",{className:"text-xs font-medium",children:"Attendance"})]}),N.jsxs(kt,{variant:h==="register"?"default":"outline",className:`flex flex-col items-center gap-2 h-auto py-4 ${h==="register"?"bg-gradient-to-r from-indigo-600 to-purple-600 text-white":"border-slate-200 hover:bg-slate-50"}`,onClick:()=>p("register"),children:[N.jsx(dm,{className:"h-5 w-5"}),N.jsx("span",{className:"text-xs font-medium",children:"Register"})]}),N.jsxs(kt,{variant:h==="manage"?"default":"outline",className:`flex flex-col items-center gap-2 h-auto py-4 ${h==="manage"?"bg-gradient-to-r from-indigo-600 to-purple-600 text-white":"border-slate-200 hover:bg-slate-50"}`,onClick:()=>p("manage"),children:[N.jsx(bs,{className:"h-5 w-5"}),N.jsx("span",{className:"text-xs font-medium",children:"Manage"})]}),N.jsxs(kt,{variant:h==="reports"?"default":"outline",className:`flex flex-col items-center gap-2 h-auto py-4 ${h==="reports"?"bg-gradient-to-r from-indigo-600 to-purple-600 text-white":"border-slate-200 hover:bg-slate-50"}`,onClick:()=>p("reports"),children:[N.jsx(vf,{className:"h-5 w-5"}),N.jsx("span",{className:"text-xs font-medium",children:"Reports"})]}),N.jsxs(kt,{variant:h==="settings"?"default":"outline",className:`flex flex-col items-center gap-2 h-auto py-4 ${h==="settings"?"bg-gradient-to-r from-indigo-600 to-purple-600 text-white":"border-slate-200 hover:bg-slate-50"}`,onClick:()=>p("settings"),children:[N.jsx(fm,{className:"h-5 w-5"}),N.jsx("span",{className:"text-xs font-medium",children:"Settings"})]}),N.jsx("div",{className:"col-span-2 md:col-span-3 lg:col-span-5",children:N.jsxs(kt,{variant:"outline",className:"w-full justify-center border-red-200 text-red-600 hover:bg-red-50 bg-transparent",onClick:f,children:[N.jsx(EL,{className:"mr-2 h-4 w-4"}),"Logout"]})})]}):N.jsxs("div",{className:"space-y-4",children:[N.jsxs("div",{className:"space-y-2",children:[N.jsx(Ir,{htmlFor:"username",className:"text-sm font-medium text-slate-700",children:"Username"}),N.jsx(Or,{id:"username",type:"text",placeholder:"Enter username",value:t,onChange:m=>e(m.target.value),className:"border-slate-200 focus:border-indigo-500 focus:ring-indigo-500"})]}),N.jsxs("div",{className:"space-y-2",children:[N.jsx(Ir,{htmlFor:"password",className:"text-sm font-medium text-slate-700",children:"Password"}),N.jsxs("div",{className:"relative",children:[N.jsx(Or,{id:"password",type:o?"text":"password",placeholder:"Enter password",value:r,onChange:m=>a(m.target.value),className:"border-slate-200 focus:border-indigo-500 focus:ring-indigo-500 pr-10"}),N.jsx(kt,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 hover:bg-transparent",onClick:()=>u(!o),children:o?N.jsx(yL,{className:"h-4 w-4 text-slate-400"}):N.jsx(xL,{className:"h-4 w-4 text-slate-400"})})]})]}),N.jsx(kt,{onClick:c,className:"w-full bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white font-medium py-2.5",disabled:l,children:l?N.jsxs(N.Fragment,{children:[N.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Logging in..."]}):"Login"})]})})]}),F5=n=>n==="success"?be.createElement(cm,{className:"h-4 w-4 text-green-500"}):n==="warning"?be.createElement(lm,{className:"h-4 w-4 text-yellow-500"}):n==="destructive"?be.createElement(lm,{className:"h-4 w-4 text-red-500"}):be.createElement(SC,{className:"h-4 w-4 text-blue-500"}),P5=({statusMessage:n,cameraBorderColor:t})=>N.jsx("div",{className:"mb-8",children:N.jsx(Uf,{className:"border-0 shadow-xl bg-white/80 backdrop-blur-sm",children:N.jsxs(wg,{className:"text-center pb-6",children:[N.jsx(Sg,{className:"text-4xl md:text-5xl font-bold bg-gradient-to-r from-indigo-600 via-purple-600 to-blue-600 bg-clip-text text-transparent mb-4",children:"Face Attendance System"}),N.jsxs("div",{className:"flex items-center justify-center gap-3 px-4 py-2 rounded-full bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-100",children:[F5(t),N.jsx("p",{className:"text-sm font-medium text-slate-700",children:n})]})]})})});function L5(n){if(typeof document>"u")return;let t=document.head||document.getElementsByTagName("head")[0],e=document.createElement("style");e.type="text/css",t.appendChild(e),e.styleSheet?e.styleSheet.cssText=n:e.appendChild(document.createTextNode(n))}const z5=n=>{switch(n){case"success":return H5;case"info":return W5;case"warning":return V5;case"error":return G5;default:return null}},U5=Array(12).fill(0),j5=({visible:n,className:t})=>be.createElement("div",{className:["sonner-loading-wrapper",t].filter(Boolean).join(" "),"data-visible":n},be.createElement("div",{className:"sonner-spinner"},U5.map((e,r)=>be.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${r}`})))),H5=be.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},be.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),V5=be.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},be.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),W5=be.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},be.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),G5=be.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},be.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),q5=be.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},be.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),be.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),X5=()=>{const[n,t]=be.useState(document.hidden);return be.useEffect(()=>{const e=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",e),()=>window.removeEventListener("visibilitychange",e)},[]),n};let pm=1;class Y5{constructor(){this.subscribe=t=>(this.subscribers.push(t),()=>{const e=this.subscribers.indexOf(t);this.subscribers.splice(e,1)}),this.publish=t=>{this.subscribers.forEach(e=>e(t))},this.addToast=t=>{this.publish(t),this.toasts=[...this.toasts,t]},this.create=t=>{var e;const{message:r,...a}=t,o=typeof t?.id=="number"||((e=t.id)==null?void 0:e.length)>0?t.id:pm++,u=this.toasts.find(c=>c.id===o),l=t.dismissible===void 0?!0:t.dismissible;return this.dismissedToasts.has(o)&&this.dismissedToasts.delete(o),u?this.toasts=this.toasts.map(c=>c.id===o?(this.publish({...c,...t,id:o,title:r}),{...c,...t,id:o,dismissible:l,title:r}):c):this.addToast({title:r,...a,dismissible:l,id:o}),o},this.dismiss=t=>(t?(this.dismissedToasts.add(t),requestAnimationFrame(()=>this.subscribers.forEach(e=>e({id:t,dismiss:!0})))):this.toasts.forEach(e=>{this.subscribers.forEach(r=>r({id:e.id,dismiss:!0}))}),t),this.message=(t,e)=>this.create({...e,message:t}),this.error=(t,e)=>this.create({...e,message:t,type:"error"}),this.success=(t,e)=>this.create({...e,type:"success",message:t}),this.info=(t,e)=>this.create({...e,type:"info",message:t}),this.warning=(t,e)=>this.create({...e,type:"warning",message:t}),this.loading=(t,e)=>this.create({...e,type:"loading",message:t}),this.promise=(t,e)=>{if(!e)return;let r;e.loading!==void 0&&(r=this.create({...e,promise:t,type:"loading",message:e.loading,description:typeof e.description!="function"?e.description:void 0}));const a=Promise.resolve(t instanceof Function?t():t);let o=r!==void 0,u;const l=a.then(async f=>{if(u=["resolve",f],be.isValidElement(f))o=!1,this.create({id:r,type:"default",message:f});else if(Q5(f)&&!f.ok){o=!1;const p=typeof e.error=="function"?await e.error(`HTTP error! status: ${f.status}`):e.error,m=typeof e.description=="function"?await e.description(`HTTP error! status: ${f.status}`):e.description,b=typeof p=="object"&&!be.isValidElement(p)?p:{message:p};this.create({id:r,type:"error",description:m,...b})}else if(f instanceof Error){o=!1;const p=typeof e.error=="function"?await e.error(f):e.error,m=typeof e.description=="function"?await e.description(f):e.description,b=typeof p=="object"&&!be.isValidElement(p)?p:{message:p};this.create({id:r,type:"error",description:m,...b})}else if(e.success!==void 0){o=!1;const p=typeof e.success=="function"?await e.success(f):e.success,m=typeof e.description=="function"?await e.description(f):e.description,b=typeof p=="object"&&!be.isValidElement(p)?p:{message:p};this.create({id:r,type:"success",description:m,...b})}}).catch(async f=>{if(u=["reject",f],e.error!==void 0){o=!1;const h=typeof e.error=="function"?await e.error(f):e.error,p=typeof e.description=="function"?await e.description(f):e.description,g=typeof h=="object"&&!be.isValidElement(h)?h:{message:h};this.create({id:r,type:"error",description:p,...g})}}).finally(()=>{o&&(this.dismiss(r),r=void 0),e.finally==null||e.finally.call(e)}),c=()=>new Promise((f,h)=>l.then(()=>u[0]==="reject"?h(u[1]):f(u[1])).catch(h));return typeof r!="string"&&typeof r!="number"?{unwrap:c}:Object.assign(r,{unwrap:c})},this.custom=(t,e)=>{const r=e?.id||pm++;return this.create({jsx:t(r),id:r,...e}),r},this.getActiveToasts=()=>this.toasts.filter(t=>!this.dismissedToasts.has(t.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}}const Wn=new Y5,K5=(n,t)=>{const e=t?.id||pm++;return Wn.addToast({title:n,...t,id:e}),e},Q5=n=>n&&typeof n=="object"&&"ok"in n&&typeof n.ok=="boolean"&&"status"in n&&typeof n.status=="number",$5=K5,Z5=()=>Wn.toasts,J5=()=>Wn.getActiveToasts(),yw=Object.assign($5,{success:Wn.success,info:Wn.info,warning:Wn.warning,error:Wn.error,custom:Wn.custom,message:Wn.message,promise:Wn.promise,dismiss:Wn.dismiss,loading:Wn.loading},{getHistory:Z5,getToasts:J5});L5("[data-sonner-toaster][dir=ltr],html[dir=ltr]{--toast-icon-margin-start:-3px;--toast-icon-margin-end:4px;--toast-svg-margin-start:-1px;--toast-svg-margin-end:0px;--toast-button-margin-start:auto;--toast-button-margin-end:0;--toast-close-button-start:0;--toast-close-button-end:unset;--toast-close-button-transform:translate(-35%, -35%)}[data-sonner-toaster][dir=rtl],html[dir=rtl]{--toast-icon-margin-start:4px;--toast-icon-margin-end:-3px;--toast-svg-margin-start:0px;--toast-svg-margin-end:-1px;--toast-button-margin-start:0;--toast-button-margin-end:auto;--toast-close-button-start:unset;--toast-close-button-end:0;--toast-close-button-transform:translate(35%, -35%)}[data-sonner-toaster]{position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1:hsl(0, 0%, 99%);--gray2:hsl(0, 0%, 97.3%);--gray3:hsl(0, 0%, 95.1%);--gray4:hsl(0, 0%, 93%);--gray5:hsl(0, 0%, 90.9%);--gray6:hsl(0, 0%, 88.7%);--gray7:hsl(0, 0%, 85.8%);--gray8:hsl(0, 0%, 78%);--gray9:hsl(0, 0%, 56.1%);--gray10:hsl(0, 0%, 52.3%);--gray11:hsl(0, 0%, 43.5%);--gray12:hsl(0, 0%, 9%);--border-radius:8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:0;z-index:999999999;transition:transform .4s ease}@media (hover:none) and (pointer:coarse){[data-sonner-toaster][data-lifted=true]{transform:none}}[data-sonner-toaster][data-x-position=right]{right:var(--offset-right)}[data-sonner-toaster][data-x-position=left]{left:var(--offset-left)}[data-sonner-toaster][data-x-position=center]{left:50%;transform:translateX(-50%)}[data-sonner-toaster][data-y-position=top]{top:var(--offset-top)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--offset-bottom)}[data-sonner-toast]{--y:translateY(100%);--lift-amount:calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:0;overflow-wrap:anywhere}[data-sonner-toast][data-styled=true]{padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px rgba(0,0,0,.1);width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}[data-sonner-toast]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-y-position=top]{top:0;--y:translateY(-100%);--lift:1;--lift-amount:calc(1 * var(--gap))}[data-sonner-toast][data-y-position=bottom]{bottom:0;--y:translateY(100%);--lift:-1;--lift-amount:calc(var(--lift) * var(--gap))}[data-sonner-toast][data-styled=true] [data-description]{font-weight:400;line-height:1.4;color:#3f3f3f}[data-rich-colors=true][data-sonner-toast][data-styled=true] [data-description]{color:inherit}[data-sonner-toaster][data-sonner-theme=dark] [data-description]{color:#e8e8e8}[data-sonner-toast][data-styled=true] [data-title]{font-weight:500;line-height:1.5;color:inherit}[data-sonner-toast][data-styled=true] [data-icon]{display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}[data-sonner-toast][data-promise=true] [data-icon]>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}[data-sonner-toast][data-styled=true] [data-icon]>*{flex-shrink:0}[data-sonner-toast][data-styled=true] [data-icon] svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}[data-sonner-toast][data-styled=true] [data-content]{display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;font-weight:500;cursor:pointer;outline:0;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}[data-sonner-toast][data-styled=true] [data-button]:focus-visible{box-shadow:0 0 0 2px rgba(0,0,0,.4)}[data-sonner-toast][data-styled=true] [data-button]:first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}[data-sonner-toast][data-styled=true] [data-cancel]{color:var(--normal-text);background:rgba(0,0,0,.08)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-styled=true] [data-cancel]{background:rgba(255,255,255,.3)}[data-sonner-toast][data-styled=true] [data-close-button]{position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);background:var(--normal-bg);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast][data-styled=true] [data-close-button]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-styled=true] [data-disabled=true]{cursor:not-allowed}[data-sonner-toast][data-styled=true]:hover [data-close-button]:hover{background:var(--gray2);border-color:var(--gray5)}[data-sonner-toast][data-swiping=true]::before{content:'';position:absolute;left:-100%;right:-100%;height:100%;z-index:-1}[data-sonner-toast][data-y-position=top][data-swiping=true]::before{bottom:50%;transform:scaleY(3) translateY(50%)}[data-sonner-toast][data-y-position=bottom][data-swiping=true]::before{top:50%;transform:scaleY(3) translateY(-50%)}[data-sonner-toast][data-swiping=false][data-removed=true]::before{content:'';position:absolute;inset:0;transform:scaleY(2)}[data-sonner-toast][data-expanded=true]::after{content:'';position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}[data-sonner-toast][data-mounted=true]{--y:translateY(0);opacity:1}[data-sonner-toast][data-expanded=false][data-front=false]{--scale:var(--toasts-before) * 0.05 + 1;--y:translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}[data-sonner-toast]>*{transition:opacity .4s}[data-sonner-toast][data-x-position=right]{right:0}[data-sonner-toast][data-x-position=left]{left:0}[data-sonner-toast][data-expanded=false][data-front=false][data-styled=true]>*{opacity:0}[data-sonner-toast][data-visible=false]{opacity:0;pointer-events:none}[data-sonner-toast][data-mounted=true][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}[data-sonner-toast][data-removed=true][data-front=true][data-swipe-out=false]{--y:translateY(calc(var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=false]{--y:translateY(40%);opacity:0;transition:transform .5s,opacity .2s}[data-sonner-toast][data-removed=true][data-front=false]::before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y,0)) translateX(var(--swipe-amount-x,0));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width:600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-sonner-theme=light]{--normal-bg:#fff;--normal-border:var(--gray4);--normal-text:var(--gray12);--success-bg:hsl(143, 85%, 96%);--success-border:hsl(145, 92%, 87%);--success-text:hsl(140, 100%, 27%);--info-bg:hsl(208, 100%, 97%);--info-border:hsl(221, 91%, 93%);--info-text:hsl(210, 92%, 45%);--warning-bg:hsl(49, 100%, 97%);--warning-border:hsl(49, 91%, 84%);--warning-text:hsl(31, 92%, 45%);--error-bg:hsl(359, 100%, 97%);--error-border:hsl(359, 100%, 94%);--error-text:hsl(360, 100%, 45%)}[data-sonner-toaster][data-sonner-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg:#000;--normal-border:hsl(0, 0%, 20%);--normal-text:var(--gray1)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg:#fff;--normal-border:var(--gray3);--normal-text:var(--gray12)}[data-sonner-toaster][data-sonner-theme=dark]{--normal-bg:#000;--normal-bg-hover:hsl(0, 0%, 12%);--normal-border:hsl(0, 0%, 20%);--normal-border-hover:hsl(0, 0%, 25%);--normal-text:var(--gray1);--success-bg:hsl(150, 100%, 6%);--success-border:hsl(147, 100%, 12%);--success-text:hsl(150, 86%, 65%);--info-bg:hsl(215, 100%, 6%);--info-border:hsl(223, 43%, 17%);--info-text:hsl(216, 87%, 65%);--warning-bg:hsl(64, 100%, 6%);--warning-border:hsl(60, 100%, 9%);--warning-text:hsl(46, 87%, 65%);--error-bg:hsl(358, 76%, 10%);--error-border:hsl(357, 89%, 16%);--error-text:hsl(358, 100%, 81%)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size:16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:first-child{animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}100%{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}100%{opacity:.15}}@media (prefers-reduced-motion){.sonner-loading-bar,[data-sonner-toast],[data-sonner-toast]>*{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}");function lf(n){return n.label!==void 0}const ez=3,tz="24px",nz="16px",bw=4e3,rz=356,az=14,oz=45,iz=200;function Qr(...n){return n.filter(Boolean).join(" ")}function sz(n){const[t,e]=n.split("-"),r=[];return t&&r.push(t),e&&r.push(e),r}const uz=n=>{var t,e,r,a,o,u,l,c,f;const{invert:h,toast:p,unstyled:m,interacting:g,setHeights:b,visibleToasts:x,heights:w,index:E,toasts:C,expanded:_,removeToast:R,defaultRichColors:A,closeButton:D,style:M,cancelButtonStyle:k,actionButtonStyle:B,className:O="",descriptionClassName:V="",duration:H,position:ee,gap:$,expandByDefault:K,classNames:L,icons:W,closeButtonAriaLabel:U="Close toast"}=n,[Z,P]=be.useState(null),[q,ne]=be.useState(null),[J,le]=be.useState(!1),[ye,pe]=be.useState(!1),[de,ce]=be.useState(!1),[xe,we]=be.useState(!1),[Ee,De]=be.useState(!1),[Fe,Xe]=be.useState(0),[it,rt]=be.useState(0),st=be.useRef(p.duration||H||bw),mn=be.useRef(null),pt=be.useRef(null),Qn=E===0,Qt=E+1<=x,xt=p.type,Lt=p.dismissible!==!1,hr=p.className||"",Bn=p.descriptionClassName||"",_n=be.useMemo(()=>w.findIndex(Ve=>Ve.toastId===p.id)||0,[w,p.id]),Rt=be.useMemo(()=>{var Ve;return(Ve=p.closeButton)!=null?Ve:D},[p.closeButton,D]),At=be.useMemo(()=>p.duration||H||bw,[p.duration,H]),Nt=be.useRef(0),pr=be.useRef(0),Ga=be.useRef(0),ze=be.useRef(null),[Fn,Vr]=ee.split("-"),zn=be.useMemo(()=>w.reduce((Ve,zt,Gt)=>Gt>=_n?Ve:Ve+zt.height,0),[w,_n]),Bo=X5(),Fo=p.invert||h,Gs=xt==="loading";pr.current=be.useMemo(()=>_n*$+zn,[_n,zn]),be.useEffect(()=>{st.current=At},[At]),be.useEffect(()=>{le(!0)},[]),be.useEffect(()=>{const Ve=pt.current;if(Ve){const zt=Ve.getBoundingClientRect().height;return rt(zt),b(Gt=>[{toastId:p.id,height:zt,position:p.position},...Gt]),()=>b(Gt=>Gt.filter(gn=>gn.toastId!==p.id))}},[b,p.id]),be.useLayoutEffect(()=>{if(!J)return;const Ve=pt.current,zt=Ve.style.height;Ve.style.height="auto";const Gt=Ve.getBoundingClientRect().height;Ve.style.height=zt,rt(Gt),b(gn=>gn.find($t=>$t.toastId===p.id)?gn.map($t=>$t.toastId===p.id?{...$t,height:Gt}:$t):[{toastId:p.id,height:Gt,position:p.position},...gn])},[J,p.title,p.description,b,p.id,p.jsx,p.action,p.cancel]);const Nr=be.useCallback(()=>{pe(!0),Xe(pr.current),b(Ve=>Ve.filter(zt=>zt.toastId!==p.id)),setTimeout(()=>{R(p)},iz)},[p,R,b,pr]);be.useEffect(()=>{if(p.promise&&xt==="loading"||p.duration===1/0||p.type==="loading")return;let Ve;return _||g||Bo?(()=>{if(Ga.current<Nt.current){const gn=new Date().getTime()-Nt.current;st.current=st.current-gn}Ga.current=new Date().getTime()})():(()=>{st.current!==1/0&&(Nt.current=new Date().getTime(),Ve=setTimeout(()=>{p.onAutoClose==null||p.onAutoClose.call(p,p),Nr()},st.current))})(),()=>clearTimeout(Ve)},[_,g,p,xt,Bo,Nr]),be.useEffect(()=>{p.delete&&(Nr(),p.onDismiss==null||p.onDismiss.call(p,p))},[Nr,p.delete]);function Tl(){var Ve;if(W?.loading){var zt;return be.createElement("div",{className:Qr(L?.loader,p==null||(zt=p.classNames)==null?void 0:zt.loader,"sonner-loader"),"data-visible":xt==="loading"},W.loading)}return be.createElement(j5,{className:Qr(L?.loader,p==null||(Ve=p.classNames)==null?void 0:Ve.loader),visible:xt==="loading"})}const qs=p.icon||W?.[xt]||z5(xt);var qa,Nl;return be.createElement("li",{tabIndex:0,ref:pt,className:Qr(O,hr,L?.toast,p==null||(t=p.classNames)==null?void 0:t.toast,L?.default,L?.[xt],p==null||(e=p.classNames)==null?void 0:e[xt]),"data-sonner-toast":"","data-rich-colors":(qa=p.richColors)!=null?qa:A,"data-styled":!(p.jsx||p.unstyled||m),"data-mounted":J,"data-promise":!!p.promise,"data-swiped":Ee,"data-removed":ye,"data-visible":Qt,"data-y-position":Fn,"data-x-position":Vr,"data-index":E,"data-front":Qn,"data-swiping":de,"data-dismissible":Lt,"data-type":xt,"data-invert":Fo,"data-swipe-out":xe,"data-swipe-direction":q,"data-expanded":!!(_||K&&J),style:{"--index":E,"--toasts-before":E,"--z-index":C.length-E,"--offset":`${ye?Fe:pr.current}px`,"--initial-height":K?"auto":`${it}px`,...M,...p.style},onDragEnd:()=>{ce(!1),P(null),ze.current=null},onPointerDown:Ve=>{Ve.button!==2&&(Gs||!Lt||(mn.current=new Date,Xe(pr.current),Ve.target.setPointerCapture(Ve.pointerId),Ve.target.tagName!=="BUTTON"&&(ce(!0),ze.current={x:Ve.clientX,y:Ve.clientY})))},onPointerUp:()=>{var Ve,zt,Gt;if(xe||!Lt)return;ze.current=null;const gn=Number(((Ve=pt.current)==null?void 0:Ve.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),Po=Number(((zt=pt.current)==null?void 0:zt.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),$t=new Date().getTime()-((Gt=mn.current)==null?void 0:Gt.getTime()),Ut=Z==="x"?gn:Po,jt=Math.abs(Ut)/$t;if(Math.abs(Ut)>=oz||jt>.11){Xe(pr.current),p.onDismiss==null||p.onDismiss.call(p,p),ne(Z==="x"?gn>0?"right":"left":Po>0?"down":"up"),Nr(),we(!0);return}else{var wt,un;(wt=pt.current)==null||wt.style.setProperty("--swipe-amount-x","0px"),(un=pt.current)==null||un.style.setProperty("--swipe-amount-y","0px")}De(!1),ce(!1),P(null)},onPointerMove:Ve=>{var zt,Gt,gn;if(!ze.current||!Lt||((zt=window.getSelection())==null?void 0:zt.toString().length)>0)return;const $t=Ve.clientY-ze.current.y,Ut=Ve.clientX-ze.current.x;var jt;const wt=(jt=n.swipeDirections)!=null?jt:sz(ee);!Z&&(Math.abs(Ut)>1||Math.abs($t)>1)&&P(Math.abs(Ut)>Math.abs($t)?"x":"y");let un={x:0,y:0};const wi=ga=>1/(1.5+Math.abs(ga)/20);if(Z==="y"){if(wt.includes("top")||wt.includes("bottom"))if(wt.includes("top")&&$t<0||wt.includes("bottom")&&$t>0)un.y=$t;else{const ga=$t*wi($t);un.y=Math.abs(ga)<Math.abs($t)?ga:$t}}else if(Z==="x"&&(wt.includes("left")||wt.includes("right")))if(wt.includes("left")&&Ut<0||wt.includes("right")&&Ut>0)un.x=Ut;else{const ga=Ut*wi(Ut);un.x=Math.abs(ga)<Math.abs(Ut)?ga:Ut}(Math.abs(un.x)>0||Math.abs(un.y)>0)&&De(!0),(Gt=pt.current)==null||Gt.style.setProperty("--swipe-amount-x",`${un.x}px`),(gn=pt.current)==null||gn.style.setProperty("--swipe-amount-y",`${un.y}px`)}},Rt&&!p.jsx&&xt!=="loading"?be.createElement("button",{"aria-label":U,"data-disabled":Gs,"data-close-button":!0,onClick:Gs||!Lt?()=>{}:()=>{Nr(),p.onDismiss==null||p.onDismiss.call(p,p)},className:Qr(L?.closeButton,p==null||(r=p.classNames)==null?void 0:r.closeButton)},(Nl=W?.close)!=null?Nl:q5):null,(xt||p.icon||p.promise)&&p.icon!==null&&(W?.[xt]!==null||p.icon)?be.createElement("div",{"data-icon":"",className:Qr(L?.icon,p==null||(a=p.classNames)==null?void 0:a.icon)},p.promise||p.type==="loading"&&!p.icon?p.icon||Tl():null,p.type!=="loading"?qs:null):null,be.createElement("div",{"data-content":"",className:Qr(L?.content,p==null||(o=p.classNames)==null?void 0:o.content)},be.createElement("div",{"data-title":"",className:Qr(L?.title,p==null||(u=p.classNames)==null?void 0:u.title)},p.jsx?p.jsx:typeof p.title=="function"?p.title():p.title),p.description?be.createElement("div",{"data-description":"",className:Qr(V,Bn,L?.description,p==null||(l=p.classNames)==null?void 0:l.description)},typeof p.description=="function"?p.description():p.description):null),be.isValidElement(p.cancel)?p.cancel:p.cancel&&lf(p.cancel)?be.createElement("button",{"data-button":!0,"data-cancel":!0,style:p.cancelButtonStyle||k,onClick:Ve=>{lf(p.cancel)&&Lt&&(p.cancel.onClick==null||p.cancel.onClick.call(p.cancel,Ve),Nr())},className:Qr(L?.cancelButton,p==null||(c=p.classNames)==null?void 0:c.cancelButton)},p.cancel.label):null,be.isValidElement(p.action)?p.action:p.action&&lf(p.action)?be.createElement("button",{"data-button":!0,"data-action":!0,style:p.actionButtonStyle||B,onClick:Ve=>{lf(p.action)&&(p.action.onClick==null||p.action.onClick.call(p.action,Ve),!Ve.defaultPrevented&&Nr())},className:Qr(L?.actionButton,p==null||(f=p.classNames)==null?void 0:f.actionButton)},p.action.label):null)};function xw(){if(typeof window>"u"||typeof document>"u")return"ltr";const n=document.documentElement.getAttribute("dir");return n==="auto"||!n?window.getComputedStyle(document.documentElement).direction:n}function lz(n,t){const e={};return[n,t].forEach((r,a)=>{const o=a===1,u=o?"--mobile-offset":"--offset",l=o?nz:tz;function c(f){["top","right","bottom","left"].forEach(h=>{e[`${u}-${h}`]=typeof f=="number"?`${f}px`:f})}typeof r=="number"||typeof r=="string"?c(r):typeof r=="object"?["top","right","bottom","left"].forEach(f=>{r[f]===void 0?e[`${u}-${f}`]=l:e[`${u}-${f}`]=typeof r[f]=="number"?`${r[f]}px`:r[f]}):c(l)}),e}const cz=be.forwardRef(function(t,e){const{invert:r,position:a="bottom-right",hotkey:o=["altKey","KeyT"],expand:u,closeButton:l,className:c,offset:f,mobileOffset:h,theme:p="light",richColors:m,duration:g,style:b,visibleToasts:x=ez,toastOptions:w,dir:E=xw(),gap:C=az,icons:_,containerAriaLabel:R="Notifications"}=t,[A,D]=be.useState([]),M=be.useMemo(()=>Array.from(new Set([a].concat(A.filter(q=>q.position).map(q=>q.position)))),[A,a]),[k,B]=be.useState([]),[O,V]=be.useState(!1),[H,ee]=be.useState(!1),[$,K]=be.useState(p!=="system"?p:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),L=be.useRef(null),W=o.join("+").replace(/Key/g,"").replace(/Digit/g,""),U=be.useRef(null),Z=be.useRef(!1),P=be.useCallback(q=>{D(ne=>{var J;return(J=ne.find(le=>le.id===q.id))!=null&&J.delete||Wn.dismiss(q.id),ne.filter(({id:le})=>le!==q.id)})},[]);return be.useEffect(()=>Wn.subscribe(q=>{if(q.dismiss){requestAnimationFrame(()=>{D(ne=>ne.map(J=>J.id===q.id?{...J,delete:!0}:J))});return}setTimeout(()=>{oE.flushSync(()=>{D(ne=>{const J=ne.findIndex(le=>le.id===q.id);return J!==-1?[...ne.slice(0,J),{...ne[J],...q},...ne.slice(J+1)]:[q,...ne]})})})}),[A]),be.useEffect(()=>{if(p!=="system"){K(p);return}if(p==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?K("dark"):K("light")),typeof window>"u")return;const q=window.matchMedia("(prefers-color-scheme: dark)");try{q.addEventListener("change",({matches:ne})=>{K(ne?"dark":"light")})}catch{q.addListener(({matches:J})=>{try{K(J?"dark":"light")}catch(le){console.error(le)}})}},[p]),be.useEffect(()=>{A.length<=1&&V(!1)},[A]),be.useEffect(()=>{const q=ne=>{var J;if(o.every(pe=>ne[pe]||ne.code===pe)){var ye;V(!0),(ye=L.current)==null||ye.focus()}ne.code==="Escape"&&(document.activeElement===L.current||(J=L.current)!=null&&J.contains(document.activeElement))&&V(!1)};return document.addEventListener("keydown",q),()=>document.removeEventListener("keydown",q)},[o]),be.useEffect(()=>{if(L.current)return()=>{U.current&&(U.current.focus({preventScroll:!0}),U.current=null,Z.current=!1)}},[L.current]),be.createElement("section",{ref:e,"aria-label":`${R} ${W}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},M.map((q,ne)=>{var J;const[le,ye]=q.split("-");return A.length?be.createElement("ol",{key:q,dir:E==="auto"?xw():E,tabIndex:-1,ref:L,className:c,"data-sonner-toaster":!0,"data-sonner-theme":$,"data-y-position":le,"data-x-position":ye,style:{"--front-toast-height":`${((J=k[0])==null?void 0:J.height)||0}px`,"--width":`${rz}px`,"--gap":`${C}px`,...b,...lz(f,h)},onBlur:pe=>{Z.current&&!pe.currentTarget.contains(pe.relatedTarget)&&(Z.current=!1,U.current&&(U.current.focus({preventScroll:!0}),U.current=null))},onFocus:pe=>{pe.target instanceof HTMLElement&&pe.target.dataset.dismissible==="false"||Z.current||(Z.current=!0,U.current=pe.relatedTarget)},onMouseEnter:()=>V(!0),onMouseMove:()=>V(!0),onMouseLeave:()=>{H||V(!1)},onDragEnd:()=>V(!1),onPointerDown:pe=>{pe.target instanceof HTMLElement&&pe.target.dataset.dismissible==="false"||ee(!0)},onPointerUp:()=>ee(!1)},A.filter(pe=>!pe.position&&ne===0||pe.position===q).map((pe,de)=>{var ce,xe;return be.createElement(uz,{key:pe.id,icons:_,index:de,toast:pe,defaultRichColors:m,duration:(ce=w?.duration)!=null?ce:g,className:w?.className,descriptionClassName:w?.descriptionClassName,invert:r,visibleToasts:x,closeButton:(xe=w?.closeButton)!=null?xe:l,interacting:H,position:q,style:w?.style,unstyled:w?.unstyled,classNames:w?.classNames,cancelButtonStyle:w?.cancelButtonStyle,actionButtonStyle:w?.actionButtonStyle,closeButtonAriaLabel:w?.closeButtonAriaLabel,removeToast:P,toasts:A.filter(we=>we.position==pe.position),heights:k.filter(we=>we.position==pe.position),setHeights:B,expandByDefault:u,gap:C,expanded:O,swipeDirections:t.swipeDirections})})):null}))}),ww={admin_username:"admin",admin_password:"admin",min_capture_interval_minutes:3},Zu=async n=>{const e=new TextEncoder().encode(n),r=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(r)).map(o=>o.toString(16).padStart(2,"0")).join("")},Lg="registered_faces",fl="app_config",Ws="attendance_log",Rl=()=>{const n=localStorage.getItem(Lg);return n?JSON.parse(n):[]},wd=n=>{localStorage.setItem(Lg,JSON.stringify(n))},fz=()=>Rl(),dz=(n,t,e)=>{const r=Rl();if(r.some(a=>a.id===n))throw new Error(`Employee with ID ${n} already exists.`);r.push({id:n,name:t,descriptor:Array.from(e)}),wd(r)},hz=n=>{let t=Rl();const e=t.length;return t=t.filter(r=>r.id!==n),t.length<e?(wd(t),!0):!1},pz=(n,t)=>{const e=Rl();let r=!1;for(const a of e)if(a.id===n){a.name=t,r=!0;break}return r&&wd(e),r},mf=async()=>{const n=localStorage.getItem(fl);if(console.log(n),n){const r=JSON.parse(n);if(r.admin_username&&r.admin_password)return r}const t=await Zu(ww.admin_password),e={...ww,admin_password:t};return localStorage.setItem(fl,JSON.stringify(e)),e},Cv=async n=>{n.admin_password&&!/^[0-9a-f]{64}$/i.test(n.admin_password)&&(n.admin_password=await Zu(n.admin_password)),localStorage.setItem(fl,JSON.stringify(n))},Al=n=>{const t=localStorage.getItem(Ws),e=t?JSON.parse(t):[];if(!n)return e;const r=n.toLowerCase();return e.filter(a=>a.toLowerCase().includes(r))},vz=n=>{const t=Al();t.push(n),localStorage.setItem(Ws,JSON.stringify(t))},mz=n=>{let t=Al();const e=t.length;return t=t.filter(r=>r!==n),t.length<e?(localStorage.setItem(Ws,JSON.stringify(t)),!0):!1},gz=(n,t)=>{const e=Al(),r=e.indexOf(n);return r!==-1?(e[r]=t,localStorage.setItem(Ws,JSON.stringify(e)),!0):!1},yz=n=>{const t=`employee,time
`,e=n.map(l=>{const c=l.split(" - ");if(c.length>=3){const f=c[1],h=c.slice(2).join(" - ").replace(/Z$/,"");return`${f},${h}`}return`"${l}",""`}).join(`
`),r=t+e,a=new Blob([r],{type:"text/csv;charset=utf-8;"}),o=document.createElement("a"),u=URL.createObjectURL(a);o.setAttribute("href",u),o.setAttribute("download","attendance_report.csv"),o.style.visibility="hidden",document.body.appendChild(o),o.click(),document.body.removeChild(o)},bz=async()=>{const n=Rl(),t=await mf(),e=Al(),r={...t,admin_password:btoa(t.admin_password)},a={registeredFaces:n,config:r,attendanceLogs:e},o=new Blob([JSON.stringify(a,null,2)],{type:"application/json"}),u=document.createElement("a");u.href=URL.createObjectURL(o),u.download="attendance_app_backup.json",document.body.appendChild(u),u.click(),document.body.removeChild(u)},xz=n=>new Promise((t,e)=>{if(!n)return e(new Error("No file selected."));const r=new FileReader;r.onload=a=>{try{const o=JSON.parse(a.target?.result);if(o.registeredFaces&&o.config&&o.attendanceLogs){const u={...o.config,admin_password:atob(o.config.admin_password)};wd(o.registeredFaces),localStorage.setItem(fl,JSON.stringify(u)),localStorage.setItem(Ws,JSON.stringify(o.attendanceLogs)),t("Data restored successfully. The application will now reload.")}else e(new Error("Invalid backup file format."))}catch(o){e(new Error(`Error parsing backup file: ${o.message}`))}},r.onerror=()=>{e(new Error("Error reading file"))},r.readAsText(n)}),wz=()=>new Promise((n,t)=>{try{localStorage.removeItem(Lg),localStorage.removeItem(fl),localStorage.removeItem(Ws),n("All data has been reset. The application will now reload.")}catch(e){t(new Error(`Error resetting data: ${e.message}`))}}),cf="/Face-Recognition-Attendance-System",Sz=({config:n,lastAttendanceTime:t,setLastAttendanceTime:e,realtimeDetectionEnabled:r})=>{const a=F.useRef(null),o=F.useRef(null),[u,l]=F.useState(!1),[c,f]=F.useState({active:!1,borderColor:"default"}),[h,p]=F.useState("Loading models..."),[m,g]=F.useState(!1),[b,x]=F.useState([]),[w,E]=F.useState(null);F.useEffect(()=>{_()},[]);const C=(O,V="default")=>{p(O),f(H=>({...H,borderColor:V})),yw(O)};F.useEffect(()=>{if(b.length>0){const O=b.map(V=>new ys(V.id,[new Float32Array(V.descriptor)]));E(O)}else E(null)},[b]);const _=async()=>{try{g(!0),await On.tinyFaceDetector.loadFromUri(cf),await On.faceLandmark68Net.loadFromUri(cf),await On.faceRecognitionNet.loadFromUri(cf),await On.ssdMobilenetv1.loadFromUri(cf),l(!0),C("Models loaded. Loading configuration...","default"),console.log("Real time detection: ",r),R()}catch(O){console.error("Error initializing app:",O),C("Error initializing app. Please check console.","destructive"),yw("Failed to load face recognition models.")}finally{g(!1)}},R=()=>{try{const O=fz();x(O),C(`Loaded ${O.length} registered faces.`,"default")}catch(O){console.error("Error loading registered faces:",O),C("Error loading registered faces.","destructive")}},A=async()=>{if(!c.active)try{g(!0);const O=await navigator.mediaDevices.getUserMedia({video:{width:{ideal:640},height:{ideal:480},facingMode:"user"}});a.current&&(a.current.srcObject=O,a.current.play()),f({active:!0,borderColor:"success"}),C("Camera active. Ready for attendance.","success")}catch(O){console.error("Error accessing camera:",O),C("Error accessing camera. Please ensure camera permissions are granted.","destructive")}finally{g(!1)}},D=()=>{a.current?.srcObject&&(a.current.srcObject.getTracks().forEach(V=>V.stop()),a.current.srcObject=null),f({active:!1,borderColor:"default"}),C("Camera stopped.","default")},M=O=>{if(!o.current||!a.current)return;if(a.current.videoWidth===0||a.current.videoHeight===0){setTimeout(()=>M(O),1e3);return}const V={width:a.current.videoWidth,height:a.current.videoHeight};EM(o.current,V);const H=setInterval(async()=>{if(!a.current||a.current.paused||a.current.ended||!u)return;const ee=o.current?.getContext("2d");if(ee&&o.current&&ee.clearRect(0,0,o.current.width,o.current.height),O){const $=await I1(a.current,new Ro).withFaceLandmarks().withFaceDescriptors(),K=WS($,V);if(ee&&o.current&&(mM(o.current,K),MM(o.current,K),w)){const L=new B1(w,.6);K.forEach(W=>{const U=L.findBestMatch(W.descriptor),Z=W.detection.box;new pS(Z,{label:U.toString()}).draw(o.current)})}}},100);return()=>clearInterval(H)};return{videoRef:a,canvasRef:o,modelsLoaded:u,cameraStatus:c,statusMessage:h,loading:m,registeredFaces:b,internalLabeledFaceDescriptors:w,updateStatus:C,setRegisteredFaces:x,setInternalLabeledFaceDescriptors:E,initializeApp:_,loadRegisteredFaces:R,startCamera:A,stopCamera:D,handleVideoPlay:M,handleRegisterFace:async(O,V)=>{if(!O||!V){C("Please enter both Employee ID and Name.","warning");return}if(!c.active||!a.current){C("Camera not active. Please start camera.","warning");return}g(!0);try{const H=await YO(a.current,new Ro).withFaceLandmarks().withFaceDescriptor();H?(dz(O,V,H.descriptor),R(),C(`Face for ${V} (ID: ${O}) registered successfully!`,"success")):C("No face detected. Please ensure your face is clearly visible.","warning")}catch(H){C(`Registration Error: ${H.message}`,"destructive")}finally{g(!1)}},handleMarkAttendance:async()=>{if(!c.active||!a.current){C("Camera not active. Please start camera.","warning");return}if(!w||w.length===0){C("No faces registered. Please register faces first.","warning");return}g(!0);try{const O=await I1(a.current,new Ro).withFaceLandmarks().withFaceDescriptors();if(O.length===0){C("No face detected for attendance.","warning");return}const V=new B1(w,.6);let H=0,ee=0,$=0;for(const K of O){const L=V.findBestMatch(K.descriptor);if(L.label!=="unknown"){const W=L.label,U=b.find(J=>J.id===W)?.name||"Unknown",Z=new Date,P=n.min_capture_interval_minutes;if(t[W]){const J=(Z.getTime()-t[W].getTime())/6e4;if(J<P){C(`${U} (ID: ${W}) already marked attendance recently. Please wait ${Math.ceil(P-J)} minutes.`,"warning"),$++;continue}}const q=Z.toISOString(),ne=`${U} - ${W} - ${q}`;vz(ne),e(J=>({...J,[W]:Z})),C(`Attendance Marked for: ${U} (ID: ${W})`,"success"),H++}else ee++}H===0&&ee>0?C("Unknown face detected.","destructive"):H===0&&$===0&&C("No registered faces detected for attendance.","warning")}catch{C("Error marking attendance. Please try again.","destructive")}finally{g(!1)}}}},Ez=({updateStatus:n,loadRegisteredFaces:t,config:e,setConfig:r,setLoading:a,setActiveView:o})=>{const[u,l]=F.useState(!1),[c,f]=F.useState(""),[h,p]=F.useState(""),[m,g]=F.useState(!1),[b,x]=F.useState(""),[w,E]=F.useState(""),[C,_]=F.useState(""),[R,A]=F.useState([]),[D,M]=F.useState(""),[k,B]=F.useState(""),[O,V]=F.useState(""),[H,ee]=F.useState(""),[$,K]=F.useState(""),L=async()=>{if(!c||!h){n("Please enter both username and password.","warning");return}a(!0);try{const ce=await mf(),xe=await Zu(h);console.log(ce.admin_password,xe),c===ce.admin_username&&xe===ce.admin_password?(l(!0),n("Admin logged in successfully!","success"),o("attendance")):n("Invalid admin credentials. Please try again.","destructive")}catch{n("Error during login. Please try again.","destructive")}finally{a(!1)}},W=()=>{l(!1),f(""),p(""),n("Admin logged out.","default"),o("attendance")},U=async ce=>{if(!b){n("Please select an employee ID.","warning");return}try{if(ce==="delete")hz(b)&&(t(),n(`Face data for ID ${b} deleted.`,"success"),x(""));else if(ce==="update"){if(!w){n("Please enter a new name.","warning");return}pz(b,w)&&(t(),n(`Name for ID ${b} updated to ${w}.`,"success"),x(""),E(""))}}catch(xe){n(`Error managing face: ${xe.message}`,"destructive")}},Z=()=>{const ce=Al(C);A(ce)};return{adminLoggedIn:u,setAdminLoggedIn:l,adminUsername:c,setAdminUsername:f,adminPassword:h,setAdminPassword:p,showPassword:m,setShowPassword:g,selectedFaceId:b,setSelectedFaceId:x,newFaceName:w,setNewFaceName:E,reportFilter:C,setReportFilter:_,filteredLogs:R,setFilteredLogs:A,selectedLog:D,setSelectedLog:M,newLogEntry:k,setNewLogEntry:B,oldAdminPassword:O,setOldAdminPassword:V,newAdminUsername:H,setNewAdminUsername:ee,newAdminPassword:$,setNewAdminPassword:K,handleAdminLogin:L,handleAdminLogout:W,handleManageFaces:U,handleViewReports:Z,handleEditLog:()=>{if(!D||!k){n("Please select a log and enter a new entry to edit.","warning");return}gz(D,k)?(n("Log entry updated successfully!","success"),Z(),M(""),B("")):n("Failed to update log entry.","destructive")},handleDeleteLog:()=>{if(!D){n("Please select a log to delete.","warning");return}mz(D)?(n("Log entry deleted successfully!","success"),Z(),M("")):n("Failed to delete log entry.","destructive")},handleSaveReportsAsCsv:()=>{if(R.length===0){n("No logs to export.","warning");return}yz(R),n("Attendance report downloaded as CSV successfully.","success")},handleSaveAdminSettings:async()=>{try{const ce=await mf(),xe=Number.parseInt(e.min_capture_interval_minutes.toString());if(isNaN(xe)||xe<0){n("Minimum capture interval must be a non-negative number.","warning");return}console.log("New min interval:",xe);const we={...ce,min_capture_interval_minutes:xe};await Cv(we),r(we),n("Admin credentials updated successfully!","success")}catch{n("Error updating credentials.","destructive")}finally{a(!1)}try{console.log("New min interval:",e);const ce=Number.parseInt(e.min_capture_interval_minutes.toString());if(isNaN(ce)||ce<0){n("Minimum capture interval must be a non-negative number.","warning");return}await Cv(e),n("Admin settings saved successfully!","success")}catch(ce){n(`Error saving settings: ${ce.message}`,"destructive")}},handleChangeAdminCredentials:async()=>{if(!O){n("Please enter your old password.","warning");return}a(!0);try{const ce=await mf();if(await Zu(O)!==ce.admin_password){n("Incorrect old password.","destructive");return}const we={...ce};H&&(we.admin_username=H),$&&(we.admin_password=await Zu($)),await Cv(we),r(we),V(""),ee(""),K(""),n("Admin credentials updated successfully!","success")}catch{n("Error updating credentials.","destructive")}finally{a(!1)}},handleExportData:async()=>{try{await bz(),n("All data exported successfully!","success")}catch(ce){n(`Error exporting data: ${ce.message}`,"destructive")}},handleImportData:async ce=>{const xe=ce.target.files?.[0];if(xe){a(!0);try{const we=await xz(xe);n(we,"success"),setTimeout(()=>window.location.reload(),2e3)}catch(we){n(`Error importing data: ${we.message}`,"destructive")}finally{a(!1)}}},handleResetData:async()=>{if(window.confirm("Are you sure you want to reset all data? This action cannot be undone.")){a(!0);try{const ce=await wz();n(ce,"success"),setTimeout(()=>window.location.reload(),2e3)}catch(ce){n(`Error resetting data: ${ce.message}`,"destructive")}finally{a(!1)}}}}};var Sd="Switch",[Cz,Hz]=xi(Sd),[_z,Rz]=Cz(Sd),JC=F.forwardRef((n,t)=>{const{__scopeSwitch:e,name:r,checked:a,defaultChecked:o,required:u,disabled:l,value:c="on",onCheckedChange:f,form:h,...p}=n,[m,g]=F.useState(null),b=bt(t,_=>g(_)),x=F.useRef(!1),w=m?h||!!m.closest("form"):!0,[E,C]=cl({prop:a,defaultProp:o??!1,onChange:f,caller:Sd});return N.jsxs(_z,{scope:e,checked:E,disabled:l,children:[N.jsx(nt.button,{type:"button",role:"switch","aria-checked":E,"aria-required":u,"data-state":r_(E),"data-disabled":l?"":void 0,disabled:l,value:c,...p,ref:b,onClick:et(n.onClick,_=>{C(R=>!R),w&&(x.current=_.isPropagationStopped(),x.current||_.stopPropagation())})}),w&&N.jsx(n_,{control:m,bubbles:!x.current,name:r,value:c,checked:E,required:u,disabled:l,form:h,style:{transform:"translateX(-100%)"}})]})});JC.displayName=Sd;var e_="SwitchThumb",t_=F.forwardRef((n,t)=>{const{__scopeSwitch:e,...r}=n,a=Rz(e_,e);return N.jsx(nt.span,{"data-state":r_(a.checked),"data-disabled":a.disabled?"":void 0,...r,ref:t})});t_.displayName=e_;var Az="SwitchBubbleInput",n_=F.forwardRef(({__scopeSwitch:n,control:t,checked:e,bubbles:r=!0,...a},o)=>{const u=F.useRef(null),l=bt(u,o),c=PE(e),f=_E(t);return F.useEffect(()=>{const h=u.current;if(!h)return;const p=window.HTMLInputElement.prototype,g=Object.getOwnPropertyDescriptor(p,"checked").set;if(c!==e&&g){const b=new Event("click",{bubbles:r});g.call(h,e),h.dispatchEvent(b)}},[c,e,r]),N.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:e,...a,tabIndex:-1,ref:l,style:{...a.style,...f,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});n_.displayName=Az;function r_(n){return n?"checked":"unchecked"}var Tz=JC,Nz=t_;function Dz({className:n,...t}){return N.jsx(Tz,{"data-slot":"switch",className:Ct("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",n),...t,children:N.jsx(Nz,{"data-slot":"switch-thumb",className:Ct("bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0")})})}function kz(){const[n,t]=F.useState("attendance"),[e,r]=F.useState({}),[a,o]=F.useState({}),[u,l]=F.useState(!1),[c,f]=F.useState(!1),[h,p]=F.useState(""),[m,g]=F.useState(""),{videoRef:b,canvasRef:x,modelsLoaded:w,cameraStatus:E,loading:C,registeredFaces:_,statusMessage:R,loadRegisteredFaces:A,updateStatus:D,setRegisteredFaces:M,setInternalLabeledFaceDescriptors:k,initializeApp:B,startCamera:O,stopCamera:V,handleVideoPlay:H,handleRegisterFace:ee,handleMarkAttendance:$}=Sz({config:a,lastAttendanceTime:e,setLastAttendanceTime:r,realtimeDetectionEnabled:c}),{adminLoggedIn:K,adminUsername:L,setAdminUsername:W,adminPassword:U,setAdminPassword:Z,showPassword:P,setShowPassword:q,selectedFaceId:ne,setSelectedFaceId:J,newFaceName:le,setNewFaceName:ye,reportFilter:pe,setReportFilter:de,filteredLogs:ce,selectedLog:xe,setSelectedLog:we,newLogEntry:Ee,setNewLogEntry:De,oldAdminPassword:Fe,setOldAdminPassword:Xe,newAdminUsername:it,setNewAdminUsername:rt,newAdminPassword:st,setNewAdminPassword:mn,handleAdminLogin:pt,handleAdminLogout:Qn,handleManageFaces:Qt,handleViewReports:xt,handleEditLog:Lt,handleDeleteLog:hr,handleSaveReportsAsCsv:Bn,handleSaveAdminSettings:_n,handleChangeAdminCredentials:Rt,handleExportData:At,handleImportData:Nt,handleResetData:pr}=Ez({updateStatus:D,loadRegisteredFaces:A,setRegisteredFaces:M,config:a,setConfig:o,setLoading:l,setActiveView:t});F.useEffect(()=>{if(_.length>0){const ze=_.map(Fn=>new ys(Fn.id,[new Float32Array(Fn.descriptor)]));k(ze)}else k(null)},[_]),F.useEffect(()=>{B()},[]);const Ga=()=>{switch(E.borderColor){case"success":return"border-success-DEFAULT shadow-success-light shadow-lg";case"warning":return"border-warning-DEFAULT shadow-warning-light shadow-lg";case"destructive":return"border-destructive-DEFAULT shadow-destructive-light shadow-lg";default:return"border-background-dark shadow-background-DEFAULT shadow-lg"}};return N.jsx("div",{className:"min-h-screen bg-gradient-to-br from-background-light via-blue-50 to-indigo-100",children:N.jsxs("div",{className:"container mx-auto px-4 py-6",children:[N.jsx("div",{className:"mb-8",children:N.jsx(P5,{statusMessage:R,cameraBorderColor:E.borderColor})}),N.jsxs("div",{className:"space-y-6",children:[N.jsx(B5,{adminLoggedIn:K,adminUsername:L,setAdminUsername:W,adminPassword:U,setAdminPassword:Z,showPassword:P,setShowPassword:q,loading:C,handleAdminLogin:pt,handleAdminLogout:Qn,activeView:n,setActiveView:t}),N.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[N.jsxs(Uf,{className:"border-0 shadow-lg bg-background-DEFAULT/90 backdrop-blur-sm",children:[N.jsx(wg,{className:"pb-4",children:N.jsxs(Sg,{className:"flex items-center justify-between",children:[N.jsxs("div",{className:"flex items-center gap-3",children:[N.jsx("div",{className:"p-2 rounded-lg bg-primary-light/20",children:N.jsx(hw,{className:"h-5 w-5 text-primary-DEFAULT"})}),N.jsx("span",{className:"text-xl font-semibold text-text-dark",children:"Live Camera Feed"})]}),N.jsxs("div",{className:"flex items-center gap-3",children:[N.jsx("div",{className:"flex items-center justify-between space-x-2",children:K&&N.jsxs(N.Fragment,{children:[N.jsx(Ir,{htmlFor:"realtimeDetection",className:"text-sm font-semibold text-slate-700",children:"Realtime Face Detection"}),N.jsx(Dz,{id:"realtimeDetection",checked:c,onCheckedChange:f,className:"data-[state=checked]:bg-green-500 data-[state=unchecked]:bg-slate-200"})]})}),N.jsx(GL,{variant:E.active?"default":"secondary",className:`${E.active?"bg-success-light text-success-dark border-success-DEFAULT":"bg-background-dark text-text-DEFAULT border-background-DEFAULT"}`,children:E.active?"Active":"Inactive"})]})]})}),N.jsx($v,{children:N.jsxs("div",{className:"space-y-4",children:[N.jsxs("div",{className:`relative rounded-2xl border-4 overflow-hidden bg-gradient-to-br from-slate-900 to-slate-800 shadow-inner ${Ga()}`,children:[N.jsx("video",{ref:b,onPlay:()=>H(c),className:"w-full h-auto max-h-[400px] object-cover rounded-xl",muted:!0,playsInline:!0}),N.jsx("canvas",{ref:x,className:"absolute top-0 left-0 w-full h-full rounded-xl"}),!E.active&&N.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gradient-to-br from-slate-900/80 to-slate-800/80 rounded-xl",children:N.jsxs("div",{className:"text-center text-white",children:[N.jsx("div",{className:"p-4 rounded-full bg-white/10 backdrop-blur-sm mb-4 inline-block",children:N.jsx(dw,{className:"h-12 w-12"})}),N.jsx("p",{className:"text-lg font-medium",children:"Camera is not active"}),N.jsx("p",{className:"text-sm text-slate-300 mt-1",children:'Click "Start Camera" to begin'})]})})]}),N.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[N.jsxs(kt,{onClick:O,disabled:E.active||C,className:"bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-white font-medium py-3",children:[N.jsx(hw,{className:"mr-2 h-4 w-4"}),C?"Starting...":"Start Camera"]}),N.jsxs(kt,{onClick:V,disabled:!E.active,variant:"outline",className:"border-red-200 text-red-600 hover:bg-red-50 font-medium py-3 bg-transparent",children:[N.jsx(dw,{className:"mr-2 h-4 w-4"}),"Stop Camera"]})]}),n==="attendance"&&N.jsx("div",{className:"mt-4 text-center",children:N.jsx(kt,{onClick:$,disabled:!E.active||!w||C,size:"lg",className:"w-full bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white font-semibold px-8 py-4 text-lg shadow-lg",children:C?N.jsxs(N.Fragment,{children:[N.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-3"}),"Processing..."]}):N.jsxs(N.Fragment,{children:[N.jsx(cm,{className:"mr-3 h-5 w-5"}),"Mark Attendance"]})})})]})})]}),N.jsx(Uf,{className:"border-0 shadow-lg bg-white/90 backdrop-blur-sm",children:N.jsxs($v,{className:"p-6",children:[n==="attendance"&&N.jsxs("div",{className:"space-y-6",children:[N.jsxs("div",{className:"text-center",children:[N.jsx("div",{className:"p-3 rounded-full bg-gradient-to-r from-indigo-100 to-purple-100 inline-block mb-4",children:N.jsx(cm,{className:"h-8 w-8 text-indigo-600"})}),N.jsx("h2",{className:"text-3xl font-bold text-slate-800 mb-2",children:"Attendance Overview"}),N.jsx("p",{className:"text-slate-600 mb-6",children:"Registered employees and attendance status"})]}),_.length>0&&N.jsxs("div",{className:"bg-gradient-to-r from-slate-50 to-blue-50 rounded-2xl p-6",children:[N.jsxs("h3",{className:"text-xl font-semibold text-slate-800 mb-4 flex items-center gap-2",children:[N.jsx(bs,{className:"h-5 w-5 text-indigo-600"}),"Registered Employees (",_.length,")"]}),N.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:_.map(ze=>N.jsx("div",{className:"bg-white rounded-lg p-3 shadow-sm border border-slate-100",children:N.jsxs("div",{className:"flex items-center gap-3",children:[N.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-r from-indigo-500 to-purple-500 flex items-center justify-center text-white font-semibold",children:ze.name.charAt(0).toUpperCase()}),N.jsxs("div",{children:[N.jsx("p",{className:"font-medium text-slate-800",children:ze.name}),N.jsxs("p",{className:"text-sm text-slate-500",children:["ID: ",ze.id]})]})]})},ze.id))})]})]}),n==="register"&&N.jsxs("div",{className:"space-y-6",children:[N.jsxs("div",{className:"text-center mb-6",children:[N.jsx("div",{className:"p-3 rounded-full bg-gradient-to-r from-green-100 to-emerald-100 inline-block mb-4",children:N.jsx(dm,{className:"h-8 w-8 text-green-600"})}),N.jsx("h2",{className:"text-3xl font-bold text-slate-800 mb-2",children:"Register New Face"}),N.jsx("p",{className:"text-slate-600",children:"Add a new employee to the system"})]}),N.jsxs("div",{className:"bg-gradient-to-r from-slate-50 to-blue-50 rounded-2xl p-6",children:[N.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[N.jsxs("div",{className:"space-y-2",children:[N.jsx(Ir,{htmlFor:"employeeId",className:"text-sm font-semibold text-slate-700",children:"Employee ID"}),N.jsx(Or,{id:"employeeId",placeholder:"Enter Employee ID",value:h,onChange:ze=>p(ze.target.value),className:"border-slate-200 focus:border-indigo-500 focus:ring-indigo-500"})]}),N.jsxs("div",{className:"space-y-2",children:[N.jsx(Ir,{htmlFor:"employeeName",className:"text-sm font-semibold text-slate-700",children:"Employee Name"}),N.jsx(Or,{id:"employeeName",placeholder:"Enter Employee Name",value:m,onChange:ze=>g(ze.target.value),className:"border-slate-200 focus:border-indigo-500 focus:ring-indigo-500"})]})]}),N.jsx(kt,{onClick:()=>ee(h,m),disabled:!E.active||!w||C,className:"w-full mt-6 bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-white font-semibold py-3",children:C?N.jsxs(N.Fragment,{children:[N.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Registering..."]}):N.jsxs(N.Fragment,{children:[N.jsx(dm,{className:"mr-2 h-4 w-4"}),"Capture and Register"]})})]})]}),n==="manage"&&N.jsxs("div",{className:"space-y-6",children:[N.jsxs("div",{className:"text-center mb-6",children:[N.jsx("div",{className:"p-3 rounded-full bg-gradient-to-r from-blue-100 to-indigo-100 inline-block mb-4",children:N.jsx(bs,{className:"h-8 w-8 text-blue-600"})}),N.jsx("h2",{className:"text-3xl font-bold text-slate-800 mb-2",children:"Manage Registered Faces"}),N.jsx("p",{className:"text-slate-600",children:"Update or remove employee records"})]}),N.jsxs("div",{className:"bg-gradient-to-r from-slate-50 to-blue-50 rounded-2xl p-6 space-y-6",children:[N.jsxs("div",{className:"space-y-2",children:[N.jsx(Ir,{htmlFor:"selectEmployee",className:"text-sm font-semibold text-slate-700",children:"Select Employee"}),N.jsxs(OL,{value:ne,onValueChange:J,children:[N.jsx(BL,{className:"border-slate-200 focus:border-indigo-500",children:N.jsx(IL,{placeholder:"Select Employee ID"})}),N.jsx(FL,{children:_.map(ze=>N.jsxs(PL,{value:ze.id,children:[ze.id," - ",ze.name]},ze.id))})]})]}),N.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[N.jsxs(kt,{onClick:()=>Qt("delete"),disabled:!ne,variant:"destructive",className:"bg-gradient-to-r from-red-600 to-rose-600 hover:from-red-700 hover:to-rose-700 py-3 text-white",children:[N.jsx(sf,{className:"mr-2 h-4 w-4"}),"Delete Selected"]}),N.jsxs("div",{className:"space-y-3",children:[N.jsx(Or,{placeholder:"New Name (for update)",value:le,onChange:ze=>ye(ze.target.value),className:"border-slate-200 focus:border-indigo-500 focus:ring-indigo-500"}),N.jsxs(kt,{onClick:()=>Qt("update"),disabled:!ne||!le,className:"w-full bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 py-3 text-white",children:[N.jsx(pw,{className:"mr-2 h-4 w-4"}),"Update Name"]})]})]})]}),N.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-6",children:[N.jsxs("h3",{className:"text-xl font-semibold text-slate-800 mb-4 flex items-center gap-2",children:[N.jsx(bs,{className:"h-5 w-5 text-indigo-600"}),"All Registered Faces"]}),N.jsx(gw,{className:"h-64",children:_.length===0?N.jsxs("div",{className:"text-center py-12",children:[N.jsx(bs,{className:"h-12 w-12 text-slate-300 mx-auto mb-4"}),N.jsx("p",{className:"text-slate-500 font-medium",children:"No faces registered yet."}),N.jsx("p",{className:"text-sm text-slate-400",children:"Register your first employee to get started."})]}):N.jsx("div",{className:"space-y-3",children:_.map(ze=>N.jsx("div",{className:"flex items-center justify-between p-4 bg-gradient-to-r from-slate-50 to-blue-50 rounded-lg border border-slate-100",children:N.jsxs("div",{className:"flex items-center gap-3",children:[N.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-r from-indigo-500 to-purple-500 flex items-center justify-center text-white font-semibold",children:ze.name.charAt(0).toUpperCase()}),N.jsxs("div",{children:[N.jsx("p",{className:"font-semibold text-slate-800",children:ze.name}),N.jsxs("p",{className:"text-sm text-slate-500",children:["ID: ",ze.id]})]})]})},ze.id))})})]})]}),n==="reports"&&N.jsxs("div",{className:"space-y-6",children:[N.jsxs("div",{className:"text-center mb-6",children:[N.jsx("div",{className:"p-3 rounded-full bg-gradient-to-r from-purple-100 to-pink-100 inline-block mb-4",children:N.jsx(vf,{className:"h-8 w-8 text-purple-600"})}),N.jsx("h2",{className:"text-3xl font-bold text-slate-800 mb-2",children:"Attendance Reports"}),N.jsx("p",{className:"text-slate-600",children:"View and manage attendance records"})]}),N.jsx("div",{className:"bg-gradient-to-r from-slate-50 to-blue-50 rounded-2xl p-6",children:N.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[N.jsx(Or,{placeholder:"Filter by Name/ID",value:pe,onChange:ze=>de(ze.target.value),className:"flex-1 border-slate-200 focus:border-indigo-500 focus:ring-indigo-500"}),N.jsx(kt,{onClick:xt,className:"bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700",children:"Apply Filter"}),N.jsxs(kt,{onClick:Bn,variant:"outline",className:"border-green-200 text-green-700 hover:bg-green-50 bg-transparent",children:[N.jsx(xv,{className:"mr-2 h-4 w-4"}),"Export CSV"]})]})}),N.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-6",children:[N.jsxs("h3",{className:"text-xl font-semibold text-slate-800 mb-4 flex items-center gap-2",children:[N.jsx(vf,{className:"h-5 w-5 text-purple-600"}),"Attendance Logs"]}),N.jsx(gw,{className:"h-80 mb-4",children:ce.length===0?N.jsxs("div",{className:"text-center py-12",children:[N.jsx(vf,{className:"h-12 w-12 text-slate-300 mx-auto mb-4"}),N.jsx("p",{className:"text-slate-500 font-medium",children:"No logs found."}),N.jsx("p",{className:"text-sm text-slate-400",children:"Attendance records will appear here."})]}):N.jsx("div",{className:"space-y-2",children:ce.map((ze,Fn)=>N.jsx("div",{className:`p-4 rounded-lg cursor-pointer transition-all duration-200 ${xe===ze?"bg-gradient-to-r from-indigo-50 to-purple-50 border-2 border-indigo-200 shadow-sm":"bg-slate-50 hover:bg-slate-100 border border-slate-200"}`,onClick:()=>we(ze),children:N.jsx("p",{className:"text-sm font-medium text-slate-700",children:ze})},Fn))})}),xe&&N.jsxs("div",{className:"bg-gradient-to-r from-slate-50 to-blue-50 rounded-xl p-4 space-y-4",children:[N.jsx(Ir,{htmlFor:"editLog",className:"text-sm font-semibold text-slate-700",children:"Edit Selected Log"}),N.jsx(UL,{id:"editLog",placeholder:"Edit log entry",value:Ee,onChange:ze=>De(ze.target.value),className:"border-slate-200 focus:border-indigo-500 focus:ring-indigo-500"}),N.jsxs("div",{className:"flex gap-3",children:[N.jsxs(kt,{onClick:Lt,disabled:!Ee,className:"flex-1 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700",children:[N.jsx(pw,{className:"mr-2 h-4 w-4"}),"Update Log"]}),N.jsxs(kt,{onClick:hr,variant:"destructive",className:"flex-1 bg-gradient-to-r from-red-600 to-rose-600 hover:from-red-700 hover:to-rose-700",children:[N.jsx(sf,{className:"mr-2 h-4 w-4"}),"Delete Log"]})]})]})]})]}),n==="settings"&&N.jsxs("div",{className:"space-y-6",children:[N.jsxs("div",{className:"text-center mb-6",children:[N.jsx("div",{className:"p-3 rounded-full bg-gradient-to-r from-slate-100 to-gray-100 inline-block mb-4",children:N.jsx(fm,{className:"h-8 w-8 text-slate-600"})}),N.jsx("h2",{className:"text-3xl font-bold text-slate-800 mb-2",children:"Admin Settings"}),N.jsx("p",{className:"text-slate-600",children:"Configure system preferences"})]}),N.jsxs(O5,{defaultValue:"general",className:"w-full bg-slate-100",children:[N.jsxs(I5,{className:"grid w-full grid-cols-3 bg-slate-100 p-1 rounded-xl",children:[N.jsx(Sv,{value:"general",className:"rounded-lg data-[state=active]:bg-white data-[state=active]:shadow-sm",children:"General"}),N.jsx(Sv,{value:"credentials",className:"rounded-lg data-[state=active]:bg-white data-[state=active]:shadow-sm",children:"Credentials"}),N.jsx(Sv,{value:"data",className:"rounded-lg data-[state=active]:bg-white data-[state=active]:shadow-sm",children:"Data"})]}),N.jsx(Ev,{value:"general",className:"space-y-4 mt-6",children:N.jsxs("div",{className:"bg-gradient-to-r from-slate-50 to-blue-50 rounded-2xl p-6 space-y-4",children:[N.jsxs("div",{className:"space-y-2",children:[N.jsx(Ir,{htmlFor:"minInterval",className:"text-sm font-semibold text-slate-700",children:"Minimum Capture Interval (minutes)"}),N.jsx(Or,{id:"minInterval",type:"number",value:a.min_capture_interval_minutes||5,onChange:ze=>o({...a,min_capture_interval_minutes:Number.parseInt(ze.target.value)||5}),className:"border-slate-200 focus:border-indigo-500 focus:ring-indigo-500"})]}),N.jsxs(kt,{onClick:_n,className:"w-full bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700",children:[N.jsx(_L,{className:"mr-2 h-4 w-4"}),"Save Settings"]})]})}),N.jsx(Ev,{value:"credentials",className:"space-y-4 mt-6",children:N.jsxs("div",{className:"bg-gradient-to-r from-slate-50 to-blue-50 rounded-2xl p-6 space-y-4",children:[N.jsxs("div",{className:"space-y-2",children:[N.jsx(Ir,{htmlFor:"oldPassword",className:"text-sm font-semibold text-slate-700",children:"Current Password"}),N.jsx(Or,{id:"oldPassword",type:"password",placeholder:"Enter current password",value:Fe,onChange:ze=>Xe(ze.target.value),className:"border-slate-200 focus:border-indigo-500 focus:ring-indigo-500"})]}),N.jsxs("div",{className:"space-y-2",children:[N.jsx(Ir,{htmlFor:"newUsername",className:"text-sm font-semibold text-slate-700",children:"New Username (optional)"}),N.jsx(Or,{id:"newUsername",placeholder:"Enter new username",value:it,onChange:ze=>rt(ze.target.value),className:"border-slate-200 focus:border-indigo-500 focus:ring-indigo-500"})]}),N.jsxs("div",{className:"space-y-2",children:[N.jsx(Ir,{htmlFor:"newPassword",className:"text-sm font-semibold text-slate-700",children:"New Password (optional)"}),N.jsx(Or,{id:"newPassword",type:"password",placeholder:"Enter new password",value:st,onChange:ze=>mn(ze.target.value),className:"border-slate-200 focus:border-indigo-500 focus:ring-indigo-500"})]}),N.jsx(kt,{onClick:Rt,disabled:!Fe||C,className:"w-full bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700",children:C?N.jsxs(N.Fragment,{children:[N.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Updating..."]}):"Update Credentials"})]})}),N.jsxs(Ev,{value:"data",className:"space-y-6 mt-6",children:[N.jsxs("div",{className:"bg-gradient-to-r from-slate-50 to-blue-50 rounded-2xl p-6",children:[N.jsxs("h3",{className:"text-lg font-semibold text-slate-800 mb-4 flex items-center gap-2",children:[N.jsx(xv,{className:"h-5 w-5 text-blue-600"}),"Backup & Restore"]}),N.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[N.jsxs(kt,{onClick:At,className:"bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700",children:[N.jsx(xv,{className:"mr-2 h-4 w-4"}),"Backup All Data"]}),N.jsxs("div",{children:[N.jsx(Or,{type:"file",accept:".json",onChange:Nt,className:"hidden",id:"import-file"}),N.jsx(kt,{asChild:!0,variant:"outline",className:"w-full border-blue-200 text-blue-700 hover:bg-blue-50 bg-transparent",children:N.jsxs("label",{htmlFor:"import-file",className:"cursor-pointer",children:[N.jsx(DL,{className:"mr-2 h-4 w-4"}),"Restore from Backup"]})})]})]})]}),N.jsx(QL,{}),N.jsxs("div",{className:"bg-gradient-to-r from-red-50 to-rose-50 rounded-2xl p-6 border border-red-100",children:[N.jsxs("h3",{className:"text-lg font-semibold text-red-800 mb-4 flex items-center gap-2",children:[N.jsx(sf,{className:"h-5 w-5 text-red-600"}),"Reset Data"]}),N.jsxs(HL,{className:"mb-4 border-red-200 bg-red-50",children:[N.jsx(lm,{className:"h-4 w-4 text-red-600"}),N.jsx(VL,{className:"text-red-700",children:"This will permanently delete all registered faces, attendance logs, and settings."})]}),N.jsx(kt,{onClick:pr,variant:"destructive",disabled:C,className:"w-full bg-gradient-to-r from-red-600 to-rose-600 hover:from-red-700 hover:to-rose-700",children:C?N.jsxs(N.Fragment,{children:[N.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Resetting..."]}):N.jsxs(N.Fragment,{children:[N.jsx(sf,{className:"mr-2 h-4 w-4"}),"Reset All Data"]})})]})]})]})]})]})})]})]})]})})}var Mz=(n,t,e,r,a,o,u,l)=>{let c=document.documentElement,f=["light","dark"];function h(g){(Array.isArray(n)?n:[n]).forEach(b=>{let x=b==="class",w=x&&o?a.map(E=>o[E]||E):a;x?(c.classList.remove(...w),c.classList.add(o&&o[g]?o[g]:g)):c.setAttribute(b,g)}),p(g)}function p(g){l&&f.includes(g)&&(c.style.colorScheme=g)}function m(){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}if(r)h(r);else try{let g=localStorage.getItem(t)||e,b=u&&g==="system"?m():g;h(b)}catch{}},Oz=F.createContext(void 0),Iz={setTheme:n=>{},themes:[]},Bz=()=>{var n;return(n=F.useContext(Oz))!=null?n:Iz};F.memo(({forcedTheme:n,storageKey:t,attribute:e,enableSystem:r,enableColorScheme:a,defaultTheme:o,value:u,themes:l,nonce:c,scriptProps:f})=>{let h=JSON.stringify([e,t,o,n,l,u,r,a]).slice(1,-1);return F.createElement("script",{...f,suppressHydrationWarning:!0,nonce:typeof window>"u"?c:"",dangerouslySetInnerHTML:{__html:`(${Mz.toString()})(${h})`}})});const Fz=({...n})=>{const{theme:t="system"}=Bz();return N.jsx(cz,{theme:t,className:"toaster group",style:{"--normal-bg":"var(--popover)","--normal-text":"var(--popover-foreground)","--normal-border":"var(--border)"},...n})};EA.createRoot(document.getElementById("root")).render(N.jsxs(F.StrictMode,{children:[N.jsx(kz,{}),N.jsx(Fz,{richColors:!0})]}))});export default Pz();
